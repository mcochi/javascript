(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"+Lap":function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host {\n  width: -webkit-min-content;\n  width: -moz-min-content;\n  width: min-content;\n}\n:host mat-select.default-state-controller {\n  margin: 0;\n}\n:host ::ng-deep mat-select.default-state-controller .mat-select-value {\n  max-width: 200px;\n}'},"+XbJ":function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host {\n  /*  flex: 1;\n    display: flex;\n    justify-content: flex-start; */\n  padding-right: 8px;\n  min-width: 160px;\n}\n:host ::ng-deep mat-form-field {\n  font-size: 16px;\n  width: 200px;\n}\n:host ::ng-deep mat-form-field .mat-form-field-wrapper {\n  padding-bottom: 0;\n}\n:host ::ng-deep mat-form-field .mat-form-field-underline {\n  bottom: 0;\n}\n@media screen and (max-width: 599px) {\n  :host ::ng-deep mat-form-field {\n    width: 100%;\n  }\n  :host ::ng-deep mat-form-field .mat-form-field-infix {\n    width: auto !important;\n  }\n}'},"+m5s":function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host {\n  width: 100%;\n  height: 100%;\n}\n:host .tb-entity-table .tb-entity-table-content {\n  width: 100%;\n  height: 100%;\n  background: #fff;\n}\n:host .tb-entity-table .tb-entity-table-content .mat-toolbar-tools {\n  min-height: auto;\n}\n:host .tb-entity-table .tb-entity-table-content .title-container {\n  overflow: hidden;\n}\n:host .tb-entity-table .tb-entity-table-content .tb-entity-table-title {\n  padding-right: 20px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n:host .tb-entity-table .tb-entity-table-content .table-container {\n  overflow: auto;\n}\n:host .tb-entity-table .tb-entity-table-content .tb-entity-table-info {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n@media screen and (max-width: 599px) {\n  :host .mat-toolbar {\n    height: auto;\n    min-height: 100px;\n  }\n  :host .mat-toolbar .tb-entity-table-title {\n    padding-bottom: 5px;\n    width: 100%;\n  }\n}\n:host ::ng-deep .mat-sort-header-sorted .mat-sort-header-arrow {\n  opacity: 1 !important;\n}'},"/Bgp":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n("U3y+"),a=function(t){this.entityType=i.b.USER,this.id=t}},"/tmG":function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */'},"01JT":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form [formGroup]="legendConfigForm">\n  <fieldset [disabled]="(isLoading$ | async)">\n    <div class="mat-content" style="height: 100%;">\n      <div class="mat-padding">\n        <section fxLayout="column">\n          <mat-form-field>\n            <mat-label translate>legend.direction</mat-label>\n            <mat-select matInput formControlName="direction" style="min-width: 150px;">\n              <mat-option *ngFor="let direction of legendDirections" [value]="direction">\n                {{ legendDirectionTranslations.get(legendDirection[direction]) | translate }}\n              </mat-option>\n            </mat-select>\n          </mat-form-field>\n          <mat-form-field>\n            <mat-label translate>legend.position</mat-label>\n            <mat-select matInput formControlName="position" style="min-width: 150px;">\n              <mat-option *ngFor="let pos of legendPositions" [value]="pos"\n                  [disabled]="legendConfigForm.get(\'direction\').value === legendDirection.row &&\n                  (pos === legendPosition.left || pos === legendPosition.right)">\n                {{ legendPositionTranslations.get(legendPosition[pos]) | translate }}\n              </mat-option>\n            </mat-select>\n          </mat-form-field>\n          <mat-checkbox formControlName="showMin">\n            {{ \'legend.show-min\' | translate }}\n          </mat-checkbox>\n          <mat-checkbox formControlName="showMax">\n            {{ \'legend.show-max\' | translate }}\n          </mat-checkbox>\n          <mat-checkbox formControlName="showAvg">\n            {{ \'legend.show-avg\' | translate }}\n          </mat-checkbox>\n          <mat-checkbox formControlName="showTotal">\n            {{ \'legend.show-total\' | translate }}\n          </mat-checkbox>\n        </section>\n      </div>\n    </div>\n  </fieldset>\n</form>\n'},"0aaO":function(t,e,n){"use strict";n.d(e,"a",(function(){return P}));var i=n("mrSG"),a=n("TYT/"),o=n("RxGS"),r=n("6onV"),s=n("DUip"),l=n("OiFK"),c=n("Vurf"),d=n("wtyh"),u=n("//Q6"),h=function(){function t(t){this.dashboardCtx=t,this.widgetIds=[],this.loaded=!1}return t.prototype.size=function(){return this.widgetIds.length},t.prototype.isLoading=function(){return!this.loaded},t.prototype.isEmpty=function(){return this.loaded&&0===this.widgetIds.length},t.prototype.setWidgetIds=function(t){this.widgetIds=t,this.loaded=!0},t.prototype.addWidgetId=function(t){this.widgetIds.push(t)},t.prototype.removeWidgetId=function(t){var e=this.widgetIds.indexOf(t);return e>-1&&(this.widgetIds.splice(e,1),!0)},t.prototype[Symbol.iterator]=function(){var t=0,e=this.widgetIds,n=this.dashboardCtx.getDashboard();return{next:function(i){if(t<e.length){var a=e[t++];return{done:!1,value:n.configuration.widgets[a]}}return{done:!0,value:null}}}},t.prototype.widgetByIndex=function(t){var e=this.widgetIds[t];return e?this.widgetById(e):null},t.prototype.widgetById=function(t){return this.dashboardCtx.getDashboard().configuration.widgets[t]},t}(),p=n("nNBm"),m=n("he9t"),g=n("C/rb"),f=n("0lYY"),b=n("AytR"),y=n("zp9Z"),v=n("S+vS"),w=n("21Fy"),x=n("Xk9D"),S=n("F/XL"),C=n("4j5O"),T=n("YnEf"),O=n("BOYq"),_=n("QJY3"),L=n("FBAY"),I=n("ea4N"),A=n("EWcq"),k=n("e/A1"),E=n("bE8y"),j=n("o8Qb"),D=n("qFS8"),F=n("6opy"),M=n("mAYL"),R=n("lHnB"),N=n("9HAa"),P=function(t){function e(e,n,i,a,o,r,s,l,c,d,u,h,p,f,y,v,w,x,S){var C=t.call(this,e)||this;return C.store=e,C.window=n,C.breakpointObserver=i,C.route=a,C.router=o,C.utils=r,C.dashboardUtils=s,C.authService=l,C.entityService=c,C.dialogService=d,C.widgetComponentService=u,C.dashboardService=h,C.itembuffer=p,C.importExport=f,C.fb=y,C.dialog=v,C.translate=w,C.ngZone=x,C.cd=S,C.authState=Object(g.a)(C.store),C.authUser=C.authState.authUser,C.iframeMode=C.utils.iframeMode,C.forceFullscreen=C.authState.forceFullscreen,C.isFullscreen=!1,C.isEdit=!1,C.isEditingWidget=!1,C.isEditingWidgetClosed=!0,C.isMobile=!C.breakpointObserver.isMatched(m.d["gt-sm"]),C.forceDashboardMobileMode=!1,C.isAddingWidget=!1,C.isAddingWidgetClosed=!0,C.widgetsBundle=null,C.isToolbarOpened=!1,C.isToolbarOpenedAnimate=!1,C.isRightLayoutOpened=!1,C.editingWidget=null,C.editingWidgetLayout=null,C.editingWidgetOriginal=null,C.editingWidgetLayoutOriginal=null,C.editingWidgetSubtitle=null,C.editingLayoutCtx=null,C.thingsboardVersion=b.a.tbVersion,C.dashboardCtx={getDashboard:function(){return C.dashboard},dashboardTimewindow:null,state:null,stateController:null,aliasController:null,runChangeDetection:C.runChangeDetection.bind(C)},C.layouts={main:{show:!1,layoutCtx:{id:"main",widgets:null,widgetLayouts:{},gridSettings:{},ignoreLoading:!0,ctrl:null,dashboardCtrl:C}},right:{show:!1,layoutCtx:{id:"right",widgets:null,widgetLayouts:{},gridSettings:{},ignoreLoading:!0,ctrl:null,dashboardCtrl:C}}},C.addWidgetFabButtons={fabTogglerName:"dashboard.add-widget",fabTogglerIcon:"add",buttons:[{name:"dashboard.create-new-widget",icon:"insert_drive_file",onAction:function(t){C.addWidget(t)}},{name:"dashboard.import-widget",icon:"file_upload",onAction:function(t){C.importWidget(t)}}]},C.rxSubscriptions=new Array,C.rxSubscriptions.push(C.route.data.subscribe((function(t){C.init(t),C.runChangeDetection()}))),C.rxSubscriptions.push(C.breakpointObserver.observe(m.d["gt-sm"]).subscribe((function(t){C.isMobile=!t.matches}))),C}return Object(i.d)(e,t),Object.defineProperty(e.prototype,"toolbarOpened",{get:function(){return!this.widgetEditMode&&(this.toolbarAlwaysOpen()||this.isToolbarOpened||this.isEdit||this.showRightLayoutSwitch())},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rightLayoutOpened",{get:function(){return!this.isMobile||this.isRightLayoutOpened},set:function(t){},enumerable:!0,configurable:!0}),e.prototype.init=function(t){var e=this;if(this.reset(),this.currentDashboardId=this.route.snapshot.params.dashboardId,this.route.snapshot.params.customerId?(this.currentCustomerId=this.route.snapshot.params.customerId,this.currentDashboardScope="customer"):(this.currentDashboardScope=this.authUser.authority===y.a.TENANT_ADMIN?"tenant":"customer",this.currentCustomerId=this.authUser.customerId),this.dashboard=t.dashboard,this.dashboardConfiguration=this.dashboard.configuration,this.dashboardCtx.dashboardTimewindow=this.dashboardConfiguration.timewindow,this.layouts.main.layoutCtx.widgets=new h(this.dashboardCtx),this.layouts.right.layoutCtx.widgets=new h(this.dashboardCtx),this.widgetEditMode=t.widgetEditMode,this.singlePageMode=t.singlePageMode,this.dashboardCtx.aliasController=new x.a(this.utils,this.entityService,(function(){return e.dashboardCtx.stateController}),this.dashboardConfiguration.entityAliases),this.widgetEditMode){this.window.parent.postMessage(JSON.stringify({type:"widgetEditModeInited"}),"*")}},e.prototype.reset=function(){this.dashboard=null,this.dashboardConfiguration=null,this.prevDashboard=null,this.widgetEditMode=!1,this.singlePageMode=!1,this.isFullscreen=!1,this.isEdit=!1,this.isEditingWidget=!1,this.isEditingWidgetClosed=!0,this.forceDashboardMobileMode=!1,this.isAddingWidget=!1,this.isAddingWidgetClosed=!0,this.widgetsBundle=null,this.isToolbarOpened=!1,this.isToolbarOpenedAnimate=!1,this.isRightLayoutOpened=!1,this.editingWidget=null,this.editingWidgetLayout=null,this.editingWidgetOriginal=null,this.editingWidgetLayoutOriginal=null,this.editingWidgetSubtitle=null,this.editingLayoutCtx=null,this.currentDashboardId=null,this.currentCustomerId=null,this.currentDashboardScope=null,this.dashboardCtx.state=null},e.prototype.ngOnDestroy=function(){this.rxSubscriptions.forEach((function(t){t.unsubscribe()})),this.rxSubscriptions.length=0},e.prototype.runChangeDetection=function(){},e.prototype.openToolbar=function(){this.isToolbarOpenedAnimate=!0,this.isToolbarOpened=!0},e.prototype.closeToolbar=function(){this.isToolbarOpenedAnimate=!0,this.isToolbarOpened=!1},e.prototype.showCloseToolbar=function(){return!this.toolbarAlwaysOpen()&&!this.isEdit&&!this.showRightLayoutSwitch()},e.prototype.hideFullscreenButton=function(){return this.widgetEditMode||this.iframeMode||this.forceFullscreen||this.singlePageMode},e.prototype.toolbarAlwaysOpen=function(){return!this.dashboard.configuration.settings||!Object(u.k)(this.dashboard.configuration.settings.toolbarAlwaysOpen)||this.dashboard.configuration.settings.toolbarAlwaysOpen},e.prototype.displayTitle=function(){return!(!this.dashboard.configuration.settings||!Object(u.k)(this.dashboard.configuration.settings.showTitle))&&this.dashboard.configuration.settings.showTitle},e.prototype.displayExport=function(){return!this.dashboard.configuration.settings||!Object(u.k)(this.dashboard.configuration.settings.showDashboardExport)||this.dashboard.configuration.settings.showDashboardExport},e.prototype.displayDashboardTimewindow=function(){return!this.dashboard.configuration.settings||!Object(u.k)(this.dashboard.configuration.settings.showDashboardTimewindow)||this.dashboard.configuration.settings.showDashboardTimewindow},e.prototype.displayDashboardsSelect=function(){return!this.dashboard.configuration.settings||!Object(u.k)(this.dashboard.configuration.settings.showDashboardsSelect)||this.dashboard.configuration.settings.showDashboardsSelect},e.prototype.displayEntitiesSelect=function(){return!this.dashboard.configuration.settings||!Object(u.k)(this.dashboard.configuration.settings.showEntitiesSelect)||this.dashboard.configuration.settings.showEntitiesSelect},e.prototype.showRightLayoutSwitch=function(){return this.isMobile&&this.layouts.right.show},e.prototype.toggleLayouts=function(){this.isRightLayoutOpened=!this.isRightLayoutOpened},e.prototype.openRightLayout=function(){this.isRightLayoutOpened=!0},e.prototype.mainLayoutWidth=function(){return this.isEditingWidget&&"main"===this.editingLayoutCtx.id?"100%":this.layouts.right.show&&!this.isMobile?"50%":"100%"},e.prototype.mainLayoutHeight=function(){return this.isEditingWidget&&"main"!==this.editingLayoutCtx.id?"0px":"100%"},e.prototype.rightLayoutWidth=function(){return this.isEditingWidget&&"right"===this.editingLayoutCtx.id||this.isMobile?"100%":"50%"},e.prototype.rightLayoutHeight=function(){return this.isEditingWidget&&"right"!==this.editingLayoutCtx.id?"0px":"100%"},e.prototype.isPublicUser=function(){return this.authUser.isPublic},e.prototype.isTenantAdmin=function(){return this.authUser.authority===y.a.TENANT_ADMIN},e.prototype.isSystemAdmin=function(){return this.authUser.authority===y.a.SYS_ADMIN},e.prototype.exportDashboard=function(t){t&&t.stopPropagation(),this.importExport.exportDashboard(this.currentDashboardId)},e.prototype.openEntityAliases=function(t){var e=this;t&&t.stopPropagation(),this.dialog.open(A.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{entityAliases:Object(u.d)(this.dashboard.configuration.entityAliases),widgets:this.dashboardUtils.getWidgetsArray(this.dashboard),isSingleEntityAlias:!1}}).afterClosed().subscribe((function(t){t&&(e.dashboard.configuration.entityAliases=t,e.entityAliasesUpdated())}))},e.prototype.openDashboardSettings=function(t){var e=this;t&&t.stopPropagation();var n=null,i=this.dashboardUtils.isSingleLayoutDashboard(this.dashboard);i&&(n=Object(u.d)(this.dashboard.configuration.states[i.state].layouts[i.layout].gridSettings)),this.dialog.open(M.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{settings:Object(u.d)(this.dashboard.configuration.settings),gridSettings:n}}).afterClosed().subscribe((function(t){if(t){e.dashboard.configuration.settings=t.settings;var n=t.gridSettings;if(n){var a=e.dashboard.configuration.states[i.state].layouts[i.layout];e.dashboardUtils.updateLayoutSettings(a,n),e.updateLayouts()}}}))},e.prototype.manageDashboardStates=function(t){var e=this;t&&t.stopPropagation(),this.dialog.open(R.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{states:Object(u.d)(this.dashboard.configuration.states)}}).afterClosed().subscribe((function(t){t&&e.updateStates(t)}))},e.prototype.manageDashboardLayouts=function(t){var e=this;t&&t.stopPropagation(),this.dialog.open(D.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{layouts:Object(u.d)(this.dashboard.configuration.states[this.dashboardCtx.state].layouts)}}).afterClosed().subscribe((function(t){t&&e.updateDashboardLayouts(t)}))},e.prototype.updateDashboardLayouts=function(t){this.dashboardUtils.setLayouts(this.dashboard,this.dashboardCtx.state,t),this.updateLayouts()},e.prototype.updateStates=function(t){this.dashboard.configuration.states=t,this.dashboardUtils.removeUnusedWidgets(this.dashboard);var e=this.dashboardCtx.state;this.dashboard.configuration.states[e]||(e=this.dashboardUtils.getRootStateId(this.dashboardConfiguration.states)),this.openDashboardState(e)},e.prototype.importWidget=function(t){var e=this;t&&t.stopPropagation(),this.importExport.importWidget(this.dashboard,this.dashboardCtx.state,this.selectTargetLayout.bind(this),this.entityAliasesUpdated.bind(this)).subscribe((function(t){if(t){var n=t.widget,i=t.layoutId;e.layouts[i].layoutCtx.widgets.addWidgetId(n.id)}}))},e.prototype.currentDashboardIdChanged=function(t){this.widgetEditMode||("customer"===this.currentDashboardScope&&this.authUser.authority===y.a.TENANT_ADMIN?this.router.navigateByUrl("customers/"+this.currentCustomerId+"/dashboards/"+t):this.singlePageMode?this.router.navigateByUrl("dashboard/"+t):this.router.navigateByUrl("dashboards/"+t))},e.prototype.toggleDashboardEditMode=function(){this.setEditMode(!this.isEdit,!0)},e.prototype.saveDashboard=function(){this.setEditMode(!1,!1),this.notifyDashboardUpdated()},e.prototype.openDashboardState=function(t,e){var n=this.dashboardUtils.getStateLayoutsData(this.dashboard,t);n&&(this.dashboardCtx.state=t,this.dashboardCtx.aliasController.dashboardStateChanged(),this.isRightLayoutOpened=!!e,this.updateLayouts(n))},e.prototype.updateLayouts=function(t){t||(t=this.dashboardUtils.getStateLayoutsData(this.dashboard,this.dashboardCtx.state));for(var e=0,n=Object.keys(this.layouts);e<n.length;e++){var i=n[e],a=this.layouts[i];if(t[i]){a.show=!0;var o=t[i];this.updateLayout(a,o)}else a.show=!1,this.updateLayout(a,{widgetIds:[],widgetLayouts:{},gridSettings:null})}},e.prototype.updateLayout=function(t,e){e.gridSettings&&(t.layoutCtx.gridSettings=e.gridSettings),t.layoutCtx.widgets.setWidgetIds(e.widgetIds),t.layoutCtx.widgetLayouts=e.widgetLayouts,t.show&&t.layoutCtx.ctrl&&t.layoutCtx.ctrl.reload(),t.layoutCtx.ignoreLoading=!0},e.prototype.setEditMode=function(t,e){this.isEdit=t,this.isEdit?(this.dashboardCtx.stateController.preserveState(),this.prevDashboard=Object(u.d)(this.dashboard)):this.widgetEditMode?e&&(this.dashboard=this.prevDashboard):(this.resetHighlight(),e?(this.dashboard=this.prevDashboard,this.dashboardConfiguration=this.dashboard.configuration,this.dashboardCtx.dashboardTimewindow=this.dashboardConfiguration.timewindow,this.entityAliasesUpdated(),this.updateLayouts()):this.dashboard.configuration.timewindow=this.dashboardCtx.dashboardTimewindow)},e.prototype.resetHighlight=function(){for(var t=0,e=Object.keys(this.layouts);t<e.length;t++){var n=e[t];this.layouts[n].layoutCtx&&this.layouts[n].layoutCtx.ctrl&&this.layouts[n].layoutCtx.ctrl.resetHighlight()}},e.prototype.entityAliasesUpdated=function(){this.dashboardCtx.aliasController.updateEntityAliases(this.dashboard.configuration.entityAliases)},e.prototype.notifyDashboardUpdated=function(){if(this.widgetEditMode){var t=this.layouts.main.layoutCtx.widgets.widgetByIndex(0),e=this.layouts.main.layoutCtx.widgetLayouts[t.id];t.sizeX=e.sizeX,t.sizeY=e.sizeY;var n={type:"widgetEditUpdated",data:t};this.window.parent.postMessage(JSON.stringify(n),"*")}else this.dashboardService.saveDashboard(this.dashboard).subscribe()},e.prototype.helpLinkIdForWidgetType=function(){var t="widgetsConfig";return this.editingWidget&&this.editingWidget.type&&(t=f.l.get(this.editingWidget.type).configHelpLinkId),t},e.prototype.addWidget=function(t,e){t&&t.stopPropagation(),this.isAddingWidget=!0,this.addingLayoutCtx=e},e.prototype.onAddWidgetClosed=function(){this.isAddingWidget=!1},e.prototype.detailsDrawerOpenedStart=function(){var t=this;this.isEditingWidget?this.isEditingWidgetClosed=!1:this.isAddingWidget&&(this.isAddingWidgetClosed=!1),setTimeout((function(){t.cd.detach()}),0)},e.prototype.detailsDrawerOpened=function(){this.cd.reattach()},e.prototype.detailsDrawerClosedStart=function(){this.cd.detach()},e.prototype.detailsDrawerClosed=function(){this.isEditingWidgetClosed=!0,this.isAddingWidgetClosed=!0,this.cd.reattach()},e.prototype.addWidgetToLayout=function(t,e){this.dashboardUtils.addWidgetToLayout(this.dashboard,this.dashboardCtx.state,e,t),this.layouts[e].layoutCtx.widgets.addWidgetId(t.id)},e.prototype.selectTargetLayout=function(){var t=this.dashboardConfiguration.states[this.dashboardCtx.state].layouts,e=Object.keys(t);return e.length>1?this.dialog.open(F.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"]}).afterClosed():Object(S.a)(e[0])},e.prototype.addWidgetToDashboard=function(t){var e=this;this.addingLayoutCtx?(this.addWidgetToLayout(t,this.addingLayoutCtx.id),this.addingLayoutCtx=null):this.selectTargetLayout().subscribe((function(n){n&&e.addWidgetToLayout(t,n)}))},e.prototype.addWidgetFromType=function(t){var e=this;this.onAddWidgetClosed(),this.widgetComponentService.getWidgetInfo(t.bundleAlias,t.typeAlias,t.isSystemType).subscribe((function(n){var i=JSON.parse(n.defaultConfig);i.title="New "+n.widgetName,i.datasources=[];var a={isSystemType:t.isSystemType,bundleAlias:t.bundleAlias,typeAlias:n.alias,type:n.type,title:"New widget",sizeX:n.sizeX,sizeY:n.sizeY,config:i,row:0,col:0};n.typeParameters.useCustomDatasources?e.addWidgetToDashboard(a):e.dialog.open(E.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{dashboard:e.dashboard,aliasController:e.dashboardCtx.aliasController,widget:a,widgetInfo:n}}).afterClosed().subscribe((function(t){t&&e.addWidgetToDashboard(t)}))}))},e.prototype.onRevertWidgetEdit=function(){this.editWidgetComponent.widgetFormGroup.dirty&&(this.editWidgetComponent.widgetFormGroup.markAsPristine(),this.editingWidget=Object(u.d)(this.editingWidgetOriginal),this.editingWidgetLayout=Object(u.d)(this.editingWidgetLayoutOriginal))},e.prototype.saveWidget=function(){var t=this;this.editWidgetComponent.widgetFormGroup.markAsPristine();var e=Object(u.d)(this.editingWidget),n=Object(u.d)(this.editingWidgetLayout),i=this.editingWidgetOriginal.id;this.dashboardConfiguration.widgets[i]=e,this.editingWidgetOriginal=e,this.editingWidgetLayoutOriginal=n,this.editingLayoutCtx.widgetLayouts[e.id]=n,setTimeout((function(){t.editingLayoutCtx.ctrl.highlightWidget(e.id,0)}),0)},e.prototype.onEditWidgetClosed=function(){this.editingWidgetOriginal=null,this.editingWidget=null,this.editingWidgetLayoutOriginal=null,this.editingWidgetLayout=null,this.editingLayoutCtx=null,this.editingWidgetSubtitle=null,this.isEditingWidget=!1,this.resetHighlight(),this.forceDashboardMobileMode=!1},e.prototype.editWidget=function(t,e,n){if(t.stopPropagation(),this.editingWidgetOriginal===n)this.onEditWidgetClosed();else{var i=!this.forceDashboardMobileMode;if(this.editingWidgetOriginal=n,this.editingWidgetLayoutOriginal=e.widgetLayouts[n.id],this.editingWidget=Object(u.d)(this.editingWidgetOriginal),this.editingWidgetLayout=Object(u.d)(this.editingWidgetLayoutOriginal),this.editingLayoutCtx=e,this.editingWidgetSubtitle=this.widgetComponentService.getInstantWidgetInfo(this.editingWidget).widgetName,this.forceDashboardMobileMode=!0,this.isEditingWidget=!0,e){var a=i?400:300;setTimeout((function(){e.ctrl.highlightWidget(n.id,a)}),i?350:0)}}},e.prototype.copyWidget=function(t,e,n){this.itembuffer.copyWidget(this.dashboard,this.dashboardCtx.state,e.id,n)},e.prototype.copyWidgetReference=function(t,e,n){this.itembuffer.copyWidgetReference(this.dashboard,this.dashboardCtx.state,e.id,n)},e.prototype.pasteWidget=function(t,e,n){this.itembuffer.pasteWidget(this.dashboard,this.dashboardCtx.state,e.id,n,this.entityAliasesUpdated.bind(this)).subscribe((function(t){e.widgets.addWidgetId(t.id)}))},e.prototype.pasteWidgetReference=function(t,e,n){this.itembuffer.pasteWidgetReference(this.dashboard,this.dashboardCtx.state,e.id,n).subscribe((function(t){e.widgets.addWidgetId(t.id)}))},e.prototype.removeWidget=function(t,e,n){var i=this,a=n.config.title;a&&0!==a.length||(a=this.widgetComponentService.getInstantWidgetInfo(n).widgetName);var o=this.translate.instant("widget.remove-widget-title",{widgetTitle:a}),r=this.translate.instant("widget.remove-widget-text");this.dialogService.confirm(o,r,this.translate.instant("action.no"),this.translate.instant("action.yes")).subscribe((function(t){t&&e.widgets.removeWidgetId(n.id)&&i.dashboardUtils.removeWidgetFromLayout(i.dashboard,i.dashboardCtx.state,e.id,n.id)}))},e.prototype.exportWidget=function(t,e,n){t.stopPropagation(),this.importExport.exportWidget(this.dashboard,this.dashboardCtx.state,e.id,n)},e.prototype.widgetClicked=function(t,e,n){this.isEditingWidget&&this.editWidget(t,e,n)},e.prototype.widgetMouseDown=function(t,e,n){this.isEdit&&!this.isEditingWidget&&e.ctrl.selectWidget(n.id,0)},e.prototype.prepareDashboardContextMenu=function(t){var e=[];return!this.isEdit||this.isEditingWidget||this.widgetEditMode||(e.push({action:this.openDashboardSettings.bind(this),enabled:!0,value:"dashboard.settings",icon:"settings"}),e.push({action:this.openEntityAliases.bind(this),enabled:!0,value:"entity.aliases",icon:"devices_other"}),e.push({action:function(e){t.ctrl.pasteWidget(e)},enabled:this.itembuffer.hasWidget(),value:"action.paste",icon:"content_paste",shortcut:"M-V"}),e.push({action:function(e){t.ctrl.pasteWidgetReference(e)},enabled:this.itembuffer.canPasteWidgetReference(this.dashboard,this.dashboardCtx.state,t.id),value:"action.paste-reference",icon:"content_paste",shortcut:"M-I"})),e},e.prototype.prepareWidgetContextMenu=function(t,e){var n=this,i=[];return this.isEdit&&!this.isEditingWidget&&(i.push({action:function(e,i){n.editWidget(e,t,i)},enabled:!0,value:"action.edit",icon:"edit"}),this.widgetEditMode||(i.push({action:function(e,i){n.copyWidget(e,t,i)},enabled:!0,value:"action.copy",icon:"content_copy",shortcut:"M-C"}),i.push({action:function(e,i){n.copyWidgetReference(e,t,i)},enabled:!0,value:"action.copy-reference",icon:"content_copy",shortcut:"M-R"}),i.push({action:function(e,i){n.removeWidget(e,t,i)},enabled:!0,value:"action.delete",icon:"clear",shortcut:"M-X"}))),i},e.ctorParameters=function(){return[{type:r.Store},{type:Window,decorators:[{type:a.Inject,args:[d.b]}]},{type:p.a},{type:s.ActivatedRoute},{type:s.Router},{type:l.a},{type:C.a},{type:c.a},{type:w.a},{type:v.a},{type:O.a},{type:T.a},{type:L.a},{type:N.a},{type:_.FormBuilder},{type:I.MatDialog},{type:j.TranslateService},{type:a.NgZone},{type:a.ChangeDetectorRef}]},Object(i.c)([Object(a.ViewChild)("tbEditWidget"),Object(i.g)("design:type",k.a)],e.prototype,"editWidgetComponent",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-dashboard-page",template:Object(i.f)(n("5FVY")).default,encapsulation:a.ViewEncapsulation.None,styles:[Object(i.f)(n("WXpk")).default]}),Object(i.h)(1,Object(a.Inject)(d.b)),Object(i.g)("design:paramtypes",[r.Store,Window,p.a,s.ActivatedRoute,s.Router,l.a,C.a,c.a,w.a,v.a,O.a,T.a,L.a,N.a,_.FormBuilder,I.MatDialog,j.TranslateService,a.NgZone,a.ChangeDetectorRef])],e)}(o.a)},"0hfc":function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host {\n  overflow: hidden;\n}\n:host .entity-state-controller .state-divider {\n  padding: 0 15px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  pointer-events: none;\n}\n:host .entity-state-controller .state-entry {\n  pointer-events: all;\n  overflow: hidden;\n  font-size: 18px;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  outline: none;\n}\n:host .entity-state-controller mat-select {\n  margin: 0;\n}\n:host ::ng-deep mat-select .mat-select-value {\n  max-width: 200px;\n}\n:host ::ng-deep mat-select .mat-select-value .mat-select-value-text {\n  font-size: 18px;\n  font-weight: 700;\n}'},"10j8":function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var i=n("mrSG"),a=n("TYT/"),o=n("ea4N"),r=n("6onV"),s=n("QJY3"),l=n("S5bw"),c=n("DUip"),d=n("gmuX"),u=n("UZbx"),h=n("7ZKe"),p=n("xMyE"),m=n("Valr"),g=n("o8Qb"),f=function(t){function e(e,n,i,a,o,r,s,c){var d=t.call(this,e,n,s)||this;return d.store=e,d.router=n,d.datePipe=i,d.translate=a,d.data=o,d.alarmService=r,d.dialogRef=s,d.fb=c,d.loadAlarmSubject=new l.a,d.alarm$=d.loadAlarmSubject.asObservable().pipe(Object(p.a)((function(t){return d.loadAlarmFields(t)}))),d.alarmSeverityColorsMap=u.g,d.alarmStatuses=u.d,d.alarmUpdated=!1,d.allowAcknowledgment=o.allowAcknowledgment,d.allowClear=o.allowClear,d.displayDetails=o.displayDetails,d.alarmFormGroup=d.fb.group({createdTime:[""],originatorName:[""],startTime:[""],endTime:[""],ackTime:[""],clearTime:[""],type:[""],alarmSeverity:[""],alarmStatus:[""],alarmDetails:[null]}),d.loadAlarm(),d}return Object(i.d)(e,t),e.prototype.loadAlarm=function(){var t=this;this.alarmService.getAlarmInfo(this.data.alarmId).subscribe((function(e){return t.loadAlarmSubject.next(e)}))},e.prototype.loadAlarmFields=function(t){this.alarmFormGroup.get("createdTime").patchValue(this.datePipe.transform(t.createdTime,"yyyy-MM-dd HH:mm:ss")),this.alarmFormGroup.get("originatorName").patchValue(t.originatorName),t.startTs&&this.alarmFormGroup.get("startTime").patchValue(this.datePipe.transform(t.startTs,"yyyy-MM-dd HH:mm:ss")),t.endTs&&this.alarmFormGroup.get("endTime").patchValue(this.datePipe.transform(t.endTs,"yyyy-MM-dd HH:mm:ss")),t.ackTs&&this.alarmFormGroup.get("ackTime").patchValue(this.datePipe.transform(t.ackTs,"yyyy-MM-dd HH:mm:ss")),t.clearTs&&this.alarmFormGroup.get("clearTime").patchValue(this.datePipe.transform(t.clearTs,"yyyy-MM-dd HH:mm:ss")),this.alarmFormGroup.get("type").patchValue(t.type),this.alarmFormGroup.get("alarmSeverity").patchValue(this.translate.instant(u.h.get(t.severity))),this.alarmFormGroup.get("alarmStatus").patchValue(this.translate.instant(u.i.get(t.status))),this.alarmFormGroup.get("alarmDetails").patchValue(t.details)},e.prototype.ngOnInit=function(){},e.prototype.close=function(){this.dialogRef.close(this.alarmUpdated)},e.prototype.acknowledge=function(){var t=this;this.alarmService.ackAlarm(this.data.alarmId).subscribe((function(){t.alarmUpdated=!0,t.loadAlarm()}))},e.prototype.clear=function(){var t=this;this.alarmService.clearAlarm(this.data.alarmId).subscribe((function(){t.alarmUpdated=!0,t.loadAlarm()}))},e.ctorParameters=function(){return[{type:r.Store},{type:c.Router},{type:m.DatePipe},{type:g.TranslateService},{type:void 0,decorators:[{type:a.Inject,args:[o.MAT_DIALOG_DATA]}]},{type:h.a},{type:o.MatDialogRef},{type:s.FormBuilder}]},e=Object(i.c)([Object(a.Component)({selector:"tb-alarm-details-dialog",template:Object(i.f)(n("iG9X")).default}),Object(i.h)(4,Object(a.Inject)(o.MAT_DIALOG_DATA)),Object(i.g)("design:paramtypes",[r.Store,c.Router,m.DatePipe,g.TranslateService,Object,h.a,o.MatDialogRef,s.FormBuilder])],e)}(d.a)},"1KgG":function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host {\n  width: 100%;\n  height: 100%;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-direction: column;\n      flex-direction: column;\n}\n:host .mat-toolbar.details-toolbar {\n  padding: 0;\n}\n:host ::ng-deep .mat-toolbar-tools {\n  height: 100%;\n  min-height: 100px;\n  max-height: 120px;\n}\n:host ::ng-deep .mat-toolbar-tools.tb-details-title-header {\n  min-width: 0;\n}\n:host ::ng-deep .tb-details-title {\n  width: inherit;\n  margin: 20px 8px 0 0;\n  overflow: hidden;\n  font-size: 1rem;\n  font-weight: 400;\n  text-overflow: ellipsis;\n  text-transform: uppercase;\n  white-space: nowrap;\n}\n@media screen and (min-width: 960px) {\n  :host ::ng-deep .tb-details-title {\n    font-size: 1.5rem;\n  }\n}\n:host ::ng-deep .tb-details-subtitle {\n  width: inherit;\n  margin: 10px 0;\n  overflow: hidden;\n  font-size: 1rem;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  opacity: 0.8;\n}\n:host ::ng-deep tb-dashboard .tb-dashboard-content {\n  background-color: #cfd8dc !important;\n}'},"1LDp":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form (ngSubmit)="add()" style="min-width: 400px;" [ngStyle]="entitiesTableConfig.addDialogStyle">\n  <mat-toolbar color="primary">\n    <h2 translate>{{ translations.add }}</h2>\n    <span fxFlex></span>\n    <div [tb-help]="helpLinkId()"></div>\n    <button mat-icon-button\n            (click)="cancel()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div style="height: 4px;" *ngIf="!(isLoading$ | async)"></div>\n  <div mat-dialog-content>\n    <tb-anchor #entityDetailsForm></tb-anchor>\n  </div>\n  <div mat-dialog-actions fxLayoutAlign="end center">\n    <button mat-raised-button color="primary"\n            type="submit"\n            [disabled]="(isLoading$ | async) || detailsForm?.invalid || !detailsForm?.dirty">\n      {{ \'action.add\' | translate }}\n    </button>\n    <button mat-button color="primary"\n            type="button"\n            cdkFocusInitial\n            [disabled]="(isLoading$ | async)"\n            (click)="cancel()">\n      {{ \'action.cancel\' | translate }}\n    </button>\n  </div>\n</form>\n'},"1llQ":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<mat-select class="default-state-controller" [fxShow]="displayStateSelection()"\n    [(ngModel)]="stateObject[0].id" (ngModelChange)="selectedStateIdChanged()">\n  <mat-option *ngFor="let stateKv of states | keyvalue" [value]="stateKv.key">\n    {{getStateName(stateKv.key, stateKv.value)}}\n  </mat-option>\n</mat-select>\n'},"1sVU":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form [formGroup]="stateFormGroup" (ngSubmit)="save()">\n  <mat-toolbar color="primary">\n    <h2 translate>dashboard.select-state</h2>\n    <span fxFlex></span>\n    <button mat-icon-button\n            (click)="cancel()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div mat-dialog-content>\n    <fieldset [disabled]="isLoading$ | async" fxLayout="column">\n      <mat-form-field class="mat-block">\n        <mat-label translate>dashboard.state</mat-label>\n        <mat-select required formControlName="stateId">\n          <mat-option *ngFor="let stateItem of states | keyvalue" [value]="stateItem.key">\n            {{ stateItem.value.name }}\n          </mat-option>\n        </mat-select>\n      </mat-form-field>\n    </fieldset>\n  </div>\n  <div mat-dialog-actions fxLayoutAlign="end center">\n    <button mat-raised-button color="primary"\n            type="submit"\n            [disabled]="(isLoading$ | async) || stateFormGroup.invalid">\n      {{ \'action.select\' | translate }}\n    </button>\n    <button mat-button color="primary"\n            type="button"\n            [disabled]="(isLoading$ | async)"\n            (click)="cancel()"\n            cdkFocusInitial>\n      {{ \'action.cancel\' | translate }}\n    </button>\n  </div>\n</form>\n'},"2TWi":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form [formGroup]="assignToCustomerFormGroup" (ngSubmit)="assign()">\n  <mat-toolbar color="primary">\n    <h2>{{ assignToCustomerTitle | translate }}</h2>\n    <span fxFlex></span>\n    <button mat-button mat-icon-button\n            (click)="cancel()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div style="height: 4px;" *ngIf="!(isLoading$ | async)"></div>\n  <div mat-dialog-content>\n    <fieldset [disabled]="isLoading$ | async">\n      <div style="padding-bottom: 0.5em;">{{ assignToCustomerText | translate }}</div>\n      <tb-entity-autocomplete\n        formControlName="customerId"\n        required\n        [entityType]="entityType.CUSTOMER">\n      </tb-entity-autocomplete>\n    </fieldset>\n  </div>\n  <div mat-dialog-actions fxLayout="row" fxLayoutAlign="end center">\n    <button mat-raised-button color="primary"\n            type="submit"\n            [disabled]="(isLoading$ | async) || assignToCustomerFormGroup.invalid\n            || !assignToCustomerFormGroup.dirty">\n      {{ \'action.assign\' | translate }}\n    </button>\n    <button mat-button color="primary"\n            type="button"\n            [disabled]="(isLoading$ | async)"\n            (click)="cancel()" cdkFocusInitial>\n      {{ \'action.cancel\' | translate }}\n    </button>\n  </div>\n</form>\n'},"2lgB":function(t,e,n){"use strict";n.d(e,"a",(function(){return y}));var i=n("mrSG"),a=n("TYT/"),o=n("3Tyt"),r=n("6onV"),s=n("Vurf"),l=n("C/rb"),c=n("wtyh"),d=n("K9Ia"),u=n("FFOo"),h=n("6blF"),p=n("pugT"),m=n("S5bw"),g={url:"",deserializer:function(t){return JSON.parse(t.data)},serializer:function(t){return JSON.stringify(t)}},f=function(t){function e(e,n){var a=t.call(this)||this;if(e instanceof h.a)a.destination=n,a.source=e;else{var o=a._config=i.a({},g);if(a._output=new d.b,"string"==typeof e)o.url=e;else for(var r in e)e.hasOwnProperty(r)&&(o[r]=e[r]);if(!o.WebSocketCtor&&WebSocket)o.WebSocketCtor=WebSocket;else if(!o.WebSocketCtor)throw new Error("no WebSocket constructor can be found");a.destination=new m.a}return a}return i.d(e,t),e.prototype.lift=function(t){var n=new e(this._config,this.destination);return n.operator=t,n.source=this,n},e.prototype._resetState=function(){this._socket=null,this.source||(this.destination=new m.a),this._output=new d.b},e.prototype.multiplex=function(t,e,n){var i=this;return new h.a((function(a){try{i.next(t())}catch(r){a.error(r)}var o=i.subscribe((function(t){try{n(t)&&a.next(t)}catch(r){a.error(r)}}),(function(t){return a.error(t)}),(function(){return a.complete()}));return function(){try{i.next(e())}catch(r){a.error(r)}o.unsubscribe()}}))},e.prototype._connectSocket=function(){var t=this,e=this._config,n=e.WebSocketCtor,i=e.protocol,a=e.url,o=e.binaryType,r=this._output,s=null;try{s=i?new n(a,i):new n(a),this._socket=s,o&&(this._socket.binaryType=o)}catch(c){return void r.error(c)}var l=new p.a((function(){t._socket=null,s&&1===s.readyState&&s.close()}));s.onopen=function(e){if(!t._socket)return s.close(),void t._resetState();var n=t._config.openObserver;n&&n.next(e);var i=t.destination;t.destination=u.a.create((function(n){if(1===s.readyState)try{var i=t._config.serializer;s.send(i(n))}catch(e){t.destination.error(e)}}),(function(e){var n=t._config.closingObserver;n&&n.next(void 0),e&&e.code?s.close(e.code,e.reason):r.error(new TypeError("WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }")),t._resetState()}),(function(){var e=t._config.closingObserver;e&&e.next(void 0),s.close(),t._resetState()})),i&&i instanceof m.a&&l.add(i.subscribe(t.destination))},s.onerror=function(e){t._resetState(),r.error(e)},s.onclose=function(e){t._resetState();var n=t._config.closeObserver;n&&n.next(e),e.wasClean?r.complete():r.error(e)},s.onmessage=function(e){try{var n=t._config.deserializer;r.next(n(e))}catch(i){r.error(i)}}},e.prototype._subscribe=function(t){var e=this,n=this.source;return n?n.subscribe(t):(this._socket||this._connectSocket(),this._output.subscribe(t),t.add((function(){var t=e._socket;0===e._output.observers.length&&(t&&1===t.readyState&&t.close(),e._resetState())})),t)},e.prototype.unsubscribe=function(){var e=this._socket;e&&1===e.readyState&&e.close(),this._resetState(),t.prototype.unsubscribe.call(this)},e}(d.a);var b=n("xKAQ"),y=function(){function t(t,e,n,i){var a=this;this.store=t,this.authService=e,this.ngZone=n,this.window=i,this.isActive=!1,this.isOpening=!1,this.isOpened=!1,this.isReconnect=!1,this.lastCmdId=0,this.subscribersCount=0,this.subscribersMap=new Map,this.reconnectSubscribers=new Set,this.cmdsWrapper=new o.i,this.store.pipe(Object(r.select)(l.e)).subscribe((function(){a.reset(!0)}));var s=this.window.location.port;"https:"===this.window.location.protocol?(s||(s="443"),this.telemetryUri="wss:"):(s||(s="80"),this.telemetryUri="ws:"),this.telemetryUri+="//"+this.window.location.hostname+":"+s+"/api/ws/plugins/telemetry"}return t.prototype.subscribe=function(t){var e=this;this.isActive=!0,t.subscriptionCommands.forEach((function(n){var i=e.nextCmdId();e.subscribersMap.set(i,t),n.cmdId=i,n instanceof o.f?n.getType()===o.h.TIMESERIES?e.cmdsWrapper.tsSubCmds.push(n):e.cmdsWrapper.attrSubCmds.push(n):n instanceof o.d&&e.cmdsWrapper.historyCmds.push(n)})),this.subscribersCount++,this.publishCommands()},t.prototype.unsubscribe=function(t){var e=this;this.isActive&&(t.subscriptionCommands.forEach((function(t){t instanceof o.f&&(t.unsubscribe=!0,t.getType()===o.h.TIMESERIES?e.cmdsWrapper.tsSubCmds.push(t):e.cmdsWrapper.attrSubCmds.push(t));var n=t.cmdId;n&&e.subscribersMap.delete(n)})),this.reconnectSubscribers.delete(t),this.subscribersCount--,this.publishCommands())},t.prototype.nextCmdId=function(){return this.lastCmdId++,this.lastCmdId},t.prototype.publishCommands=function(){for(;this.isOpened&&this.cmdsWrapper.hasCommands();)this.dataStream.next(this.cmdsWrapper.preparePublishCommands(10)),this.checkToClose();this.tryOpenSocket()},t.prototype.checkToClose=function(){var t=this;0===this.subscribersCount&&this.isOpened&&(this.socketCloseTimer||(this.socketCloseTimer=setTimeout((function(){return t.closeSocket()}),9e4)))},t.prototype.reset=function(t){this.socketCloseTimer&&(clearTimeout(this.socketCloseTimer),this.socketCloseTimer=null),this.lastCmdId=0,this.subscribersMap.clear(),this.subscribersCount=0,this.cmdsWrapper.clear(),t&&this.closeSocket()},t.prototype.closeSocket=function(){this.isActive=!1,this.isOpened&&this.dataStream.unsubscribe()},t.prototype.tryOpenSocket=function(){var t=this;this.isActive&&(this.isOpened||this.isOpening||(this.isOpening=!0,s.a.isJwtTokenValid()?this.openSocket(s.a.getJwtToken()):this.authService.refreshJwtToken().subscribe((function(){t.openSocket(s.a.getJwtToken())}),(function(){t.isOpening=!1,t.authService.logout(!0)}))),this.socketCloseTimer&&(clearTimeout(this.socketCloseTimer),this.socketCloseTimer=null))},t.prototype.openSocket=function(t){var e=this,n=this.telemetryUri+"?token="+t;this.dataStream=new f({url:n,openObserver:{next:function(t){e.onOpen()}},closeObserver:{next:function(t){e.onClose(t)}}}),this.dataStream.subscribe((function(t){e.ngZone.runOutsideAngular((function(){e.onMessage(t)}))}),(function(t){e.onError(t)}))},t.prototype.onOpen=function(){var t=this;this.isOpening=!1,this.isOpened=!0,this.reconnectTimer&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=null),this.isReconnect?(this.isReconnect=!1,this.reconnectSubscribers.forEach((function(e){e.onReconnected(),t.subscribe(e)})),this.reconnectSubscribers.clear()):this.publishCommands()},t.prototype.onMessage=function(t){if(t.errorCode)this.showWsError(t.errorCode,t.errorMsg);else if(t.subscriptionId){var e=this.subscribersMap.get(t.subscriptionId);e&&e.onData(new o.g(t))}this.checkToClose()},t.prototype.onError=function(t){t&&console.warn("WebSocket error event",t),this.isOpening=!1},t.prototype.onClose=function(t){var e=this;t&&t.code>1e3&&1006!==t.code&&this.showWsError(t.code,t.reason),this.isOpening=!1,this.isOpened=!1,this.isActive&&(this.isReconnect||(this.reconnectSubscribers.clear(),this.subscribersMap.forEach((function(t){e.reconnectSubscribers.add(t)})),this.reset(!1),this.isReconnect=!0),this.reconnectTimer&&clearTimeout(this.reconnectTimer),this.reconnectTimer=setTimeout((function(){return e.tryOpenSocket()}),2e3))},t.prototype.showWsError=function(t,e){var n="WebSocket Error: ";n+=e||"error code - "+t+".",this.store.dispatch(new b.b({message:n,type:"error"}))},t.ctorParameters=function(){return[{type:r.Store},{type:s.a},{type:a.NgZone},{type:Window,decorators:[{type:a.Inject,args:[c.b]}]}]},t=Object(i.c)([Object(a.Injectable)({providedIn:"root"}),Object(i.h)(3,Object(a.Inject)(c.b)),Object(i.g)("design:paramtypes",[r.Store,s.a,a.NgZone,Window])],t)}()},"3Dpw":function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .tb-multiple-input {\n  height: 100%;\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n:host .tb-multiple-input .fields-group {\n  padding: 0 8px;\n  margin: 10px 0;\n  border: 1px groove rgba(0, 0, 0, 0.25);\n}\n:host .tb-multiple-input .fields-group legend {\n  color: rgba(0, 0, 0, 0.7);\n}\n:host .tb-multiple-input .input-field {\n  padding-right: 10px;\n}\n:host .tb-multiple-input .input-field mat-form-field {\n  margin-bottom: 5px;\n}\n:host .tb-multiple-input mat-checkbox,\n:host .tb-multiple-input mat-slide-toggle {\n  display: block;\n  margin-top: 20px;\n  margin-bottom: 16px;\n  white-space: normal;\n}\n:host .tb-multiple-input .date-time-input mat-form-field {\n  width: 100%;\n  margin: 2px 0;\n}\n:host .tb-multiple-input .vertical-alignment {\n  -ms-flex-direction: column;\n      flex-direction: column;\n}\n:host .tb-multiple-input .vertical-alignment mat-checkbox,\n:host .tb-multiple-input .vertical-alignment mat-slide-toggle {\n  margin-top: 18px;\n}\n:host .tb-multiple-input .vertical-alignment mat-slide-toggle {\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-pack: justify;\n      justify-content: space-between;\n}\n:host .tb-multiple-input .vertically-aligned {\n  -ms-flex-direction: column;\n      flex-direction: column;\n}'},"3QxM":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"m",(function(){return a})),n.d(e,"c",(function(){return o})),n.d(e,"i",(function(){return r})),n.d(e,"a",(function(){return s})),n.d(e,"e",(function(){return l})),n.d(e,"l",(function(){return c})),n.d(e,"g",(function(){return d})),n.d(e,"h",(function(){return u})),n.d(e,"d",(function(){return h})),n.d(e,"j",(function(){return p})),n.d(e,"k",(function(){return m})),n.d(e,"f",(function(){return g})),n.d(e,"n",(function(){return f}));var i={schema:{title:"Google Map Configuration",type:"object",properties:{gmApiKey:{title:"Google Maps API Key",type:"string",default:"AIzaSyDoEx2kaGz3PxwbI9T7ccTSg5xjdw8Nw8Q"},gmDefaultMapType:{title:"Default map type",type:"string",default:"roadmap"}},required:[]},form:["gmApiKey",{key:"gmDefaultMapType",type:"rc-select",multiple:!1,items:[{value:"roadmap",label:"Roadmap"},{value:"satellite",label:"Satellite"},{value:"hybrid",label:"Hybrid"},{value:"terrain",label:"Terrain"}]}]},a={schema:{title:"Tencent Map Configuration",type:"object",properties:{tmApiKey:{title:"Tencent Maps API Key",type:"string",default:"84d6d83e0e51e481e50454ccbe8986b"},tmDefaultMapType:{title:"Default map type",type:"string",default:"roadmap"}},required:[]},form:["tmApiKey",{key:"tmDefaultMapType",type:"rc-select",multiple:!1,items:[{value:"roadmap",label:"Roadmap"},{value:"satellite",label:"Satellite"},{value:"hybrid",label:"Hybrid"}]}]},o={schema:{title:"HERE Map Configuration",type:"object",properties:{mapProviderHere:{title:"Map layer",type:"string",default:"HERE.normalDay"},credentials:{type:"object",title:"Credentials",properties:{app_id:{title:"HERE app id",type:"string",default:"AhM6TzD9ThyK78CT3ptx"},app_code:{title:"HERE app code",type:"string",default:"p6NPiITB3Vv0GMUFnkLOOg"}},required:["app_id","app_code"]}},required:[]},form:[{key:"mapProviderHere",type:"rc-select",multiple:!1,items:[{value:"HERE.normalDay",label:"HERE.normalDay (Default)"},{value:"HERE.normalNight",label:"HERE.normalNight"},{value:"HERE.hybridDay",label:"HERE.hybridDay"},{value:"HERE.terrainDay",label:"HERE.terrainDay"}]},"credentials"]},r={schema:{title:"Openstreet Map Configuration",type:"object",properties:{mapProvider:{title:"Map provider",type:"string",default:"OpenStreetMap.Mapnik"},useCustomProvider:{title:"Use custom provider",type:"boolean",default:!1},customProviderTileUrl:{title:"Custom provider tile URL",type:"string",default:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}},required:[]},form:[{key:"mapProvider",type:"rc-select",multiple:!1,items:[{value:"OpenStreetMap.Mapnik",label:"OpenStreetMap.Mapnik (Default)"},{value:"OpenStreetMap.BlackAndWhite",label:"OpenStreetMap.BlackAndWhite"},{value:"OpenStreetMap.HOT",label:"OpenStreetMap.HOT"},{value:"Esri.WorldStreetMap",label:"Esri.WorldStreetMap"},{value:"Esri.WorldTopoMap",label:"Esri.WorldTopoMap"},{value:"CartoDB.Positron",label:"CartoDB.Positron"},{value:"CartoDB.DarkMatter",label:"CartoDB.DarkMatter"}]},"useCustomProvider",{key:"customProviderTileUrl",condition:"model.useCustomProvider === true"}]},s={schema:{title:"Map Configuration",type:"object",properties:{defaultZoomLevel:{title:"Default map zoom level (0 - 20)",type:"number"},useDefaultCenterPosition:{title:"Use default map center position",type:"boolean",default:!1},defaultCenterPosition:{title:"Default map center position (0,0)",type:"string",default:"0,0"},fitMapBounds:{title:"Fit map bounds to cover all markers",type:"boolean",default:!0},draggableMarker:{title:"Draggable Marker",type:"boolean",default:!1},disableScrollZooming:{title:"Disable scroll zooming",type:"boolean",default:!1},latKeyName:{title:"Latitude key name",type:"string",default:"latitude"},lngKeyName:{title:"Longitude key name",type:"string",default:"longitude"},xPosKeyName:{title:"X position key name",type:"string",default:"xPos"},yPosKeyName:{title:"Y position key name",type:"string",default:"yPos"},showLabel:{title:"Show label",type:"boolean",default:!0},label:{title:"Label (pattern examples: '${entityName}', '${entityName}: (Text ${keyName} units.)' )",type:"string",default:"${entityName}"},useLabelFunction:{title:"Use label function",type:"boolean",default:!1},labelFunction:{title:"Label function: f(data, dsData, dsIndex)",type:"string"},showTooltip:{title:"Show tooltip",type:"boolean",default:!0},showTooltipAction:{title:"Action for displaying the tooltip",type:"string",default:"click"},autocloseTooltip:{title:"Auto-close tooltips",type:"boolean",default:!0},tooltipPattern:{title:"Tooltip (for ex. 'Text ${keyName} units.' or <link-act name='my-action'>Link text</link-act>')",type:"string",default:"<b>${entityName}</b><br/><br/><b>Latitude:</b> ${latitude:7}<br/><b>Longitude:</b> ${longitude:7}"},useTooltipFunction:{title:"Use tooltip function",type:"boolean",default:!1},tooltipFunction:{title:"Tooltip function: f(data, dsData, dsIndex)",type:"string"},posFunction:{title:"Position conversion function: f(origXPos, origYPos), should return x,y coordinates as double from 0 to 1 each",type:"string",default:"return {x: origXPos, y: origYPos};"},markerOffsetX:{title:"Marker X offset relative to position",type:"number",default:.5},markerOffsetY:{title:"Marker Y offset relative to position",type:"number",default:1},color:{title:"Color",type:"string"},useColorFunction:{title:"Use color function",type:"boolean",default:!1},colorFunction:{title:"Color function: f(data, dsData, dsIndex)",type:"string"},markerImage:{title:"Custom marker image",type:"string"},markerImageSize:{title:"Custom marker image size (px)",type:"number",default:34},useMarkerImageFunction:{title:"Use marker image function",type:"boolean",default:!1},markerImageFunction:{title:"Marker image function: f(data, images, dsData, dsIndex)",type:"string"},markerImages:{title:"Marker images",type:"array",items:{title:"Marker image",type:"string"}}},required:[]},form:[{key:"defaultZoomLevel",condition:'model.provider !== "image-map"'},{key:"useDefaultCenterPosition",condition:'model.provider !== "image-map"'},{key:"defaultCenterPosition",condition:'model.provider !== "image-map"'},{key:"fitMapBounds",condition:'model.provider !== "image-map"'},"draggableMarker",{key:"disableScrollZooming",condition:'model.provider !== "image-map"'},{key:"latKeyName",condition:'model.provider !== "image-map"'},{key:"lngKeyName",condition:'model.provider !== "image-map"'},{key:"xPosKeyName",condition:'model.provider === "image-map"'},{key:"yPosKeyName",condition:'model.provider === "image-map"'},"showLabel","label","useLabelFunction",{key:"labelFunction",type:"javascript"},"showTooltip",{key:"showTooltipAction",type:"rc-select",multiple:!1,items:[{value:"click",label:"Show tooltip on click (Default)"},{value:"hover",label:"Show tooltip on hover"}]},"autocloseTooltip",{key:"tooltipPattern",type:"textarea"},"useTooltipFunction",{key:"tooltipFunction",type:"javascript"},{key:"markerOffsetX",condition:'model.provider === "image-map"'},{key:"markerOffsetY",condition:'model.provider === "image-map"'},{key:"posFunction",type:"javascript",condition:'model.provider === "image-map"'},{key:"color",type:"color"},"useColorFunction",{key:"colorFunction",type:"javascript"},{key:"markerImage",type:"image"},"markerImageSize","useMarkerImageFunction",{key:"markerImageFunction",type:"javascript"},{key:"markerImages",items:[{key:"markerImages[]",type:"image"}]}]},l={schema:{title:"Map Polygon Configuration",type:"object",properties:{showPolygon:{title:"Show polygon",type:"boolean",default:!1},polygonKeyName:{title:"Polygon key name",type:"string",default:"coordinates"},polygonColor:{title:"Polygon color",type:"string"},polygonOpacity:{title:"Polygon opacity",type:"number",default:.5},polygonStrokeColor:{title:"Stroke color",type:"string"},polygonStrokeOpacity:{title:"Stroke opacity",type:"number",default:1},polygonStrokeWeight:{title:"Stroke weight",type:"number",default:1},showPolygonTooltip:{title:"Show polygon tooltip",type:"boolean",default:!1},polygonTooltipPattern:{title:"Tooltip (for ex. 'Text ${keyName} units.' or <link-act name='my-action'>Link text</link-act>')",type:"string",default:"<b>${entityName}</b><br/><br/><b>TimeStamp:</b> ${ts:7}"},usePolygonTooltipFunction:{title:"Use polygon tooltip function",type:"boolean",default:!1},polygonTooltipFunction:{title:"Polygon tooltip function: f(data, dsData, dsIndex)",type:"string"},usePolygonColorFunction:{title:"Use polygon color function",type:"boolean",default:!1},polygonColorFunction:{title:"Polygon Color function: f(data, dsData, dsIndex)",type:"string"}},required:[]},form:["showPolygon","polygonKeyName",{key:"polygonColor",type:"color"},"polygonOpacity",{key:"polygonStrokeColor",type:"color"},"polygonStrokeOpacity","polygonStrokeWeight","showPolygonTooltip",{key:"polygonTooltipPattern",type:"textarea"},"usePolygonTooltipFunction",{key:"polygonTooltipFunction",type:"javascript"},"usePolygonColorFunction",{key:"polygonColorFunction",type:"javascript"}]},c={schema:{title:"Route Map Configuration",type:"object",properties:{strokeWeight:{title:"Stroke weight",type:"number",default:2},strokeOpacity:{title:"Stroke opacity",type:"number",default:1}},required:[]},form:["strokeWeight","strokeOpacity"]},d={schema:{title:"Markers Clustering Configuration",type:"object",properties:{useClusterMarkers:{title:"Use map markers clustering",type:"boolean",default:!1}},required:[]},form:[{key:"useClusterMarkers",condition:'model.provider !== "image-map"'}]},u={schema:{title:"Markers Clustering Configuration Leaflet",type:"object",properties:{zoomOnClick:{title:"Zoom when clicking on a cluster",type:"boolean",default:!0},maxZoom:{title:"The maximum zoom level when a marker can be part of a cluster (0 - 18)",type:"number"},showCoverageOnHover:{title:"Show the bounds of markers when mouse over a cluster",type:"boolean",default:!0},animate:{title:"Show animation on markers when zooming",type:"boolean",default:!0},maxClusterRadius:{title:"Maximum radius that a cluster will cover in pixels",type:"number",default:80},chunkedLoading:{title:"Use chunks for adding markers so that the page does not freeze",type:"boolean",default:!1},removeOutsideVisibleBounds:{title:"Use lazy load for adding markers",type:"boolean",default:!0}},required:[]},form:["zoomOnClick","maxZoom","showCoverageOnHover","animate","maxClusterRadius","chunkedLoading","removeOutsideVisibleBounds"]},h={schema:{title:"Image Map Configuration",type:"object",properties:{mapImageUrl:{title:"Image map background",type:"string",default:"data:image/svg+xml;base64,PHN2ZyBpZD0ic3ZnMiIgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTAwIiB3aWR0aD0iMTAwIiB2ZXJzaW9uPSIxLjEiIHhtbG5zOmNjPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9ucyMiIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgdmlld0JveD0iMCAwIDEwMCAxMDAiPgogPGcgaWQ9ImxheWVyMSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMCAtOTUyLjM2KSI+CiAgPHJlY3QgaWQ9InJlY3Q0Njg0IiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBoZWlnaHQ9Ijk5LjAxIiB3aWR0aD0iOTkuMDEiIHN0cm9rZT0iIzAwMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiB5PSI5NTIuODYiIHg9Ii40OTUwNSIgc3Ryb2tlLXdpZHRoPSIuOTkwMTAiIGZpbGw9IiNlZWUiLz4KICA8dGV4dCBpZD0idGV4dDQ2ODYiIHN0eWxlPSJ3b3JkLXNwYWNpbmc6MHB4O2xldHRlci1zcGFjaW5nOjBweDt0ZXh0LWFuY2hvcjptaWRkbGU7dGV4dC1hbGlnbjpjZW50ZXIiIGZvbnQtd2VpZ2h0PSJib2xkIiB4bWw6c3BhY2U9InByZXNlcnZlIiBmb250LXNpemU9IjEwcHgiIGxpbmUtaGVpZ2h0PSIxMjUlIiB5PSI5NzAuNzI4MDkiIHg9IjQ5LjM5NjQ3NyIgZm9udC1mYW1pbHk9IlJvYm90byIgZmlsbD0iIzY2NjY2NiI+PHRzcGFuIGlkPSJ0c3BhbjQ2OTAiIHg9IjUwLjY0NjQ3NyIgeT0iOTcwLjcyODA5Ij5JbWFnZSBiYWNrZ3JvdW5kIDwvdHNwYW4+PHRzcGFuIGlkPSJ0c3BhbjQ2OTIiIHg9IjQ5LjM5NjQ3NyIgeT0iOTgzLjIyODA5Ij5pcyBub3QgY29uZmlndXJlZDwvdHNwYW4+PC90ZXh0PgogIDxyZWN0IGlkPSJyZWN0NDY5NCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgaGVpZ2h0PSIxOS4zNiIgd2lkdGg9IjY5LjM2IiBzdHJva2U9IiMwMDAiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgeT0iOTkyLjY4IiB4PSIxNS4zMiIgc3Ryb2tlLXdpZHRoPSIuNjM5ODYiIGZpbGw9Im5vbmUiLz4KIDwvZz4KPC9zdmc+Cg=="},imageEntityAlias:{title:"Image URL source entity alias",type:"string",default:""},imageUrlAttribute:{title:"Image URL source entity attribute",type:"string",default:""}},required:[]},form:[{key:"mapImageUrl",type:"image"},"imageEntityAlias","imageUrlAttribute"]},p={schema:{title:"Trip Animation Path Configuration",type:"object",properties:{color:{title:"Path color",type:"string"},strokeWeight:{title:"Stroke weight",type:"number",default:2},strokeOpacity:{title:"Stroke opacity",type:"number",default:1},useColorFunction:{title:"Use path color function",type:"boolean",default:!1},colorFunction:{title:"Path color function: f(data, dsData, dsIndex)",type:"string"},usePolylineDecorator:{title:"Use path decorator",type:"boolean",default:!1},decoratorSymbol:{title:"Decorator symbol",type:"string",default:"arrowHead"},decoratorSymbolSize:{title:"Decorator symbol size (px)",type:"number",default:10},useDecoratorCustomColor:{title:"Use path decorator custom color",type:"boolean",default:!1},decoratorCustomColor:{title:"Decorator custom color",type:"string",default:"#000"},decoratorOffset:{title:"Decorator offset",type:"string",default:"20px"},endDecoratorOffset:{title:"End decorator offset",type:"string",default:"20px"},decoratorRepeat:{title:"Decorator repeat",type:"string",default:"20px"}},required:[]},form:[{key:"color",type:"color"},"useColorFunction",{key:"colorFunction",type:"javascript"},"strokeWeight","strokeOpacity","usePolylineDecorator",{key:"decoratorSymbol",type:"rc-select",multiple:!1,items:[{value:"arrowHead",label:"Arrow"},{value:"dash",label:"Dash"}]},"decoratorSymbolSize","useDecoratorCustomColor",{key:"decoratorCustomColor",type:"color"},{key:"decoratorOffset",type:"textarea"},{key:"endDecoratorOffset",type:"textarea"},{key:"decoratorRepeat",type:"textarea"}]},m={schema:{title:"Trip Animation Path Configuration",type:"object",properties:{showPoints:{title:"Show points",type:"boolean",default:!1},pointColor:{title:"Point color",type:"string"},pointSize:{title:"Point size (px)",type:"number",default:10},usePointAsAnchor:{title:"Use point as anchor",type:"boolean",default:!1},pointAsAnchorFunction:{title:"Point as anchor function: f(data, dsData, dsIndex)",type:"string"},pointTooltipOnRightPanel:{title:"Independant point tooltip",type:"boolean",default:!0}},required:[]},form:["showPoints",{key:"pointColor",type:"color"},"pointSize","usePointAsAnchor",{key:"pointAsAnchorFunction",type:"javascript"},"pointTooltipOnRightPanel"]},g={schema:{title:"Map Provider Configuration",type:"object",properties:{provider:{title:"Map Provider",type:"string",default:"openstreet-map"}},required:[]},form:[{key:"provider",type:"rc-select",multiple:!1,items:[{value:"google-map",label:"Google maps"},{value:"openstreet-map",label:"Openstreet maps"},{value:"here",label:"HERE maps"},{value:"image-map",label:"Image map"},{value:"tencent-map",label:"Tencent maps"}]}]},f={schema:{title:"Openstreet Map Configuration",type:"object",properties:{normalizationStep:{title:"Normalization data step (ms)",type:"number",default:1e3},latKeyName:{title:"Latitude key name",type:"string",default:"latitude"},lngKeyName:{title:"Longitude key name",type:"string",default:"longitude"},showLabel:{title:"Show label",type:"boolean",default:!0},label:{title:"Label (pattern examples: '${entityName}', '${entityName}: (Text ${keyName} units.)' )",type:"string",default:"${entityName}"},useLabelFunction:{title:"Use label function",type:"boolean",default:!1},labelFunction:{title:"Label function: f(data, dsData, dsIndex)",type:"string"},showTooltip:{title:"Show tooltip",type:"boolean",default:!0},tooltipColor:{title:"Tooltip background color",type:"string",default:"#fff"},tooltipFontColor:{title:"Tooltip font color",type:"string",default:"#000"},tooltipOpacity:{title:"Tooltip opacity (0-1)",type:"number",default:1},tooltipPattern:{title:"Tooltip (for ex. 'Text ${keyName} units.' or <link-act name='my-action'>Link text</link-act>')",type:"string",default:"<b>${entityName}</b><br/><br/><b>Latitude:</b> ${latitude:7}<br/><b>Longitude:</b> ${longitude:7}"},useTooltipFunction:{title:"Use tooltip function",type:"boolean",default:!1},tooltipFunction:{title:"Tooltip function: f(data, dsData, dsIndex)",type:"string"},autocloseTooltip:{title:"Auto-close point popup",type:"boolean",default:!0},markerImage:{title:"Custom marker image",type:"string"},markerImageSize:{title:"Custom marker image size (px)",type:"number",default:34},rotationAngle:{title:"Set additional rotation angle for marker (deg)",type:"number",default:0},useMarkerImageFunction:{title:"Use marker image function",type:"boolean",default:!1},markerImageFunction:{title:"Marker image function: f(data, images, dsData, dsIndex)",type:"string"},markerImages:{title:"Marker images",type:"array",items:{title:"Marker image",type:"string"}}},required:[]},form:["normalizationStep","latKeyName","lngKeyName","showLabel","label","useLabelFunction",{key:"labelFunction",type:"javascript"},"showTooltip",{key:"tooltipColor",type:"color"},{key:"tooltipFontColor",type:"color"},"tooltipOpacity",{key:"tooltipPattern",type:"textarea"},"useTooltipFunction",{key:"tooltipFunction",type:"javascript"},"autocloseTooltip",{key:"markerImage",type:"image"},"markerImageSize","rotationAngle","useMarkerImageFunction",{key:"markerImageFunction",type:"javascript"},{key:"markerImages",items:[{key:"markerImages[]",type:"image"}]}]}},"3s2E":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form [formGroup]="addWidgetFormGroup" (ngSubmit)="add()" style="min-width: 400px;">\n  <mat-toolbar color="primary">\n    <h2 translate>attribute.add-widget-to-dashboard</h2>\n    <span fxFlex></span>\n    <button mat-button mat-icon-button\n            (click)="cancel()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div mat-dialog-content fxLayout="column">\n    <fieldset [disabled]="isLoading$ | async">\n      <mat-radio-group formControlName="addToDashboardType">\n        <mat-radio-button [value]="0" color="primary">\n          <section fxLayout="column" style="width: 300px;">\n            <span translate>dashboard.select-existing</span>\n            <tb-dashboard-autocomplete formControlName="dashboardId"\n                                       [required]="addWidgetFormGroup.get(\'addToDashboardType\').value === 0"\n                                       [selectFirstDashboard]="false">\n            </tb-dashboard-autocomplete>\n          </section>\n        </mat-radio-button>\n        <mat-radio-button [value]="1" color="primary">\n          <section fxLayout="column" style="width: 300px;">\n            <span translate>dashboard.create-new</span>\n            <mat-form-field class="mat-block">\n              <mat-label translate>dashboard.new-dashboard-title</mat-label>\n              <input matInput formControlName="newDashboardTitle"\n                     [required]="addWidgetFormGroup.get(\'addToDashboardType\').value === 1">\n              <mat-error *ngIf="addWidgetFormGroup.get(\'newDashboardTitle\').hasError(\'required\')">\n                {{ \'dashboard.title-required\' | translate }}\n              </mat-error>\n            </mat-form-field>\n          </section>\n        </mat-radio-button>\n      </mat-radio-group>\n    </fieldset>\n  </div>\n  <div mat-dialog-actions fxLayoutAlign="end center">\n    <mat-checkbox formControlName="openDashboard"\n                  style="margin-bottom: 0; padding-right: 20px;">\n      {{ \'dashboard.open-dashboard\' | translate }}\n    </mat-checkbox>\n    <button mat-raised-button color="primary"\n            type="submit"\n            [disabled]="(isLoading$ | async) || addWidgetFormGroup.invalid || !addWidgetFormGroup.dirty">\n      {{ \'action.add\' | translate }}\n    </button>\n    <button mat-button color="primary"\n            type="button"\n            [disabled]="(isLoading$ | async)"\n            (click)="cancel()" cdkFocusInitial>\n      {{ \'action.cancel\' | translate }}\n    </button>\n  </div>\n</form>\n'},"4+Bt":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<mat-form-field floatLabel="always" hideRequiredMarker [formGroup]="selectEntityAliasFormGroup" class="mat-block">\n  <mat-label></mat-label>\n  <input matInput type="text" placeholder="{{ \'entity.entity-alias\' | translate }}"\n         #entityAliasInput\n         formControlName="entityAlias"\n         (focusin)="onFocus()"\n         [required]="tbRequired"\n         (keydown)="entityAliasEnter($event)"\n         (keypress)="entityAliasEnter($event)"\n         [matAutocomplete]="entityAliasAutocomplete">\n  <button *ngIf="selectEntityAliasFormGroup.get(\'entityAlias\').value && !disabled"\n          type="button"\n          matSuffix mat-icon-button aria-label="Clear"\n          (click)="clear()">\n    <mat-icon class="material-icons">close</mat-icon>\n  </button>\n  <mat-autocomplete class="tb-autocomplete"\n                    #entityAliasAutocomplete="matAutocomplete"\n                    [displayWith]="displayEntityAliasFn">\n    <mat-option *ngFor="let entityAlias of filteredEntityAliases | async" [value]="entityAlias">\n      <span [innerHTML]="entityAlias.alias | highlight:searchText"></span>\n    </mat-option>\n    <mat-option *ngIf="!(filteredEntityAliases | async)?.length" [value]="null" class="tb-not-found">\n      <div class="tb-not-found-content" (click)="$event.stopPropagation()">\n        <div *ngIf="!textIsNotEmpty(searchText); else searchNotEmpty">\n          <span translate>entity.no-aliases-found</span>\n        </div>\n        <ng-template #searchNotEmpty>\n          <span>\n            {{ translate.get(\'entity.no-alias-matching\',\n              {alias: truncate.transform(searchText, true, 6, &apos;...&apos;)}) | async }}\n          </span>\n        </ng-template>\n        <span>\n          <a translate (click)="createEntityAlias($event, searchText)">entity.create-new-alias</a>\n        </span>\n      </div>\n    </mat-option>\n  </mat-autocomplete>\n  <mat-error *ngIf="!modelValue && tbRequired">\n    {{ \'entity.alias-required\' | translate }}\n  </mat-error>\n</mat-form-field>\n'},"44to":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div class="tb-entities-hierarchy tb-absolute-fill" tb-toast toastTarget="{{ toastTargetId }}">\n  <div fxFlex fxLayout="column" class="tb-absolute-fill">\n    <mat-toolbar class="mat-table-toolbar" [fxShow]="textSearchMode">\n      <div class="mat-toolbar-tools">\n        <button mat-button mat-icon-button\n                matTooltip="{{ \'action.search\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>search</mat-icon>\n        </button>\n        <mat-form-field fxFlex>\n          <mat-label>&nbsp;</mat-label>\n          <input #searchInput matInput\n                 [(ngModel)]="textSearch"\n                 placeholder="{{ \'entity.search\' | translate }}"/>\n        </mat-form-field>\n        <button mat-button mat-icon-button (click)="exitFilterMode()"\n                matTooltip="{{ \'action.close\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>close</mat-icon>\n        </button>\n      </div>\n    </mat-toolbar>\n    <div fxFlex class="tb-entities-nav-tree-panel">\n      <tb-nav-tree\n        [loadNodes]="loadNodes"\n        [onNodeSelected]="onNodeSelected"\n        [onNodesInserted]="onNodesInserted"\n        [editCallbacks]="nodeEditCallbacks"\n        enableSearch="true"\n        [searchCallback]="searchCallback"\n      ></tb-nav-tree>\n    </div>\n  </div>\n</div>\n'},"4GWK":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<mat-fab-toolbar [isOpen]="toolbarOpened" color="primary" direction="left"\n                 [ngClass]="{\'is-fullscreen\': forceFullscreen, \'mat-elevation-z1\': forceFullscreen && toolbarOpened }">\n  <mat-fab-trigger>\n    <button mat-fab color="primary"\n            [matTooltip]="!toolbarOpened ? (\'dashboard.open-toolbar\' | translate) : \'\'"\n            matTooltipPosition="below"\n            (click)="onTriggerClick()">\n      <mat-icon>more_horiz</mat-icon>\n    </button>\n  </mat-fab-trigger>\n  <mat-toolbar color="primary">\n    <mat-fab-actions class="mat-toolbar-tools">\n      <ng-content></ng-content>\n    </mat-fab-actions>\n  </mat-toolbar>\n</mat-fab-toolbar>\n'},"4Pg0":function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .tb-datakey-config {\n  height: 100%;\n}\n:host .tb-datakey-config .settings > :first-child {\n  padding-top: 12px;\n}\n:host .tb-datakey-config .settings > :nth-child(n) {\n  padding-right: 12px;\n  padding-left: 12px;\n}\n:host ::ng-deep .tb-datakey-config .mat-tab-body.mat-tab-body-active .mat-tab-body-content > div {\n  height: calc(65vh - 50px);\n  overflow: initial;\n}\n@media screen and (max-width: 599px) {\n  :host ::ng-deep .tb-datakey-config .mat-tab-body.mat-tab-body-active .mat-tab-body-content > div {\n    height: 500px;\n  }\n}'},"4R65":function(t,e,n){!function(t){"use strict";var e=Object.freeze;function n(t){var e,n,i,a;for(n=1,i=arguments.length;n<i;n++)for(e in a=arguments[n])t[e]=a[e];return t}Object.freeze=function(t){return t};var i=Object.create||function(){function t(){}return function(e){return t.prototype=e,new t}}();function a(t,e){var n=Array.prototype.slice;if(t.bind)return t.bind.apply(t,n.call(arguments,1));var i=n.call(arguments,2);return function(){return t.apply(e,i.length?i.concat(n.call(arguments)):arguments)}}var o=0;function r(t){return t._leaflet_id=t._leaflet_id||++o,t._leaflet_id}function s(t,e,n){var i,a,o,r;return r=function(){i=!1,a&&(o.apply(n,a),a=!1)},o=function(){i?a=arguments:(t.apply(n,arguments),setTimeout(r,e),i=!0)}}function l(t,e,n){var i=e[1],a=e[0],o=i-a;return t===i&&n?t:((t-a)%o+o)%o+a}function c(){return!1}function d(t,e){var n=Math.pow(10,void 0===e?6:e);return Math.round(t*n)/n}function u(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function h(t){return u(t).split(/\s+/)}function p(t,e){for(var n in t.hasOwnProperty("options")||(t.options=t.options?i(t.options):{}),e)t.options[n]=e[n];return t.options}function m(t,e,n){var i=[];for(var a in t)i.push(encodeURIComponent(n?a.toUpperCase():a)+"="+encodeURIComponent(t[a]));return(e&&-1!==e.indexOf("?")?"&":"?")+i.join("&")}var g=/\{ *([\w_-]+) *\}/g;function f(t,e){return t.replace(g,(function(t,n){var i=e[n];if(void 0===i)throw new Error("No value provided for variable "+t);return"function"==typeof i&&(i=i(e)),i}))}var b=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function y(t,e){for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}var v="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function w(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var x=0;function S(t){var e=+new Date,n=Math.max(0,16-(e-x));return x=e+n,window.setTimeout(t,n)}var C=window.requestAnimationFrame||w("RequestAnimationFrame")||S,T=window.cancelAnimationFrame||w("CancelAnimationFrame")||w("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function O(t,e,n){if(!n||C!==S)return C.call(window,a(t,e));t.call(e)}function _(t){t&&T.call(window,t)}var I=(Object.freeze||Object)({freeze:e,extend:n,create:i,bind:a,lastId:o,stamp:r,throttle:s,wrapNum:l,falseFn:c,formatNum:d,trim:u,splitWords:h,setOptions:p,getParamString:m,template:f,isArray:b,indexOf:y,emptyImageUrl:v,requestFn:C,cancelFn:T,requestAnimFrame:O,cancelAnimFrame:_});function A(){}A.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},a=e.__super__=this.prototype,o=i(a);for(var r in o.constructor=e,e.prototype=o,this)this.hasOwnProperty(r)&&"prototype"!==r&&"__super__"!==r&&(e[r]=this[r]);return t.statics&&(n(e,t.statics),delete t.statics),t.includes&&(function(t){if("undefined"!=typeof L&&L&&L.Mixin){t=b(t)?t:[t];for(var e=0;e<t.length;e++)t[e]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",(new Error).stack)}}(t.includes),n.apply(null,[o].concat(t.includes)),delete t.includes),o.options&&(t.options=n(i(o.options),t.options)),n(o,t),o._initHooks=[],o.callInitHooks=function(){if(!this._initHooksCalled){a.callInitHooks&&a.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=o._initHooks.length;t<e;t++)o._initHooks[t].call(this)}},e},A.include=function(t){return n(this.prototype,t),this},A.mergeOptions=function(t){return n(this.prototype.options,t),this},A.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n),this};var k={on:function(t,e,n){if("object"==typeof t)for(var i in t)this._on(i,t[i],e);else for(var a=0,o=(t=h(t)).length;a<o;a++)this._on(t[a],e,n);return this},off:function(t,e,n){if(t)if("object"==typeof t)for(var i in t)this._off(i,t[i],e);else for(var a=0,o=(t=h(t)).length;a<o;a++)this._off(t[a],e,n);else delete this._events;return this},_on:function(t,e,n){this._events=this._events||{};var i=this._events[t];i||(i=[],this._events[t]=i),n===this&&(n=void 0);for(var a={fn:e,ctx:n},o=i,r=0,s=o.length;r<s;r++)if(o[r].fn===e&&o[r].ctx===n)return;o.push(a)},_off:function(t,e,n){var i,a,o;if(this._events&&(i=this._events[t]))if(e){if(n===this&&(n=void 0),i)for(a=0,o=i.length;a<o;a++){var r=i[a];if(r.ctx===n&&r.fn===e)return r.fn=c,this._firingCount&&(this._events[t]=i=i.slice()),void i.splice(a,1)}}else{for(a=0,o=i.length;a<o;a++)i[a].fn=c;delete this._events[t]}},fire:function(t,e,i){if(!this.listens(t,i))return this;var a=n({},e,{type:t,target:this,sourceTarget:e&&e.sourceTarget||this});if(this._events){var o=this._events[t];if(o){this._firingCount=this._firingCount+1||1;for(var r=0,s=o.length;r<s;r++){var l=o[r];l.fn.call(l.ctx||this,a)}this._firingCount--}}return i&&this._propagateEvent(a),this},listens:function(t,e){var n=this._events&&this._events[t];if(n&&n.length)return!0;if(e)for(var i in this._eventParents)if(this._eventParents[i].listens(t,e))return!0;return!1},once:function(t,e,n){if("object"==typeof t){for(var i in t)this.once(i,t[i],e);return this}var o=a((function(){this.off(t,e,n).off(t,o,n)}),this);return this.on(t,e,n).on(t,o,n)},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[r(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[r(t)],this},_propagateEvent:function(t){for(var e in this._eventParents)this._eventParents[e].fire(t.type,n({layer:t.target,propagatedFrom:t.target},t),!0)}};k.addEventListener=k.on,k.removeEventListener=k.clearAllEventListeners=k.off,k.addOneTimeEventListener=k.once,k.fireEvent=k.fire,k.hasEventListeners=k.listens;var E=A.extend(k);function j(t,e,n){this.x=n?Math.round(t):t,this.y=n?Math.round(e):e}var D=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};function F(t,e,n){return t instanceof j?t:b(t)?new j(t[0],t[1]):null==t?t:"object"==typeof t&&"x"in t&&"y"in t?new j(t.x,t.y):new j(t,e,n)}function M(t,e){if(t)for(var n=e?[t,e]:t,i=0,a=n.length;i<a;i++)this.extend(n[i])}function R(t,e){return!t||t instanceof M?t:new M(t,e)}function N(t,e){if(t)for(var n=e?[t,e]:t,i=0,a=n.length;i<a;i++)this.extend(n[i])}function P(t,e){return t instanceof N?t:new N(t,e)}function V(t,e,n){if(isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=+t,this.lng=+e,void 0!==n&&(this.alt=+n)}function W(t,e,n){return t instanceof V?t:b(t)&&"object"!=typeof t[0]?3===t.length?new V(t[0],t[1],t[2]):2===t.length?new V(t[0],t[1]):null:null==t?t:"object"==typeof t&&"lat"in t?new V(t.lat,"lng"in t?t.lng:t.lon,t.alt):void 0===e?null:new V(t,e,n)}j.prototype={clone:function(){return new j(this.x,this.y)},add:function(t){return this.clone()._add(F(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(F(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new j(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new j(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=D(this.x),this.y=D(this.y),this},distanceTo:function(t){var e=(t=F(t)).x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},equals:function(t){return(t=F(t)).x===this.x&&t.y===this.y},contains:function(t){return t=F(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+d(this.x)+", "+d(this.y)+")"}},M.prototype={extend:function(t){return t=F(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new j((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new j(this.min.x,this.max.y)},getTopRight:function(){return new j(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,n;return(t="number"==typeof t[0]||t instanceof j?F(t):R(t))instanceof M?(e=t.min,n=t.max):e=n=t,e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(t){t=R(t);var e=this.min,n=this.max,i=t.min,a=t.max,o=a.x>=e.x&&i.x<=n.x,r=a.y>=e.y&&i.y<=n.y;return o&&r},overlaps:function(t){t=R(t);var e=this.min,n=this.max,i=t.min,a=t.max,o=a.x>e.x&&i.x<n.x,r=a.y>e.y&&i.y<n.y;return o&&r},isValid:function(){return!(!this.min||!this.max)}},N.prototype={extend:function(t){var e,n,i=this._southWest,a=this._northEast;if(t instanceof V)e=t,n=t;else{if(!(t instanceof N))return t?this.extend(W(t)||P(t)):this;if(e=t._southWest,n=t._northEast,!e||!n)return this}return i||a?(i.lat=Math.min(e.lat,i.lat),i.lng=Math.min(e.lng,i.lng),a.lat=Math.max(n.lat,a.lat),a.lng=Math.max(n.lng,a.lng)):(this._southWest=new V(e.lat,e.lng),this._northEast=new V(n.lat,n.lng)),this},pad:function(t){var e=this._southWest,n=this._northEast,i=Math.abs(e.lat-n.lat)*t,a=Math.abs(e.lng-n.lng)*t;return new N(new V(e.lat-i,e.lng-a),new V(n.lat+i,n.lng+a))},getCenter:function(){return new V((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new V(this.getNorth(),this.getWest())},getSouthEast:function(){return new V(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof V||"lat"in t?W(t):P(t);var e,n,i=this._southWest,a=this._northEast;return t instanceof N?(e=t.getSouthWest(),n=t.getNorthEast()):e=n=t,e.lat>=i.lat&&n.lat<=a.lat&&e.lng>=i.lng&&n.lng<=a.lng},intersects:function(t){t=P(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),a=t.getNorthEast(),o=a.lat>=e.lat&&i.lat<=n.lat,r=a.lng>=e.lng&&i.lng<=n.lng;return o&&r},overlaps:function(t){t=P(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),a=t.getNorthEast(),o=a.lat>e.lat&&i.lat<n.lat,r=a.lng>e.lng&&i.lng<n.lng;return o&&r},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,e){return!!t&&(t=P(t),this._southWest.equals(t.getSouthWest(),e)&&this._northEast.equals(t.getNorthEast(),e))},isValid:function(){return!(!this._southWest||!this._northEast)}},V.prototype={equals:function(t,e){return!!t&&(t=W(t),Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng))<=(void 0===e?1e-9:e))},toString:function(t){return"LatLng("+d(this.lat,t)+", "+d(this.lng,t)+")"},distanceTo:function(t){return U.distance(this,W(t))},wrap:function(){return U.wrapLatLng(this)},toBounds:function(t){var e=180*t/40075017,n=e/Math.cos(Math.PI/180*this.lat);return P([this.lat-e,this.lng-n],[this.lat+e,this.lng+n])},clone:function(){return new V(this.lat,this.lng,this.alt)}};var z,B={latLngToPoint:function(t,e){var n=this.projection.project(t),i=this.scale(e);return this.transformation._transform(n,i)},pointToLatLng:function(t,e){var n=this.scale(e),i=this.transformation.untransform(t,n);return this.projection.unproject(i)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var e=this.projection.bounds,n=this.scale(t);return new M(this.transformation.transform(e.min,n),this.transformation.transform(e.max,n))},infinite:!1,wrapLatLng:function(t){var e=this.wrapLng?l(t.lng,this.wrapLng,!0):t.lng;return new V(this.wrapLat?l(t.lat,this.wrapLat,!0):t.lat,e,t.alt)},wrapLatLngBounds:function(t){var e=t.getCenter(),n=this.wrapLatLng(e),i=e.lat-n.lat,a=e.lng-n.lng;if(0===i&&0===a)return t;var o=t.getSouthWest(),r=t.getNorthEast();return new N(new V(o.lat-i,o.lng-a),new V(r.lat-i,r.lng-a))}},U=n({},B,{wrapLng:[-180,180],R:6371e3,distance:function(t,e){var n=Math.PI/180,i=t.lat*n,a=e.lat*n,o=Math.sin((e.lat-t.lat)*n/2),r=Math.sin((e.lng-t.lng)*n/2),s=o*o+Math.cos(i)*Math.cos(a)*r*r,l=2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s));return this.R*l}}),G={R:6378137,MAX_LATITUDE:85.0511287798,project:function(t){var e=Math.PI/180,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),a=Math.sin(i*e);return new j(this.R*t.lng*e,this.R*Math.log((1+a)/(1-a))/2)},unproject:function(t){var e=180/Math.PI;return new V((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,t.x*e/this.R)},bounds:(z=6378137*Math.PI,new M([-z,-z],[z,z]))};function H(t,e,n,i){if(b(t))return this._a=t[0],this._b=t[1],this._c=t[2],void(this._d=t[3]);this._a=t,this._b=e,this._c=n,this._d=i}function K(t,e,n,i){return new H(t,e,n,i)}H.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new j((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}};var Y=n({},U,{code:"EPSG:3857",projection:G,transformation:function(){var t=.5/(Math.PI*G.R);return K(t,.5,-t,.5)}()}),Z=n({},Y,{code:"EPSG:900913"});function q(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function $(t,e){var n,i,a,o,r,s,l="";for(n=0,a=t.length;n<a;n++){for(i=0,o=(r=t[n]).length;i<o;i++)l+=(i?"L":"M")+(s=r[i]).x+" "+s.y;l+=e?It?"z":"x":""}return l||"M0 0"}var X=document.documentElement.style,Q="ActiveXObject"in window,J=Q&&!document.addEventListener,tt="msLaunchUri"in navigator&&!("documentMode"in document),et=kt("webkit"),nt=kt("android"),it=kt("android 2")||kt("android 3"),at=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ot=nt&&kt("Google")&&at<537&&!("AudioNode"in window),rt=!!window.opera,st=kt("chrome"),lt=kt("gecko")&&!et&&!rt&&!Q,ct=!st&&kt("safari"),dt=kt("phantom"),ut="OTransition"in X,ht=0===navigator.platform.indexOf("Win"),pt=Q&&"transition"in X,mt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!it,gt="MozPerspective"in X,ft=!window.L_DISABLE_3D&&(pt||mt||gt)&&!ut&&!dt,bt="undefined"!=typeof orientation||kt("mobile"),yt=bt&&et,vt=bt&&mt,wt=!window.PointerEvent&&window.MSPointerEvent,xt=!(et||!window.PointerEvent&&!wt),St=!window.L_NO_TOUCH&&(xt||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),Ct=bt&&rt,Tt=bt&&lt,Ot=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,_t=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",c,e),window.removeEventListener("testPassiveEventSupport",c,e)}catch(n){}return t},Lt=!!document.createElement("canvas").getContext,It=!(!document.createElementNS||!q("svg").createSVGRect),At=!It&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(n){return!1}}();function kt(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var Et=(Object.freeze||Object)({ie:Q,ielt9:J,edge:tt,webkit:et,android:nt,android23:it,androidStock:ot,opera:rt,chrome:st,gecko:lt,safari:ct,phantom:dt,opera12:ut,win:ht,ie3d:pt,webkit3d:mt,gecko3d:gt,any3d:ft,mobile:bt,mobileWebkit:yt,mobileWebkit3d:vt,msPointer:wt,pointer:xt,touch:St,mobileOpera:Ct,mobileGecko:Tt,retina:Ot,passiveEvents:_t,canvas:Lt,svg:It,vml:At}),jt=wt?"MSPointerDown":"pointerdown",Dt=wt?"MSPointerMove":"pointermove",Ft=wt?"MSPointerUp":"pointerup",Mt=wt?"MSPointerCancel":"pointercancel",Rt=["INPUT","SELECT","OPTION"],Nt={},Pt=!1,Vt=0;function Wt(t,e,n,i){return"touchstart"===e?function(t,e,n){var i=a((function(t){if("mouse"!==t.pointerType&&t.MSPOINTER_TYPE_MOUSE&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE){if(!(Rt.indexOf(t.target.tagName)<0))return;Ne(t)}Gt(t,e)}));t["_leaflet_touchstart"+n]=i,t.addEventListener(jt,i,!1),Pt||(document.documentElement.addEventListener(jt,zt,!0),document.documentElement.addEventListener(Dt,Bt,!0),document.documentElement.addEventListener(Ft,Ut,!0),document.documentElement.addEventListener(Mt,Ut,!0),Pt=!0)}(t,n,i):"touchmove"===e?function(t,e,n){var i=function(t){(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons)&&Gt(t,e)};t["_leaflet_touchmove"+n]=i,t.addEventListener(Dt,i,!1)}(t,n,i):"touchend"===e&&function(t,e,n){var i=function(t){Gt(t,e)};t["_leaflet_touchend"+n]=i,t.addEventListener(Ft,i,!1),t.addEventListener(Mt,i,!1)}(t,n,i),this}function zt(t){Nt[t.pointerId]=t,Vt++}function Bt(t){Nt[t.pointerId]&&(Nt[t.pointerId]=t)}function Ut(t){delete Nt[t.pointerId],Vt--}function Gt(t,e){for(var n in t.touches=[],Nt)t.touches.push(Nt[n]);t.changedTouches=[t],e(t)}var Ht=wt?"MSPointerDown":xt?"pointerdown":"touchstart",Kt=wt?"MSPointerUp":xt?"pointerup":"touchend",Yt="_leaflet_";function Zt(t,e,n){var i,a,o=!1;function r(t){var e;if(xt){if(!tt||"mouse"===t.pointerType)return;e=Vt}else e=t.touches.length;if(!(e>1)){var n=Date.now(),r=n-(i||n);a=t.touches?t.touches[0]:t,o=r>0&&r<=250,i=n}}function s(t){if(o&&!a.cancelBubble){if(xt){if(!tt||"mouse"===t.pointerType)return;var n,r,s={};for(r in a)n=a[r],s[r]=n&&n.bind?n.bind(a):n;a=s}a.type="dblclick",a.button=0,e(a),i=null}}return t[Yt+Ht+n]=r,t[Yt+Kt+n]=s,t[Yt+"dblclick"+n]=e,t.addEventListener(Ht,r,!!_t&&{passive:!1}),t.addEventListener(Kt,s,!!_t&&{passive:!1}),t.addEventListener("dblclick",e,!1),this}function qt(t,e){var n=t[Yt+Ht+e],i=t[Yt+Kt+e],a=t[Yt+"dblclick"+e];return t.removeEventListener(Ht,n,!!_t&&{passive:!1}),t.removeEventListener(Kt,i,!!_t&&{passive:!1}),tt||t.removeEventListener("dblclick",a,!1),this}var $t,Xt,Qt,Jt,te,ee=be(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ne=be(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),ie="webkitTransition"===ne||"OTransition"===ne?ne+"End":"transitionend";function ae(t){return"string"==typeof t?document.getElementById(t):t}function oe(t,e){var n=t.style[e]||t.currentStyle&&t.currentStyle[e];if((!n||"auto"===n)&&document.defaultView){var i=document.defaultView.getComputedStyle(t,null);n=i?i[e]:null}return"auto"===n?null:n}function re(t,e,n){var i=document.createElement(t);return i.className=e||"",n&&n.appendChild(i),i}function se(t){var e=t.parentNode;e&&e.removeChild(t)}function le(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function ce(t){var e=t.parentNode;e&&e.lastChild!==t&&e.appendChild(t)}function de(t){var e=t.parentNode;e&&e.firstChild!==t&&e.insertBefore(t,e.firstChild)}function ue(t,e){if(void 0!==t.classList)return t.classList.contains(e);var n=ge(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)}function he(t,e){if(void 0!==t.classList)for(var n=h(e),i=0,a=n.length;i<a;i++)t.classList.add(n[i]);else if(!ue(t,e)){var o=ge(t);me(t,(o?o+" ":"")+e)}}function pe(t,e){void 0!==t.classList?t.classList.remove(e):me(t,u((" "+ge(t)+" ").replace(" "+e+" "," ")))}function me(t,e){void 0===t.className.baseVal?t.className=e:t.className.baseVal=e}function ge(t){return t.correspondingElement&&(t=t.correspondingElement),void 0===t.className.baseVal?t.className:t.className.baseVal}function fe(t,e){"opacity"in t.style?t.style.opacity=e:"filter"in t.style&&function(t,e){var n=!1,i="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(i)}catch(a){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+i+"(opacity="+e+")"}(t,e)}function be(t){for(var e=document.documentElement.style,n=0;n<t.length;n++)if(t[n]in e)return t[n];return!1}function ye(t,e,n){var i=e||new j(0,0);t.style[ee]=(pt?"translate("+i.x+"px,"+i.y+"px)":"translate3d("+i.x+"px,"+i.y+"px,0)")+(n?" scale("+n+")":"")}function ve(t,e){t._leaflet_pos=e,ft?ye(t,e):(t.style.left=e.x+"px",t.style.top=e.y+"px")}function we(t){return t._leaflet_pos||new j(0,0)}if("onselectstart"in document)$t=function(){Ae(window,"selectstart",Ne)},Xt=function(){Ee(window,"selectstart",Ne)};else{var xe=be(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);$t=function(){if(xe){var t=document.documentElement.style;Qt=t[xe],t[xe]="none"}},Xt=function(){xe&&(document.documentElement.style[xe]=Qt,Qt=void 0)}}function Se(){Ae(window,"dragstart",Ne)}function Ce(){Ee(window,"dragstart",Ne)}function Te(t){for(;-1===t.tabIndex;)t=t.parentNode;t.style&&(Oe(),Jt=t,te=t.style.outline,t.style.outline="none",Ae(window,"keydown",Oe))}function Oe(){Jt&&(Jt.style.outline=te,Jt=void 0,te=void 0,Ee(window,"keydown",Oe))}function _e(t){do{t=t.parentNode}while(!(t.offsetWidth&&t.offsetHeight||t===document.body));return t}function Le(t){var e=t.getBoundingClientRect();return{x:e.width/t.offsetWidth||1,y:e.height/t.offsetHeight||1,boundingClientRect:e}}var Ie=(Object.freeze||Object)({TRANSFORM:ee,TRANSITION:ne,TRANSITION_END:ie,get:ae,getStyle:oe,create:re,remove:se,empty:le,toFront:ce,toBack:de,hasClass:ue,addClass:he,removeClass:pe,setClass:me,getClass:ge,setOpacity:fe,testProp:be,setTransform:ye,setPosition:ve,getPosition:we,disableTextSelection:$t,enableTextSelection:Xt,disableImageDrag:Se,enableImageDrag:Ce,preventOutline:Te,restoreOutline:Oe,getSizedParentNode:_e,getScale:Le});function Ae(t,e,n,i){if("object"==typeof e)for(var a in e)je(t,a,e[a],n);else for(var o=0,r=(e=h(e)).length;o<r;o++)je(t,e[o],n,i);return this}var ke="_leaflet_events";function Ee(t,e,n,i){if("object"==typeof e)for(var a in e)De(t,a,e[a],n);else if(e)for(var o=0,r=(e=h(e)).length;o<r;o++)De(t,e[o],n,i);else{for(var s in t[ke])De(t,s,t[ke][s]);delete t[ke]}return this}function je(t,e,n,i){var a=e+r(n)+(i?"_"+r(i):"");if(t[ke]&&t[ke][a])return this;var o=function(e){return n.call(i||t,e||window.event)},s=o;xt&&0===e.indexOf("touch")?Wt(t,e,o,a):!St||"dblclick"!==e||!Zt||xt&&st?"addEventListener"in t?"mousewheel"===e?t.addEventListener("onwheel"in t?"wheel":"mousewheel",o,!!_t&&{passive:!1}):"mouseenter"===e||"mouseleave"===e?(o=function(e){e=e||window.event,Ke(t,e)&&s(e)},t.addEventListener("mouseenter"===e?"mouseover":"mouseout",o,!1)):("click"===e&&nt&&(o=function(t){!function(t,e){var n=t.timeStamp||t.originalEvent&&t.originalEvent.timeStamp,i=Be&&n-Be;i&&i>100&&i<500||t.target._simulatedClick&&!t._simulated?Pe(t):(Be=n,e(t))}(t,s)}),t.addEventListener(e,o,!1)):"attachEvent"in t&&t.attachEvent("on"+e,o):Zt(t,o,a),t[ke]=t[ke]||{},t[ke][a]=o}function De(t,e,n,i){var a=e+r(n)+(i?"_"+r(i):""),o=t[ke]&&t[ke][a];if(!o)return this;xt&&0===e.indexOf("touch")?function(t,e,n){var i=t["_leaflet_"+e+n];"touchstart"===e?t.removeEventListener(jt,i,!1):"touchmove"===e?t.removeEventListener(Dt,i,!1):"touchend"===e&&(t.removeEventListener(Ft,i,!1),t.removeEventListener(Mt,i,!1))}(t,e,a):!St||"dblclick"!==e||!qt||xt&&st?"removeEventListener"in t?"mousewheel"===e?t.removeEventListener("onwheel"in t?"wheel":"mousewheel",o,!!_t&&{passive:!1}):t.removeEventListener("mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,o,!1):"detachEvent"in t&&t.detachEvent("on"+e,o):qt(t,a),t[ke][a]=null}function Fe(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,He(t),this}function Me(t){return je(t,"mousewheel",Fe),this}function Re(t){return Ae(t,"mousedown touchstart dblclick",Fe),je(t,"click",Ge),this}function Ne(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Pe(t){return Ne(t),Fe(t),this}function Ve(t,e){if(!e)return new j(t.clientX,t.clientY);var n=Le(e),i=n.boundingClientRect;return new j((t.clientX-i.left)/n.x-e.clientLeft,(t.clientY-i.top)/n.y-e.clientTop)}var We=ht&&st?2*window.devicePixelRatio:lt?window.devicePixelRatio:1;function ze(t){return tt?t.wheelDeltaY/2:t.deltaY&&0===t.deltaMode?-t.deltaY/We:t.deltaY&&1===t.deltaMode?20*-t.deltaY:t.deltaY&&2===t.deltaMode?60*-t.deltaY:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?20*-t.detail:t.detail?t.detail/-32765*60:0}var Be,Ue={};function Ge(t){Ue[t.type]=!0}function He(t){var e=Ue[t.type];return Ue[t.type]=!1,e}function Ke(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(i){return!1}return n!==t}var Ye=(Object.freeze||Object)({on:Ae,off:Ee,stopPropagation:Fe,disableScrollPropagation:Me,disableClickPropagation:Re,preventDefault:Ne,stop:Pe,getMousePosition:Ve,getWheelDelta:ze,fakeStop:Ge,skipped:He,isExternalTarget:Ke,addListener:Ae,removeListener:Ee}),Ze=E.extend({run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=we(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=O(this._animate,this),this._step()},_step:function(t){var e=+new Date-this._startTime,n=1e3*this._duration;e<n?this._runFrame(this._easeOut(e/n),t):(this._runFrame(1),this._complete())},_runFrame:function(t,e){var n=this._startPos.add(this._offset.multiplyBy(t));e&&n._round(),ve(this._el,n),this.fire("step")},_complete:function(){_(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),qe=E.extend({options:{crs:Y,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,e){e=p(this,e),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=a(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),void 0!==e.zoom&&(this._zoom=this._limitZoom(e.zoom)),e.center&&void 0!==e.zoom&&this.setView(W(e.center),e.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ne&&ft&&!Ct&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ae(this._proxy,ie,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,e,i){return e=void 0===e?this._zoom:this._limitZoom(e),t=this._limitCenter(W(t),e,this.options.maxBounds),i=i||{},this._stop(),this._loaded&&!i.reset&&!0!==i&&(void 0!==i.animate&&(i.zoom=n({animate:i.animate},i.zoom),i.pan=n({animate:i.animate,duration:i.duration},i.pan)),this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,i.zoom):this._tryAnimatedPan(t,i.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(t,e),this)},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=t,this)},zoomIn:function(t,e){return t=t||(ft?this.options.zoomDelta:1),this.setZoom(this._zoom+t,e)},zoomOut:function(t,e){return t=t||(ft?this.options.zoomDelta:1),this.setZoom(this._zoom-t,e)},setZoomAround:function(t,e,n){var i=this.getZoomScale(e),a=this.getSize().divideBy(2),o=(t instanceof j?t:this.latLngToContainerPoint(t)).subtract(a).multiplyBy(1-1/i),r=this.containerPointToLatLng(a.add(o));return this.setView(r,e,{zoom:n})},_getBoundsCenterZoom:function(t,e){e=e||{},t=t.getBounds?t.getBounds():P(t);var n=F(e.paddingTopLeft||e.padding||[0,0]),i=F(e.paddingBottomRight||e.padding||[0,0]),a=this.getBoundsZoom(t,!1,n.add(i));if((a="number"==typeof e.maxZoom?Math.min(e.maxZoom,a):a)===1/0)return{center:t.getCenter(),zoom:a};var o=i.subtract(n).divideBy(2),r=this.project(t.getSouthWest(),a),s=this.project(t.getNorthEast(),a);return{center:this.unproject(r.add(s).divideBy(2).add(o),a),zoom:a}},fitBounds:function(t,e){if(!(t=P(t)).isValid())throw new Error("Bounds are not valid.");var n=this._getBoundsCenterZoom(t,e);return this.setView(n.center,n.zoom,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t,e){if(e=e||{},!(t=F(t).round()).x&&!t.y)return this.fire("moveend");if(!0!==e.animate&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ze,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),!1!==e.animate){he(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,n,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,e,n){if(!1===(n=n||{}).animate||!ft)return this.setView(t,e,n);this._stop();var i=this.project(this.getCenter()),a=this.project(t),o=this.getSize(),r=this._zoom;t=W(t),e=void 0===e?r:e;var s=Math.max(o.x,o.y),l=s*this.getZoomScale(r,e),c=a.distanceTo(i)||1;function d(t){var e=(l*l-s*s+2.0164*(t?-1:1)*2.0164*c*c)/(2*(t?l:s)*2.0164*c),n=Math.sqrt(e*e+1)-e;return n<1e-9?-18:Math.log(n)}function u(t){return(Math.exp(t)-Math.exp(-t))/2}function h(t){return(Math.exp(t)+Math.exp(-t))/2}var p=d(0);function m(t){return s*(h(p)*(u(e=p+1.42*t)/h(e))-u(p))/2.0164;var e}var g=Date.now(),f=(d(1)-p)/1.42,b=n.duration?1e3*n.duration:1e3*f*.8;return this._moveStart(!0,n.noMoveStart),(function n(){var o=(Date.now()-g)/b,l=function(t){return 1-Math.pow(1-t,1.5)}(o)*f;o<=1?(this._flyToFrame=O(n,this),this._move(this.unproject(i.add(a.subtract(i).multiplyBy(m(l)/c)),r),this.getScaleZoom(s/function(t){return s*(h(p)/h(p+1.42*t))}(l),r),{flyTo:!0})):this._move(t,e)._moveEnd(!0)}).call(this),this},flyToBounds:function(t,e){var n=this._getBoundsCenterZoom(t,e);return this.flyTo(n.center,n.zoom,e)},setMaxBounds:function(t){return(t=P(t)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(t){var e=this.options.minZoom;return this.options.minZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var e=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&e!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,e){this._enforcingBounds=!0;var n=this.getCenter(),i=this._limitCenter(n,this._zoom,P(t));return n.equals(i)||this.panTo(i,e),this._enforcingBounds=!1,this},panInside:function(t,e){var n=F((e=e||{}).paddingTopLeft||e.padding||[0,0]),i=F(e.paddingBottomRight||e.padding||[0,0]),a=this.getCenter(),o=this.project(a),r=this.project(t),s=this.getPixelBounds(),l=s.getSize().divideBy(2),c=R([s.min.add(n),s.max.subtract(i)]);if(!c.contains(r)){this._enforcingBounds=!0;var d=o.subtract(r),u=F(r.x+d.x,r.y+d.y);(r.x<c.min.x||r.x>c.max.x)&&(u.x=o.x-d.x,d.x>0?u.x+=l.x-n.x:u.x-=l.x-i.x),(r.y<c.min.y||r.y>c.max.y)&&(u.y=o.y-d.y,d.y>0?u.y+=l.y-n.y:u.y-=l.y-i.y),this.panTo(this.unproject(u),e),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=n({animate:!1,pan:!0},!0===t?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var i=this.getSize(),o=e.divideBy(2).round(),r=i.divideBy(2).round(),s=o.subtract(r);return s.x||s.y?(t.animate&&t.pan?this.panBy(s):(t.pan&&this._rawPanBy(s),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(a(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=n({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=a(this._handleGeolocationResponse,this),i=a(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,n=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+n+"."})},_handleGeolocationResponse:function(t){var e=new V(t.coords.latitude,t.coords.longitude),n=e.toBounds(2*t.coords.accuracy),i=this._locateOptions;if(i.setView){var a=this.getBoundsZoom(n);this.setView(e,i.maxZoom?Math.min(a,i.maxZoom):a)}var o={latlng:e,bounds:n,timestamp:t.timestamp};for(var r in t.coords)"number"==typeof t.coords[r]&&(o[r]=t.coords[r]);this.fire("locationfound",o)},addHandler:function(t,e){if(!e)return this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(e){this._container._leaflet_id=void 0,this._containerId=void 0}var t;for(t in void 0!==this._locationWatchId&&this.stopLocate(),this._stop(),se(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(_(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload"),this._layers)this._layers[t].remove();for(t in this._panes)se(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,e){var n=re("div","leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),e||this._mapPane);return t&&(this._panes[t]=n),n},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds();return new N(this.unproject(t.getBottomLeft()),this.unproject(t.getTopRight()))},getMinZoom:function(){return void 0===this.options.minZoom?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return void 0===this.options.maxZoom?void 0===this._layersMaxZoom?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,n){t=P(t),n=F(n||[0,0]);var i=this.getZoom()||0,a=this.getMinZoom(),o=this.getMaxZoom(),r=t.getNorthWest(),s=t.getSouthEast(),l=this.getSize().subtract(n),c=R(this.project(s,i),this.project(r,i)).getSize(),d=ft?this.options.zoomSnap:1,u=l.x/c.x,h=l.y/c.y,p=e?Math.max(u,h):Math.min(u,h);return i=this.getScaleZoom(p,i),d&&(i=Math.round(i/(d/100))*(d/100),i=e?Math.ceil(i/d)*d:Math.floor(i/d)*d),Math.max(a,Math.min(o,i))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new j(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,e){var n=this._getTopLeftPoint(t,e);return new M(n,n.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(void 0===t?this.getZoom():t)},getPane:function(t){return"string"==typeof t?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,e){var n=this.options.crs;return e=void 0===e?this._zoom:e,n.scale(t)/n.scale(e)},getScaleZoom:function(t,e){var n=this.options.crs;e=void 0===e?this._zoom:e;var i=n.zoom(t*n.scale(e));return isNaN(i)?1/0:i},project:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.latLngToPoint(W(t),e)},unproject:function(t,e){return e=void 0===e?this._zoom:e,this.options.crs.pointToLatLng(F(t),e)},layerPointToLatLng:function(t){var e=F(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){return this.project(W(t))._round()._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(W(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(P(t))},distance:function(t,e){return this.options.crs.distance(W(t),W(e))},containerPointToLayerPoint:function(t){return F(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return F(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(F(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(W(t)))},mouseEventToContainerPoint:function(t){return Ve(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=ae(t);if(!e)throw new Error("Map container not found.");if(e._leaflet_id)throw new Error("Map container is already initialized.");Ae(e,"scroll",this._onScroll,this),this._containerId=r(e)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&ft,he(t,"leaflet-container"+(St?" leaflet-touch":"")+(Ot?" leaflet-retina":"")+(J?" leaflet-oldie":"")+(ct?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var e=oe(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ve(this._mapPane,new j(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(he(t.markerPane,"leaflet-zoom-hide"),he(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,e){ve(this._mapPane,new j(0,0));var n=!this._loaded;this._loaded=!0,e=this._limitZoom(e),this.fire("viewprereset");var i=this._zoom!==e;this._moveStart(i,!1)._move(t,e)._moveEnd(i),this.fire("viewreset"),n&&this.fire("load")},_moveStart:function(t,e){return t&&this.fire("zoomstart"),e||this.fire("movestart"),this},_move:function(t,e,n){void 0===e&&(e=this._zoom);var i=this._zoom!==e;return this._zoom=e,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),(i||n&&n.pinch)&&this.fire("zoom",n),this.fire("move",n)},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return _(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){ve(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[r(this._container)]=this;var e=t?Ee:Ae;e(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&e(window,"resize",this._onResize,this),ft&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){_(this._resizeRequest),this._resizeRequest=O((function(){this.invalidateSize({debounceMoveend:!0})}),this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,e){for(var n,i=[],a="mouseout"===e||"mouseover"===e,o=t.target||t.srcElement,s=!1;o;){if((n=this._targets[r(o)])&&("click"===e||"preclick"===e)&&!t._simulated&&this._draggableMoved(n)){s=!0;break}if(n&&n.listens(e,!0)){if(a&&!Ke(o,t))break;if(i.push(n),a)break}if(o===this._container)break;o=o.parentNode}return i.length||s||a||!Ke(o,t)||(i=[this]),i},_handleDOMEvent:function(t){if(this._loaded&&!He(t)){var e=t.type;"mousedown"!==e&&"keypress"!==e&&"keyup"!==e&&"keydown"!==e||Te(t.target||t.srcElement),this._fireDOMEvent(t,e)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,e,i){if("click"===t.type){var a=n({},t);a.type="preclick",this._fireDOMEvent(a,a.type,i)}if(!t._stopped&&(i=(i||[]).concat(this._findEventTargets(t,e))).length){var o=i[0];"contextmenu"===e&&o.listens(e,!0)&&Ne(t);var r={originalEvent:t};if("keypress"!==t.type&&"keydown"!==t.type&&"keyup"!==t.type){var s=o.getLatLng&&(!o._radius||o._radius<=10);r.containerPoint=s?this.latLngToContainerPoint(o.getLatLng()):this.mouseEventToContainerPoint(t),r.layerPoint=this.containerPointToLayerPoint(r.containerPoint),r.latlng=s?o.getLatLng():this.layerPointToLatLng(r.layerPoint)}for(var l=0;l<i.length;l++)if(i[l].fire(e,r,!0),r.originalEvent._stopped||!1===i[l].options.bubblingMouseEvents&&-1!==y(this._mouseEvents,e))return}},_draggableMoved:function(t){return(t=t.dragging&&t.dragging.enabled()?t:this).dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,e=this._handlers.length;t<e;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,{target:this}):this.on("load",t,e),this},_getMapPanePos:function(){return we(this._mapPane)||new j(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,e){return(t&&void 0!==e?this._getNewPixelOrigin(t,e):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,e){var n=this.getSize()._divideBy(2);return this.project(t,e)._subtract(n)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,e,n){var i=this._getNewPixelOrigin(n,e);return this.project(t,e)._subtract(i)},_latLngBoundsToNewLayerBounds:function(t,e,n){var i=this._getNewPixelOrigin(n,e);return R([this.project(t.getSouthWest(),e)._subtract(i),this.project(t.getNorthWest(),e)._subtract(i),this.project(t.getSouthEast(),e)._subtract(i),this.project(t.getNorthEast(),e)._subtract(i)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,n){if(!n)return t;var i=this.project(t,e),a=this.getSize().divideBy(2),o=new M(i.subtract(a),i.add(a)),r=this._getBoundsOffset(o,n,e);return r.round().equals([0,0])?t:this.unproject(i.add(r),e)},_limitOffset:function(t,e){if(!e)return t;var n=this.getPixelBounds(),i=new M(n.min.add(t),n.max.add(t));return t.add(this._getBoundsOffset(i,e))},_getBoundsOffset:function(t,e,n){var i=R(this.project(e.getNorthEast(),n),this.project(e.getSouthWest(),n)),a=i.min.subtract(t.min),o=i.max.subtract(t.max);return new j(this._rebound(a.x,-o.x),this._rebound(a.y,-o.y))},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),n=this.getMaxZoom(),i=ft?this.options.zoomSnap:1;return i&&(t=Math.round(t/i)*i),Math.max(e,Math.min(n,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){pe(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var n=this._getCenterOffset(t)._trunc();return!(!0!==(e&&e.animate)&&!this.getSize().contains(n)||(this.panBy(n,e),0))},_createAnimProxy:function(){var t=this._proxy=re("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",(function(t){var e=ee,n=this._proxy.style[e];ye(this._proxy,this.project(t.center,t.zoom),this.getZoomScale(t.zoom,1)),n===this._proxy.style[e]&&this._animatingZoom&&this._onZoomTransitionEnd()}),this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){se(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),e=this.getZoom();ye(this._proxy,this.project(t,e),this.getZoomScale(e,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||!1===n.animate||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(e),a=this._getCenterOffset(t)._divideBy(1-1/i);return!(!0!==n.animate&&!this.getSize().contains(a)||(O((function(){this._moveStart(!0,!1)._animateZoom(t,e,!0)}),this),0))},_animateZoom:function(t,e,n,i){this._mapPane&&(n&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=e,he(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:e,noUpdate:i}),setTimeout(a(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&pe(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),O((function(){this._moveEnd(!0)}),this))}}),$e=A.extend({options:{position:"topright"},initialize:function(t){p(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),n=this.getPosition(),i=t._controlCorners[n];return he(e,"leaflet-control"),-1!==n.indexOf("bottom")?i.insertBefore(e,i.firstChild):i.appendChild(e),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(se(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),Xe=function(t){return new $e(t)};qe.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",n=this._controlContainer=re("div",e+"control-container",this._container);function i(i,a){var o=e+i+" "+e+a;t[i+a]=re("div",o,n)}i("top","left"),i("top","right"),i("bottom","left"),i("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)se(this._controlCorners[t]);se(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Qe=$e.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,e,n,i){return n<i?-1:i<n?1:0}},initialize:function(t,e,n){for(var i in p(this,n),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,t)this._addLayer(t[i],i);for(i in e)this._addLayer(e[i],i,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var e=0;e<this._layers.length;e++)this._layers[e].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return $e.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._map?this._update():this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var e=this._getLayer(r(t));return e&&this._layers.splice(this._layers.indexOf(e),1),this._map?this._update():this},expand:function(){he(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(he(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):pe(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return pe(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=re("div",t),n=this.options.collapsed;e.setAttribute("aria-haspopup",!0),Re(e),Me(e);var i=this._section=re("section",t+"-list");n&&(this._map.on("click",this.collapse,this),nt||Ae(e,{mouseenter:this.expand,mouseleave:this.collapse},this));var a=this._layersLink=re("a",t+"-toggle",e);a.href="#",a.title="Layers",St?(Ae(a,"click",Pe),Ae(a,"click",this.expand,this)):Ae(a,"focus",this.expand,this),n||this.expand(),this._baseLayersList=re("div",t+"-base",i),this._separator=re("div",t+"-separator",i),this._overlaysList=re("div",t+"-overlays",i),e.appendChild(i)},_getLayer:function(t){for(var e=0;e<this._layers.length;e++)if(this._layers[e]&&r(this._layers[e].layer)===t)return this._layers[e]},_addLayer:function(t,e,n){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:e,overlay:n}),this.options.sortLayers&&this._layers.sort(a((function(t,e){return this.options.sortFunction(t.layer,e.layer,t.name,e.name)}),this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;le(this._baseLayersList),le(this._overlaysList),this._layerControlInputs=[];var t,e,n,i,a=0;for(n=0;n<this._layers.length;n++)i=this._layers[n],this._addItem(i),e=e||i.overlay,t=t||!i.overlay,a+=i.overlay?0:1;return this.options.hideSingleBase&&(t=t&&a>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=e&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var e=this._getLayer(r(t.target)),n=e.overlay?"add"===t.type?"overlayadd":"overlayremove":"add"===t.type?"baselayerchange":null;n&&this._map.fire(n,e)},_createRadioElement:function(t,e){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(e?' checked="checked"':"")+"/>",i=document.createElement("div");return i.innerHTML=n,i.firstChild},_addItem:function(t){var e,n=document.createElement("label"),i=this._map.hasLayer(t.layer);t.overlay?((e=document.createElement("input")).type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=i):e=this._createRadioElement("leaflet-base-layers_"+r(this),i),this._layerControlInputs.push(e),e.layerId=r(t.layer),Ae(e,"click",this._onInputClick,this);var a=document.createElement("span");a.innerHTML=" "+t.name;var o=document.createElement("div");return n.appendChild(o),o.appendChild(e),o.appendChild(a),(t.overlay?this._overlaysList:this._baseLayersList).appendChild(n),this._checkDisabledLayers(),n},_onInputClick:function(){var t,e,n=this._layerControlInputs,i=[],a=[];this._handlingClick=!0;for(var o=n.length-1;o>=0;o--)t=n[o],e=this._getLayer(t.layerId).layer,t.checked?i.push(e):t.checked||a.push(e);for(o=0;o<a.length;o++)this._map.hasLayer(a[o])&&this._map.removeLayer(a[o]);for(o=0;o<i.length;o++)this._map.hasLayer(i[o])||this._map.addLayer(i[o]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t,e,n=this._layerControlInputs,i=this._map.getZoom(),a=n.length-1;a>=0;a--)t=n[a],e=this._getLayer(t.layerId).layer,t.disabled=void 0!==e.options.minZoom&&i<e.options.minZoom||void 0!==e.options.maxZoom&&i>e.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),Je=$e.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",n=re("div",e+" leaflet-bar"),i=this.options;return this._zoomInButton=this._createButton(i.zoomInText,i.zoomInTitle,e+"-in",n,this._zoomIn),this._zoomOutButton=this._createButton(i.zoomOutText,i.zoomOutTitle,e+"-out",n,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,e,n,i,a){var o=re("a",n,i);return o.innerHTML=t,o.href="#",o.title=e,o.setAttribute("role","button"),o.setAttribute("aria-label",e),Re(o),Ae(o,"click",Pe),Ae(o,"click",a,this),Ae(o,"click",this._refocusOnMap,this),o},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";pe(this._zoomInButton,e),pe(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMinZoom())&&he(this._zoomOutButton,e),(this._disabled||t._zoom===t.getMaxZoom())&&he(this._zoomInButton,e)}});qe.mergeOptions({zoomControl:!0}),qe.addInitHook((function(){this.options.zoomControl&&(this.zoomControl=new Je,this.addControl(this.zoomControl))}));var tn=$e.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var e=re("div","leaflet-control-scale"),n=this.options;return this._addScales(n,"leaflet-control-scale-line",e),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),e},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,n){t.metric&&(this._mScale=re("div",e,n)),t.imperial&&(this._iScale=re("div",e,n))},_update:function(){var t=this._map,e=t.getSize().y/2,n=t.distance(t.containerPointToLatLng([0,e]),t.containerPointToLatLng([this.options.maxWidth,e]));this._updateScales(n)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var e=this._getRoundNum(t),n=e<1e3?e+" m":e/1e3+" km";this._updateScale(this._mScale,n,e/t)},_updateImperial:function(t){var e,n,i,a=3.2808399*t;a>5280?(e=a/5280,n=this._getRoundNum(e),this._updateScale(this._iScale,n+" mi",n/e)):(i=this._getRoundNum(a),this._updateScale(this._iScale,i+" ft",i/a))},_updateScale:function(t,e,n){t.style.width=Math.round(this.options.maxWidth*n)+"px",t.innerHTML=e},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return e*(n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1)}}),en=$e.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){p(this,t),this._attributions={}},onAdd:function(t){for(var e in t.attributionControl=this,this._container=re("div","leaflet-control-attribution"),Re(this._container),t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return this._update(),this._container},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var n=[];this.options.prefix&&n.push(this.options.prefix),t.length&&n.push(t.join(", ")),this._container.innerHTML=n.join(" | ")}}});qe.mergeOptions({attributionControl:!0}),qe.addInitHook((function(){this.options.attributionControl&&(new en).addTo(this)})),$e.Layers=Qe,$e.Zoom=Je,$e.Scale=tn,$e.Attribution=en,Xe.layers=function(t,e,n){return new Qe(t,e,n)},Xe.zoom=function(t){return new Je(t)},Xe.scale=function(t){return new tn(t)},Xe.attribution=function(t){return new en(t)};var nn=A.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled||(this._enabled=!0,this.addHooks()),this},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});nn.addTo=function(t,e){return t.addHandler(e,this),this};var an,on={Events:k},rn=St?"touchstart mousedown":"mousedown",sn={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},ln={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},cn=E.extend({options:{clickTolerance:3},initialize:function(t,e,n,i){p(this,i),this._element=t,this._dragStartTarget=e||t,this._preventOutline=n},enable:function(){this._enabled||(Ae(this._dragStartTarget,rn,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(cn._dragging===this&&this.finishDrag(),Ee(this._dragStartTarget,rn,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(!t._simulated&&this._enabled&&(this._moved=!1,!ue(this._element,"leaflet-zoom-anim")&&!(cn._dragging||t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(cn._dragging=this,this._preventOutline&&Te(this._element),Se(),$t(),this._moving)))){this.fire("down");var e=t.touches?t.touches[0]:t,n=_e(this._element);this._startPoint=new j(e.clientX,e.clientY),this._parentScale=Le(n),Ae(document,ln[t.type],this._onMove,this),Ae(document,sn[t.type],this._onUp,this)}},_onMove:function(t){if(!t._simulated&&this._enabled)if(t.touches&&t.touches.length>1)this._moved=!0;else{var e=t.touches&&1===t.touches.length?t.touches[0]:t,n=new j(e.clientX,e.clientY)._subtract(this._startPoint);(n.x||n.y)&&(Math.abs(n.x)+Math.abs(n.y)<this.options.clickTolerance||(n.x/=this._parentScale.x,n.y/=this._parentScale.y,Ne(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=we(this._element).subtract(n),he(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),he(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(n),this._moving=!0,_(this._animRequest),this._lastEvent=t,this._animRequest=O(this._updatePosition,this,!0)))}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),ve(this._element,this._newPos),this.fire("drag",t)},_onUp:function(t){!t._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){for(var t in pe(document.body,"leaflet-dragging"),this._lastTarget&&(pe(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),ln)Ee(document,ln[t],this._onMove,this),Ee(document,sn[t],this._onUp,this);Ce(),Xt(),this._moved&&this._moving&&(_(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,cn._dragging=!1}});function dn(t,e){if(!e||!t.length)return t.slice();var n=e*e;return t=function(t,e){var n=t.length,i=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(n);i[0]=i[n-1]=1,function t(e,n,i,a,o){var r,s,l,c=0;for(s=a+1;s<=o-1;s++)(l=gn(e[s],e[a],e[o],!0))>c&&(r=s,c=l);c>i&&(n[r]=1,t(e,n,i,a,r),t(e,n,i,r,o))}(t,i,e,0,n-1);var a,o=[];for(a=0;a<n;a++)i[a]&&o.push(t[a]);return o}(t=function(t,e){for(var n=[t[0]],i=1,a=0,o=t.length;i<o;i++)r=t[i],s=t[a],l=void 0,c=void 0,l=s.x-r.x,c=s.y-r.y,l*l+c*c>e&&(n.push(t[i]),a=i);var r,s,l,c;return a<o-1&&n.push(t[o-1]),n}(t,n),n)}function un(t,e,n){return Math.sqrt(gn(t,e,n,!0))}function hn(t,e,n,i,a){var o,r,s,l=i?an:mn(t,n),c=mn(e,n);for(an=c;;){if(!(l|c))return[t,e];if(l&c)return!1;s=mn(r=pn(t,e,o=l||c,n,a),n),o===l?(t=r,l=s):(e=r,c=s)}}function pn(t,e,n,i,a){var o,r,s=e.x-t.x,l=e.y-t.y,c=i.min,d=i.max;return 8&n?(o=t.x+s*(d.y-t.y)/l,r=d.y):4&n?(o=t.x+s*(c.y-t.y)/l,r=c.y):2&n?(o=d.x,r=t.y+l*(d.x-t.x)/s):1&n&&(o=c.x,r=t.y+l*(c.x-t.x)/s),new j(o,r,a)}function mn(t,e){var n=0;return t.x<e.min.x?n|=1:t.x>e.max.x&&(n|=2),t.y<e.min.y?n|=4:t.y>e.max.y&&(n|=8),n}function gn(t,e,n,i){var a,o=e.x,r=e.y,s=n.x-o,l=n.y-r,c=s*s+l*l;return c>0&&((a=((t.x-o)*s+(t.y-r)*l)/c)>1?(o=n.x,r=n.y):a>0&&(o+=s*a,r+=l*a)),s=t.x-o,l=t.y-r,i?s*s+l*l:new j(o,r)}function fn(t){return!b(t[0])||"object"!=typeof t[0][0]&&void 0!==t[0][0]}function bn(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),fn(t)}var yn=(Object.freeze||Object)({simplify:dn,pointToSegmentDistance:un,closestPointOnSegment:function(t,e,n){return gn(t,e,n)},clipSegment:hn,_getEdgeIntersection:pn,_getBitCode:mn,_sqClosestPointOnSegment:gn,isFlat:fn,_flat:bn});function vn(t,e,n){var i,a,o,r,s,l,c,d,u,h=[1,4,2,8];for(a=0,c=t.length;a<c;a++)t[a]._code=mn(t[a],e);for(r=0;r<4;r++){for(d=h[r],i=[],a=0,o=(c=t.length)-1;a<c;o=a++)s=t[a],l=t[o],s._code&d?l._code&d||((u=pn(l,s,d,e,n))._code=mn(u,e),i.push(u)):(l._code&d&&((u=pn(l,s,d,e,n))._code=mn(u,e),i.push(u)),i.push(s));t=i}return t}var wn=(Object.freeze||Object)({clipPolygon:vn}),xn={project:function(t){return new j(t.lng,t.lat)},unproject:function(t){return new V(t.y,t.x)},bounds:new M([-180,-90],[180,90])},Sn={R:6378137,R_MINOR:6356752.314245179,bounds:new M([-20037508.34279,-15496570.73972],[20037508.34279,18764656.23138]),project:function(t){var e=Math.PI/180,n=this.R,i=t.lat*e,a=this.R_MINOR/n,o=Math.sqrt(1-a*a),r=o*Math.sin(i),s=Math.tan(Math.PI/4-i/2)/Math.pow((1-r)/(1+r),o/2);return i=-n*Math.log(Math.max(s,1e-10)),new j(t.lng*e*n,i)},unproject:function(t){for(var e,n=180/Math.PI,i=this.R,a=this.R_MINOR/i,o=Math.sqrt(1-a*a),r=Math.exp(-t.y/i),s=Math.PI/2-2*Math.atan(r),l=0,c=.1;l<15&&Math.abs(c)>1e-7;l++)e=o*Math.sin(s),e=Math.pow((1-e)/(1+e),o/2),s+=c=Math.PI/2-2*Math.atan(r*e)-s;return new V(s*n,t.x*n/i)}},Cn=(Object.freeze||Object)({LonLat:xn,Mercator:Sn,SphericalMercator:G}),Tn=n({},U,{code:"EPSG:3395",projection:Sn,transformation:function(){var t=.5/(Math.PI*Sn.R);return K(t,.5,-t,.5)}()}),On=n({},U,{code:"EPSG:4326",projection:xn,transformation:K(1/180,1,-1/180,.5)}),_n=n({},B,{projection:xn,transformation:K(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,e){var n=e.lng-t.lng,i=e.lat-t.lat;return Math.sqrt(n*n+i*i)},infinite:!0});B.Earth=U,B.EPSG3395=Tn,B.EPSG3857=Y,B.EPSG900913=Z,B.EPSG4326=On,B.Simple=_n;var Ln=E.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[r(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[r(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var e=t.target;if(e.hasLayer(this)){if(this._map=e,this._zoomAnimated=e._zoomAnimated,this.getEvents){var n=this.getEvents();e.on(n,this),this.once("remove",(function(){e.off(n,this)}),this)}this.onAdd(e),this.getAttribution&&e.attributionControl&&e.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),e.fire("layeradd",{layer:this})}}});qe.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var e=r(t);return this._layers[e]||(this._layers[e]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t)),this},removeLayer:function(t){var e=r(t);return this._layers[e]?(this._loaded&&t.onRemove(this),t.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(t.getAttribution()),delete this._layers[e],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return!!t&&r(t)in this._layers},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},_addLayers:function(t){for(var e=0,n=(t=t?b(t)?t:[t]:[]).length;e<n;e++)this.addLayer(t[e])},_addZoomLimit:function(t){!isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[r(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var e=r(t);this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,e=-1/0,n=this._getZoomSpan();for(var i in this._zoomBoundLayers){var a=this._zoomBoundLayers[i].options;t=void 0===a.minZoom?t:Math.min(t,a.minZoom),e=void 0===a.maxZoom?e:Math.max(e,a.maxZoom)}this._layersMaxZoom=e===-1/0?void 0:e,this._layersMinZoom=t===1/0?void 0:t,n!==this._getZoomSpan()&&this.fire("zoomlevelschange"),void 0===this.options.maxZoom&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),void 0===this.options.minZoom&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var In=Ln.extend({initialize:function(t,e){var n,i;if(p(this,e),this._layers={},t)for(n=0,i=t.length;n<i;n++)this.addLayer(t[n])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return!!t&&(t in this._layers||this.getLayerId(t)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var e,n,i=Array.prototype.slice.call(arguments,1);for(e in this._layers)(n=this._layers[e])[t]&&n[t].apply(n,i);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return r(t)}}),An=In.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),In.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),In.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new N;for(var e in this._layers){var n=this._layers[e];t.extend(n.getBounds?n.getBounds():n.getLatLng())}return t}}),kn=A.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(t){p(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var n=this._getIconUrl(t);if(!n){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i=this._createImg(n,e&&"IMG"===e.tagName?e:null);return this._setIconStyles(i,t),i},_setIconStyles:function(t,e){var n=this.options,i=n[e+"Size"];"number"==typeof i&&(i=[i,i]);var a=F(i),o=F("shadow"===e&&n.shadowAnchor||n.iconAnchor||a&&a.divideBy(2,!0));t.className="leaflet-marker-"+e+" "+(n.className||""),o&&(t.style.marginLeft=-o.x+"px",t.style.marginTop=-o.y+"px"),a&&(t.style.width=a.x+"px",t.style.height=a.y+"px")},_createImg:function(t,e){return(e=e||document.createElement("img")).src=t,e},_getIconUrl:function(t){return Ot&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}}),En=kn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return En.imagePath||(En.imagePath=this._detectIconPath()),(this.options.imagePath||En.imagePath)+kn.prototype._getIconUrl.call(this,t)},_detectIconPath:function(){var t=re("div","leaflet-default-icon-path",document.body),e=oe(t,"background-image")||oe(t,"backgroundImage");return document.body.removeChild(t),e=null===e||0!==e.indexOf("url")?"":e.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),jn=nn.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new cn(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),he(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&pe(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var e=this._marker,n=e._map,i=this._marker.options.autoPanSpeed,a=this._marker.options.autoPanPadding,o=we(e._icon),r=n.getPixelBounds(),s=n.getPixelOrigin(),l=R(r.min._subtract(s).add(a),r.max._subtract(s).subtract(a));if(!l.contains(o)){var c=F((Math.max(l.max.x,o.x)-l.max.x)/(r.max.x-l.max.x)-(Math.min(l.min.x,o.x)-l.min.x)/(r.min.x-l.min.x),(Math.max(l.max.y,o.y)-l.max.y)/(r.max.y-l.max.y)-(Math.min(l.min.y,o.y)-l.min.y)/(r.min.y-l.min.y)).multiplyBy(i);n.panBy(c,{animate:!1}),this._draggable._newPos._add(c),this._draggable._startPos._add(c),ve(e._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=O(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(_(this._panRequest),this._panRequest=O(this._adjustPan.bind(this,t)))},_onDrag:function(t){var e=this._marker,n=e._shadow,i=we(e._icon),a=e._map.layerPointToLatLng(i);n&&ve(n,i),e._latlng=a,t.latlng=a,t.oldLatLng=this._oldLatLng,e.fire("move",t).fire("drag",t)},_onDragEnd:function(t){_(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Dn=Ln.extend({options:{icon:new En,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,e){p(this,e),this._latlng=W(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var e=this._latlng;return this._latlng=W(t),this.update(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),n=t.icon.createIcon(this._icon),i=!1;n!==this._icon&&(this._icon&&this._removeIcon(),i=!0,t.title&&(n.title=t.title),"IMG"===n.tagName&&(n.alt=t.alt||"")),he(n,e),t.keyboard&&(n.tabIndex="0"),this._icon=n,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var a=t.icon.createShadow(this._shadow),o=!1;a!==this._shadow&&(this._removeShadow(),o=!0),a&&(he(a,e),a.alt=""),this._shadow=a,t.opacity<1&&this._updateOpacity(),i&&this.getPane().appendChild(this._icon),this._initInteraction(),a&&o&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),se(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&se(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&ve(this._icon,t),this._shadow&&ve(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.interactive&&(he(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),jn)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new jn(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&fe(this._icon,t),this._shadow&&fe(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}}),Fn=Ln.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return p(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&t.hasOwnProperty("weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),Mn=Fn.extend({options:{fill:!0,radius:10},initialize:function(t,e){p(this,e),this._latlng=W(t),this._radius=this.options.radius},setLatLng:function(t){var e=this._latlng;return this._latlng=W(t),this.redraw(),this.fire("move",{oldLatLng:e,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var e=t&&t.radius||this._radius;return Fn.prototype.setStyle.call(this,t),this.setRadius(e),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,e=this._radiusY||t,n=this._clickTolerance(),i=[t+n,e+n];this._pxBounds=new M(this._point.subtract(i),this._point.add(i))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),Rn=Mn.extend({initialize:function(t,e,i){if("number"==typeof e&&(e=n({},i,{radius:e})),p(this,e),this._latlng=W(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new N(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Fn.prototype.setStyle,_project:function(){var t=this._latlng.lng,e=this._latlng.lat,n=this._map,i=n.options.crs;if(i.distance===U.distance){var a=Math.PI/180,o=this._mRadius/U.R/a,r=n.project([e+o,t]),s=n.project([e-o,t]),l=r.add(s).divideBy(2),c=n.unproject(l).lat,d=Math.acos((Math.cos(o*a)-Math.sin(e*a)*Math.sin(c*a))/(Math.cos(e*a)*Math.cos(c*a)))/a;(isNaN(d)||0===d)&&(d=o/Math.cos(Math.PI/180*e)),this._point=l.subtract(n.getPixelOrigin()),this._radius=isNaN(d)?0:l.x-n.project([c,t-d]).x,this._radiusY=l.y-r.y}else{var u=i.unproject(i.project(this._latlng).subtract([this._mRadius,0]));this._point=n.latLngToLayerPoint(this._latlng),this._radius=this._point.x-n.latLngToLayerPoint(u).x}this._updateBounds()}}),Nn=Fn.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,e){p(this,e),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var e,n,i=1/0,a=null,o=gn,r=0,s=this._parts.length;r<s;r++)for(var l=this._parts[r],c=1,d=l.length;c<d;c++){var u=o(t,e=l[c-1],n=l[c],!0);u<i&&(i=u,a=o(t,e,n))}return a&&(a.distance=Math.sqrt(i)),a},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,n,i,a,o,r,s=this._rings[0],l=s.length;if(!l)return null;for(t=0,e=0;t<l-1;t++)e+=s[t].distanceTo(s[t+1])/2;if(0===e)return this._map.layerPointToLatLng(s[0]);for(t=0,i=0;t<l-1;t++)if(a=s[t],o=s[t+1],(i+=n=a.distanceTo(o))>e)return r=(i-e)/n,this._map.layerPointToLatLng([o.x-r*(o.x-a.x),o.y-r*(o.y-a.y)])},getBounds:function(){return this._bounds},addLatLng:function(t,e){return e=e||this._defaultShape(),t=W(t),e.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new N,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return fn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var e=[],n=fn(t),i=0,a=t.length;i<a;i++)n?(e[i]=W(t[i]),this._bounds.extend(e[i])):e[i]=this._convertLatLngs(t[i]);return e},_project:function(){var t=new M;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),e=new j(t,t);this._pxBounds=new M([this._rawPxBounds.min.subtract(e),this._rawPxBounds.max.add(e)])},_projectLatlngs:function(t,e,n){var i,a,o=t[0]instanceof V,r=t.length;if(o){for(a=[],i=0;i<r;i++)a[i]=this._map.latLngToLayerPoint(t[i]),n.extend(a[i]);e.push(a)}else for(i=0;i<r;i++)this._projectLatlngs(t[i],e,n)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else{var e,n,i,a,o,r,s,l=this._parts;for(e=0,i=0,a=this._rings.length;e<a;e++)for(n=0,o=(s=this._rings[e]).length;n<o-1;n++)(r=hn(s[n],s[n+1],t,n,!0))&&(l[i]=l[i]||[],l[i].push(r[0]),r[1]===s[n+1]&&n!==o-2||(l[i].push(r[1]),i++))}},_simplifyPoints:function(){for(var t=this._parts,e=this.options.smoothFactor,n=0,i=t.length;n<i;n++)t[n]=dn(t[n],e)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,e){var n,i,a,o,r,s,l=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(n=0,o=this._parts.length;n<o;n++)for(i=0,a=(r=(s=this._parts[n]).length)-1;i<r;a=i++)if((e||0!==i)&&un(t,s[a],s[i])<=l)return!0;return!1}});Nn._flat=bn;var Pn=Nn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var t,e,n,i,a,o,r,s,l,c=this._rings[0],d=c.length;if(!d)return null;for(o=r=s=0,t=0,e=d-1;t<d;e=t++)n=c[t],i=c[e],a=n.y*i.x-i.y*n.x,r+=(n.x+i.x)*a,s+=(n.y+i.y)*a,o+=3*a;return l=0===o?c[0]:[r/o,s/o],this._map.layerPointToLatLng(l)},_convertLatLngs:function(t){var e=Nn.prototype._convertLatLngs.call(this,t),n=e.length;return n>=2&&e[0]instanceof V&&e[0].equals(e[n-1])&&e.pop(),e},_setLatLngs:function(t){Nn.prototype._setLatLngs.call(this,t),fn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return fn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,e=this.options.weight,n=new j(e,e);if(t=new M(t.min.subtract(n),t.max.add(n)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(t))if(this.options.noClip)this._parts=this._rings;else for(var i,a=0,o=this._rings.length;a<o;a++)(i=vn(this._rings[a],t,!0)).length&&this._parts.push(i)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var e,n,i,a,o,r,s,l,c=!1;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(a=0,s=this._parts.length;a<s;a++)for(o=0,r=(l=(e=this._parts[a]).length)-1;o<l;r=o++)n=e[o],i=e[r],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(c=!c);return c||Nn.prototype._containsPoint.call(this,t,!0)}}),Vn=An.extend({initialize:function(t,e){p(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,n,i,a=b(t)?t:t.features;if(a){for(e=0,n=a.length;e<n;e++)((i=a[e]).geometries||i.geometry||i.features||i.coordinates)&&this.addData(i);return this}var o=this.options;if(o.filter&&!o.filter(t))return this;var r=Wn(t,o);return r?(r.feature=Yn(t),r.defaultOptions=r.options,this.resetStyle(r),o.onEachFeature&&o.onEachFeature(t,r),this.addLayer(r)):this},resetStyle:function(t){return void 0===t?this.eachLayer(this.resetStyle,this):(t.options=n({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer((function(e){this._setLayerStyle(e,t)}),this)},_setLayerStyle:function(t,e){t.setStyle&&("function"==typeof e&&(e=e(t.feature)),t.setStyle(e))}});function Wn(t,e){var n,i,a,o,r="Feature"===t.type?t.geometry:t,s=r?r.coordinates:null,l=[],c=e&&e.pointToLayer,d=e&&e.coordsToLatLng||Bn;if(!s&&!r)return null;switch(r.type){case"Point":return zn(c,t,n=d(s),e);case"MultiPoint":for(a=0,o=s.length;a<o;a++)n=d(s[a]),l.push(zn(c,t,n,e));return new An(l);case"LineString":case"MultiLineString":return i=Un(s,"LineString"===r.type?0:1,d),new Nn(i,e);case"Polygon":case"MultiPolygon":return i=Un(s,"Polygon"===r.type?1:2,d),new Pn(i,e);case"GeometryCollection":for(a=0,o=r.geometries.length;a<o;a++){var u=Wn({geometry:r.geometries[a],type:"Feature",properties:t.properties},e);u&&l.push(u)}return new An(l);default:throw new Error("Invalid GeoJSON object.")}}function zn(t,e,n,i){return t?t(e,n):new Dn(n,i&&i.markersInheritOptions&&i)}function Bn(t){return new V(t[1],t[0],t[2])}function Un(t,e,n){for(var i,a=[],o=0,r=t.length;o<r;o++)i=e?Un(t[o],e-1,n):(n||Bn)(t[o]),a.push(i);return a}function Gn(t,e){return e="number"==typeof e?e:6,void 0!==t.alt?[d(t.lng,e),d(t.lat,e),d(t.alt,e)]:[d(t.lng,e),d(t.lat,e)]}function Hn(t,e,n,i){for(var a=[],o=0,r=t.length;o<r;o++)a.push(e?Hn(t[o],e-1,n,i):Gn(t[o],i));return!e&&n&&a.push(a[0]),a}function Kn(t,e){return t.feature?n({},t.feature,{geometry:e}):Yn(e)}function Yn(t){return"Feature"===t.type||"FeatureCollection"===t.type?t:{type:"Feature",properties:{},geometry:t}}var Zn={toGeoJSON:function(t){return Kn(this,{type:"Point",coordinates:Gn(this.getLatLng(),t)})}};function qn(t,e){return new Vn(t,e)}Dn.include(Zn),Rn.include(Zn),Mn.include(Zn),Nn.include({toGeoJSON:function(t){var e=!fn(this._latlngs);return Kn(this,{type:(e?"Multi":"")+"LineString",coordinates:Hn(this._latlngs,e?1:0,!1,t)})}}),Pn.include({toGeoJSON:function(t){var e=!fn(this._latlngs),n=e&&!fn(this._latlngs[0]),i=Hn(this._latlngs,n?2:e?1:0,!0,t);return e||(i=[i]),Kn(this,{type:(n?"Multi":"")+"Polygon",coordinates:i})}}),In.include({toMultiPoint:function(t){var e=[];return this.eachLayer((function(n){e.push(n.toGeoJSON(t).geometry.coordinates)})),Kn(this,{type:"MultiPoint",coordinates:e})},toGeoJSON:function(t){var e=this.feature&&this.feature.geometry&&this.feature.geometry.type;if("MultiPoint"===e)return this.toMultiPoint(t);var n="GeometryCollection"===e,i=[];return this.eachLayer((function(e){if(e.toGeoJSON){var a=e.toGeoJSON(t);if(n)i.push(a.geometry);else{var o=Yn(a);"FeatureCollection"===o.type?i.push.apply(i,o.features):i.push(o)}}})),n?Kn(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}});var $n=qn,Xn=Ln.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,e,n){this._url=t,this._bounds=P(e),p(this,n)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(he(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){se(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&ce(this._image),this},bringToBack:function(){return this._map&&de(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=P(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t="IMG"===this._url.tagName,e=this._image=t?this._url:re("img");he(e,"leaflet-image-layer"),this._zoomAnimated&&he(e,"leaflet-zoom-animated"),this.options.className&&he(e,this.options.className),e.onselectstart=c,e.onmousemove=c,e.onload=a(this.fire,this,"load"),e.onerror=a(this._overlayOnError,this,"error"),(this.options.crossOrigin||""===this.options.crossOrigin)&&(e.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t?this._url=e.src:(e.src=this._url,e.alt=this.options.alt)},_animateZoom:function(t){var e=this._map.getZoomScale(t.zoom),n=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;ye(this._image,n,e)},_reset:function(){var t=this._image,e=new M(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),n=e.getSize();ve(t,e.min),t.style.width=n.x+"px",t.style.height=n.y+"px"},_updateOpacity:function(){fe(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)}}),Qn=Xn.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0},_initImage:function(){var t="VIDEO"===this._url.tagName,e=this._image=t?this._url:re("video");if(he(e,"leaflet-image-layer"),this._zoomAnimated&&he(e,"leaflet-zoom-animated"),this.options.className&&he(e,this.options.className),e.onselectstart=c,e.onmousemove=c,e.onloadeddata=a(this.fire,this,"load"),t){for(var n=e.getElementsByTagName("source"),i=[],o=0;o<n.length;o++)i.push(n[o].src);this._url=n.length>0?i:[e.src]}else{b(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&e.style.hasOwnProperty("objectFit")&&(e.style.objectFit="fill"),e.autoplay=!!this.options.autoplay,e.loop=!!this.options.loop;for(var r=0;r<this._url.length;r++){var s=re("source");s.src=this._url[r],e.appendChild(s)}}}}),Jn=Xn.extend({_initImage:function(){var t=this._image=this._url;he(t,"leaflet-image-layer"),this._zoomAnimated&&he(t,"leaflet-zoom-animated"),this.options.className&&he(t,this.options.className),t.onselectstart=c,t.onmousemove=c}}),ti=Ln.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(t,e){p(this,t),this._source=e},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&fe(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&fe(this._container,1),this.bringToFront()},onRemove:function(t){t._fadeAnimated?(fe(this._container,0),this._removeTimeout=setTimeout(a(se,void 0,this._container),200)):se(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=W(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ce(this._container),this},bringToBack:function(){return this._map&&de(this._container),this},_prepareOpen:function(t,e,n){if(e instanceof Ln||(n=e,e=t),e instanceof An)for(var i in t._layers){e=t._layers[i];break}if(!n)if(e.getCenter)n=e.getCenter();else{if(!e.getLatLng)throw new Error("Unable to get source layer LatLng.");n=e.getLatLng()}return this._source=e,this.update(),n},_updateContent:function(){if(this._content){var t=this._contentNode,e="function"==typeof this._content?this._content(this._source||this):this._content;if("string"==typeof e)t.innerHTML=e;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(e)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=F(this.options.offset),n=this._getAnchor();this._zoomAnimated?ve(this._container,t.add(n)):e=e.add(t).add(n);var i=this._containerBottom=-e.y,a=this._containerLeft=-Math.round(this._containerWidth/2)+e.x;this._container.style.bottom=i+"px",this._container.style.left=a+"px"}},_getAnchor:function(){return[0,0]}}),ei=ti.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t.openPopup(this),this},onAdd:function(t){ti.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Fn||this._source.on("preclick",Fe))},onRemove:function(t){ti.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Fn||this._source.off("preclick",Fe))},getEvents:function(){var t=ti.prototype.getEvents.call(this);return(void 0!==this.options.closeOnClick?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t="leaflet-popup",e=this._container=re("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),n=this._wrapper=re("div",t+"-content-wrapper",e);if(this._contentNode=re("div",t+"-content",n),Re(n),Me(this._contentNode),Ae(n,"contextmenu",Fe),this._tipContainer=re("div",t+"-tip-container",e),this._tip=re("div",t+"-tip",this._tipContainer),this.options.closeButton){var i=this._closeButton=re("a",t+"-close-button",e);i.href="#close",i.innerHTML="&#215;",Ae(i,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var n=t.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),e.width=n+1+"px",e.whiteSpace="",e.height="";var i=t.offsetHeight,a=this.options.maxHeight;a&&i>a?(e.height=a+"px",he(t,"leaflet-popup-scrolled")):pe(t,"leaflet-popup-scrolled"),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),n=this._getAnchor();ve(this._container,e.add(n))},_adjustPan:function(){if(this.options.autoPan){this._map._panAnim&&this._map._panAnim.stop();var t=this._map,e=parseInt(oe(this._container,"marginBottom"),10)||0,n=this._container.offsetHeight+e,i=this._containerWidth,a=new j(this._containerLeft,-n-this._containerBottom);a._add(we(this._container));var o=t.layerPointToContainerPoint(a),r=F(this.options.autoPanPadding),s=F(this.options.autoPanPaddingTopLeft||r),l=F(this.options.autoPanPaddingBottomRight||r),c=t.getSize(),d=0,u=0;o.x+i+l.x>c.x&&(d=o.x+i-c.x+l.x),o.x-d-s.x<0&&(d=o.x-s.x),o.y+n+l.y>c.y&&(u=o.y+n-c.y+l.y),o.y-u-s.y<0&&(u=o.y-s.y),(d||u)&&t.fire("autopanstart").panBy([d,u])}},_onCloseButtonClick:function(t){this._close(),Pe(t)},_getAnchor:function(){return F(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});qe.mergeOptions({closePopupOnClick:!0}),qe.include({openPopup:function(t,e,n){return t instanceof ei||(t=new ei(n).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=t,this.addLayer(t))},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&this.removeLayer(t),this}}),Ln.include({bindPopup:function(t,e){return t instanceof ei?(p(t,e),this._popup=t,t._source=this):(this._popup&&!e||(this._popup=new ei(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t,e){return this._popup&&this._map&&(e=this._popup._prepareOpen(this,t,e),this._map.openPopup(this._popup,e)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(t){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(t)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){var e=t.layer||t.target;this._popup&&this._map&&(Pe(t),e instanceof Fn?this.openPopup(t.layer||t.target,t.latlng):this._map.hasLayer(this._popup)&&this._popup._source===e?this.closePopup():this.openPopup(e,t.latlng))},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){13===t.originalEvent.keyCode&&this._openPopup(t)}});var ni=ti.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(t){ti.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(t){ti.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var t=ti.prototype.getEvents.call(this);return St&&!this.options.permanent&&(t.preclick=this._close),t},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var t="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=re("div",t)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var e=this._map,n=this._container,i=e.latLngToContainerPoint(e.getCenter()),a=e.layerPointToContainerPoint(t),o=this.options.direction,r=n.offsetWidth,s=n.offsetHeight,l=F(this.options.offset),c=this._getAnchor();"top"===o?t=t.add(F(-r/2+l.x,-s+l.y+c.y,!0)):"bottom"===o?t=t.subtract(F(r/2-l.x,-l.y,!0)):"center"===o?t=t.subtract(F(r/2+l.x,s/2-c.y+l.y,!0)):"right"===o||"auto"===o&&a.x<i.x?(o="right",t=t.add(F(l.x+c.x,c.y-s/2+l.y,!0))):(o="left",t=t.subtract(F(r+c.x-l.x,s/2-c.y-l.y,!0))),pe(n,"leaflet-tooltip-right"),pe(n,"leaflet-tooltip-left"),pe(n,"leaflet-tooltip-top"),pe(n,"leaflet-tooltip-bottom"),he(n,"leaflet-tooltip-"+o),ve(n,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&fe(this._container,t)},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(e)},_getAnchor:function(){return F(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});qe.include({openTooltip:function(t,e,n){return t instanceof ni||(t=new ni(n).setContent(t)),e&&t.setLatLng(e),this.hasLayer(t)?this:this.addLayer(t)},closeTooltip:function(t){return t&&this.removeLayer(t),this}}),Ln.include({bindTooltip:function(t,e){return t instanceof ni?(p(t,e),this._tooltip=t,t._source=this):(this._tooltip&&!e||(this._tooltip=new ni(e,this)),this._tooltip.setContent(t)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(t||!this._tooltipHandlersAdded){var e=t?"off":"on",n={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?n.add=this._openTooltip:(n.mouseover=this._openTooltip,n.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(n.mousemove=this._moveTooltip),St&&(n.click=this._openTooltip)),this[e](n),this._tooltipHandlersAdded=!t}},openTooltip:function(t,e){return this._tooltip&&this._map&&(e=this._tooltip._prepareOpen(this,t,e),this._map.openTooltip(this._tooltip,e),this._tooltip.options.interactive&&this._tooltip._container&&(he(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(pe(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(t){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(t)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_openTooltip:function(t){var e=t.layer||t.target;this._tooltip&&this._map&&this.openTooltip(e,this._tooltip.options.sticky?t.latlng:void 0)},_moveTooltip:function(t){var e,n,i=t.latlng;this._tooltip.options.sticky&&t.originalEvent&&(e=this._map.mouseEventToContainerPoint(t.originalEvent),n=this._map.containerPointToLayerPoint(e),i=this._map.layerPointToLatLng(n)),this._tooltip.setLatLng(i)}});var ii=kn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:document.createElement("div"),n=this.options;if(n.html instanceof Element?(le(e),e.appendChild(n.html)):e.innerHTML=!1!==n.html?n.html:"",n.bgPos){var i=F(n.bgPos);e.style.backgroundPosition=-i.x+"px "+-i.y+"px"}return this._setIconStyles(e,"icon"),e},createShadow:function(){return null}});kn.Default=En;var ai=Ln.extend({options:{tileSize:256,opacity:1,updateWhenIdle:bt,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){p(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),se(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ce(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(de(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=s(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof j?t:new j(t,t)},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var e,n=this.getPane().children,i=-t(-1/0,1/0),a=0,o=n.length;a<o;a++)e=n[a].style.zIndex,n[a]!==this._container&&e&&(i=t(i,+e));isFinite(i)&&(this.options.zIndex=i+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!J){fe(this._container,this.options.opacity);var t=+new Date,e=!1,n=!1;for(var i in this._tiles){var a=this._tiles[i];if(a.current&&a.loaded){var o=Math.min(1,(t-a.loaded)/200);fe(a.el,o),o<1?e=!0:(a.active?n=!0:this._onOpaqueTile(a),a.active=!0)}}n&&!this._noPrune&&this._pruneTiles(),e&&(_(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this))}},_onOpaqueTile:c,_initContainer:function(){this._container||(this._container=re("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,e=this.options.maxZoom;if(void 0!==t){for(var n in this._levels)this._levels[n].el.children.length||n===t?(this._levels[n].el.style.zIndex=e-Math.abs(t-n),this._onUpdateLevel(n)):(se(this._levels[n].el),this._removeTilesAtZoom(n),this._onRemoveLevel(n),delete this._levels[n]);var i=this._levels[t],a=this._map;return i||((i=this._levels[t]={}).el=re("div","leaflet-tile-container leaflet-zoom-animated",this._container),i.el.style.zIndex=e,i.origin=a.project(a.unproject(a.getPixelOrigin()),t).round(),i.zoom=t,this._setZoomTransform(i,a.getCenter(),a.getZoom()),i.el.offsetWidth,this._onCreateLevel(i)),this._level=i,i}},_onUpdateLevel:c,_onRemoveLevel:c,_onCreateLevel:c,_pruneTiles:function(){if(this._map){var t,e,n=this._map.getZoom();if(n>this.options.maxZoom||n<this.options.minZoom)this._removeAllTiles();else{for(t in this._tiles)(e=this._tiles[t]).retain=e.current;for(t in this._tiles)if((e=this._tiles[t]).current&&!e.active){var i=e.coords;this._retainParent(i.x,i.y,i.z,i.z-5)||this._retainChildren(i.x,i.y,i.z,i.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}}},_removeTilesAtZoom:function(t){for(var e in this._tiles)this._tiles[e].coords.z===t&&this._removeTile(e)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)se(this._levels[t].el),this._onRemoveLevel(t),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,e,n,i){var a=Math.floor(t/2),o=Math.floor(e/2),r=n-1,s=new j(+a,+o);s.z=+r;var l=this._tileCoordsToKey(s),c=this._tiles[l];return c&&c.active?(c.retain=!0,!0):(c&&c.loaded&&(c.retain=!0),r>i&&this._retainParent(a,o,r,i))},_retainChildren:function(t,e,n,i){for(var a=2*t;a<2*t+2;a++)for(var o=2*e;o<2*e+2;o++){var r=new j(a,o);r.z=n+1;var s=this._tileCoordsToKey(r),l=this._tiles[s];l&&l.active?l.retain=!0:(l&&l.loaded&&(l.retain=!0),n+1<i&&this._retainChildren(a,o,n+1,i))}},_resetView:function(t){var e=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),e,e)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var e=this.options;return void 0!==e.minNativeZoom&&t<e.minNativeZoom?e.minNativeZoom:void 0!==e.maxNativeZoom&&e.maxNativeZoom<t?e.maxNativeZoom:t},_setView:function(t,e,n,i){var a=this._clampZoom(Math.round(e));(void 0!==this.options.maxZoom&&a>this.options.maxZoom||void 0!==this.options.minZoom&&a<this.options.minZoom)&&(a=void 0);var o=this.options.updateWhenZooming&&a!==this._tileZoom;i&&!o||(this._tileZoom=a,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),void 0!==a&&this._update(t),n||this._pruneTiles(),this._noPrune=!!n),this._setZoomTransforms(t,e)},_setZoomTransforms:function(t,e){for(var n in this._levels)this._setZoomTransform(this._levels[n],t,e)},_setZoomTransform:function(t,e,n){var i=this._map.getZoomScale(n,t.zoom),a=t.origin.multiplyBy(i).subtract(this._map._getNewPixelOrigin(e,n)).round();ft?ye(t.el,a,i):ve(t.el,a)},_resetGrid:function(){var t=this._map,e=t.options.crs,n=this._tileSize=this.getTileSize(),i=this._tileZoom,a=this._map.getPixelWorldBounds(this._tileZoom);a&&(this._globalTileRange=this._pxBoundsToTileRange(a)),this._wrapX=e.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,e.wrapLng[0]],i).x/n.x),Math.ceil(t.project([0,e.wrapLng[1]],i).x/n.y)],this._wrapY=e.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([e.wrapLat[0],0],i).y/n.x),Math.ceil(t.project([e.wrapLat[1],0],i).y/n.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(t){var e=this._map,n=e._animatingZoom?Math.max(e._animateToZoom,e.getZoom()):e.getZoom(),i=e.getZoomScale(n,this._tileZoom),a=e.project(t,this._tileZoom).floor(),o=e.getSize().divideBy(2*i);return new M(a.subtract(o),a.add(o))},_update:function(t){var e=this._map;if(e){var n=this._clampZoom(e.getZoom());if(void 0===t&&(t=e.getCenter()),void 0!==this._tileZoom){var i=this._getTiledPixelBounds(t),a=this._pxBoundsToTileRange(i),o=a.getCenter(),r=[],s=this.options.keepBuffer,l=new M(a.getBottomLeft().subtract([s,-s]),a.getTopRight().add([s,-s]));if(!(isFinite(a.min.x)&&isFinite(a.min.y)&&isFinite(a.max.x)&&isFinite(a.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var c in this._tiles){var d=this._tiles[c].coords;d.z===this._tileZoom&&l.contains(new j(d.x,d.y))||(this._tiles[c].current=!1)}if(Math.abs(n-this._tileZoom)>1)this._setView(t,n);else{for(var u=a.min.y;u<=a.max.y;u++)for(var h=a.min.x;h<=a.max.x;h++){var p=new j(h,u);if(p.z=this._tileZoom,this._isValidTile(p)){var m=this._tiles[this._tileCoordsToKey(p)];m?m.current=!0:r.push(p)}}if(r.sort((function(t,e){return t.distanceTo(o)-e.distanceTo(o)})),0!==r.length){this._loading||(this._loading=!0,this.fire("loading"));var g=document.createDocumentFragment();for(h=0;h<r.length;h++)this._addTile(r[h],g);this._level.el.appendChild(g)}}}}},_isValidTile:function(t){var e=this._map.options.crs;if(!e.infinite){var n=this._globalTileRange;if(!e.wrapLng&&(t.x<n.min.x||t.x>n.max.x)||!e.wrapLat&&(t.y<n.min.y||t.y>n.max.y))return!1}if(!this.options.bounds)return!0;var i=this._tileCoordsToBounds(t);return P(this.options.bounds).overlaps(i)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var e=this._map,n=this.getTileSize(),i=t.scaleBy(n),a=i.add(n);return[e.unproject(i,t.z),e.unproject(a,t.z)]},_tileCoordsToBounds:function(t){var e=this._tileCoordsToNwSe(t),n=new N(e[0],e[1]);return this.options.noWrap||(n=this._map.wrapLatLngBounds(n)),n},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var e=t.split(":"),n=new j(+e[0],+e[1]);return n.z=+e[2],n},_removeTile:function(t){var e=this._tiles[t];e&&(se(e.el),delete this._tiles[t],this.fire("tileunload",{tile:e.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){he(t,"leaflet-tile");var e=this.getTileSize();t.style.width=e.x+"px",t.style.height=e.y+"px",t.onselectstart=c,t.onmousemove=c,J&&this.options.opacity<1&&fe(t,this.options.opacity),nt&&!it&&(t.style.WebkitBackfaceVisibility="hidden")},_addTile:function(t,e){var n=this._getTilePos(t),i=this._tileCoordsToKey(t),o=this.createTile(this._wrapCoords(t),a(this._tileReady,this,t));this._initTile(o),this.createTile.length<2&&O(a(this._tileReady,this,t,null,o)),ve(o,n),this._tiles[i]={el:o,coords:t,current:!0},e.appendChild(o),this.fire("tileloadstart",{tile:o,coords:t})},_tileReady:function(t,e,n){e&&this.fire("tileerror",{error:e,tile:n,coords:t});var i=this._tileCoordsToKey(t);(n=this._tiles[i])&&(n.loaded=+new Date,this._map._fadeAnimated?(fe(n.el,0),_(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this)):(n.active=!0,this._pruneTiles()),e||(he(n.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:n.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),J||!this._map._fadeAnimated?O(this._pruneTiles,this):setTimeout(a(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var e=new j(this._wrapX?l(t.x,this._wrapX):t.x,this._wrapY?l(t.y,this._wrapY):t.y);return e.z=t.z,e},_pxBoundsToTileRange:function(t){var e=this.getTileSize();return new M(t.min.unscaleBy(e).floor(),t.max.unscaleBy(e).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}}),oi=ai.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(t,e){this._url=t,(e=p(this,e)).detectRetina&&Ot&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomReverse?(e.zoomOffset--,e.minZoom++):(e.zoomOffset++,e.maxZoom--),e.minZoom=Math.max(0,e.minZoom)),"string"==typeof e.subdomains&&(e.subdomains=e.subdomains.split("")),nt||this.on("tileunload",this._onTileRemove)},setUrl:function(t,e){return this._url===t&&void 0===e&&(e=!0),this._url=t,e||this.redraw(),this},createTile:function(t,e){var n=document.createElement("img");return Ae(n,"load",a(this._tileOnLoad,this,e,n)),Ae(n,"error",a(this._tileOnError,this,e,n)),(this.options.crossOrigin||""===this.options.crossOrigin)&&(n.crossOrigin=!0===this.options.crossOrigin?"":this.options.crossOrigin),n.alt="",n.setAttribute("role","presentation"),n.src=this.getTileUrl(t),n},getTileUrl:function(t){var e={r:Ot?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var i=this._globalTileRange.max.y-t.y;this.options.tms&&(e.y=i),e["-y"]=i}return f(this._url,n(e,this.options))},_tileOnLoad:function(t,e){J?setTimeout(a(t,this,null,e),0):t(null,e)},_tileOnError:function(t,e,n){var i=this.options.errorTileUrl;i&&e.getAttribute("src")!==i&&(e.src=i),t(n,e)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,e=this.options.maxZoom;return this.options.zoomReverse&&(t=e-t),t+this.options.zoomOffset},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_abortLoading:function(){var t,e;for(t in this._tiles)this._tiles[t].coords.z!==this._tileZoom&&((e=this._tiles[t].el).onload=c,e.onerror=c,e.complete||(e.src=v,se(e),delete this._tiles[t]))},_removeTile:function(t){var e=this._tiles[t];if(e)return ot||e.el.setAttribute("src",v),ai.prototype._removeTile.call(this,t)},_tileReady:function(t,e,n){if(this._map&&(!n||n.getAttribute("src")!==v))return ai.prototype._tileReady.call(this,t,e,n)}});function ri(t,e){return new oi(t,e)}var si=oi.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,e){this._url=t;var i=n({},this.defaultWmsParams);for(var a in e)a in this.options||(i[a]=e[a]);var o=(e=p(this,e)).detectRetina&&Ot?2:1,r=this.getTileSize();i.width=r.x*o,i.height=r.y*o,this.wmsParams=i},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,oi.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._tileCoordsToNwSe(t),n=this._crs,i=R(n.project(e[0]),n.project(e[1])),a=i.min,o=i.max,r=(this._wmsVersion>=1.3&&this._crs===On?[a.y,a.x,o.y,o.x]:[a.x,a.y,o.x,o.y]).join(","),s=oi.prototype.getTileUrl.call(this,t);return s+m(this.wmsParams,s,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+r},setParams:function(t,e){return n(this.wmsParams,t),e||this.redraw(),this}});oi.WMS=si,ri.wms=function(t,e){return new si(t,e)};var li=Ln.extend({options:{padding:.1,tolerance:0},initialize:function(t){p(this,t),r(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&he(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,e){var n=this._map.getZoomScale(e,this._zoom),i=we(this._container),a=this._map.getSize().multiplyBy(.5+this.options.padding),o=this._map.project(this._center,e),r=this._map.project(t,e).subtract(o),s=a.multiplyBy(-n).add(i).add(a).subtract(r);ft?ye(this._container,s,n):ve(this._container,s)},_reset:function(){for(var t in this._update(),this._updateTransform(this._center,this._zoom),this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,e=this._map.getSize(),n=this._map.containerPointToLayerPoint(e.multiplyBy(-t)).round();this._bounds=new M(n,n.add(e.multiplyBy(1+2*t)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),ci=li.extend({getEvents:function(){var t=li.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){li.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Ae(t,"mousemove",this._onMouseMove,this),Ae(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ae(t,"mouseout",this._handleMouseOut,this),this._ctx=t.getContext("2d")},_destroyContainer:function(){_(this._redrawRequest),delete this._ctx,se(this._container),Ee(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){for(var t in this._redrawBounds=null,this._layers)this._layers[t]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){li.prototype._update.call(this);var t=this._bounds,e=this._container,n=t.getSize(),i=Ot?2:1;ve(e,t.min),e.width=i*n.x,e.height=i*n.y,e.style.width=n.x+"px",e.style.height=n.y+"px",Ot&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){li.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[r(t)]=t;var e=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=e),this._drawLast=e,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var e=t._order,n=e.next,i=e.prev;n?n.prev=i:this._drawLast=i,i?i.next=n:this._drawFirst=n,delete t._order,delete this._layers[r(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if("string"==typeof t.options.dashArray){var e,n,i=t.options.dashArray.split(/[, ]+/),a=[];for(n=0;n<i.length;n++){if(e=Number(i[n]),isNaN(e))return;a.push(e)}t.options._dashArray=a}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||O(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var e=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new M,this._redrawBounds.extend(t._pxBounds.min.subtract([e,e])),this._redrawBounds.extend(t._pxBounds.max.add([e,e]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var e=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,e.x,e.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var t,e=this._redrawBounds;if(this._ctx.save(),e){var n=e.getSize();this._ctx.beginPath(),this._ctx.rect(e.min.x,e.min.y,n.x,n.y),this._ctx.clip()}this._drawing=!0;for(var i=this._drawFirst;i;i=i.next)t=i.layer,(!e||t._pxBounds&&t._pxBounds.intersects(e))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,e){if(this._drawing){var n,i,a,o,r=t._parts,s=r.length,l=this._ctx;if(s){for(l.beginPath(),n=0;n<s;n++){for(i=0,a=r[n].length;i<a;i++)o=r[n][i],l[i?"lineTo":"moveTo"](o.x,o.y);e&&l.closePath()}this._fillStroke(l,t)}}},_updateCircle:function(t){if(this._drawing&&!t._empty()){var e=t._point,n=this._ctx,i=Math.max(Math.round(t._radius),1),a=(Math.max(Math.round(t._radiusY),1)||i)/i;1!==a&&(n.save(),n.scale(1,a)),n.beginPath(),n.arc(e.x,e.y/a,i,0,2*Math.PI,!1),1!==a&&n.restore(),this._fillStroke(n,t)}},_fillStroke:function(t,e){var n=e.options;n.fill&&(t.globalAlpha=n.fillOpacity,t.fillStyle=n.fillColor||n.color,t.fill(n.fillRule||"evenodd")),n.stroke&&0!==n.weight&&(t.setLineDash&&t.setLineDash(e.options&&e.options._dashArray||[]),t.globalAlpha=n.opacity,t.lineWidth=n.weight,t.strokeStyle=n.color,t.lineCap=n.lineCap,t.lineJoin=n.lineJoin,t.stroke())},_onClick:function(t){for(var e,n,i=this._map.mouseEventToLayerPoint(t),a=this._drawFirst;a;a=a.next)(e=a.layer).options.interactive&&e._containsPoint(i)&&!this._map._draggableMoved(e)&&(n=e);n&&(Ge(t),this._fireEvent([n],t))},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(pe(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,e){if(!this._mouseHoverThrottled){for(var n,i,a=this._drawFirst;a;a=a.next)(n=a.layer).options.interactive&&n._containsPoint(e)&&(i=n);i!==this._hoveredLayer&&(this._handleMouseOut(t),i&&(he(this._container,"leaflet-interactive"),this._fireEvent([i],t,"mouseover"),this._hoveredLayer=i)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t),this._mouseHoverThrottled=!0,setTimeout(L.bind((function(){this._mouseHoverThrottled=!1}),this),32)}},_fireEvent:function(t,e,n){this._map._fireDOMEvent(e,n||e.type,t)},_bringToFront:function(t){var e=t._order;if(e){var n=e.next,i=e.prev;n&&(n.prev=i,i?i.next=n:n&&(this._drawFirst=n),e.prev=this._drawLast,this._drawLast.next=e,e.next=null,this._drawLast=e,this._requestRedraw(t))}},_bringToBack:function(t){var e=t._order;if(e){var n=e.next,i=e.prev;i&&(i.next=n,n?n.prev=i:i&&(this._drawLast=i),e.prev=null,e.next=this._drawFirst,this._drawFirst.prev=e,this._drawFirst=e,this._requestRedraw(t))}}});function di(t){return Lt?new ci(t):null}var ui=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),hi={_initContainer:function(){this._container=re("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(li.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var e=t._container=ui("shape");he(e,"leaflet-vml-shape "+(this.options.className||"")),e.coordsize="1 1",t._path=ui("path"),e.appendChild(t._path),this._updateStyle(t),this._layers[r(t)]=t},_addPath:function(t){var e=t._container;this._container.appendChild(e),t.options.interactive&&t.addInteractiveTarget(e)},_removePath:function(t){var e=t._container;se(e),t.removeInteractiveTarget(e),delete this._layers[r(t)]},_updateStyle:function(t){var e=t._stroke,n=t._fill,i=t.options,a=t._container;a.stroked=!!i.stroke,a.filled=!!i.fill,i.stroke?(e||(e=t._stroke=ui("stroke")),a.appendChild(e),e.weight=i.weight+"px",e.color=i.color,e.opacity=i.opacity,i.dashArray?e.dashStyle=b(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," "):e.dashStyle="",e.endcap=i.lineCap.replace("butt","flat"),e.joinstyle=i.lineJoin):e&&(a.removeChild(e),t._stroke=null),i.fill?(n||(n=t._fill=ui("fill")),a.appendChild(n),n.color=i.fillColor||i.color,n.opacity=i.fillOpacity):n&&(a.removeChild(n),t._fill=null)},_updateCircle:function(t){var e=t._point.round(),n=Math.round(t._radius),i=Math.round(t._radiusY||n);this._setPath(t,t._empty()?"M0 0":"AL "+e.x+","+e.y+" "+n+","+i+" 0,23592600")},_setPath:function(t,e){t._path.v=e},_bringToFront:function(t){ce(t._container)},_bringToBack:function(t){de(t._container)}},pi=At?ui:q,mi=li.extend({getEvents:function(){var t=li.prototype.getEvents.call(this);return t.zoomstart=this._onZoomStart,t},_initContainer:function(){this._container=pi("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=pi("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){se(this._container),Ee(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){li.prototype._update.call(this);var t=this._bounds,e=t.getSize(),n=this._container;this._svgSize&&this._svgSize.equals(e)||(this._svgSize=e,n.setAttribute("width",e.x),n.setAttribute("height",e.y)),ve(n,t.min),n.setAttribute("viewBox",[t.min.x,t.min.y,e.x,e.y].join(" ")),this.fire("update")}},_initPath:function(t){var e=t._path=pi("path");t.options.className&&he(e,t.options.className),t.options.interactive&&he(e,"leaflet-interactive"),this._updateStyle(t),this._layers[r(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){se(t._path),t.removeInteractiveTarget(t._path),delete this._layers[r(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var e=t._path,n=t.options;e&&(n.stroke?(e.setAttribute("stroke",n.color),e.setAttribute("stroke-opacity",n.opacity),e.setAttribute("stroke-width",n.weight),e.setAttribute("stroke-linecap",n.lineCap),e.setAttribute("stroke-linejoin",n.lineJoin),n.dashArray?e.setAttribute("stroke-dasharray",n.dashArray):e.removeAttribute("stroke-dasharray"),n.dashOffset?e.setAttribute("stroke-dashoffset",n.dashOffset):e.removeAttribute("stroke-dashoffset")):e.setAttribute("stroke","none"),n.fill?(e.setAttribute("fill",n.fillColor||n.color),e.setAttribute("fill-opacity",n.fillOpacity),e.setAttribute("fill-rule",n.fillRule||"evenodd")):e.setAttribute("fill","none"))},_updatePoly:function(t,e){this._setPath(t,$(t._parts,e))},_updateCircle:function(t){var e=t._point,n=Math.max(Math.round(t._radius),1),i="a"+n+","+(Math.max(Math.round(t._radiusY),1)||n)+" 0 1,0 ",a=t._empty()?"M0 0":"M"+(e.x-n)+","+e.y+i+2*n+",0 "+i+2*-n+",0 ";this._setPath(t,a)},_setPath:function(t,e){t._path.setAttribute("d",e)},_bringToFront:function(t){ce(t._path)},_bringToBack:function(t){de(t._path)}});function gi(t){return It||At?new mi(t):null}At&&mi.include(hi),qe.include({getRenderer:function(t){var e=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return e||(e=this._renderer=this._createRenderer()),this.hasLayer(e)||this.addLayer(e),e},_getPaneRenderer:function(t){if("overlayPane"===t||void 0===t)return!1;var e=this._paneRenderers[t];return void 0===e&&(e=this._createRenderer({pane:t}),this._paneRenderers[t]=e),e},_createRenderer:function(t){return this.options.preferCanvas&&di(t)||gi(t)}});var fi=Pn.extend({initialize:function(t,e){Pn.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return[(t=P(t)).getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});mi.create=pi,mi.pointsToPath=$,Vn.geometryToLayer=Wn,Vn.coordsToLatLng=Bn,Vn.coordsToLatLngs=Un,Vn.latLngToCoords=Gn,Vn.latLngsToCoords=Hn,Vn.getFeature=Kn,Vn.asFeature=Yn,qe.mergeOptions({boxZoom:!0});var bi=nn.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Ae(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ee(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){se(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){0!==this._resetStateTimeout&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||1!==t.which&&1!==t.button)return!1;this._clearDeferredResetState(),this._resetState(),$t(),Se(),this._startPoint=this._map.mouseEventToContainerPoint(t),Ae(document,{contextmenu:Pe,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=re("div","leaflet-zoom-box",this._container),he(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var e=new M(this._point,this._startPoint),n=e.getSize();ve(this._box,e.min),this._box.style.width=n.x+"px",this._box.style.height=n.y+"px"},_finish:function(){this._moved&&(se(this._box),pe(this._container,"leaflet-crosshair")),Xt(),Ce(),Ee(document,{contextmenu:Pe,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if((1===t.which||1===t.button)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(a(this._resetState,this),0);var e=new N(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(e).fire("boxzoomend",{boxZoomBounds:e})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}});qe.addInitHook("addHandler","boxZoom",bi),qe.mergeOptions({doubleClickZoom:!0});var yi=nn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,n=e.getZoom(),i=e.options.zoomDelta,a=t.originalEvent.shiftKey?n-i:n+i;"center"===e.options.doubleClickZoom?e.setZoom(a):e.setZoomAround(t.containerPoint,a)}});qe.addInitHook("addHandler","doubleClickZoom",yi),qe.mergeOptions({dragging:!0,inertia:!it,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var vi=nn.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new cn(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}he(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){pe(this._map._container,"leaflet-grab"),pe(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var e=P(this._map.options.maxBounds);this._offsetLimit=R(this._map.latLngToContainerPoint(e.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(e.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var e=this._lastTime=+new Date,n=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(n),this._times.push(e),this._prunePositions(e)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,e){return t-(t-e)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var t=this._draggable._newPos.subtract(this._draggable._startPos),e=this._offsetLimit;t.x<e.min.x&&(t.x=this._viscousLimit(t.x,e.min.x)),t.y<e.min.y&&(t.y=this._viscousLimit(t.y,e.min.y)),t.x>e.max.x&&(t.x=this._viscousLimit(t.x,e.max.x)),t.y>e.max.y&&(t.y=this._viscousLimit(t.y,e.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,e=Math.round(t/2),n=this._initialWorldOffset,i=this._draggable._newPos.x,a=(i-e+n)%t+e-n,o=(i+e+n)%t-e-n,r=Math.abs(a+n)<Math.abs(o+n)?a:o;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=r},_onDragEnd:function(t){var e=this._map,n=e.options,i=!n.inertia||this._times.length<2;if(e.fire("dragend",t),i)e.fire("moveend");else{this._prunePositions(+new Date);var a=this._lastPos.subtract(this._positions[0]),o=(this._lastTime-this._times[0])/1e3,r=n.easeLinearity,s=a.multiplyBy(r/o),l=s.distanceTo([0,0]),c=Math.min(n.inertiaMaxSpeed,l),d=s.multiplyBy(c/l),u=c/(n.inertiaDeceleration*r),h=d.multiplyBy(-u/2).round();h.x||h.y?(h=e._limitOffset(h,e.options.maxBounds),O((function(){e.panBy(h,{duration:u,easeLinearity:r,noMoveStart:!0,animate:!0})}))):e.fire("moveend")}}});qe.addInitHook("addHandler","dragging",vi),qe.mergeOptions({keyboard:!0,keyboardPanDelta:80});var wi=nn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Ae(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ee(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,e=document.documentElement,n=t.scrollTop||e.scrollTop,i=t.scrollLeft||e.scrollLeft;this._map._container.focus(),window.scrollTo(i,n)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var e,n,i=this._panKeys={},a=this.keyCodes;for(e=0,n=a.left.length;e<n;e++)i[a.left[e]]=[-1*t,0];for(e=0,n=a.right.length;e<n;e++)i[a.right[e]]=[t,0];for(e=0,n=a.down.length;e<n;e++)i[a.down[e]]=[0,t];for(e=0,n=a.up.length;e<n;e++)i[a.up[e]]=[0,-1*t]},_setZoomDelta:function(t){var e,n,i=this._zoomKeys={},a=this.keyCodes;for(e=0,n=a.zoomIn.length;e<n;e++)i[a.zoomIn[e]]=t;for(e=0,n=a.zoomOut.length;e<n;e++)i[a.zoomOut[e]]=-t},_addHooks:function(){Ae(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ee(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var e,n=t.keyCode,i=this._map;if(n in this._panKeys)i._panAnim&&i._panAnim._inProgress||(e=this._panKeys[n],t.shiftKey&&(e=F(e).multiplyBy(3)),i.panBy(e),i.options.maxBounds&&i.panInsideBounds(i.options.maxBounds));else if(n in this._zoomKeys)i.setZoom(i.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[n]);else{if(27!==n||!i._popup||!i._popup.options.closeOnEscapeKey)return;i.closePopup()}Pe(t)}}});qe.addInitHook("addHandler","keyboard",wi),qe.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var xi=nn.extend({addHooks:function(){Ae(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ee(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var e=ze(t),n=this._map.options.wheelDebounceTime;this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var i=Math.max(n-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(a(this._performZoom,this),i),Pe(t)},_performZoom:function(){var t=this._map,e=t.getZoom(),n=this._map.options.zoomSnap||0;t._stop();var i=this._delta/(4*this._map.options.wheelPxPerZoomLevel),a=4*Math.log(2/(1+Math.exp(-Math.abs(i))))/Math.LN2,o=n?Math.ceil(a/n)*n:a,r=t._limitZoom(e+(this._delta>0?o:-o))-e;this._delta=0,this._startTime=null,r&&("center"===t.options.scrollWheelZoom?t.setZoom(e+r):t.setZoomAround(this._lastMousePos,e+r))}});qe.addInitHook("addHandler","scrollWheelZoom",xi),qe.mergeOptions({tap:!0,tapTolerance:15});var Si=nn.extend({addHooks:function(){Ae(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ee(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(Ne(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],n=e.target;this._startPos=this._newPos=new j(e.clientX,e.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&he(n,"leaflet-active"),this._holdTimeout=setTimeout(a((function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))}),this),1e3),this._simulateEvent("mousedown",e),Ae(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),Ee(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],n=e.target;n&&n.tagName&&"a"===n.tagName.toLowerCase()&&pe(n,"leaflet-active"),this._simulateEvent("mouseup",e),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new j(e.clientX,e.clientY),this._simulateEvent("mousemove",e)},_simulateEvent:function(t,e){var n=document.createEvent("MouseEvents");n._simulated=!0,e.target._simulatedClick=!0,n.initMouseEvent(t,!0,!0,window,1,e.screenX,e.screenY,e.clientX,e.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(n)}});St&&!xt&&qe.addInitHook("addHandler","tap",Si),qe.mergeOptions({touchZoom:St&&!it,bounceAtZoomLimits:!0});var Ci=nn.extend({addHooks:function(){he(this._map._container,"leaflet-touch-zoom"),Ae(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){pe(this._map._container,"leaflet-touch-zoom"),Ee(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var n=e.mouseEventToContainerPoint(t.touches[0]),i=e.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=e.getSize()._divideBy(2),this._startLatLng=e.containerPointToLatLng(this._centerPoint),"center"!==e.options.touchZoom&&(this._pinchStartLatLng=e.containerPointToLatLng(n.add(i)._divideBy(2))),this._startDist=n.distanceTo(i),this._startZoom=e.getZoom(),this._moved=!1,this._zooming=!0,e._stop(),Ae(document,"touchmove",this._onTouchMove,this),Ae(document,"touchend",this._onTouchEnd,this),Ne(t)}},_onTouchMove:function(t){if(t.touches&&2===t.touches.length&&this._zooming){var e=this._map,n=e.mouseEventToContainerPoint(t.touches[0]),i=e.mouseEventToContainerPoint(t.touches[1]),o=n.distanceTo(i)/this._startDist;if(this._zoom=e.getScaleZoom(o,this._startZoom),!e.options.bounceAtZoomLimits&&(this._zoom<e.getMinZoom()&&o<1||this._zoom>e.getMaxZoom()&&o>1)&&(this._zoom=e._limitZoom(this._zoom)),"center"===e.options.touchZoom){if(this._center=this._startLatLng,1===o)return}else{var r=n._add(i)._divideBy(2)._subtract(this._centerPoint);if(1===o&&0===r.x&&0===r.y)return;this._center=e.unproject(e.project(this._pinchStartLatLng,this._zoom).subtract(r),this._zoom)}this._moved||(e._moveStart(!0,!1),this._moved=!0),_(this._animRequest);var s=a(e._move,e,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=O(s,this,!0),Ne(t)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,_(this._animRequest),Ee(document,"touchmove",this._onTouchMove),Ee(document,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});qe.addInitHook("addHandler","touchZoom",Ci),qe.BoxZoom=bi,qe.DoubleClickZoom=yi,qe.Drag=vi,qe.Keyboard=wi,qe.ScrollWheelZoom=xi,qe.Tap=Si,qe.TouchZoom=Ci,Object.freeze=e,t.version="1.6.0",t.Control=$e,t.control=Xe,t.Browser=Et,t.Evented=E,t.Mixin=on,t.Util=I,t.Class=A,t.Handler=nn,t.extend=n,t.bind=a,t.stamp=r,t.setOptions=p,t.DomEvent=Ye,t.DomUtil=Ie,t.PosAnimation=Ze,t.Draggable=cn,t.LineUtil=yn,t.PolyUtil=wn,t.Point=j,t.point=F,t.Bounds=M,t.bounds=R,t.Transformation=H,t.transformation=K,t.Projection=Cn,t.LatLng=V,t.latLng=W,t.LatLngBounds=N,t.latLngBounds=P,t.CRS=B,t.GeoJSON=Vn,t.geoJSON=qn,t.geoJson=$n,t.Layer=Ln,t.LayerGroup=In,t.layerGroup=function(t,e){return new In(t,e)},t.FeatureGroup=An,t.featureGroup=function(t){return new An(t)},t.ImageOverlay=Xn,t.imageOverlay=function(t,e,n){return new Xn(t,e,n)},t.VideoOverlay=Qn,t.videoOverlay=function(t,e,n){return new Qn(t,e,n)},t.SVGOverlay=Jn,t.svgOverlay=function(t,e,n){return new Jn(t,e,n)},t.DivOverlay=ti,t.Popup=ei,t.popup=function(t,e){return new ei(t,e)},t.Tooltip=ni,t.tooltip=function(t,e){return new ni(t,e)},t.Icon=kn,t.icon=function(t){return new kn(t)},t.DivIcon=ii,t.divIcon=function(t){return new ii(t)},t.Marker=Dn,t.marker=function(t,e){return new Dn(t,e)},t.TileLayer=oi,t.tileLayer=ri,t.GridLayer=ai,t.gridLayer=function(t){return new ai(t)},t.SVG=mi,t.svg=gi,t.Renderer=li,t.Canvas=ci,t.canvas=di,t.Path=Fn,t.CircleMarker=Mn,t.circleMarker=function(t,e){return new Mn(t,e)},t.Circle=Rn,t.circle=function(t,e,n){return new Rn(t,e,n)},t.Polyline=Nn,t.polyline=function(t,e){return new Nn(t,e)},t.Polygon=Pn,t.polygon=function(t,e){return new Pn(t,e)},t.Rectangle=fi,t.rectangle=function(t,e){return new fi(t,e)},t.Map=qe,t.map=function(t,e){return new qe(t,e)};var Ti=window.L;t.noConflict=function(){return window.L=Ti,this},window.L=t}(e)},"4Xas":function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .tb-audit-log-action-data,\n:host .tb-audit-log-failure-details {\n  width: 100%;\n  min-width: 400px;\n  height: 100%;\n  min-height: 50px;\n  border: 1px solid #c0c0c0;\n}'},"4eaF":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div class="tb-knob" fxLayout="column" [ngStyle]="{\'pointerEvents\': ctx.isEdit ? \'none\' : \'all\'}">\n  <div #knobContainer id="knob-container" fxFlex fxLayout="column" fxLayoutAlign="center center">\n    <div #knob class="knob">\n      <div #knobValueContainer class="value-container" fxLayout="row" fxLayoutAlign="center center">\n        <span #knobValue class="knob-value">{{ value }}</span>\n      </div>\n      <div class="canvas-background"></div>\n      <canvas #canvasBar id="canvasBar"></canvas>\n      <div #knobTopPointerContainer class="top-pointer-container">\n        <div #knobTopPointer class="top-pointer"></div>\n      </div>\n      <div class="top"></div>\n      <div #knobErrorContainer class="error-container" [ngStyle]="{\'background\': error?.length ? \'rgba(255,255,255,0.25)\' : \'none\'}"\n           fxLayout="row" fxLayoutAlign="center center">\n        <span #knobError class="knob-error" [innerHTML]="error"></span>\n      </div>\n      <div #knobTitleContainer class="title-container" fxLayout="row" fxLayoutAlign="center center">\n        <span #knobTitle class="knob-title">{{ title }}</span>\n      </div>\n      <div #knobMinmaxContainer class="minmax-container" fxLayout="row" fxLayoutAlign="start center">\n        <span class="minmax-label">min</span>\n        <span fxFlex></span>\n        <span class="minmax-label">max</span>\n      </div>\n      <div #textMeasure id="text-measure"></div>\n    </div>\n  </div>\n</div>\n'},"4j5O":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var i=n("mrSG"),a=n("TYT/"),o=n("OiFK"),r=n("k9IB"),s=n("//Q6"),l=n("0lYY"),c=n("U3y+"),d=n("MBk6"),u=function(){function t(t,e){this.utils=t,this.timeService=e}return t.prototype.validateAndUpdateDashboard=function(t){var e=this;if(t.configuration||(t.configuration={}),Object(s.u)(t.configuration.widgets))t.configuration.widgets={};else if(Array.isArray(t.configuration.widgets)){var n={};t.configuration.widgets.forEach((function(t){t.id||(t.id=e.utils.guid()),n[t.id]=t})),t.configuration.widgets=n}for(var i=0,a=Object.keys(t.configuration.widgets);i<a.length;i++){var o=a[i],r=t.configuration.widgets[o];t.configuration.widgets[o]=this.validateAndUpdateWidget(r)}if(Object(s.u)(t.configuration.states)){t.configuration.states={default:this.createDefaultState(t.title,!0)};for(var l=t.configuration.states.default.layouts.main,c=0,d=Object.keys(t.configuration.widgets);c<d.length;c++){o=d[c],r=t.configuration.widgets[o];l.widgets[o]={sizeX:r.sizeX,sizeY:r.sizeY,row:r.row,col:r.col},Object(s.k)(r.config.mobileHeight)&&(l.widgets[o].mobileHeight=r.config.mobileHeight),Object(s.k)(r.config.mobileOrder)&&(l.widgets[o].mobileOrder=r.config.mobileOrder)}}else{for(var u=t.configuration.states,h=!1,p=0,m=Object.keys(u);p<m.length;p++){var g=u[m[p]];Object(s.u)(g.root)?g.root=!1:g.root&&(h=!0),this.validateAndUpdateState(g)}if(!h)u[Object.keys(u)[0]].root=!0}for(var f={},b={},y=0,v=Object.keys(t.configuration.widgets);y<v.length;y++){var w=v[y];if((r=t.configuration.widgets[w]).config.datasources.forEach((function(t){if(t.entityAliasId){var e=t.entityAliasId,n=f[e];n||(n=[],f[e]=n),n.push(t)}})),r.config.targetDeviceAliasIds&&r.config.targetDeviceAliasIds.length){var x=r.config.targetDeviceAliasIds[0],S=b[x];S||(S=[],b[x]=S),S.push(r.config.targetDeviceAliasIds)}}if(t.configuration=this.validateAndUpdateEntityAliases(t.configuration,f,b),Object(s.u)(t.configuration.timewindow)&&(t.configuration.timewindow=this.timeService.defaultTimewindow()),Object(s.u)(t.configuration.settings)?(t.configuration.settings={},t.configuration.settings.stateControllerId="entity",t.configuration.settings.showTitle=!1,t.configuration.settings.showDashboardsSelect=!0,t.configuration.settings.showEntitiesSelect=!0,t.configuration.settings.showDashboardTimewindow=!0,t.configuration.settings.showDashboardExport=!0,t.configuration.settings.toolbarAlwaysOpen=!0):Object(s.u)(t.configuration.settings.stateControllerId)&&(t.configuration.settings.stateControllerId="entity"),Object(s.k)(t.configuration.gridSettings)){var C=t.configuration.gridSettings;Object(s.k)(C.showTitle)&&(t.configuration.settings.showTitle=C.showTitle,delete C.showTitle),Object(s.k)(C.titleColor)&&(t.configuration.settings.titleColor=C.titleColor,delete C.titleColor),Object(s.k)(C.showDevicesSelect)&&(t.configuration.settings.showEntitiesSelect=C.showDevicesSelect,delete C.showDevicesSelect),Object(s.k)(C.showEntitiesSelect)&&(t.configuration.settings.showEntitiesSelect=C.showEntitiesSelect,delete C.showEntitiesSelect),Object(s.k)(C.showDashboardTimewindow)&&(t.configuration.settings.showDashboardTimewindow=C.showDashboardTimewindow,delete C.showDashboardTimewindow),Object(s.k)(C.showDashboardExport)&&(t.configuration.settings.showDashboardExport=C.showDashboardExport,delete C.showDashboardExport),t.configuration.states.default.layouts.main.gridSettings=C,delete t.configuration.gridSettings}return t},t.prototype.createSingleWidgetDashboard=function(t){t.id||(t.id=this.utils.guid());var e={};return(e=this.validateAndUpdateDashboard(e)).configuration.widgets[t.id]=t,e.configuration.states.default.layouts.main.widgets[t.id]={sizeX:t.sizeX,sizeY:t.sizeY,row:t.row,col:t.col},e},t.prototype.validateAndUpdateWidget=function(t){return t.config||(t.config={}),t.config.datasources||(t.config.datasources=[]),t.config.datasources.forEach((function(t){"device"===t.type&&(t.type=l.a.entity),t.deviceAliasId&&(t.entityAliasId=t.deviceAliasId,delete t.deviceAliasId)})),t.isSystemType&&"charts"===t.bundleAlias&&"timeseries"===t.typeAlias&&(t.typeAlias="basic_timeseries"),t},t.prototype.createDefaultLayoutData=function(){return{widgets:{},gridSettings:this.createDefaultGridSettings()}},t.prototype.createDefaultGridSettings=function(){return{backgroundColor:"#eeeeee",color:"rgba(0,0,0,0.870588)",columns:24,margin:10,backgroundSizeMode:"100%"}},t.prototype.createDefaultLayouts=function(){return{main:this.createDefaultLayoutData()}},t.prototype.createDefaultState=function(t,e){return{name:t,root:e,layouts:this.createDefaultLayouts()}},t.prototype.createSingleEntityFilter=function(t){return{type:d.a.singleEntity,singleEntity:t,resolveMultiple:!1}},t.prototype.validateAndUpdateState=function(t){t.layouts||(t.layouts=this.createDefaultLayouts());for(var e=0,n=Object.keys(t.layouts);e<n.length;e++){var i=n[e],a=t.layouts[i];this.validateAndUpdateLayout(a)}},t.prototype.validateAndUpdateLayout=function(t){t.gridSettings||(t.gridSettings=this.createDefaultGridSettings()),t.gridSettings.margins&&2===t.gridSettings.margins.length&&(t.gridSettings.margin=t.gridSettings.margins[0],delete t.gridSettings.margins),t.gridSettings.margin=Object(s.k)(t.gridSettings.margin)?t.gridSettings.margin:10},t.prototype.setLayouts=function(t,e,n){for(var i=t.configuration.states[e],a=0,o=0,r=0,s=Object.keys(i.layouts);r<s.length;r++){n[d=s[r]]||o++}for(var l=0,c=Object.keys(n);l<c.length;l++){var d=c[l];i.layouts[d]||a++}i.layouts=n;var u,h=Object.keys(i.layouts).length;if(a)for(var p=0,m=Object.keys(i.layouts);p<m.length;p++){d=m[p];(u=i.layouts[d].gridSettings.columns*(h-a)/h)>0&&(i.layouts[d].gridSettings.columns=u)}if(o)for(var g=0,f=Object.keys(i.layouts);g<f.length;g++){d=f[g];(u=i.layouts[d].gridSettings.columns*(h+o)/h)>0&&(i.layouts[d].gridSettings.columns=u)}this.removeUnusedWidgets(t)},t.prototype.getRootStateId=function(t){for(var e=0,n=Object.keys(t);e<n.length;e++){var i=n[e];if(t[i].root)return i}return Object.keys(t)[0]},t.prototype.getStateLayoutsData=function(t,e){var n=t.configuration.states[e];if(n){for(var i={},a=0,o=Object.keys(n.layouts);a<o.length;a++){var r=o[a],s=n.layouts[r];if(s){i[r]={widgetIds:[],widgetLayouts:{},gridSettings:{}};for(var l=0,c=Object.keys(s.widgets);l<c.length;l++){var d=c[l];i[r].widgetIds.push(d)}i[r].widgetLayouts=s.widgets,i[r].gridSettings=s.gridSettings}}return i}return null},t.prototype.getWidgetsArray=function(t){for(var e=[],n=t.configuration.widgets,i=0,a=Object.keys(n);i<a.length;i++){var o=n[a[i]];e.push(o)}return e},t.prototype.addWidgetToLayout=function(t,e,n,i,a,o,r,l){var c=t.configuration,d=c.states[e],u=d.layouts[n],h=Object.keys(d.layouts).length;i.id||(i.id=this.utils.guid()),c.widgets[i.id]||(c.widgets[i.id]=i);var p={sizeX:o?o.sizeX:i.sizeX,sizeY:o?o.sizeY:i.sizeY,mobileOrder:i.config.mobileOrder,mobileHeight:i.config.mobileHeight};Object(s.u)(a)&&(a=24);var m=u.gridSettings,g=24;if(m&&m.columns&&(g=m.columns),(g*=h)!==a){var f=g/a;p.sizeX*=f,p.sizeY*=f}if(r>-1&&l>-1)p.row=r,p.col=l;else{r=0;for(var b=0,y=Object.keys(u.widgets);b<y.length;b++){var v=y[b],w=u.widgets[v],x=(w.row?w.row:0)+(w.sizeY?w.sizeY:1);r=Math.max(r,x)}p.row=r,p.col=0}u.widgets[i.id]=p},t.prototype.removeWidgetFromLayout=function(t,e,n,i){delete t.configuration.states[e].layouts[n].widgets[i],this.removeUnusedWidgets(t)},t.prototype.isSingleLayoutDashboard=function(t){var e=t.configuration.states,n=Object.keys(e);if(1===n.length){var i=e[n[0]].layouts,a=Object.keys(i);if(1===a.length)return{state:n[0],layout:a[0]}}return null},t.prototype.updateLayoutSettings=function(t,e){var n=t.gridSettings,i=n?n.columns:24;i||(i=24);var a=e.columns||24,o=a/i;t.gridSettings=e;for(var r=0,s=0,l=Object.keys(t.widgets);s<l.length;s++){var c=l[s];(p=t.widgets[c]).sizeX||(p.sizeX=1),p.sizeY||(p.sizeY=1),r=Math.max(r,p.row+p.sizeY)}for(var d=Math.round(r*o),u=0,h=Object.keys(t.widgets);u<h.length;u++){var p;c=h[u];(p=t.widgets[c]).row+p.sizeY===r?(p.row=Math.round(p.row*o),p.sizeY=d-p.row):(p.row=Math.round(p.row*o),p.sizeY=Math.round(p.sizeY*o)),p.sizeX=Math.round(p.sizeX*o),p.col=Math.round(p.col*o),p.col+p.sizeX>a&&(p.sizeX=a-p.col)}},t.prototype.removeUnusedWidgets=function(t){for(var e=t.configuration,n=e.states,i=e.widgets,a=0,o=Object.keys(i);a<o.length;a++){for(var r=o[a],s=!1,l=0,c=Object.keys(n);l<c.length;l++)for(var d=n[c[l]],u=0,h=Object.keys(d.layouts);u<h.length;u++){var p=h[u];if(d.layouts[p].widgets[r]){s=!0;break}}s||delete e.widgets[r]}},t.prototype.validateAndUpdateEntityAliases=function(t,e,n){var i;if(Object(s.u)(t.entityAliases)){if(t.entityAliases={},t.deviceAliases){for(var a=t.deviceAliases,o=0,r=Object.keys(a);o<r.length;o++){var l=a[h=r[o]];i=this.validateAndUpdateDeviceAlias(h,l,e,n),t.entityAliases[i.id]=i}delete t.deviceAliases}}else for(var c=t.entityAliases,d=0,u=Object.keys(c);d<u.length;d++){var h;i=c[h=u[d]],h!==(i=this.validateAndUpdateEntityAlias(h,i,e,n)).id&&delete c[h],c[i.id]=i}return t},t.prototype.validateAndUpdateDeviceAlias=function(t,e,n,i){var a={id:t=this.validateAliasId(t,n,i),alias:e.alias,filter:{type:null,entityType:c.b.DEVICE,resolveMultiple:!1}};return e.deviceFilter?(a.filter.type=e.deviceFilter.useFilter?d.a.entityName:d.a.entityList,a.filter.type===d.a.entityList?a.filter.entityList=e.deviceFilter.deviceList:a.filter.entityNameFilter=e.deviceFilter.deviceNameFilter):(a.filter.type=d.a.entityList,a.filter.entityList=[e.deviceId]),a},t.prototype.validateAndUpdateEntityAlias=function(t,e,n,i){return e.id=this.validateAliasId(t,n,i),e.filter||(e.filter={type:e.entityFilter.useFilter?d.a.entityName:d.a.entityList,entityType:e.entityType,resolveMultiple:!1},e.filter.type===d.a.entityList?e.filter.entityList=e.entityFilter.entityList:e.filter.entityNameFilter=e.entityFilter.entityNameFilter,delete e.entityType,delete e.entityFilter),e},t.prototype.validateAliasId=function(t,e,n){if(t&&Object(s.t)(t)&&36===t.length)return t;var i=this.utils.guid(),a=e[t];a&&a.forEach((function(t){t.entityAliasId=i}));var o=n[t];return o&&o.forEach((function(t){t[0]=i})),i},t.ctorParameters=function(){return[{type:o.a},{type:r.a}]},t=Object(i.c)([Object(a.Injectable)({providedIn:"root"}),Object(i.g)("design:paramtypes",[o.a,r.a])],t)}()},"58+T":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<mat-tab-group class="tb-datakey-config" [ngClass]="{\'tb-headless\': !displayAdvanced}">\n  <mat-tab [formGroup]="dataKeyFormGroup" label="{{ \'datakey.settings\' | translate }}">\n    <div class="mat-padding settings" fxLayout="column">\n      <mat-form-field class="mat-block" *ngIf="modelValue.type !== dataKeyTypes.function">\n        <mat-label>{{ \'entity.key\' | translate }}</mat-label>\n        <input matInput type="text" placeholder="{{ \'entity.key-name\' | translate }}"\n               #keyInput\n               formControlName="name"\n               required\n               [matAutocomplete]="keyAutocomplete">\n        <button *ngIf="dataKeyFormGroup.get(\'name\').value"\n                type="button"\n                matSuffix mat-icon-button aria-label="Clear"\n                (click)="clearKey()">\n          <mat-icon class="material-icons">close</mat-icon>\n        </button>\n        <mat-autocomplete\n          class="tb-autocomplete"\n          #keyAutocomplete="matAutocomplete">\n          <mat-option *ngFor="let key of filteredKeys | async" [value]="key">\n            <span [innerHTML]="key | highlight:keySearchText"></span>\n          </mat-option>\n        </mat-autocomplete>\n      </mat-form-field>\n      <div fxLayout="row" fxLayout.xs="column" fxLayoutAlign="start center" fxLayoutAlign.xs fxLayoutGap="8px">\n        <mat-form-field fxFlex class="mat-block">\n          <mat-label translate>datakey.label</mat-label>\n          <input matInput formControlName="label" required>\n        </mat-form-field>\n        <tb-color-input fxFlex\n          required\n          label="{{\'datakey.color\' | translate}}"\n          icon="format_color_fill"\n          openOnInput\n          formControlName="color">\n        </tb-color-input>\n      </div>\n      <div fxLayout="row" fxLayout.xs="column" fxLayoutAlign="start center" fxLayoutAlign.xs fxLayoutGap="8px" *ngIf="modelValue.type !== dataKeyTypes.alarm">\n        <mat-form-field fxFlex>\n          <mat-label translate>datakey.units</mat-label>\n          <input matInput formControlName="units">\n        </mat-form-field>\n        <mat-form-field fxFlex>\n          <mat-label translate>datakey.decimals</mat-label>\n          <input matInput formControlName="decimals" type="number" min="0" max="15" step="1">\n        </mat-form-field>\n      </div>\n      <section fxLayout="column" *ngIf="modelValue.type === dataKeyTypes.function">\n        <span translate>datakey.data-generation-func</span>\n        <br/>\n        <tb-js-func #funcBodyEdit\n          [functionArgs]="[\'time\', \'prevValue\']"\n          [validationArgs]="[[1, 1],[1, \'1\']]"\n          resultType="any"\n          formControlName="funcBody">\n        </tb-js-func>\n      </section>\n      <section fxLayout="column" *ngIf="modelValue.type === dataKeyTypes.timeseries || modelValue.type === dataKeyTypes.attribute">\n        <mat-checkbox formControlName="usePostProcessing">\n          {{ \'datakey.use-data-post-processing-func\' | translate }}\n        </mat-checkbox>\n        <tb-js-func *ngIf="dataKeyFormGroup.get(\'usePostProcessing\').value" #postFuncBodyEdit\n                    [functionArgs]="[\'time\', \'value\', \'prevValue\', \'timePrev\', \'prevOrigValue\']"\n                    [validationArgs]="[[1, 1, 1, 1, 1],[1, \'1\', \'1\', 1, \'1\']]"\n                    resultType="any"\n                    formControlName="postFuncBody">\n        </tb-js-func>\n        <label *ngIf="dataKeyFormGroup.get(\'usePostProcessing\').value" class="tb-title" style="margin-left: 15px;">\n          time - {{ \'datakey.time-description\' | translate }}<br/>\n          value - {{ \'datakey.value-description\' | translate }}<br/>\n          prevValue - {{ \'datakey.prev-value-description\' | translate }}<br/>\n          timePrev - {{ \'datakey.time-prev-description\' | translate }}<br/>\n          prevOrigValue - {{ \'datakey.prev-orig-value-description\' | translate }}\n        </label>\n      </section>\n    </div>\n  </mat-tab>\n  <mat-tab [formGroup]="dataKeySettingsFormGroup" label="{{ \'datakey.advanced\' | translate }}" *ngIf="displayAdvanced">\n    <div class="mat-padding" fxLayout="column">\n      <tb-json-form\n        formControlName="settings">\n      </tb-json-form>\n    </div>\n  </mat-tab>\n</mat-tab-group>\n'},"5FVY":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div class="tb-dashboard-page mat-content" style="padding-top: 150px;"\n     fxFlex tb-fullscreen [fullscreen]="widgetEditMode || iframeMode || forceFullscreen || isFullscreen">\n  <tb-hotkeys-cheatsheet #cheatSheetComponent></tb-hotkeys-cheatsheet>\n  <section class="tb-dashboard-toolbar"\n           [ngClass]="{ \'tb-dashboard-toolbar-opened\': toolbarOpened,\n                        \'tb-dashboard-toolbar-closed\': !toolbarOpened }">\n    <tb-dashboard-toolbar [fxShow]="!widgetEditMode" [forceFullscreen]="forceFullscreen"\n                          [toolbarOpened]="toolbarOpened" (triggerClick)="openToolbar()">\n      <div class="tb-dashboard-action-panels" fxLayout="column" fxLayout.gt-sm="row"\n           fxLayoutAlign="center stretch" fxLayoutAlign.gt-sm="space-between center">\n        <div class="tb-dashboard-action-panel" fxFlex="auto" fxLayout="row-reverse"\n             fxLayoutAlign.gt-sm="end center" fxLayoutAlign="space-between center" fxLayoutGap="12px">\n          <tb-user-menu *ngIf="!isPublicUser() && forceFullscreen" fxHide.gt-sm displayUserInfo="true">\n          </tb-user-menu>\n          <div [fxShow]="isEdit"\n               fxFlex.lt-md fxLayout="row"\n               fxLayoutAlign.gt-sm="start center"\n               fxLayoutAlign="end center" fxLayoutGap="12px">\n            <button mat-icon-button\n                    matTooltip="{{\'dashboard.manage-states\' | translate}}"\n                    matTooltipPosition="below"\n                    (click)="manageDashboardStates($event)">\n              <mat-icon>layers</mat-icon>\n            </button>\n            <button mat-icon-button\n                    matTooltip="{{\'layout.manage\' | translate}}"\n                    matTooltipPosition="below"\n                    (click)="manageDashboardLayouts($event)">\n              <mat-icon>view_compact</mat-icon>\n            </button>\n          </div>\n          <tb-states-component fxFlex.lt-md\n                               [statesControllerId]="isEdit ? \'default\' : dashboardConfiguration.settings.stateControllerId"\n                               [dashboardCtrl]="this"\n                               [dashboardId]="dashboard.id ? dashboard.id.id : \'\'"\n                               [isMobile]="isMobile"\n                               [state]="dashboardCtx.state"\n                               [states]="dashboardConfiguration.states">\n          </tb-states-component>\n        </div>\n        <div class="tb-dashboard-action-panel" fxFlex="1 0 auto" fxLayout="row-reverse"\n             fxLayoutAlign.gt-sm="start center" fxLayoutAlign="space-between center" fxLayoutGap="12px">\n          <button [fxShow]="showCloseToolbar()" mat-icon-button class="close-action"\n                  matTooltip="{{ \'dashboard.close-toolbar\' | translate }}"\n                  matTooltipPosition="below"\n                  (click)="closeToolbar()">\n            <mat-icon>arrow_forward</mat-icon>\n          </button>\n          <tb-user-menu *ngIf="!isPublicUser() && forceFullscreen" fxHide.lt-md displayUserInfo="true">\n          </tb-user-menu>\n          <button [fxShow]="showRightLayoutSwitch()" mat-icon-button\n                  matTooltip="{{ (isRightLayoutOpened ? \'dashboard.hide-details\' : \'dashboard.show-details\') | translate }}"\n                  matTooltipPosition="below"\n                  (click)="toggleLayouts()">\n            <mat-icon>{{isRightLayoutOpened ? \'arrow_back\' : \'menu\'}}</mat-icon>\n          </button>\n          <button [fxShow]="!hideFullscreenButton()" mat-icon-button\n                  matTooltip="{{(isFullscreen ? \'fullscreen.exit\' : \'fullscreen.expand\') | translate}}"\n                  matTooltipPosition="below"\n                  (click)="isFullscreen = !isFullscreen">\n            <mat-icon>{{ isFullscreen ? \'fullscreen_exit\' : \'fullscreen\' }}</mat-icon>\n          </button>\n          <button [fxShow]="isEdit || displayExport()" mat-icon-button\n                  matTooltip="{{\'dashboard.export\' | translate}}"\n                  matTooltipPosition="below"\n                  (click)="exportDashboard($event)">\n            <mat-icon>file_download</mat-icon>\n          </button>\n          <tb-timewindow [fxShow]="isEdit || displayDashboardTimewindow()"\n                         isToolbar="true"\n                         [isEdit]="isEdit"\n                         direction="left"\n                         tooltipPosition="below"\n                         aggregation="true"\n                         [(ngModel)]="dashboardCtx.dashboardTimewindow">\n          </tb-timewindow>\n          <tb-aliases-entity-select [fxShow]="!isEdit && displayEntitiesSelect()"\n                                    tooltipPosition="below"\n                                    [aliasController]="dashboardCtx.aliasController">\n          </tb-aliases-entity-select>\n          <button [fxShow]="isEdit" mat-icon-button\n                  matTooltip="{{ \'entity.aliases\' | translate }}"\n                  matTooltipPosition="below"\n                  (click)="openEntityAliases($event)">\n            <mat-icon>devices_other</mat-icon>\n          </button>\n          <button [fxShow]="isEdit" mat-icon-button\n                  matTooltip="{{ \'dashboard.settings\' | translate }}"\n                  matTooltipPosition="below"\n                  (click)="openDashboardSettings($event)">\n            <mat-icon>settings</mat-icon>\n          </button>\n          <tb-dashboard-select [fxShow]="!isEdit && !widgetEditMode && displayDashboardsSelect()"\n                               [(ngModel)]="currentDashboardId"\n                               (ngModelChange)="currentDashboardIdChanged(currentDashboardId)"\n                               [customerId]="currentCustomerId"\n                               [dashboardsScope]="currentDashboardScope">\n          </tb-dashboard-select>\n        </div>\n      </div>\n    </tb-dashboard-toolbar>\n  </section>\n  <section class="tb-dashboard-container tb-absolute-fill"\n           [ngClass]="{ \'is-fullscreen\': forceFullscreen,\n           \'tb-dashboard-toolbar-opened\': toolbarOpened,\n           \'tb-dashboard-toolbar-animated\': isToolbarOpenedAnimate,\n           \'tb-dashboard-toolbar-closed\': !toolbarOpened }">\n    <mat-drawer-container hasBackdrop="false" class="tb-absolute-fill tb-dashboard-drawer-container">\n      <mat-drawer-content fxLayout="column" fxLayoutAlign="center start">\n        <section *ngIf="!widgetEditMode" class="tb-dashboard-title"\n                 [ngStyle]="{\'color\': dashboard.configuration.settings.titleColor}">\n          <h3 [fxShow]="!isEdit && displayTitle()">{{ dashboard.title }}</h3>\n          <mat-form-field [fxShow]="isEdit" class="mat-block">\n            <mat-label translate [ngStyle]="{\'color\': dashboard.configuration.settings.titleColor}">dashboard.title</mat-label>\n            <input matInput class="tb-dashboard-title"\n                   [ngStyle]="{\'color\': dashboard.configuration.settings.titleColor}"\n                   required name="title" [(ngModel)]="dashboard.title">\n          </mat-form-field>\n        </section>\n        <mat-drawer-container class="tb-dashboard-layouts" fxFlex\n                              [ngClass]="{ \'tb-shrinked\' : isEditingWidget }">\n          <mat-drawer *ngIf="layouts.right.show"\n                      id="tb-right-layout"\n                      [ngStyle]="{minWidth: rightLayoutWidth(),\n                                  maxWidth: rightLayoutWidth(),\n                                  height: rightLayoutHeight(),\n                                  borderLeft: \'none\'}"\n              disableClose="true"\n              [@.disabled]="!isMobile"\n              position="end"\n              [mode]="isMobile ? \'over\' : \'side\'"\n              [(opened)]="rightLayoutOpened">\n            <tb-dashboard-layout style="height: 100%;"\n              [dashboardCheatSheet]="cheatSheetComponent"\n              [layoutCtx]="layouts.right.layoutCtx"\n              [dashboardCtx]="dashboardCtx"\n              [isEdit]="isEdit"\n              [isEditingWidget]="isEditingWidget"\n              [isMobile]="forceDashboardMobileMode"\n              [widgetEditMode]="widgetEditMode">\n            </tb-dashboard-layout>\n          </mat-drawer>\n          <mat-drawer-content [fxShow]="layouts.main.show"\n                              id="tb-main-layout"\n                              [ngStyle]="{width: mainLayoutWidth(),\n                              height: mainLayoutHeight()}">\n            <tb-dashboard-layout\n              [dashboardCheatSheet]="cheatSheetComponent"\n              [layoutCtx]="layouts.main.layoutCtx"\n              [dashboardCtx]="dashboardCtx"\n              [isEdit]="isEdit"\n              [isEditingWidget]="isEditingWidget"\n              [isMobile]="forceDashboardMobileMode"\n              [widgetEditMode]="widgetEditMode">\n            </tb-dashboard-layout>\n          </mat-drawer-content>\n        </mat-drawer-container>\n        <section fxLayout="row" class="layout-wrap tb-footer-buttons" fxLayoutAlign="start end">\n          <tb-footer-fab-buttons [fxShow]="!isAddingWidget && isEdit && !widgetEditMode"\n                                 relative\n                                 [footerFabButtons]="addWidgetFabButtons">\n          </tb-footer-fab-buttons>\n          <button *ngIf="(isTenantAdmin() || isSystemAdmin()) && !forceFullscreen"\n                  mat-fab color="accent" class="tb-btn-footer"\n                  [ngClass]="{\'tb-hide\': !isEdit || isAddingWidget}"\n                  [disabled]="isLoading$ | async"\n                  (click)="saveDashboard()"\n                  matTooltip="{{ \'action.apply-changes\' | translate }}"\n                  matTooltipPosition="above">\n            <mat-icon>done</mat-icon>\n          </button>\n          <button *ngIf="(isTenantAdmin() || isSystemAdmin()) && !forceFullscreen"\n                  mat-fab color="accent" class="tb-btn-footer"\n                  [ngClass]="{\'tb-hide\': isAddingWidget || (isLoading$ | async)}"\n                  [disabled]="isLoading$ | async"\n                  (click)="toggleDashboardEditMode()"\n                  matTooltip="{{ (isEdit ? \'action.decline-changes\': \'action.enter-edit-mode\') | translate }}"\n                  matTooltipPosition="above">\n            <mat-icon>{{ isEdit ? \'close\' : \'edit\' }}</mat-icon>\n          </button>\n        </section>\n        <section class="tb-powered-by-footer" [ngStyle]="{\'color\': dashboard.configuration.settings.titleColor}">\n          <span>Powered by <a href="https://thingsboard.io" target="_blank">Thingsboard v.{{ thingsboardVersion }}</a></span>\n        </section>\n      </mat-drawer-content>\n      <mat-drawer class="tb-details-drawer"\n                  [opened]="isEditingWidget || isAddingWidget"\n                  (openedStart)="detailsDrawerOpenedStart()"\n                  (opened)="detailsDrawerOpened()"\n                  (closedStart)="detailsDrawerClosedStart()"\n                  (closed)="detailsDrawerClosed()"\n                  mode="over"\n                  position="end">\n        <tb-details-panel *ngIf="!isEditingWidgetClosed" fxFlex\n                          headerTitle="{{editingWidget?.config.title}}"\n                          headerSubtitle="{{ editingWidgetSubtitle }}"\n                          [isReadOnly]="false"\n                          [isAlwaysEdit]="true"\n                          (closeDetails)="onEditWidgetClosed()"\n                          (toggleDetailsEditMode)="onRevertWidgetEdit()"\n                          (applyDetails)="saveWidget()"\n                          [theForm]="tbEditWidget.widgetFormGroup">\n          <div class="details-buttons">\n            <div [tb-help]="helpLinkIdForWidgetType()"></div>\n          </div>\n          <tb-edit-widget #tbEditWidget\n                          [dashboard]="dashboard"\n                          [aliasController]="dashboardCtx.aliasController"\n                          [widgetEditMode]="widgetEditMode"\n                          [widget]="editingWidget"\n                          [widgetLayout]="editingWidgetLayout">\n          </tb-edit-widget>\n        </tb-details-panel>\n        <tb-details-panel *ngIf="!isAddingWidgetClosed && !widgetEditMode" fxFlex\n                          headerTitle="{{\'dashboard.select-widget-title\' | translate}}"\n                          headerHeightPx="120"\n                          [isReadOnly]="true"\n                          [isEdit]="false"\n                          (closeDetails)="onAddWidgetClosed()">\n          <div class="header-pane" *ngIf="isAddingWidget">\n            <div fxLayout="row">\n              <span class="tb-details-subtitle">{{ \'widgets-bundle.current\' | translate }}</span>\n              <tb-widgets-bundle-select fxFlexOffset="5"\n                                        fxFlex\n                                        required\n                                        [selectFirstBundle]="false"\n                                        [ngModel]="widgetsBundle"\n                                        (ngModelChange)="widgetsBundle = $event">\n              </tb-widgets-bundle-select>\n            </div>\n          </div>\n          <tb-dashboard-widget-select *ngIf="isAddingWidget"\n                                      [aliasController]="dashboardCtx.aliasController"\n                                      [widgetsBundle]="widgetsBundle"\n                                      (widgetSelected)="addWidgetFromType($event)">\n          </tb-dashboard-widget-select>\n        </tb-details-panel>\n      </mat-drawer>\n    </mat-drawer-container>\n  </section>\n</div>\n'},"5eAj":function(t,e,n){var i,a,o;a=[n("4R65")],void 0===(o="function"==typeof(i=function(t){"use strict";return t.TileLayer.Provider=t.TileLayer.extend({initialize:function(e,n){var i=t.TileLayer.Provider.providers,a=e.split("."),o=a[0],r=a[1];if(!i[o])throw"No such provider ("+o+")";var s={url:i[o].url,options:i[o].options};if(r&&"variants"in i[o]){if(!(r in i[o].variants))throw"No such variant of "+o+" ("+r+")";var l,c=i[o].variants[r];l="string"==typeof c?{variant:c}:c.options,s={url:c.url||s.url,options:t.Util.extend({},s.options,l)}}var d=function(t){return-1===t.indexOf("{attribution.")?t:t.replace(/\{attribution.(\w*)\}/g,(function(t,e){return d(i[e].options.attribution)}))};s.options.attribution=d(s.options.attribution);var u=t.Util.extend({},s.options,n);t.TileLayer.prototype.initialize.call(this,s.url,u)}}),t.TileLayer.Provider.providers={OpenStreetMap:{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",options:{maxZoom:19,attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'},variants:{Mapnik:{},DE:{url:"https://{s}.tile.openstreetmap.de/tiles/osmde/{z}/{x}/{y}.png",options:{maxZoom:18}},CH:{url:"https://tile.osm.ch/switzerland/{z}/{x}/{y}.png",options:{maxZoom:18,bounds:[[45,5],[48,11]]}},France:{url:"https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png",options:{maxZoom:20,attribution:"&copy; Openstreetmap France | {attribution.OpenStreetMap}"}},HOT:{url:"https://{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png",options:{attribution:'{attribution.OpenStreetMap}, Tiles style by <a href="https://www.hotosm.org/" target="_blank">Humanitarian OpenStreetMap Team</a> hosted by <a href="https://openstreetmap.fr/" target="_blank">OpenStreetMap France</a>'}},BZH:{url:"https://tile.openstreetmap.bzh/br/{z}/{x}/{y}.png",options:{attribution:'{attribution.OpenStreetMap}, Tiles courtesy of <a href="http://www.openstreetmap.bzh/" target="_blank">Breton OpenStreetMap Team</a>',bounds:[[46.2,-5.5],[50,.7]]}}}},OpenSeaMap:{url:"https://tiles.openseamap.org/seamark/{z}/{x}/{y}.png",options:{attribution:'Map data: &copy; <a href="http://www.openseamap.org">OpenSeaMap</a> contributors'}},OpenPtMap:{url:"http://openptmap.org/tiles/{z}/{x}/{y}.png",options:{maxZoom:17,attribution:'Map data: &copy; <a href="http://www.openptmap.org">OpenPtMap</a> contributors'}},OpenTopoMap:{url:"https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",options:{maxZoom:17,attribution:'Map data: {attribution.OpenStreetMap}, <a href="http://viewfinderpanoramas.org">SRTM</a> | Map style: &copy; <a href="https://opentopomap.org">OpenTopoMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'}},OpenRailwayMap:{url:"https://{s}.tiles.openrailwaymap.org/standard/{z}/{x}/{y}.png",options:{maxZoom:19,attribution:'Map data: {attribution.OpenStreetMap} | Map style: &copy; <a href="https://www.OpenRailwayMap.org">OpenRailwayMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'}},OpenFireMap:{url:"http://openfiremap.org/hytiles/{z}/{x}/{y}.png",options:{maxZoom:19,attribution:'Map data: {attribution.OpenStreetMap} | Map style: &copy; <a href="http://www.openfiremap.org">OpenFireMap</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'}},SafeCast:{url:"https://s3.amazonaws.com/te512.safecast.org/{z}/{x}/{y}.png",options:{maxZoom:16,attribution:'Map data: {attribution.OpenStreetMap} | Map style: &copy; <a href="https://blog.safecast.org/about/">SafeCast</a> (<a href="https://creativecommons.org/licenses/by-sa/3.0/">CC-BY-SA</a>)'}},Stadia:{url:"https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png",options:{maxZoom:20,attribution:'&copy; <a href="https://stadiamaps.com/">Stadia Maps</a>, &copy; <a href="https://openmaptiles.org/">OpenMapTiles</a> &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors'},variants:{AlidadeSmooth:{url:"https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}{r}.png"},AlidadeSmoothDark:{url:"https://tiles.stadiamaps.com/tiles/alidade_smooth_dark/{z}/{x}/{y}{r}.png"},OSMBright:{url:"https://tiles.stadiamaps.com/tiles/osm_bright/{z}/{x}/{y}{r}.png"},Outdoors:{url:"https://tiles.stadiamaps.com/tiles/outdoors/{z}/{x}/{y}{r}.png"}}},Thunderforest:{url:"https://{s}.tile.thunderforest.com/{variant}/{z}/{x}/{y}.png?apikey={apikey}",options:{attribution:'&copy; <a href="http://www.thunderforest.com/">Thunderforest</a>, {attribution.OpenStreetMap}',variant:"cycle",apikey:"<insert your api key here>",maxZoom:22},variants:{OpenCycleMap:"cycle",Transport:{options:{variant:"transport"}},TransportDark:{options:{variant:"transport-dark"}},SpinalMap:{options:{variant:"spinal-map"}},Landscape:"landscape",Outdoors:"outdoors",Pioneer:"pioneer",MobileAtlas:"mobile-atlas",Neighbourhood:"neighbourhood"}},CyclOSM:{url:"https://dev.{s}.tile.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png",options:{maxZoom:20,attribution:'<a href="https://github.com/cyclosm/cyclosm-cartocss-style/releases" title="CyclOSM - Open Bicycle render">CyclOSM</a> | Map data: {attribution.OpenStreetMap}'}},Hydda:{url:"https://{s}.tile.openstreetmap.se/hydda/{variant}/{z}/{x}/{y}.png",options:{maxZoom:20,variant:"full",attribution:'Tiles courtesy of <a href="http://openstreetmap.se/" target="_blank">OpenStreetMap Sweden</a> &mdash; Map data {attribution.OpenStreetMap}'},variants:{Full:"full",Base:"base",RoadsAndLabels:"roads_and_labels"}},Jawg:{url:"https://{s}.tile.jawg.io/{variant}/{z}/{x}/{y}{r}.png?access-token={accessToken}",options:{attribution:'<a href="http://jawg.io" title="Tiles Courtesy of Jawg Maps" target="_blank">&copy; <b>Jawg</b>Maps</a> {attribution.OpenStreetMap}',minZoom:0,maxZoom:22,subdomains:"abcd",variant:"jawg-terrain",accessToken:"<insert your access token here>"},variants:{Streets:"jawg-streets",Terrain:"jawg-terrain",Sunny:"jawg-sunny",Dark:"jawg-dark",Light:"jawg-light",Matrix:"jawg-matrix"}},MapBox:{url:"https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}{r}?access_token={accessToken}",options:{attribution:'&copy; <a href="https://www.mapbox.com/about/maps/" target="_blank">Mapbox</a> {attribution.OpenStreetMap} <a href="https://www.mapbox.com/map-feedback/" target="_blank">Improve this map</a>',tileSize:512,maxZoom:18,zoomOffset:-1,id:"mapbox/streets-v11",accessToken:"<insert your access token here>"}},MapTiler:{url:"https://api.maptiler.com/maps/{variant}/{z}/{x}/{y}{r}.{ext}?key={key}",options:{attribution:'<a href="https://www.maptiler.com/copyright/" target="_blank">&copy; MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">&copy; OpenStreetMap contributors</a>',variant:"streets",ext:"png",key:"<insert your MapTiler Cloud API key here>",tileSize:512,zoomOffset:-1,minZoom:0,maxZoom:21},variants:{Streets:"streets",Basic:"basic",Bright:"bright",Pastel:"pastel",Positron:"positron",Hybrid:{options:{variant:"hybrid",ext:"jpg"}},Toner:"toner",Topo:"topo",Voyager:"voyager"}},Stamen:{url:"https://stamen-tiles-{s}.a.ssl.fastly.net/{variant}/{z}/{x}/{y}{r}.{ext}",options:{attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data {attribution.OpenStreetMap}',subdomains:"abcd",minZoom:0,maxZoom:20,variant:"toner",ext:"png"},variants:{Toner:"toner",TonerBackground:"toner-background",TonerHybrid:"toner-hybrid",TonerLines:"toner-lines",TonerLabels:"toner-labels",TonerLite:"toner-lite",Watercolor:{url:"https://stamen-tiles-{s}.a.ssl.fastly.net/{variant}/{z}/{x}/{y}.{ext}",options:{variant:"watercolor",ext:"jpg",minZoom:1,maxZoom:16}},Terrain:{options:{variant:"terrain",minZoom:0,maxZoom:18}},TerrainBackground:{options:{variant:"terrain-background",minZoom:0,maxZoom:18}},TerrainLabels:{options:{variant:"terrain-labels",minZoom:0,maxZoom:18}},TopOSMRelief:{url:"https://stamen-tiles-{s}.a.ssl.fastly.net/{variant}/{z}/{x}/{y}.{ext}",options:{variant:"toposm-color-relief",ext:"jpg",bounds:[[22,-132],[51,-56]]}},TopOSMFeatures:{options:{variant:"toposm-features",bounds:[[22,-132],[51,-56]],opacity:.9}}}},TomTom:{url:"https://{s}.api.tomtom.com/map/1/tile/{variant}/{style}/{z}/{x}/{y}.{ext}?key={apikey}",options:{variant:"basic",maxZoom:22,attribution:'<a href="https://tomtom.com" target="_blank">&copy;  1992 - '+(new Date).getFullYear()+" TomTom.</a> ",subdomains:"abcd",style:"main",ext:"png",apikey:"<insert your API key here>"},variants:{Basic:"basic",Hybrid:"hybrid",Labels:"labels"}},Esri:{url:"https://server.arcgisonline.com/ArcGIS/rest/services/{variant}/MapServer/tile/{z}/{y}/{x}",options:{variant:"World_Street_Map",attribution:"Tiles &copy; Esri"},variants:{WorldStreetMap:{options:{attribution:"{attribution.Esri} &mdash; Source: Esri, DeLorme, NAVTEQ, USGS, Intermap, iPC, NRCAN, Esri Japan, METI, Esri China (Hong Kong), Esri (Thailand), TomTom, 2012"}},DeLorme:{options:{variant:"Specialty/DeLorme_World_Base_Map",minZoom:1,maxZoom:11,attribution:"{attribution.Esri} &mdash; Copyright: &copy;2012 DeLorme"}},WorldTopoMap:{options:{variant:"World_Topo_Map",attribution:"{attribution.Esri} &mdash; Esri, DeLorme, NAVTEQ, TomTom, Intermap, iPC, USGS, FAO, NPS, NRCAN, GeoBase, Kadaster NL, Ordnance Survey, Esri Japan, METI, Esri China (Hong Kong), and the GIS User Community"}},WorldImagery:{options:{variant:"World_Imagery",attribution:"{attribution.Esri} &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"}},WorldTerrain:{options:{variant:"World_Terrain_Base",maxZoom:13,attribution:"{attribution.Esri} &mdash; Source: USGS, Esri, TANA, DeLorme, and NPS"}},WorldShadedRelief:{options:{variant:"World_Shaded_Relief",maxZoom:13,attribution:"{attribution.Esri} &mdash; Source: Esri"}},WorldPhysical:{options:{variant:"World_Physical_Map",maxZoom:8,attribution:"{attribution.Esri} &mdash; Source: US National Park Service"}},OceanBasemap:{options:{variant:"Ocean_Basemap",maxZoom:13,attribution:"{attribution.Esri} &mdash; Sources: GEBCO, NOAA, CHS, OSU, UNH, CSUMB, National Geographic, DeLorme, NAVTEQ, and Esri"}},NatGeoWorldMap:{options:{variant:"NatGeo_World_Map",maxZoom:16,attribution:"{attribution.Esri} &mdash; National Geographic, Esri, DeLorme, NAVTEQ, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, iPC"}},WorldGrayCanvas:{options:{variant:"Canvas/World_Light_Gray_Base",maxZoom:16,attribution:"{attribution.Esri} &mdash; Esri, DeLorme, NAVTEQ"}}}},OpenWeatherMap:{url:"http://{s}.tile.openweathermap.org/map/{variant}/{z}/{x}/{y}.png?appid={apiKey}",options:{maxZoom:19,attribution:'Map data &copy; <a href="http://openweathermap.org">OpenWeatherMap</a>',apiKey:"<insert your api key here>",opacity:.5},variants:{Clouds:"clouds",CloudsClassic:"clouds_cls",Precipitation:"precipitation",PrecipitationClassic:"precipitation_cls",Rain:"rain",RainClassic:"rain_cls",Pressure:"pressure",PressureContour:"pressure_cntr",Wind:"wind",Temperature:"temp",Snow:"snow"}},HERE:{url:"https://{s}.{base}.maps.api.here.com/maptile/2.1/{type}/{mapID}/{variant}/{z}/{x}/{y}/{size}/{format}?app_id={app_id}&app_code={app_code}&lg={language}",options:{attribution:"Map &copy; 1987-"+(new Date).getFullYear()+' <a href="http://developer.here.com">HERE</a>',subdomains:"1234",mapID:"newest",app_id:"<insert your app_id here>",app_code:"<insert your app_code here>",base:"base",variant:"normal.day",maxZoom:20,type:"maptile",language:"eng",format:"png8",size:"256"},variants:{normalDay:"normal.day",normalDayCustom:"normal.day.custom",normalDayGrey:"normal.day.grey",normalDayMobile:"normal.day.mobile",normalDayGreyMobile:"normal.day.grey.mobile",normalDayTransit:"normal.day.transit",normalDayTransitMobile:"normal.day.transit.mobile",normalDayTraffic:{options:{variant:"normal.traffic.day",base:"traffic",type:"traffictile"}},normalNight:"normal.night",normalNightMobile:"normal.night.mobile",normalNightGrey:"normal.night.grey",normalNightGreyMobile:"normal.night.grey.mobile",normalNightTransit:"normal.night.transit",normalNightTransitMobile:"normal.night.transit.mobile",reducedDay:"reduced.day",reducedNight:"reduced.night",basicMap:{options:{type:"basetile"}},mapLabels:{options:{type:"labeltile",format:"png"}},trafficFlow:{options:{base:"traffic",type:"flowtile"}},carnavDayGrey:"carnav.day.grey",hybridDay:{options:{base:"aerial",variant:"hybrid.day"}},hybridDayMobile:{options:{base:"aerial",variant:"hybrid.day.mobile"}},hybridDayTransit:{options:{base:"aerial",variant:"hybrid.day.transit"}},hybridDayGrey:{options:{base:"aerial",variant:"hybrid.grey.day"}},hybridDayTraffic:{options:{variant:"hybrid.traffic.day",base:"traffic",type:"traffictile"}},pedestrianDay:"pedestrian.day",pedestrianNight:"pedestrian.night",satelliteDay:{options:{base:"aerial",variant:"satellite.day"}},terrainDay:{options:{base:"aerial",variant:"terrain.day"}},terrainDayMobile:{options:{base:"aerial",variant:"terrain.day.mobile"}}}},HEREv3:{url:"https://{s}.{base}.maps.ls.hereapi.com/maptile/2.1/{type}/{mapID}/{variant}/{z}/{x}/{y}/{size}/{format}?apiKey={apiKey}&lg={language}",options:{attribution:"Map &copy; 1987-"+(new Date).getFullYear()+' <a href="http://developer.here.com">HERE</a>',subdomains:"1234",mapID:"newest",apiKey:"<insert your apiKey here>",base:"base",variant:"normal.day",maxZoom:20,type:"maptile",language:"eng",format:"png8",size:"256"},variants:{normalDay:"normal.day",normalDayCustom:"normal.day.custom",normalDayGrey:"normal.day.grey",normalDayMobile:"normal.day.mobile",normalDayGreyMobile:"normal.day.grey.mobile",normalDayTransit:"normal.day.transit",normalDayTransitMobile:"normal.day.transit.mobile",normalNight:"normal.night",normalNightMobile:"normal.night.mobile",normalNightGrey:"normal.night.grey",normalNightGreyMobile:"normal.night.grey.mobile",normalNightTransit:"normal.night.transit",normalNightTransitMobile:"normal.night.transit.mobile",reducedDay:"reduced.day",reducedNight:"reduced.night",basicMap:{options:{type:"basetile"}},mapLabels:{options:{type:"labeltile",format:"png"}},trafficFlow:{options:{base:"traffic",type:"flowtile"}},carnavDayGrey:"carnav.day.grey",hybridDay:{options:{base:"aerial",variant:"hybrid.day"}},hybridDayMobile:{options:{base:"aerial",variant:"hybrid.day.mobile"}},hybridDayTransit:{options:{base:"aerial",variant:"hybrid.day.transit"}},hybridDayGrey:{options:{base:"aerial",variant:"hybrid.grey.day"}},pedestrianDay:"pedestrian.day",pedestrianNight:"pedestrian.night",satelliteDay:{options:{base:"aerial",variant:"satellite.day"}},terrainDay:{options:{base:"aerial",variant:"terrain.day"}},terrainDayMobile:{options:{base:"aerial",variant:"terrain.day.mobile"}}}},FreeMapSK:{url:"http://t{s}.freemap.sk/T/{z}/{x}/{y}.jpeg",options:{minZoom:8,maxZoom:16,subdomains:"1234",bounds:[[47.204642,15.996093],[49.830896,22.576904]],attribution:'{attribution.OpenStreetMap}, vizualization CC-By-SA 2.0 <a href="http://freemap.sk">Freemap.sk</a>'}},MtbMap:{url:"http://tile.mtbmap.cz/mtbmap_tiles/{z}/{x}/{y}.png",options:{attribution:"{attribution.OpenStreetMap} &amp; USGS"}},CartoDB:{url:"https://{s}.basemaps.cartocdn.com/{variant}/{z}/{x}/{y}{r}.png",options:{attribution:'{attribution.OpenStreetMap} &copy; <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd",maxZoom:19,variant:"light_all"},variants:{Positron:"light_all",PositronNoLabels:"light_nolabels",PositronOnlyLabels:"light_only_labels",DarkMatter:"dark_all",DarkMatterNoLabels:"dark_nolabels",DarkMatterOnlyLabels:"dark_only_labels",Voyager:"rastertiles/voyager",VoyagerNoLabels:"rastertiles/voyager_nolabels",VoyagerOnlyLabels:"rastertiles/voyager_only_labels",VoyagerLabelsUnder:"rastertiles/voyager_labels_under"}},HikeBike:{url:"https://tiles.wmflabs.org/{variant}/{z}/{x}/{y}.png",options:{maxZoom:19,attribution:"{attribution.OpenStreetMap}",variant:"hikebike"},variants:{HikeBike:{},HillShading:{options:{maxZoom:15,variant:"hillshading"}}}},BasemapAT:{url:"https://maps{s}.wien.gv.at/basemap/{variant}/{type}/google3857/{z}/{y}/{x}.{format}",options:{maxZoom:19,attribution:'Datenquelle: <a href="https://www.basemap.at">basemap.at</a>',subdomains:["","1","2","3","4"],type:"normal",format:"png",bounds:[[46.35877,8.782379],[49.037872,17.189532]],variant:"geolandbasemap"},variants:{basemap:{options:{maxZoom:20,variant:"geolandbasemap"}},grau:"bmapgrau",overlay:"bmapoverlay",terrain:{options:{variant:"bmapgelaende",type:"grau",format:"jpeg"}},surface:{options:{variant:"bmapoberflaeche",type:"grau",format:"jpeg"}},highdpi:{options:{variant:"bmaphidpi",format:"jpeg"}},orthofoto:{options:{maxZoom:20,variant:"bmaporthofoto30cm",format:"jpeg"}}}},nlmaps:{url:"https://geodata.nationaalgeoregister.nl/tiles/service/wmts/{variant}/EPSG:3857/{z}/{x}/{y}.png",options:{minZoom:6,maxZoom:19,bounds:[[50.5,3.25],[54,7.6]],attribution:'Kaartgegevens &copy; <a href="kadaster.nl">Kadaster</a>'},variants:{standaard:"brtachtergrondkaart",pastel:"brtachtergrondkaartpastel",grijs:"brtachtergrondkaartgrijs",luchtfoto:{url:"https://geodata.nationaalgeoregister.nl/luchtfoto/rgb/wmts/2018_ortho25/EPSG:3857/{z}/{x}/{y}.png"}}},NASAGIBS:{url:"https://map1.vis.earthdata.nasa.gov/wmts-webmerc/{variant}/default/{time}/{tilematrixset}{maxZoom}/{z}/{y}/{x}.{format}",options:{attribution:'Imagery provided by services from the Global Imagery Browse Services (GIBS), operated by the NASA/GSFC/Earth Science Data and Information System (<a href="https://earthdata.nasa.gov">ESDIS</a>) with funding provided by NASA/HQ.',bounds:[[-85.0511287776,-179.999999975],[85.0511287776,179.999999975]],minZoom:1,maxZoom:9,format:"jpg",time:"",tilematrixset:"GoogleMapsCompatible_Level"},variants:{ModisTerraTrueColorCR:"MODIS_Terra_CorrectedReflectance_TrueColor",ModisTerraBands367CR:"MODIS_Terra_CorrectedReflectance_Bands367",ViirsEarthAtNight2012:{options:{variant:"VIIRS_CityLights_2012",maxZoom:8}},ModisTerraLSTDay:{options:{variant:"MODIS_Terra_Land_Surface_Temp_Day",format:"png",maxZoom:7,opacity:.75}},ModisTerraSnowCover:{options:{variant:"MODIS_Terra_Snow_Cover",format:"png",maxZoom:8,opacity:.75}},ModisTerraAOD:{options:{variant:"MODIS_Terra_Aerosol",format:"png",maxZoom:6,opacity:.75}},ModisTerraChlorophyll:{options:{variant:"MODIS_Terra_Chlorophyll_A",format:"png",maxZoom:7,opacity:.75}}}},NLS:{url:"https://nls-{s}.tileserver.com/nls/{z}/{x}/{y}.jpg",options:{attribution:'<a href="http://geo.nls.uk/maps/">National Library of Scotland Historic Maps</a>',bounds:[[49.6,-12],[61.7,3]],minZoom:1,maxZoom:18,subdomains:"0123"}},JusticeMap:{url:"http://www.justicemap.org/tile/{size}/{variant}/{z}/{x}/{y}.png",options:{attribution:'<a href="http://www.justicemap.org/terms.php">Justice Map</a>',size:"county",bounds:[[14,-180],[72,-56]]},variants:{income:"income",americanIndian:"indian",asian:"asian",black:"black",hispanic:"hispanic",multi:"multi",nonWhite:"nonwhite",white:"white",plurality:"plural"}},Wikimedia:{url:"https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png",options:{attribution:'<a href="https://wikimediafoundation.org/wiki/Maps_Terms_of_Use">Wikimedia</a>',minZoom:1,maxZoom:19}},GeoportailFrance:{url:"https://wxs.ign.fr/{apikey}/geoportail/wmts?REQUEST=GetTile&SERVICE=WMTS&VERSION=1.0.0&STYLE={style}&TILEMATRIXSET=PM&FORMAT={format}&LAYER={variant}&TILEMATRIX={z}&TILEROW={y}&TILECOL={x}",options:{attribution:'<a target="_blank" href="https://www.geoportail.gouv.fr/">Geoportail France</a>',bounds:[[-75,-180],[81,180]],minZoom:2,maxZoom:18,apikey:"choisirgeoportail",format:"image/jpeg",style:"normal",variant:"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.STANDARD"},variants:{parcels:{options:{variant:"CADASTRALPARCELS.PARCELS",maxZoom:20,style:"bdparcellaire",format:"image/png"}},ignMaps:"GEOGRAPHICALGRIDSYSTEMS.MAPS",maps:"GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.STANDARD",orthos:{options:{maxZoom:19,variant:"ORTHOIMAGERY.ORTHOPHOTOS"}}}},OneMapSG:{url:"https://maps-{s}.onemap.sg/v3/{variant}/{z}/{x}/{y}.png",options:{variant:"Default",minZoom:11,maxZoom:18,bounds:[[1.56073,104.11475],[1.16,103.502]],attribution:'<img src="https://docs.onemap.sg/maps/images/oneMap64-01.png" style="height:20px;width:20px;"/> New OneMap | Map data &copy; contributors, <a href="http://SLA.gov.sg">Singapore Land Authority</a>'},variants:{Default:"Default",Night:"Night",Original:"Original",Grey:"Grey",LandLot:"LandLot"}}},t.tileLayer.provider=function(e,n){return new t.TileLayer.Provider(e,n)},t})?i.apply(e,a):i)||(t.exports=o)},"5pw5":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var i=n("mrSG"),a=n("TYT/"),o=n("ea4N"),r=n("6onV"),s=n("XOa3"),l=n("bU/s"),c=n("gmuX"),d=n("DUip"),u=function(t){function e(e,n,i,a,o){var r=t.call(this,e,n,a)||this;return r.store=e,r.router=n,r.data=i,r.dialogRef=a,r.renderer=o,r}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){this.auditLog=this.data.auditLog,this.displayFailureDetails=this.auditLog.actionStatus===s.a.FAILURE,this.actionData=this.auditLog.actionData?JSON.stringify(this.auditLog.actionData,null,2):"",this.actionFailureDetails=this.auditLog.actionFailureDetails,this.actionDataEditor=this.createEditor(this.actionDataEditorElmRef,this.actionData),this.displayFailureDetails&&(this.failureDetailsEditor=this.createEditor(this.failureDetailsEditorElmRef,this.actionFailureDetails))},e.prototype.createEditor=function(t,e){var n=t.nativeElement,a={mode:"ace/mode/java",theme:"ace/theme/github",showGutter:!1,showPrintMargin:!1,readOnly:!0};a=Object(i.a)(Object(i.a)({},a),{enableSnippets:!1,enableBasicAutocompletion:!1,enableLiveAutocompletion:!1});var o=l.edit(n,a);return o.session.setUseWrapMode(!1),o.setValue(e,-1),this.updateEditorSize(n,e,o),o},e.prototype.updateEditorSize=function(t,e,n){var i=200,a=600;if(e&&e.length>0){var o=e.split("\n");i=16*o.length+16;var r=0;o.forEach((function(t){var e=t.replace(/\t/g,"    ").replace(/\n/g,"").length;r=Math.max(r,e)})),a=8*r+16}this.renderer.setStyle(t,"minHeight",i.toString()+"px"),this.renderer.setStyle(t,"height",i.toString()+"px"),this.renderer.setStyle(t,"width",a.toString()+"px"),n.resize()},e.ctorParameters=function(){return[{type:r.Store},{type:d.Router},{type:void 0,decorators:[{type:a.Inject,args:[o.MAT_DIALOG_DATA]}]},{type:o.MatDialogRef},{type:a.Renderer2}]},Object(i.c)([Object(a.ViewChild)("actionDataEditor",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"actionDataEditorElmRef",void 0),Object(i.c)([Object(a.ViewChild)("failureDetailsEditor",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"failureDetailsEditorElmRef",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-audit-log-details-dialog",template:Object(i.f)(n("H1JJ")).default,styles:[Object(i.f)(n("4Xas")).default]}),Object(i.h)(2,Object(a.Inject)(o.MAT_DIALOG_DATA)),Object(i.g)("design:paramtypes",[r.Store,d.Router,Object,o.MatDialogRef,a.Renderer2])],e)}(c.a)},"60Fo":function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host small {\n  white-space: normal;\n}\n:host ::ng-deep .mat-checkbox-label {\n  white-space: normal;\n}'},"6JLT":function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host {\n  width: 100%;\n  height: 100%;\n}\n:host .tb-table-widget mat-footer-row, :host .tb-table-widget mat-row {\n  height: 38px;\n}\n:host .tb-table-widget mat-header-row {\n  height: 40px;\n}\n:host .tb-table-widget mat-toolbar {\n  z-index: 10;\n}\n:host .tb-table-widget span.no-data-found {\n  height: calc(100% - 44px);\n}\n:host ::ng-deep .tb-table-widget .mat-tab-group {\n  height: 100%;\n  overflow: hidden;\n}\n:host ::ng-deep .tb-table-widget .mat-tab-body-wrapper {\n  height: 100%;\n}\n:host ::ng-deep .tb-table-widget .mat-tab-body-content {\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-direction: column;\n      flex-direction: column;\n}'},"6epM":function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host {\n  width: 100%;\n  height: 100%;\n}\n:host .tb-entity-table .tb-entity-table-content {\n  width: 100%;\n  height: 100%;\n  background: #fff;\n}\n:host .tb-entity-table .tb-entity-table-content .mat-toolbar-tools {\n  min-height: auto;\n}\n:host .tb-entity-table .tb-entity-table-content .title-container {\n  overflow: hidden;\n}\n:host .tb-entity-table .tb-entity-table-content .tb-entity-table-title {\n  padding-right: 20px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n:host .tb-entity-table .tb-entity-table-content .table-container {\n  overflow: auto;\n}\n:host .tb-entity-table .tb-entity-table-content .tb-entity-table-info {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n@media screen and (max-width: 599px) {\n  :host .mat-toolbar {\n    height: auto;\n    min-height: 100px;\n  }\n  :host .mat-toolbar .tb-entity-table-title {\n    padding-bottom: 5px;\n    width: 100%;\n  }\n}\n:host ::ng-deep .mat-sort-header-sorted .mat-sort-header-arrow {\n  opacity: 1 !important;\n}\n:host ::ng-deep mat-form-field.tb-relation-direction {\n  font-size: 16px;\n  width: 200px;\n}\n:host ::ng-deep mat-form-field.tb-relation-direction .mat-form-field-wrapper {\n  padding-bottom: 0;\n}\n:host ::ng-deep mat-form-field.tb-relation-direction .mat-form-field-underline {\n  bottom: 0;\n}\n@media screen and (max-width: 599px) {\n  :host ::ng-deep mat-form-field.tb-relation-direction {\n    width: 100%;\n  }\n  :host ::ng-deep mat-form-field.tb-relation-direction .mat-form-field-infix {\n    width: auto !important;\n  }\n}'},"6opy":function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n("mrSG"),a=n("TYT/"),o=n("ea4N"),r=n("6onV"),s=n("DUip"),l=function(t){function e(e,n,i){var a=t.call(this,e,n,i)||this;return a.store=e,a.router=n,a.dialogRef=i,a}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){},e.prototype.selectLayout=function(t){this.dialogRef.close(t)},e.prototype.cancel=function(){this.dialogRef.close(null)},e.ctorParameters=function(){return[{type:r.Store},{type:s.Router},{type:o.MatDialogRef}]},e=Object(i.c)([Object(a.Component)({selector:"tb-select-target-layout-dialog",template:Object(i.f)(n("qDwk")).default,styles:[Object(i.f)(n("OKrC")).default]}),Object(i.g)("design:paramtypes",[r.Store,s.Router,o.MatDialogRef])],e)}(n("gmuX").a)},"6vJj":function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .tb-led-indicator {\n  width: 100%;\n  height: 100%;\n}\n:host .tb-led-indicator .title-container .led-title {\n  font-weight: 500;\n  color: #757575;\n  white-space: nowrap;\n}\n:host .tb-led-indicator .error-container {\n  position: absolute;\n  top: 1%;\n  right: 0;\n  left: 0;\n  z-index: 4;\n  height: 14px;\n}\n:host .tb-led-indicator .error-container .led-error {\n  color: #ff3315;\n  white-space: nowrap;\n}\n:host .tb-led-indicator #text-measure {\n  position: absolute;\n  width: auto;\n  height: auto;\n  white-space: nowrap;\n  visibility: hidden;\n}\n:host .tb-led-indicator #led-container {\n  padding: 10px;\n}\n:host .tb-led-indicator #led-container .led {\n  position: relative;\n  cursor: pointer;\n  background-image: radial-gradient(circle closest-corner at 50% 50%, transparent, rgba(0, 0, 0, 0.25));\n  border-radius: 50%;\n  transition: background-color 0.5s, box-shadow 0.5s;\n}\n:host .tb-led-indicator #led-container .led.disabled {\n  background-image: radial-gradient(circle closest-corner at 50% 50%, rgba(255, 255, 255, 0.5), rgba(0, 0, 0, 0.1));\n}'},"71y5":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<tb-entities-table [entitiesTableConfig]="eventTableConfig"></tb-entities-table>\n'},"7ZKe":function(t,e,n){"use strict";n.d(e,"a",(function(){return y}));var i=n("mrSG"),a=n("TYT/"),o=n("Y8nr"),r=n("G5J1"),s=n("cUzu"),l=n("UZbx"),c=n("0lYY"),d=n("OiFK"),u=n("mbhL"),h=n("4r/P"),p=n("sLa7"),m=n("67Y/"),g=n("Phjn"),f=n("R+r5"),b=n("//Q6"),y=function(){function t(t,e){this.http=t,this.utils=e,this.alarmSourceListeners={}}return t.prototype.getAlarm=function(t,e){return this.http.get("/api/alarm/"+t,Object(o.b)(e))},t.prototype.getAlarmInfo=function(t,e){return this.http.get("/api/alarm/info/"+t,Object(o.b)(e))},t.prototype.saveAlarm=function(t,e){return this.http.post("/api/alarm",t,Object(o.b)(e))},t.prototype.ackAlarm=function(t,e){return this.http.post("/api/alarm/"+t+"/ack",null,Object(o.b)(e))},t.prototype.clearAlarm=function(t,e){return this.http.post("/api/alarm/"+t+"/clear",null,Object(o.b)(e))},t.prototype.deleteAlarm=function(t,e){return this.http.delete("/api/alarm/"+t,Object(o.b)(e))},t.prototype.getAlarms=function(t,e){return this.http.get("/api/alarm"+t.toQuery(),Object(o.b)(e))},t.prototype.getHighestAlarmSeverity=function(t,e,n,i){var a="/api/alarm/highestSeverity/"+t.entityType+"/"+t.entityType;return e?a+="?searchStatus="+e:n&&(a+="?status="+n),this.http.get(a,Object(o.b)(i))},t.prototype.subscribeForAlarms=function(t){t.id=this.utils.guid(),this.alarmSourceListeners[t.id]=t;var e=t.alarmSource;if(e.type===c.a.function)setTimeout((function(){t.alarmsUpdated([l.j])}),0);else if(e.entityType&&e.entityId){var n=t.alarmsPollingInterval;t.alarmsQuery={entityType:e.entityType,entityId:e.entityId,alarmSearchStatus:t.alarmSearchStatus,alarmStatus:null,alarmsMaxCountLoad:t.alarmsMaxCountLoad,alarmsFetchSize:t.alarmsFetchSize},e.dataKeys.filter((function(t){return t.name.toLocaleLowerCase().includes("originator")})).length&&(t.alarmsQuery.fetchOriginator=!0);var i=t.subscriptionTimewindow;i.realtimeWindowMs?t.alarmsQuery.startTime=i.startTs:(t.alarmsQuery.startTime=i.fixedWindow.startTimeMs,t.alarmsQuery.endTime=i.fixedWindow.endTimeMs),t.alarmsQuery.onAlarms=function(e){if(i.realtimeWindowMs){var n=Date.now();if(t.lastUpdateTs){var a=n-t.lastUpdateTs;t.alarmsQuery.startTime+=a}t.lastUpdateTs=n}t.alarmsUpdated(e)},this.onPollAlarms(t.alarmsQuery),t.pollTimer=setInterval(this.onPollAlarms.bind(this),n,t.alarmsQuery)}},t.prototype.unsubscribeFromAlarms=function(t){t&&t.id&&(t.pollTimer&&(clearInterval(t.pollTimer),t.pollTimer=null),delete this.alarmSourceListeners[t.id])},t.prototype.onPollAlarms=function(t){this.getAlarmsByAlarmSourceQuery(t).subscribe((function(e){t.onAlarms(e)}))},t.prototype.getAlarmsByAlarmSourceQuery=function(t){var e,n,i=Date.now(),a={property:"createdTime",direction:h.a.DESC};return t.limit?e=new u.c(t.limit,0,null,a):t.interval?e=new u.c(t.alarmsFetchSize||100,0,null,a,i-t.interval):t.startTime&&(e=new u.c(t.alarmsFetchSize||100,0,null,a,Math.round(t.startTime)),t.endTime&&(e.endTime=Math.round(t.endTime))),Object(b.k)(t.alarmsMaxCountLoad)&&0!==t.alarmsMaxCountLoad&&(n=t.alarmsMaxCountLoad)<e.pageSize&&(e.pageSize=n),this.fetchAlarms(t,e,n)},t.prototype.fetchAlarms=function(t,e,n){var i=this,a=new l.a({id:t.entityId,entityType:t.entityType},e,t.alarmSearchStatus,t.alarmStatus,t.fetchOriginator,null);return this.getAlarms(a,{ignoreLoading:!0}).pipe(Object(p.a)((function(e){var o=e.hasNext&&!t.limit;return o&&Object(b.k)(n)&&(0===(n-=e.data.length)?o=!1:n<a.pageLink.pageSize&&(a.pageLink.pageSize=n)),o?(a.offset=e.data[e.data.length-1].id.id,i.getAlarms(a,{ignoreLoading:!0})):r.a})),Object(m.a)((function(t){return t.data})),Object(g.a)((function(t){return t})),Object(f.a)(),Object(m.a)((function(t){return t.sort((function(t,e){return a.pageLink.sort(t,e)}))})))},t.ctorParameters=function(){return[{type:s.b},{type:d.a}]},t=Object(i.c)([Object(a.Injectable)({providedIn:"root"}),Object(i.g)("design:paramtypes",[s.b,d.a])],t)}()},"880C":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<mat-form-field class="mat-block">\n  <mat-label translate>alarm.alarm-status</mat-label>\n  <mat-select [ngModel]="alarmTableConfig.searchStatus"\n              (ngModelChange)="searchStatusChanged($event)">\n    <mat-option *ngFor="let status of alarmSearchStatusTypes" [value]="status">\n      {{ alarmSearchStatusTranslationsMap.get(alarmSearchStatusEnum[status]) | translate }}\n    </mat-option>\n  </mat-select>\n</mat-form-field>\n'},"8Mhd":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n("U3y+"),a=function(t){this.entityType=i.b.CUSTOMER,this.id=t}},"90vD":function(t,e,n){"use strict";var i,a;n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return a})),n.d(e,"c",(function(){return o})),function(t){t.ERROR="ERROR",t.LC_EVENT="LC_EVENT",t.STATS="STATS"}(i||(i={})),function(t){t.DEBUG_RULE_NODE="DEBUG_RULE_NODE",t.DEBUG_RULE_CHAIN="DEBUG_RULE_CHAIN"}(a||(a={}));var o=new Map([[i.ERROR,"event.type-error"],[i.LC_EVENT,"event.type-lc-event"],[i.STATS,"event.type-stats"],[a.DEBUG_RULE_NODE,"event.type-debug-rule-node"],[a.DEBUG_RULE_CHAIN,"event.type-debug-rule-chain"]])},"9GfO":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var i=n("aX2P"),a=n("//Q6"),o=function(t,e){t.count++,t.sum+=e,t.aggValue=t.sum/t.count},r=function(t,e){t.aggValue=Math.min(t.aggValue,e)},s=function(t,e){t.aggValue=Math.max(t.aggValue,e)},l=function(t,e){t.aggValue=t.aggValue+e},c=function(t){t.count++,t.aggValue=t.count},d=function(t,e){t.aggValue=e},u=function(){function t(t,e,n,a,u,h,p,m,g){var f=this;switch(this.onDataCb=t,this.tsKeyNames=e,this.startTs=n,this.limit=a,this.aggregationType=u,this.timeWindow=h,this.interval=p,this.stateData=m,this.utils=g,this.dataBuffer={},this.dataReceived=!1,this.resetPending=!1,this.noAggregation=this.aggregationType===i.a.NONE,this.aggregationTimeout=Math.max(this.interval,1e3),this.tsKeyNames.forEach((function(t){f.dataBuffer[t]=[]})),this.stateData&&(this.lastPrevKvPairData={}),this.aggregationType){case i.a.MIN:this.aggFunction=r;break;case i.a.MAX:this.aggFunction=s;break;case i.a.AVG:this.aggFunction=o;break;case i.a.SUM:this.aggFunction=l;break;case i.a.COUNT:this.aggFunction=c;break;case i.a.NONE:this.aggFunction=d;break;default:this.aggFunction=o}}return t.prototype.reset=function(t,e,n){this.intervalTimeoutHandle&&(clearTimeout(this.intervalTimeoutHandle),this.intervalTimeoutHandle=null),this.intervalScheduledTime=this.utils.currentPerfTime(),this.startTs=t,this.timeWindow=e,this.interval=n,this.endTs=this.startTs+this.timeWindow,this.elapsed=0,this.aggregationTimeout=Math.max(this.interval,1e3),this.resetPending=!0,this.intervalTimeoutHandle=setTimeout(this.onInterval.bind(this),this.aggregationTimeout)},t.prototype.destroy=function(){this.intervalTimeoutHandle&&(clearTimeout(this.intervalTimeoutHandle),this.intervalTimeoutHandle=null),this.aggregationMap=null},t.prototype.onData=function(t,e,n,i){if(!this.dataReceived||this.resetPending){var a=!0;this.dataReceived||(this.elapsed=0,this.dataReceived=!0,this.endTs=this.startTs+this.timeWindow),this.resetPending&&(this.resetPending=!1,a=!1),e?(this.aggregationMap={},this.updateAggregatedData(t.data)):this.aggregationMap=this.processAggregatedData(t.data),a&&(this.intervalScheduledTime=this.utils.currentPerfTime()),this.onInterval(n,i)}else this.updateAggregatedData(t.data),n&&(this.intervalScheduledTime=this.utils.currentPerfTime(),this.onInterval(n,i))},t.prototype.onInterval=function(t,e){var n=this.utils.currentPerfTime();if(this.elapsed+=n-this.intervalScheduledTime,this.intervalScheduledTime=n,this.intervalTimeoutHandle&&(clearTimeout(this.intervalTimeoutHandle),this.intervalTimeoutHandle=null),t)this.data=this.updateData();else{var i=Math.floor(this.elapsed/this.interval);!i&&this.data||(this.startTs+=i*this.interval,this.endTs+=i*this.interval,this.data=this.updateData(),this.elapsed=this.elapsed-i*this.interval)}this.onDataCb&&this.onDataCb(this.data,e),t||(this.intervalTimeoutHandle=setTimeout(this.onInterval.bind(this),this.aggregationTimeout))},t.prototype.updateData=function(){var t=this;this.tsKeyNames.forEach((function(e){t.dataBuffer[e]=[]}));for(var e=function(e){var i=n.aggregationMap[e],o=n.dataBuffer[e];i.forEach((function(n,a){if(a<=t.startTs)t.stateData&&(!t.lastPrevKvPairData[e]||t.lastPrevKvPairData[e][0]<a)&&(t.lastPrevKvPairData[e]=[a,n.aggValue]),i.delete(a);else if(a<=t.endTs){var r=[a,n.aggValue];o.push(r)}})),o.sort((function(t,e){return t[0]-e[0]})),n.stateData&&n.updateStateBounds(o,Object(a.d)(n.lastPrevKvPairData[e])),o.length>n.limit&&(o=o.slice(o.length-n.limit)),n.dataBuffer[e]=o},n=this,i=0,o=Object.keys(this.aggregationMap);i<o.length;i++){e(o[i])}return this.dataBuffer},t.prototype.updateStateBounds=function(t,e){var n;if(e&&(e[0]=this.startTs),t.length?n=t[0]:e&&(n=e,t.push(n)),n&&n[0]>this.startTs&&e&&t.unshift(e),t.length){var i=t[t.length-1];i[0]<this.endTs&&((i=Object(a.d)(i))[0]=this.endTs,t.push(i))}},t.prototype.processAggregatedData=function(t){for(var e=this,n=this.aggregationType===i.a.COUNT,a={},o=function(i){var o=a[i];o||(o=new Map,a[i]=o),t[i].forEach((function(t){var i=t[0],a=e.convertValue(t[1]),r=i,s={count:n?a:1,sum:a,aggValue:a};o.set(r,s)}))},r=0,s=Object.keys(t);r<s.length;r++){o(s[r])}return a},t.prototype.updateAggregatedData=function(t){for(var e=this,n=this.aggregationType===i.a.COUNT,a=function(i){var a=o.aggregationMap[i];a||(a=new Map,o.aggregationMap[i]=a),t[i].forEach((function(t){var i=t[0],o=e.convertValue(t[1]),r=e.noAggregation?i:e.startTs+Math.floor((i-e.startTs)/e.interval)*e.interval+e.interval/2,s=a.get(r);s?e.aggFunction(s,o):(s={count:1,sum:o,aggValue:n?1:o},a.set(r,s))}))},o=this,r=0,s=Object.keys(t);r<s.length;r++){a(s[r])}},t.prototype.isNumeric=function(t){return t-parseFloat(t)+1>=0},t.prototype.convertValue=function(t){return!this.noAggregation||t&&this.isNumeric(t)?Number(t):t},t}()},"9HAa":function(t,e,n){"use strict";n.d(e,"a",(function(){return j}));var i=n("mrSG"),a=n("TYT/"),o=n("YnEf"),r=n("o8Qb"),s=n("6onV"),l=n("xKAQ"),c=n("//Q6"),d=n("wtyh"),u=n("Valr"),h=n("MBk6"),p=n("ea4N"),m=n("ou6H"),g=n("F/XL"),f=n("VNr4"),b=n("psW0"),y=n("9Z1F"),v=n("67Y/"),w=n("xMyE"),x=n("4j5O"),S=n("21Fy"),C=n("EWcq"),T=n("FBAY"),O=n("z3OR"),_=n("U3y+"),L=n("OiFK"),I=n("5xOD"),A=n("oKkZ"),k=n("C4fA"),E=n("xOOu"),j=function(){function t(t,e,n,i,a,o,r,s,l,c,d,u){this.window=t,this.document=e,this.store=n,this.translate=i,this.dashboardService=a,this.dashboardUtils=o,this.widgetService=r,this.entityService=s,this.ruleChainService=l,this.utils=c,this.itembuffer=d,this.dialog=u}return t.prototype.exportDashboard=function(t){var e=this;this.dashboardService.getDashboard(t).subscribe((function(t){var n=t.title;n=n.toLowerCase().replace(/\W/g,"_"),e.exportToPc(e.prepareDashboardExport(t),n)}),(function(t){e.handleExportError(t,"dashboard.export-failed-error")}))},t.prototype.importDashboard=function(){var t=this;return this.openImportDialog("dashboard.import","dashboard.dashboard-file").pipe(Object(b.a)((function(e){if(t.validateImportedDashboard(e)){var n=null,i=(e=t.dashboardUtils.validateAndUpdateDashboard(e)).configuration.entityAliases;return i&&(n=Object.keys(i)),n&&n.length>0?t.processEntityAliases(i,n).pipe(Object(b.a)((function(n){return Object.keys(n).length>0?t.editMissingAliases(t.dashboardUtils.getWidgetsArray(e),!1,"dashboard.dashboard-import-missing-aliases-title",n).pipe(Object(b.a)((function(n){for(var a=0,o=Object.keys(n);a<o.length;a++){var r=o[a];i[r]=n[r]}return t.saveImportedDashboard(e)}))):t.saveImportedDashboard(e)}))):t.saveImportedDashboard(e)}throw t.store.dispatch(new l.b({message:t.translate.instant("dashboard.invalid-dashboard-file-error"),type:"error"})),new Error("Invalid dashboard file")})),Object(y.a)((function(t){return Object(g.a)(null)})))},t.prototype.exportWidget=function(t,e,n,i){var a=this.itembuffer.prepareWidgetItem(t,e,n,i),o=a.widget.config.title;o=o.toLowerCase().replace(/\W/g,"_"),this.exportToPc(this.prepareExport(a),o)},t.prototype.importWidget=function(t,e,n,a){var o=this;return this.openImportDialog("dashboard.import-widget","dashboard.widget-file").pipe(Object(b.a)((function(r){if(o.validateImportedWidget(r)){var s=r.widget;s=o.dashboardUtils.validateAndUpdateWidget(s);var d=o.prepareAliasesInfo(r.aliasesInfo),u=r.originalColumns,h=r.originalSize,p=d.datasourceAliases,m=d.targetDeviceAliases;if(p||m){var g={},f={},y={},v=void 0,w=void 0;if(p)for(var x=0,S=Object.keys(p);x<S.length;x++){var C=S[x];w=Number(C),v=o.utils.guid(),f[v]=w,g[v]=Object(i.a)({id:v},p[w])}if(m)for(var T=0,O=Object.keys(m);T<O.length;T++){C=O[T];w=Number(C),v=o.utils.guid(),y[v]=w,g[v]=Object(i.a)({id:v},m[w])}var _=Object.keys(g);return _.length>0?o.processEntityAliases(g,_).pipe(Object(b.a)((function(i){return Object.keys(i).length>0?o.editMissingAliases([s],!1,"dashboard.widget-import-missing-aliases-title",i).pipe(Object(b.a)((function(i){for(var r=0,l=Object.keys(i);r<l.length;r++){var g=l[r],b=i[g],v=void 0;Object(c.k)(f[g])?(v=f[g],p[v]=b):Object(c.k)(y[g])&&(v=y[g],m[v]=b)}return o.addImportedWidget(t,e,n,s,d,a,u,h)}))):o.addImportedWidget(t,e,n,s,d,a,u,h)}))):o.addImportedWidget(t,e,n,s,d,a,u,h)}return o.addImportedWidget(t,e,n,s,d,a,u,h)}throw o.store.dispatch(new l.b({message:o.translate.instant("dashboard.invalid-widget-file-error"),type:"error"})),new Error("Invalid widget file")})),Object(y.a)((function(t){return Object(g.a)(null)})))},t.prototype.exportWidgetType=function(t){var e=this;this.widgetService.getWidgetTypeById(t).subscribe((function(t){Object(c.k)(t.bundleAlias)&&delete t.bundleAlias;var n=t.name;n=n.toLowerCase().replace(/\W/g,"_"),e.exportToPc(e.prepareExport(t),n)}),(function(t){e.handleExportError(t,"widget-type.export-failed-error")}))},t.prototype.importWidgetType=function(t){var e=this;return this.openImportDialog("widget-type.import","widget-type.widget-type-file").pipe(Object(b.a)((function(n){if(e.validateImportedWidgetType(n))return n.bundleAlias=t,e.widgetService.saveImportedWidgetType(n);throw e.store.dispatch(new l.b({message:e.translate.instant("widget-type.invalid-widget-type-file-error"),type:"error"})),new Error("Invalid widget type file")})),Object(y.a)((function(t){return Object(g.a)(null)})))},t.prototype.exportWidgetsBundle=function(t){var e=this;this.widgetService.getWidgetsBundle(t).subscribe((function(t){var n=t.alias,i=t.tenantId.id===A.a;e.widgetService.getBundleWidgetTypes(n,i).subscribe((function(n){for(var i={widgetsBundle:e.prepareExport(t),widgetTypes:[]},a=0,o=n;a<o.length;a++){var r=o[a];Object(c.k)(r.bundleAlias)&&delete r.bundleAlias,i.widgetTypes.push(e.prepareExport(r))}var s=t.title;s=s.toLowerCase().replace(/\W/g,"_"),e.exportToPc(i,s)}),(function(t){e.handleExportError(t,"widgets-bundle.export-failed-error")}))}),(function(t){e.handleExportError(t,"widgets-bundle.export-failed-error")}))},t.prototype.importWidgetsBundle=function(){var t=this;return this.openImportDialog("widgets-bundle.import","widgets-bundle.widgets-bundle-file").pipe(Object(b.a)((function(e){if(t.validateImportedWidgetsBundle(e)){var n=e.widgetsBundle;return t.widgetService.saveWidgetsBundle(n).pipe(Object(b.a)((function(n){var i=n.alias,a=e.widgetTypes;if(a.length){for(var o=[],r=0,s=a;r<s.length;r++){var l=s[r];l.bundleAlias=i,o.push(t.widgetService.saveImportedWidgetType(l))}return Object(f.a)(o).pipe(Object(v.a)((function(){return n})))}return Object(g.a)(n)})))}throw t.store.dispatch(new l.b({message:t.translate.instant("widgets-bundle.invalid-widgets-bundle-file-error"),type:"error"})),new Error("Invalid widgets bundle file")})),Object(y.a)((function(t){return Object(g.a)(null)})))},t.prototype.importEntities=function(t,e,n,i,a){var o=this,r=100;r=t.length>r?r:t.length;for(var s={},l=[],c=0;c<r;c++){var d=this.entityService.saveEntityParameters(e,t[c],n,a).pipe(Object(w.a)((function(t){i&&i()})));l.push(d)}return Object(f.a)(l).pipe(Object(b.a)((function(l){for(var c=0,d=l;c<d.length;c++){var u=d[c];s=o.sumObject(s,u)}return t.splice(0,r),t.length?o.importEntities(t,e,n,i,a).pipe(Object(v.a)((function(t){return o.sumObject(s,t)}))):Object(g.a)(s)})))},t.prototype.exportRuleChain=function(t){var e=this;this.ruleChainService.getRuleChain(t).pipe(Object(b.a)((function(n){return e.ruleChainService.getRuleChainMetadata(t).pipe(Object(v.a)((function(t){return{ruleChain:e.prepareRuleChain(n),metadata:e.prepareRuleChainMetaData(t)}})))}))).subscribe((function(t){var n=t.ruleChain.name;n=n.toLowerCase().replace(/\W/g,"_"),e.exportToPc(t,n)}),(function(t){e.handleExportError(t,"rulechain.export-failed-error")}))},t.prototype.importRuleChain=function(){var t=this;return this.openImportDialog("rulechain.import","rulechain.rulechain-file").pipe(Object(b.a)((function(e){if(t.validateImportedRuleChain(e))return t.ruleChainService.resolveRuleChainMetadata(e.metadata).pipe(Object(v.a)((function(t){return e.resolvedMetadata=t,e})));throw t.store.dispatch(new l.b({message:t.translate.instant("rulechain.invalid-rulechain-file-error"),type:"error"})),new Error("Invalid rule chain file")})),Object(y.a)((function(t){return Object(g.a)(null)})))},t.prototype.exportJSZip=function(t,e){var n=this,i=new E;for(var a in t)if(t.hasOwnProperty(a)){var o=t[a];i.file(a,o)}i.generateAsync({type:"blob"}).then((function(t){n.downloadFile(t,e,O.c)}))},t.prototype.prepareRuleChain=function(t){return(t=this.prepareExport(t)).firstRuleNodeId&&(t.firstRuleNodeId=null),t.root=!1,t},t.prototype.prepareRuleChainMetaData=function(t){delete t.ruleChainId;for(var e=0;e<t.nodes.length;e++){var n=t.nodes[e];delete n.ruleChainId,t.nodes[e]=this.prepareExport(n)}return t},t.prototype.validateImportedRuleChain=function(t){return!(Object(c.u)(t.ruleChain)||Object(c.u)(t.metadata)||Object(c.u)(t.ruleChain.name))},t.prototype.sumObject=function(t,e){var n=this;return Object.keys(e).map((function(a){Object(c.s)(e[a])?(t[a]=t[a]||{},t[a]=Object(i.a)(Object(i.a)({},t[a]),n.sumObject(t[a],e[a]))):t[a]=(t[a]||0)+e[a]})),t},t.prototype.handleExportError=function(t,e){var n=t;n||(n=this.translate.instant("error.unknown-error")),this.store.dispatch(new l.b({message:this.translate.instant(e,{error:n}),type:"error"}))},t.prototype.validateImportedDashboard=function(t){return!Object(c.u)(t.title)&&!Object(c.u)(t.configuration)},t.prototype.validateImportedWidget=function(t){if(Object(c.u)(t.widget)||Object(c.u)(t.aliasesInfo)||Object(c.u)(t.originalColumns))return!1;var e=t.widget;return!(Object(c.u)(e.isSystemType)||Object(c.u)(e.bundleAlias)||Object(c.u)(e.typeAlias)||Object(c.u)(e.type))},t.prototype.validateImportedWidgetType=function(t){return!Object(c.u)(t.name)&&!Object(c.u)(t.descriptor)},t.prototype.validateImportedWidgetsBundle=function(t){if(Object(c.u)(t.widgetsBundle))return!1;if(Object(c.u)(t.widgetTypes))return!1;var e=t.widgetsBundle;if(Object(c.u)(e.title))return!1;for(var n=0,i=t.widgetTypes;n<i.length;n++){var a=i[n];if(!this.validateImportedWidgetType(a))return!1}return!0},t.prototype.saveImportedDashboard=function(t){return this.dashboardService.saveDashboard(t)},t.prototype.addImportedWidget=function(t,e,n,i,a,o,r,s){var l=this;return n().pipe(Object(b.a)((function(n){return l.itembuffer.addWidgetToDashboard(t,e,n,i,a,o,r,s,-1,-1).pipe(Object(v.a)((function(){return{widget:i,layoutId:n}})))})))},t.prototype.processEntityAliases=function(t,e){for(var n=[],i=function(e){var i=t[e];n.push(a.entityService.checkEntityAlias(i).pipe(Object(v.a)((function(t){if(!t){var e=Object(c.d)(i);return e.filter=null,e}return null}))))},a=this,o=0,r=e;o<r.length;o++){i(r[o])}return Object(f.a)(n).pipe(Object(v.a)((function(t){for(var e={},n=0,i=t=t.filter((function(t){return null!==t}));n<i.length;n++){var a=i[n];e[a.id]=a}return e})))},t.prototype.editMissingAliases=function(t,e,n,i){return this.dialog.open(C.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{entityAliases:i,widgets:t,customTitle:n,isSingleWidget:e,disableAdd:!0}}).afterClosed().pipe(Object(v.a)((function(t){if(t)return t;throw new Error("Unable to resolve missing entity aliases!")})))},t.prototype.prepareAliasesInfo=function(t){var e=t.datasourceAliases,n=t.targetDeviceAliases;if(e||n){if(e)for(var i=0,a=Object.keys(e);i<a.length;i++){var o=a[i];e[l=Number(o)]=this.prepareEntityAlias(e[l])}if(n)for(var r=0,s=Object.keys(n);r<s.length;r++){var l;o=s[r];n[l=Number(o)]=this.prepareEntityAlias(n[l])}}return t},t.prototype.prepareEntityAlias=function(t){var e,n;return t.deviceId?(e=t.aliasName,n={type:h.a.entityList,entityType:_.b.DEVICE,entityList:[t.deviceId],resolveMultiple:!1}):t.deviceFilter?(e=t.aliasName,(n={type:t.deviceFilter.useFilter?h.a.entityName:h.a.entityList,entityType:_.b.DEVICE,resolveMultiple:!1}).type===h.a.entityList?n.entityList=t.deviceFilter.deviceList:n.entityNameFilter=t.deviceFilter.deviceNameFilter):t.entityFilter?(e=t.aliasName,(n={type:t.entityFilter.useFilter?h.a.entityName:h.a.entityList,entityType:t.entityType,resolveMultiple:!1}).type===h.a.entityList?n.entityList=t.entityFilter.entityList:n.entityNameFilter=t.entityFilter.entityNameFilter):(e=t.alias,n=t.filter),{alias:e,filter:n}},t.prototype.openImportDialog=function(t,e){return this.dialog.open(m.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{importTitle:t,importFileLabel:e}}).afterClosed().pipe(Object(v.a)((function(t){if(t)return t;throw new Error("No file selected!")})))},t.prototype.exportToPc=function(t,e){t?this.exportJson(t,e):console.error("No data")},t.prototype.exportJson=function(t,e){Object(c.s)(t)&&(t=JSON.stringify(t,null,2)),this.downloadFile(t,e,O.b)},t.prototype.downloadFile=function(t,e,n){e||(e="download"),e+="."+n.extension;var i=new Blob([t],{type:n.mimeType});if(this.window.navigator&&this.window.navigator.msSaveOrOpenBlob)this.window.navigator.msSaveOrOpenBlob(i,e);else{var a=this.document.createEvent("MouseEvents"),o=this.document.createElement("a");o.download=e,o.href=URL.createObjectURL(i),o.dataset.downloadurl=[n.mimeType,o.download,o.href].join(":"),a.initEvent("click",!0,!1,this.window,0,0,0,0,0,!1,!1,!1,!1,0,null),o.dispatchEvent(a)}},t.prototype.prepareDashboardExport=function(t){return delete(t=this.prepareExport(t)).assignedCustomers,t},t.prototype.prepareExport=function(t){var e=Object(c.d)(t);return Object(c.k)(e.id)&&delete e.id,Object(c.k)(e.createdTime)&&delete e.createdTime,Object(c.k)(e.tenantId)&&delete e.tenantId,Object(c.k)(e.customerId)&&delete e.customerId,e},t.ctorParameters=function(){return[{type:Window,decorators:[{type:a.Inject,args:[d.b]}]},{type:Document,decorators:[{type:a.Inject,args:[u.DOCUMENT]}]},{type:s.Store},{type:r.TranslateService},{type:o.a},{type:x.a},{type:I.a},{type:S.a},{type:k.a},{type:L.a},{type:T.a},{type:p.MatDialog}]},t=Object(i.c)([Object(a.Injectable)(),Object(i.h)(0,Object(a.Inject)(d.b)),Object(i.h)(1,Object(a.Inject)(u.DOCUMENT)),Object(i.g)("design:paramtypes",[Window,Document,s.Store,r.TranslateService,o.a,x.a,I.a,S.a,k.a,L.a,T.a,p.MatDialog])],t)}()},"AP+x":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<mat-tab *ngIf="entity && authUser.authority === authorities.TENANT_ADMIN"\n         label="{{ \'audit-log.audit-logs\' | translate }}" #auditLogsTab="matTab">\n  <tb-audit-log-table [active]="auditLogsTab.isActive" [auditLogMode]="auditLogModes.ENTITY" [entityId]="entity.id" detailsMode="true"></tb-audit-log-table>\n</mat-tab>\n'},AU9W:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<header>\n  <mat-toolbar class="details-toolbar" color="primary" [ngStyle]="{height: headerHeightPx+\'px\'}">\n    <div class="mat-toolbar-tools" fxLayout="row" fxLayoutAlign="start center" style="height: 100%;">\n      <div class="mat-toolbar-tools tb-details-title-header" fxFlex fxLayout="column" fxLayoutAlign="start start">\n        <span class="tb-details-title">{{ headerTitle }}</span>\n        <span class="tb-details-subtitle">{{ headerSubtitle }}</span>\n        <span style="width: 100%;">\n          <ng-content select=".header-pane"></ng-content>\n        </span>\n      </div>\n      <ng-content select=".details-buttons"></ng-content>\n      <button mat-button mat-icon-button (click)="onCloseDetails()">\n        <mat-icon class="material-icons">close</mat-icon>\n      </button>\n    </div>\n    <section *ngIf="!isReadOnly" fxLayout="row" class="layout-wrap tb-header-buttons">\n      <button [disabled]="(isLoading$ | async) || theForm?.invalid || !theForm?.dirty"\n              mat-fab\n              matTooltip="{{ \'action.apply-changes\' | translate }}"\n              matTooltipPosition="above"\n              color="accent" class="tb-btn-header mat-fab-bottom-right"\n              [ngClass]="{\'tb-hide\': !isEdit}"\n              (click)="onApplyDetails()">\n        <mat-icon class="material-icons">done</mat-icon>\n      </button>\n      <button [disabled]="(isLoading$ | async) || (isAlwaysEdit && !theForm?.dirty)"\n              mat-fab\n              matTooltip="{{ (isAlwaysEdit ? \'action.decline-changes\' : \'details.toggle-edit-mode\') | translate }}"\n              matTooltipPosition="above"\n              color="accent" class="tb-btn-header mat-fab-bottom-right"\n              (click)="onToggleDetailsEditMode()">\n        <mat-icon class="material-icons">{{isEdit ? \'close\' : \'edit\'}}</mat-icon>\n      </button>\n    </section>\n  </mat-toolbar>\n</header>\n<div fxFlex class="mat-content">\n  <ng-content></ng-content>\n</div>\n'},AUWA:function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var i=n("mrSG"),a=n("RxGS"),o=n("TYT/"),r=n("6onV"),s=n("IzAD"),l=n("26FU"),c=n("zp9Z"),d=n("C/rb"),u=n("U3y+"),h=n("XOa3"),p=n("90vD"),m=n("3Tyt"),g=n("oKkZ"),f=n("QJY3"),b=function(t){function e(e){var n=t.call(this,e)||this;return n.store=e,n.attributeScopes=m.a,n.latestTelemetryTypes=m.e,n.authorities=c.a,n.entityTypes=u.b,n.auditLogModes=h.c,n.eventTypes=p.b,n.debugEventTypes=p.a,n.nullUid=g.a,n.entityTabsSubject=new l.a(null),n.entityTabsChanged=n.entityTabsSubject.asObservable(),n.authUser=Object(d.b)(e),n}return Object(i.d)(e,t),Object.defineProperty(e.prototype,"isEdit",{get:function(){return this.isEditValue},set:function(t){this.isEditValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"entity",{get:function(){return this.entityValue},set:function(t){this.setEntity(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"entitiesTableConfig",{get:function(){return this.entitiesTableConfigValue},set:function(t){this.setEntitiesTableConfig(t)},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){},e.prototype.ngAfterViewInit=function(){var t=this;this.entityTabsSubject.next(this.entityTabs.toArray()),this.entityTabs.changes.subscribe((function(){t.entityTabsSubject.next(t.entityTabs.toArray())}))},e.prototype.setEntity=function(t){this.entityValue=t},e.prototype.setEntitiesTableConfig=function(t){this.entitiesTableConfigValue=t},e.ctorParameters=function(){return[{type:r.Store}]},Object(i.c)([Object(o.ViewChildren)(s.a),Object(i.g)("design:type",o.QueryList)],e.prototype,"entityTabs",void 0),Object(i.c)([Object(o.Input)(),Object(i.g)("design:type",Boolean),Object(i.g)("design:paramtypes",[Boolean])],e.prototype,"isEdit",null),Object(i.c)([Object(o.Input)(),Object(i.g)("design:type",Object),Object(i.g)("design:paramtypes",[Object])],e.prototype,"entity",null),Object(i.c)([Object(o.Input)(),Object(i.g)("design:type",Object),Object(i.g)("design:paramtypes",[Object])],e.prototype,"entitiesTableConfig",null),Object(i.c)([Object(o.Input)(),Object(i.g)("design:type",f.FormGroup)],e.prototype,"detailsForm",void 0),e=Object(i.c)([Object(o.Directive)(),Object(i.g)("design:paramtypes",[r.Store])],e)}(a.a)},BOYq:function(t,e,n){"use strict";n.d(e,"a",(function(){return Ae}));var i=n("mrSG"),a=n("TYT/"),o=n("Z9d0"),r=n("5xOD"),s=n("S5bw"),l=n("VNr4"),c=n("F/XL"),d=n("XlPw"),u=n("0G7Z"),h=n("Neop"),p=n("OiFK"),m=n("OCOE"),g=n("0lYY"),f=n("psW0"),b=n("9Z1F"),y=n("67Y/"),v=n("15JJ"),w=n("//Q6"),x=n("o8Qb"),S=n("RxGS"),C=n("6onV"),T=n("cUzu"),O=n("nhHW"),_=n("QJY3"),L=n("DaoB"),I=n("1y+p"),A=n("j37L"),k=n("ktVl"),E=n("YnEf"),j=n("9D3k"),D=n("BsGH"),F=n("Bjlt"),M=n("21Fy"),R=n("S+vS"),N=n("g8Nv"),P=n("Valr"),V=function(t){function e(e,n,i,a,o,r){var s=t.call(this,n)||this;return s.raf=e,s.store=n,s.fb=i,s.$injector=a,s.ctx=o,s.errorMessages=r,s.validators=_.Validators,s.ctx.$injector=a,s.ctx.deviceService=a.get(L.a),s.ctx.assetService=a.get(I.a),s.ctx.entityViewService=a.get(A.a),s.ctx.customerService=a.get(k.a),s.ctx.dashboardService=a.get(E.a),s.ctx.userService=a.get(j.a),s.ctx.attributeService=a.get(D.a),s.ctx.entityRelationService=a.get(F.a),s.ctx.entityService=a.get(M.a),s.ctx.dialogs=a.get(R.a),s.ctx.customDialog=a.get(N.a),s.ctx.date=a.get(P.DatePipe),s.ctx.translate=a.get(x.TranslateService),s.ctx.http=a.get(T.b),s.ctx.$scope=s,s.ctx.defaultSubscription&&(s.executingRpcRequest=s.ctx.defaultSubscription.executingRpcRequest,s.rpcEnabled=s.ctx.defaultSubscription.rpcEnabled,s.rpcErrorText=s.ctx.defaultSubscription.rpcErrorText,s.rpcRejection=s.ctx.defaultSubscription.rpcRejection),s}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){},e.prototype.ngOnDestroy=function(){},e.prototype.clearRpcError=function(){this.widgetContext.defaultSubscription&&this.widgetContext.defaultSubscription.clearRpcError()},e.prototype.showSuccessToast=function(t,e,n,i,a){void 0===e&&(e=1e3),void 0===n&&(n="bottom"),void 0===i&&(i="left"),this.ctx.showSuccessToast(t,e,n,i,a)},e.prototype.showErrorToast=function(t,e,n,i){void 0===e&&(e="bottom"),void 0===n&&(n="left"),this.ctx.showErrorToast(t,e,n,i)},e.prototype.showToast=function(t,e,n,i,a,o){void 0===i&&(i="bottom"),void 0===a&&(a="left"),this.ctx.showToast(t,e,n,i,a,o)},e=Object(i.c)([Object(i.h)(0,Object(a.Inject)(O.a)),Object(i.h)(1,Object(a.Inject)(C.Store)),Object(i.h)(2,Object(a.Inject)(_.FormBuilder)),Object(i.h)(3,Object(a.Inject)(a.Injector)),Object(i.h)(4,Object(a.Inject)("widgetContext")),Object(i.h)(5,Object(a.Inject)("errorMessages")),Object(i.g)("design:paramtypes",[O.a,C.Store,_.FormBuilder,a.Injector,u.c,Array])],e)}(S.a),W=n("PCNd"),z=n("mbhL"),B=n("4r/P"),U=n("3Tyt"),G=n("bne5"),H=n("p0ib"),K=n("26FU"),Y=n("Duvn"),Z=n("U3y+"),q=n("Gi3i"),X=n("ad02"),Q=n("xMyE"),J=n("nbAZ"),tt=n("Byqp"),et=n("E1rE"),nt=n("UZbx"),it=n("Zss7"),at=it;function ot(t,e,n,i){var a=e,o=i.find((function(n){return n[t]===e}));return o&&(a=o[n]),a}function rt(t,e){return Object(w.g)(t,e.label)}function st(t,e){var n=nt.e[e.name];return n?Object(w.g)(t,n.value):Object(w.g)(t,e.name)}function lt(t){var e=null,n=!1;if(!0===t.useCellStyleFunction&&Object(w.k)(t.cellStyleFunction)&&t.cellStyleFunction.length>0)try{e=new Function("value",t.cellStyleFunction),n=!0}catch(i){e=null,n=!1}return{useCellStyleFunction:n,cellStyleFunction:e}}function ct(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var a=null,o=!1;if(!0===t.useCellContentFunction&&Object(w.k)(t.cellContentFunction)&&t.cellContentFunction.length>0)try{a=new(Function.bind.apply(Function,Object(i.l)([void 0],e,[t.cellContentFunction]))),o=!0}catch(r){a=null,o=!1}return{cellContentFunction:a,useCellContentFunction:o}}function dt(t){return Object(w.k)(t.columnWidth)?t.columnWidth:"0px"}function ut(t){var e={width:t};return"0px"!==t&&(e.minWidth=t,e.maxWidth=t),e}function ht(t){var e=t.color||"rgba(0, 0, 0, 0.87)",n=t.backgroundColor||"rgb(255, 255, 255)",i=at.mix(n,at("rgba(221, 221, 221, 0.65)").setAlpha(1),65).toRgbString(),a=at.mix(n,at("rgba(221, 221, 221, 0.5)").setAlpha(1),50).toRgbString(),o=at.mix(n,at("rgba(221, 221, 221, 0.3)").setAlpha(1),30).toRgbString(),r=at(e),s=r.setAlpha(.87).toRgbString(),l=r.setAlpha(.54).toRgbString(),c=r.setAlpha(.26).toRgbString(),d=r.setAlpha(.38).toRgbString(),u=r.setAlpha(.12).toRgbString();return".mat-input-element::placeholder {\n   color: "+l+";\n}\n.mat-input-element::-moz-placeholder {\n   color: "+l+";\n}\n.mat-input-element::-webkit-input-placeholder {\n   color: "+l+";\n}\n.mat-input-element:-ms-input-placeholder {\n   color: "+l+";\n}\nmat-toolbar.mat-table-toolbar {\ncolor: "+s+';\n}\nmat-toolbar.mat-table-toolbar:not([color="primary"]) button.mat-icon-button mat-icon {\ncolor: '+l+";\n}\n.mat-tab-label {\ncolor: "+s+";\n}\n.mat-tab-header-pagination-chevron {\nborder-color: "+s+";\n}\n.mat-tab-header-pagination-disabled .mat-tab-header-pagination-chevron {\nborder-color: "+d+";\n}\n.mat-table .mat-header-row {\nbackground-color: "+n+";\n}\n.mat-table .mat-header-cell {\ncolor: "+l+";\n}\n.mat-table .mat-header-cell .mat-sort-header-arrow {\ncolor: "+c+";\n}\n.mat-table .mat-cell, .mat-table .mat-header-cell {\nborder-bottom-color: "+u+";\n}\n.mat-table .mat-cell .mat-checkbox-frame, .mat-table .mat-header-cell .mat-checkbox-frame {\nborder-color: "+l+";\n}\n.mat-table .mat-row .mat-cell.mat-table-sticky {\ntransition: background-color .2s;\n}\n.mat-table .mat-row.tb-current-entity {\nbackground-color: rgba(221, 221, 221, 0.65);\n}\n.mat-table .mat-row.tb-current-entity .mat-cell.mat-table-sticky {\nbackground-color: "+i+";\n}\n.mat-table .mat-row:hover:not(.tb-current-entity) {\nbackground-color: rgba(221, 221, 221, 0.3);\n}\n.mat-table .mat-row:hover:not(.tb-current-entity) .mat-cell.mat-table-sticky {\nbackground-color: "+o+";\n}\n.mat-table .mat-row.mat-row-select.mat-selected:not(.tb-current-entity) {\nbackground-color: rgba(221, 221, 221, 0.5);\n}\n.mat-table .mat-row.mat-row-select.mat-selected:not(.tb-current-entity) .mat-cell.mat-table-sticky {\nbackground-color: "+a+";\n}\n.mat-table .mat-row .mat-cell.mat-table-sticky, .mat-table .mat-header-cell.mat-table-sticky {\nbackground-color: "+n+";\n}\n.mat-table .mat-cell {\ncolor: "+s+";\n}\n.mat-table .mat-cell button.mat-icon-button mat-icon {\ncolor: "+l+";\n}\n.mat-table .mat-cell button.mat-icon-button[disabled][disabled] mat-icon {\ncolor: "+c+";\n}\n.mat-divider {\nborder-top-color: "+u+";\n}\n.mat-paginator {\ncolor: "+l+";\n}\n.mat-paginator button.mat-icon-button {\ncolor: "+l+";\n}\n.mat-paginator button.mat-icon-button[disabled][disabled] {\ncolor: "+c+";\n}\n.mat-paginator .mat-select-value {\ncolor: "+l+";\n}"}var pt=n("bYjt"),mt=n("2J3F"),gt=new a.InjectionToken("DisplayColumnsPanelData"),ft=function(){function t(t){this.data=t,this.columns=this.data.columns}return t.prototype.update=function(){this.data.columnsUpdated(this.columns)},t.ctorParameters=function(){return[{type:void 0,decorators:[{type:a.Inject,args:[gt]}]}]},t=Object(i.c)([Object(a.Component)({selector:"tb-display-columns-panel",template:Object(i.f)(n("VE42")).default,styles:[Object(i.f)(n("vU+U")).default]}),Object(i.h)(0,Object(a.Inject)(gt)),Object(i.g)("design:paramtypes",[Object])],t)}(),bt=function(t){function e(e,n,i,a,o,r,s,l){var c=t.call(this,e)||this;c.store=e,c.elementRef=n,c.ngZone=i,c.overlay=a,c.viewContainerRef=o,c.utils=r,c.translate=s,c.domSanitizer=l,c.displayPagination=!0,c.textSearchMode=!1,c.columns=[],c.displayedColumns=[],c.defaultPageSize=10,c.defaultSortOrder="entityName",c.contentsInfo={},c.stylesInfo={},c.columnWidth={},c.searchAction={name:"action.search",show:!0,icon:"search",onAction:function(){c.enterFilterMode()}},c.columnDisplayAction={name:"entity.columns-to-display",show:!0,icon:"view_column",onAction:function(t){c.editColumnsToDisplay(t)}};var d=Object(B.b)(c.defaultSortOrder);return c.pageLink=new z.b(c.defaultPageSize,0,null,d),c}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){this.ctx.$scope.entitiesTableWidget=this,this.settings=this.ctx.settings,this.widgetConfig=this.ctx.widgetConfig,this.subscription=this.ctx.defaultSubscription,this.initializeConfig(),this.updateDatasources(),this.ctx.updateWidgetParams()},e.prototype.ngAfterViewInit=function(){var t=this;Object(G.a)(this.searchInputField.nativeElement,"keyup").pipe(Object(q.a)(150),Object(X.a)(),Object(Q.a)((function(){t.displayPagination&&(t.paginator.pageIndex=0),t.updateData()}))).subscribe(),this.displayPagination&&this.sort.sortChange.subscribe((function(){return t.paginator.pageIndex=0})),(this.displayPagination?Object(H.a)(this.sort.sortChange,this.paginator.page):this.sort.sortChange).pipe(Object(Q.a)((function(){return t.updateData()}))).subscribe(),this.updateData()},e.prototype.onDataUpdated=function(){var t=this;this.ngZone.run((function(){t.entityDatasource.updateEntitiesData(t.subscription.data),t.ctx.detectChanges()}))},e.prototype.initializeConfig=function(){var t;this.ctx.widgetActions=[this.searchAction,this.columnDisplayAction],this.actionCellDescriptors=this.ctx.actionsApi.getActionDescriptors("actionCellButton"),t=this.settings.entitiesTitle&&this.settings.entitiesTitle.length?this.utils.customTranslation(this.settings.entitiesTitle,this.settings.entitiesTitle):this.translate.instant("entity.entities");var e=this.subscription.datasources[0];this.ctx.widgetTitle=Object(w.c)(e,t),this.searchAction.show=!Object(w.k)(this.settings.enableSearch)||this.settings.enableSearch,this.displayPagination=!Object(w.k)(this.settings.displayPagination)||this.settings.displayPagination,this.columnDisplayAction.show=!Object(w.k)(this.settings.enableSelectColumnDisplay)||this.settings.enableSelectColumnDisplay;var n=this.settings.defaultPageSize;Object(w.k)(n)&&Object(w.q)(n)&&n>0&&(this.defaultPageSize=n),this.pageSizeOptions=[this.defaultPageSize,2*this.defaultPageSize,3*this.defaultPageSize],this.pageLink.pageSize=this.displayPagination?this.defaultPageSize:Number.POSITIVE_INFINITY;var i=ht(this.widgetConfig),a=new h.a;a.testMode=!1;var o="entities-table-"+Object(w.i)(i);a.cssPreviewNamespace=o,a.createStyleElement(o,i),$(this.elementRef.nativeElement).addClass(o)},e.prototype.updateDatasources=function(){var t,e,n,i=this,a=!Object(w.k)(this.settings.displayEntityName)||this.settings.displayEntityName,o=!!Object(w.k)(this.settings.displayEntityLabel)&&this.settings.displayEntityLabel;e=this.settings.entityNameColumnTitle&&this.settings.entityNameColumnTitle.length?this.utils.customTranslation(this.settings.entityNameColumnTitle,this.settings.entityNameColumnTitle):this.translate.instant("entity.entity-name"),n=this.settings.entityLabelColumnTitle&&this.settings.entityLabelColumnTitle.length?this.utils.customTranslation(this.settings.entityLabelColumnTitle,this.settings.entityLabelColumnTitle):this.translate.instant("entity.entity-label");var r=!Object(w.k)(this.settings.displayEntityType)||this.settings.displayEntityType;a&&(this.columns.push({name:"entityName",label:"entityName",def:"entityName",title:e}),this.contentsInfo.entityName={useCellContentFunction:!1},this.stylesInfo.entityName={useCellStyleFunction:!1},this.columnWidth.entityName="0px"),o&&(this.columns.push({name:"entityLabel",label:"entityLabel",def:"entityLabel",title:n}),this.contentsInfo.entityLabel={useCellContentFunction:!1},this.stylesInfo.entityLabel={useCellStyleFunction:!1},this.columnWidth.entityLabel="0px"),r&&(this.columns.push({name:"entityType",label:"entityType",def:"entityType",title:this.translate.instant("entity.entity-type")}),this.contentsInfo.entityType={useCellContentFunction:!1},this.stylesInfo.entityType={useCellStyleFunction:!1},this.columnWidth.entityType="0px");var s,l,c=[],d=this.subscription.options.datasources?this.subscription.options.datasources[0]:null;d&&(d.dataKeys.forEach((function(t){var e=Object(w.d)(t);e.type===U.c.function&&(e.name=e.label),c.push(e),e.title=i.utils.customTranslation(e.label,e.label),e.def="def"+i.columns.length;var n=e.settings;i.stylesInfo[e.def]=lt(n),i.contentsInfo[e.def]=ct(n,"value, entity, ctx"),i.contentsInfo[e.def].units=e.units,i.contentsInfo[e.def].decimals=e.decimals,i.columnWidth[e.def]=dt(n),i.columns.push(e)})),(t=this.displayedColumns).push.apply(t,this.columns.map((function(t){return t.def})))),this.settings.defaultSortOrder&&this.settings.defaultSortOrder.length&&(this.defaultSortOrder=this.settings.defaultSortOrder),this.pageLink.sortOrder=Object(B.b)(this.defaultSortOrder),this.sortOrderProperty=(s=this.pageLink.sortOrder.property,l=this.columns,ot("label",s,"def",l)),this.actionCellDescriptors.length&&this.displayedColumns.push("actions"),this.entityDatasource=new yt(this.translate,c,this.subscription.datasources)},e.prototype.editColumnsToDisplay=function(t){var e=this;t&&t.stopPropagation();var n=t.target||t.srcElement||t.currentTarget,i=new pt.d;i.backdropClass="cdk-overlay-transparent-backdrop",i.hasBackdrop=!0;i.positionStrategy=this.overlay.position().flexibleConnectedTo(n).withPositions([{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}]);var a=this.overlay.create(i);a.backdropClick().subscribe((function(){a.dispose()}));var o=this.columns.map((function(t){return{title:t.title,def:t.def,display:e.displayedColumns.indexOf(t.def)>-1}})),r=new WeakMap([[gt,{columns:o,columnsUpdated:function(t){e.displayedColumns=t.filter((function(t){return t.display})).map((function(t){return t.def})),e.displayedColumns.push("actions")}}],[pt.g,a]]),s=new mt.g(this.viewContainerRef.injector,r);a.attach(new mt.d(ft,this.viewContainerRef,s)),this.ctx.detectChanges()},e.prototype.enterFilterMode=function(){var t=this;this.textSearchMode=!0,this.pageLink.textSearch="",this.ctx.hideTitlePanel=!0,this.ctx.detectChanges(!0),setTimeout((function(){t.searchInputField.nativeElement.focus(),t.searchInputField.nativeElement.setSelectionRange(0,0)}),10)},e.prototype.exitFilterMode=function(){this.textSearchMode=!1,this.pageLink.textSearch=null,this.displayPagination&&(this.paginator.pageIndex=0),this.updateData(),this.ctx.hideTitlePanel=!1,this.ctx.detectChanges(!0)},e.prototype.updateData=function(){var t,e;this.displayPagination?(this.pageLink.page=this.paginator.pageIndex,this.pageLink.pageSize=this.paginator.pageSize):this.pageLink.page=0,this.pageLink.sortOrder.property=(t=this.sort.active,e=this.columns,ot("def",t,"label",e)),this.pageLink.sortOrder.direction=B.a[this.sort.direction.toUpperCase()],this.entityDatasource.loadEntities(this.pageLink),this.ctx.detectChanges()},e.prototype.trackByColumnDef=function(t,e){return e.def},e.prototype.headerStyle=function(t){return ut(this.columnWidth[t.def])},e.prototype.cellStyle=function(t,e){var n={};if(t&&e){var a=this.stylesInfo[e.def],o=rt(t,e);if(a.useCellStyleFunction&&a.cellStyleFunction)try{n=a.cellStyleFunction(o)}catch(s){n={}}else n=this.defaultStyle(e,o)}if(!n.width){var r=this.columnWidth[e.def];n=Object(i.a)(Object(i.a)({},n),ut(r))}return n},e.prototype.cellContent=function(t,e){if(t&&e){var n=this.contentsInfo[e.def],i=rt(t,e),a="";if(n.useCellContentFunction&&n.cellContentFunction)try{a=n.cellContentFunction(i,t,this.ctx)}catch(s){a=""+i}else{var o=n.decimals||0===n.decimals?n.decimals:this.ctx.widgetConfig.decimals,r=n.units||this.ctx.widgetConfig.units;a=this.ctx.utils.formatValue(i,o,r,!0)}return Object(w.k)(a)?this.domSanitizer.bypassSecurityTrustHtml(a):""}return""},e.prototype.onRowClick=function(t,e,n){t&&t.stopPropagation(),this.entityDatasource.toggleCurrentEntity(e);var i=n?"rowDoubleClick":"rowClick",a=this.ctx.actionsApi.getActionDescriptors(i);if(a.length){var o=void 0,r=void 0,s=void 0;e&&(o=e.id,r=e.entityName,s=e.entityLabel),this.ctx.actionsApi.handleWidgetAction(t,a[0],o,r,null,s)}},e.prototype.onActionButtonClick=function(t,e,n){var i,a,o;t&&t.stopPropagation(),e&&(i=e.id,a=e.entityName,o=e.entityLabel),this.ctx.actionsApi.handleWidgetAction(t,n,i,a,null,o)},e.prototype.defaultStyle=function(t,e){return{}},e.ctorParameters=function(){return[{type:C.Store},{type:a.ElementRef},{type:a.NgZone},{type:pt.c},{type:a.ViewContainerRef},{type:p.a},{type:x.TranslateService},{type:et.b}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",u.c)],e.prototype,"ctx",void 0),Object(i.c)([Object(a.ViewChild)("searchInput"),Object(i.g)("design:type",a.ElementRef)],e.prototype,"searchInputField",void 0),Object(i.c)([Object(a.ViewChild)(J.a),Object(i.g)("design:type",J.a)],e.prototype,"paginator",void 0),Object(i.c)([Object(a.ViewChild)(tt.a),Object(i.g)("design:type",tt.a)],e.prototype,"sort",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-entities-table-widget",template:Object(i.f)(n("QG5L")).default,styles:[Object(i.f)(n("M8Od")).default,Object(i.f)(n("bAp8")).default]}),Object(i.g)("design:paramtypes",[C.Store,a.ElementRef,a.NgZone,pt.c,a.ViewContainerRef,p.a,x.TranslateService,et.b])],e)}(S.a),yt=function(){function t(t,e,n){this.translate=t,this.dataKeys=e,this.entitiesSubject=new K.a([]),this.pageDataSubject=new K.a(Object(Y.a)()),this.allEntities=[],this.allEntitiesSubject=new K.a([]),this.allEntities$=this.allEntitiesSubject.asObservable(),this.currentEntity=null;for(var i=function(t){if(t.type===g.a.entity&&!t.entityId)return"continue";var e={id:{},entityName:t.entityName,entityLabel:t.entityLabel?t.entityLabel:t.entityName};t.entityId&&(e.id.id=t.entityId),t.entityType?(e.id.entityType=t.entityType,e.entityType=a.translate.instant(Z.d.get(t.entityType).type)):e.entityType="",a.dataKeys.forEach((function(t){e[t.label]=""})),a.allEntities.push(e)},a=this,o=0,r=n;o<r.length;o++){i(r[o])}this.allEntitiesSubject.next(this.allEntities)}return t.prototype.connect=function(t){return this.entitiesSubject.asObservable()},t.prototype.disconnect=function(t){this.entitiesSubject.complete(),this.pageDataSubject.complete()},t.prototype.loadEntities=function(t){var e=this;this.fetchEntities(t).pipe(Object(b.a)((function(){return Object(c.a)(Object(Y.a)())}))).subscribe((function(t){e.entitiesSubject.next(t.data),e.pageDataSubject.next(t)}))},t.prototype.updateEntitiesData=function(t){for(var e=0;e<this.allEntities.length;e++)for(var n=this.allEntities[e],i=0;i<this.dataKeys.length;i++){var a=this.dataKeys[i],o=t[e*this.dataKeys.length+i].data;if(o&&o.length&&o[0].length>1){var r=o[0][1];n[a.label]=r}else n[a.label]=""}this.allEntitiesSubject.next(this.allEntities)},t.prototype.isEmpty=function(){return this.entitiesSubject.pipe(Object(y.a)((function(t){return!t.length})))},t.prototype.total=function(){return this.pageDataSubject.pipe(Object(y.a)((function(t){return t.totalElements})))},t.prototype.toggleCurrentEntity=function(t){return this.currentEntity!==t&&(this.currentEntity=t,!0)},t.prototype.isCurrentEntity=function(t){return this.currentEntity&&t&&this.currentEntity.id&&t.id&&this.currentEntity.id.id===t.id.id},t.prototype.fetchEntities=function(t){return this.allEntities$.pipe(Object(y.a)((function(e){return t.filterData(e)})))},t}(),vt=n("QWsF"),wt=n("t9fZ"),xt=new a.InjectionToken("AlarmStatusFilterPanelData"),St=function(){function t(t){this.data=t,this.alarmSearchStatuses=Object.keys(nt.b),this.alarmSearchStatusTranslationMap=nt.f,this.alarmSearchStatusEnum=nt.b,this.subscription=this.data.subscription}return t.ctorParameters=function(){return[{type:void 0,decorators:[{type:a.Inject,args:[xt]}]}]},t=Object(i.c)([Object(a.Component)({selector:"tb-alarm-status-filter-panel",template:Object(i.f)(n("nFIZ")).default,styles:[Object(i.f)(n("Ozic")).default]}),Object(i.h)(0,Object(a.Inject)(xt)),Object(i.g)("design:paramtypes",[Object])],t)}(),Ct=n("10j8"),Tt=n("ea4N"),Ot=n("oKkZ"),_t=n("7ZKe"),Lt=function(t){function e(e,n,i,a,o,r,s,l,c,d,u,h){var p=t.call(this,e)||this;p.store=e,p.elementRef=n,p.ngZone=i,p.overlay=a,p.viewContainerRef=o,p.utils=r,p.translate=s,p.domSanitizer=l,p.datePipe=c,p.dialog=d,p.dialogService=u,p.alarmService=h,p.enableSelection=!0,p.displayPagination=!0,p.enableStickyAction=!1,p.textSearchMode=!1,p.columns=[],p.displayedColumns=[],p.actionCellDescriptors=[],p.displayDetails=!0,p.allowAcknowledgment=!0,p.allowClear=!0,p.defaultPageSize=10,p.defaultSortOrder="-"+nt.e.createdTime.value,p.contentsInfo={},p.stylesInfo={},p.columnWidth={},p.searchAction={name:"action.search",show:!0,icon:"search",onAction:function(){p.enterFilterMode()}},p.columnDisplayAction={name:"entity.columns-to-display",show:!0,icon:"view_column",onAction:function(t){p.editColumnsToDisplay(t)}},p.statusFilterAction={name:"alarm.alarm-status-filter",show:!0,onAction:function(t){p.editAlarmStatusFilter(t)},icon:"filter_list"};var m=Object(B.b)(p.defaultSortOrder);return p.pageLink=new z.b(p.defaultPageSize,0,null,m),p}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){this.ctx.$scope.alarmsTableWidget=this,this.settings=this.ctx.settings,this.widgetConfig=this.ctx.widgetConfig,this.subscription=this.ctx.defaultSubscription,this.alarmSource=this.subscription.alarmSource,this.initializeConfig(),this.updateAlarmSource(),this.ctx.updateWidgetParams()},e.prototype.ngAfterViewInit=function(){var t=this;Object(G.a)(this.searchInputField.nativeElement,"keyup").pipe(Object(q.a)(150),Object(X.a)(),Object(Q.a)((function(){t.displayPagination&&(t.paginator.pageIndex=0),t.updateData()}))).subscribe(),this.displayPagination&&this.sort.sortChange.subscribe((function(){return t.paginator.pageIndex=0})),(this.displayPagination?Object(H.a)(this.sort.sortChange,this.paginator.page):this.sort.sortChange).pipe(Object(Q.a)((function(){return t.updateData()}))).subscribe(),this.updateData()},e.prototype.onDataUpdated=function(){var t=this;this.ngZone.run((function(){t.alarmsDatasource.updateAlarms(t.subscription.alarms),t.ctx.detectChanges()}))},e.prototype.initializeConfig=function(){var t;this.ctx.widgetActions=[this.searchAction,this.statusFilterAction,this.columnDisplayAction],this.displayDetails=!Object(w.k)(this.settings.displayDetails)||this.settings.displayDetails,this.allowAcknowledgment=!Object(w.k)(this.settings.allowAcknowledgment)||this.settings.allowAcknowledgment,this.allowClear=!Object(w.k)(this.settings.allowClear)||this.settings.allowClear,this.displayDetails&&this.actionCellDescriptors.push({displayName:this.translate.instant("alarm.details"),icon:"more_horiz",details:!0}),this.allowAcknowledgment&&this.actionCellDescriptors.push({displayName:this.translate.instant("alarm.acknowledge"),icon:"done",acknowledge:!0}),this.allowClear&&this.actionCellDescriptors.push({displayName:this.translate.instant("alarm.clear"),icon:"clear",clear:!0}),this.actionCellDescriptors=this.actionCellDescriptors.concat(this.ctx.actionsApi.getActionDescriptors("actionCellButton")),t=this.settings.alarmsTitle&&this.settings.alarmsTitle.length?this.utils.customTranslation(this.settings.alarmsTitle,this.settings.alarmsTitle):this.translate.instant("alarm.alarms"),this.ctx.widgetTitle=Object(w.c)(this.alarmSource,t),this.enableSelection=!Object(w.k)(this.settings.enableSelection)||this.settings.enableSelection,this.allowAcknowledgment||this.allowClear||(this.enableSelection=!1),this.searchAction.show=!Object(w.k)(this.settings.enableSearch)||this.settings.enableSearch,this.displayPagination=!Object(w.k)(this.settings.displayPagination)||this.settings.displayPagination,this.enableStickyAction=!!Object(w.k)(this.settings.enableStickyAction)&&this.settings.enableStickyAction,this.columnDisplayAction.show=!Object(w.k)(this.settings.enableSelectColumnDisplay)||this.settings.enableSelectColumnDisplay,this.statusFilterAction.show=!Object(w.k)(this.settings.enableStatusFilter)||this.settings.enableStatusFilter;var e=this.settings.defaultPageSize;Object(w.k)(e)&&Object(w.q)(e)&&e>0&&(this.defaultPageSize=e),this.pageSizeOptions=[this.defaultPageSize,2*this.defaultPageSize,3*this.defaultPageSize],this.pageLink.pageSize=this.displayPagination?this.defaultPageSize:Number.POSITIVE_INFINITY;var n=ht(this.widgetConfig),i=new h.a;i.testMode=!1;var a="alarms-table-"+Object(w.i)(n);i.cssPreviewNamespace=a,i.createStyleElement(a,n),$(this.elementRef.nativeElement).addClass(a)},e.prototype.updateAlarmSource=function(){var t,e,n,i=this;this.enableSelection&&this.displayedColumns.push("select"),this.alarmSource&&(this.alarmSource.dataKeys.forEach((function(t){var e=Object(w.d)(t);e.title=i.utils.customTranslation(e.label,e.label),e.def="def"+i.columns.length;var n=e.settings;i.stylesInfo[e.def]=lt(n),i.contentsInfo[e.def]=ct(n,"value, alarm, ctx"),i.columnWidth[e.def]=dt(n),i.columns.push(e)})),(t=this.displayedColumns).push.apply(t,this.columns.map((function(t){return t.def})))),this.settings.defaultSortOrder&&this.settings.defaultSortOrder.length&&(this.defaultSortOrder=this.settings.defaultSortOrder),this.pageLink.sortOrder=Object(B.b)(this.defaultSortOrder),this.sortOrderProperty=(e=this.pageLink.sortOrder.property,n=this.columns,ot("name",e,"def",n)),this.actionCellDescriptors.length&&this.displayedColumns.push("actions"),this.alarmsDatasource=new It,this.enableSelection&&this.alarmsDatasource.selectionModeChanged$.subscribe((function(t){var e=t||i.textSearchMode;i.ctx.hideTitlePanel!==e?(i.ctx.hideTitlePanel=e,i.ctx.detectChanges(!0)):i.ctx.detectChanges()}))},e.prototype.editColumnsToDisplay=function(t){var e=this;t&&t.stopPropagation();var n=t.target||t.srcElement||t.currentTarget,i=new pt.d;i.backdropClass="cdk-overlay-transparent-backdrop",i.hasBackdrop=!0;i.positionStrategy=this.overlay.position().flexibleConnectedTo(n).withPositions([{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}]);var a=this.overlay.create(i);a.backdropClick().subscribe((function(){a.dispose()}));var o=this.columns.map((function(t){return{title:t.title,def:t.def,display:e.displayedColumns.indexOf(t.def)>-1}})),r=new WeakMap([[gt,{columns:o,columnsUpdated:function(t){e.displayedColumns=t.filter((function(t){return t.display})).map((function(t){return t.def})),e.enableSelection&&e.displayedColumns.unshift("select"),e.displayedColumns.push("actions")}}],[pt.g,a]]),s=new mt.g(this.viewContainerRef.injector,r);a.attach(new mt.d(ft,this.viewContainerRef,s)),this.ctx.detectChanges()},e.prototype.editAlarmStatusFilter=function(t){t&&t.stopPropagation();var e=t.target||t.srcElement||t.currentTarget,n=new pt.d;n.backdropClass="cdk-overlay-transparent-backdrop",n.hasBackdrop=!0;n.positionStrategy=this.overlay.position().flexibleConnectedTo(e).withPositions([{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}]);var i=this.overlay.create(n);i.backdropClick().subscribe((function(){i.dispose()}));var a=new WeakMap([[xt,{subscription:this.subscription}],[pt.g,i]]),o=new mt.g(this.viewContainerRef.injector,a);i.attach(new mt.d(St,this.viewContainerRef,o)),this.ctx.detectChanges()},e.prototype.enterFilterMode=function(){var t=this;this.textSearchMode=!0,this.pageLink.textSearch="",this.ctx.hideTitlePanel=!0,this.ctx.detectChanges(!0),setTimeout((function(){t.searchInputField.nativeElement.focus(),t.searchInputField.nativeElement.setSelectionRange(0,0)}),10)},e.prototype.exitFilterMode=function(){this.textSearchMode=!1,this.pageLink.textSearch=null,this.displayPagination&&(this.paginator.pageIndex=0),this.updateData(),this.ctx.hideTitlePanel=!1,this.ctx.detectChanges(!0)},e.prototype.updateData=function(){var t,e;this.displayPagination?(this.pageLink.page=this.paginator.pageIndex,this.pageLink.pageSize=this.paginator.pageSize):this.pageLink.page=0,this.pageLink.sortOrder.property=(t=this.sort.active,e=this.columns,ot("def",t,"name",e)),this.pageLink.sortOrder.direction=B.a[this.sort.direction.toUpperCase()],this.alarmsDatasource.loadAlarms(this.pageLink),this.ctx.detectChanges()},e.prototype.trackByColumnDef=function(t,e){return e.def},e.prototype.headerStyle=function(t){return ut(this.columnWidth[t.def])},e.prototype.cellStyle=function(t,e){var n={};if(t&&e){var a=this.stylesInfo[e.def],o=st(t,e);if(a.useCellStyleFunction&&a.cellStyleFunction)try{n=a.cellStyleFunction(o)}catch(s){n={}}else n=this.defaultStyle(e,o)}if(!n.width){var r=this.columnWidth[e.def];n=Object(i.a)(Object(i.a)({},n),ut(r))}return n},e.prototype.cellContent=function(t,e){if(t&&e){var n=this.contentsInfo[e.def],i=st(t,e),a="";if(n.useCellContentFunction&&n.cellContentFunction)try{a=n.cellContentFunction(i,t,this.ctx)}catch(o){a=""+i}else a=this.defaultContent(e,i);return Object(w.k)(a)?this.domSanitizer.bypassSecurityTrustHtml(a):""}return""},e.prototype.onRowClick=function(t,e){t&&t.stopPropagation(),this.alarmsDatasource.toggleCurrentAlarm(e);var n=this.ctx.actionsApi.getActionDescriptors("rowClick");if(n.length){var i=void 0,a=void 0;e&&e.originator&&(i=e.originator,a=e.originatorName),this.ctx.actionsApi.handleWidgetAction(t,n[0],i,a,{alarm:e})}},e.prototype.onActionButtonClick=function(t,e,n){if(n.details)this.openAlarmDetails(t,e);else if(n.acknowledge)this.ackAlarm(t,e);else if(n.clear)this.clearAlarm(t,e);else{t&&t.stopPropagation();var i=void 0,a=void 0;e&&e.originator&&(i=e.originator,a=e.originatorName),this.ctx.actionsApi.handleWidgetAction(t,n,i,a,{alarm:e})}},e.prototype.actionEnabled=function(t,e){return e.acknowledge?t.status===nt.d.ACTIVE_UNACK||t.status===nt.d.CLEARED_UNACK:!e.clear||(t.status===nt.d.ACTIVE_ACK||t.status===nt.d.ACTIVE_UNACK)},e.prototype.openAlarmDetails=function(t,e){var n=this;t&&t.stopPropagation(),e&&e.id&&e.id.id!==Ot.a&&this.dialog.open(Ct.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{alarmId:e.id.id,allowAcknowledgment:this.allowAcknowledgment,allowClear:this.allowClear,displayDetails:!0}}).afterClosed().subscribe((function(t){t&&n.subscription.update()}))},e.prototype.ackAlarm=function(t,e){var n=this;t&&t.stopPropagation(),e&&e.id&&e.id.id!==Ot.a&&this.dialogService.confirm(this.translate.instant("alarm.aknowledge-alarm-title"),this.translate.instant("alarm.aknowledge-alarm-text"),this.translate.instant("action.no"),this.translate.instant("action.yes")).subscribe((function(t){t&&t&&n.alarmService.ackAlarm(e.id.id).subscribe((function(){n.subscription.update()}))}))},e.prototype.ackAlarms=function(t){var e=this;if(t&&t.stopPropagation(),this.alarmsDatasource.selection.hasValue()){var n=this.alarmsDatasource.selection.selected.filter((function(t){return t.id.id!==Ot.a}));if(n.length){var i=this.translate.instant("alarm.aknowledge-alarms-title",{count:n.length}),a=this.translate.instant("alarm.aknowledge-alarms-text",{count:n.length});this.dialogService.confirm(i,a,this.translate.instant("action.no"),this.translate.instant("action.yes")).subscribe((function(t){if(t&&t){for(var i=[],a=0,o=n;a<o.length;a++){var r=o[a];i.push(e.alarmService.ackAlarm(r.id.id))}Object(l.a)(i).subscribe((function(){e.alarmsDatasource.clearSelection(),e.subscription.update()}))}}))}}},e.prototype.clearAlarm=function(t,e){var n=this;t&&t.stopPropagation(),e&&e.id&&e.id.id!==Ot.a&&this.dialogService.confirm(this.translate.instant("alarm.clear-alarm-title"),this.translate.instant("alarm.clear-alarm-text"),this.translate.instant("action.no"),this.translate.instant("action.yes")).subscribe((function(t){t&&t&&n.alarmService.clearAlarm(e.id.id).subscribe((function(){n.subscription.update()}))}))},e.prototype.clearAlarms=function(t){var e=this;if(t&&t.stopPropagation(),this.alarmsDatasource.selection.hasValue()){var n=this.alarmsDatasource.selection.selected.filter((function(t){return t.id.id!==Ot.a}));if(n.length){var i=this.translate.instant("alarm.clear-alarms-title",{count:n.length}),a=this.translate.instant("alarm.clear-alarms-text",{count:n.length});this.dialogService.confirm(i,a,this.translate.instant("action.no"),this.translate.instant("action.yes")).subscribe((function(t){if(t&&t){for(var i=[],a=0,o=n;a<o.length;a++){var r=o[a];i.push(e.alarmService.clearAlarm(r.id.id))}Object(l.a)(i).subscribe((function(){e.alarmsDatasource.clearSelection(),e.subscription.update()}))}}))}}},e.prototype.defaultContent=function(t,e){if(Object(w.k)(e)){var n=nt.e[t.name];return n?n.time?this.datePipe.transform(e,"yyyy-MM-dd HH:mm:ss"):n.value===nt.e.severity.value?this.translate.instant(nt.h.get(e)):n.value===nt.e.status.value?this.translate.instant(nt.i.get(e)):n.value===nt.e.originatorType.value?this.translate.instant(Z.d.get(e).type):e:e}return""},e.prototype.defaultStyle=function(t,e){if(Object(w.k)(e)){var n=nt.e[t.name];return n&&n.value===nt.e.severity.value?{fontWeight:"bold",color:nt.g.get(e)}:{}}return{}},e.ctorParameters=function(){return[{type:C.Store},{type:a.ElementRef},{type:a.NgZone},{type:pt.c},{type:a.ViewContainerRef},{type:p.a},{type:x.TranslateService},{type:et.b},{type:P.DatePipe},{type:Tt.MatDialog},{type:R.a},{type:_t.a}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",u.c)],e.prototype,"ctx",void 0),Object(i.c)([Object(a.ViewChild)("searchInput"),Object(i.g)("design:type",a.ElementRef)],e.prototype,"searchInputField",void 0),Object(i.c)([Object(a.ViewChild)(J.a),Object(i.g)("design:type",J.a)],e.prototype,"paginator",void 0),Object(i.c)([Object(a.ViewChild)(tt.a),Object(i.g)("design:type",tt.a)],e.prototype,"sort",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-alarms-table-widget",template:Object(i.f)(n("wFkW")).default,styles:[Object(i.f)(n("WAO0")).default,Object(i.f)(n("bAp8")).default]}),Object(i.g)("design:paramtypes",[C.Store,a.ElementRef,a.NgZone,pt.c,a.ViewContainerRef,p.a,x.TranslateService,et.b,P.DatePipe,Tt.MatDialog,R.a,_t.a])],e)}(S.a),It=function(){function t(){this.alarmsSubject=new K.a([]),this.pageDataSubject=new K.a(Object(Y.a)()),this.selection=new vt.c(!0,[],!1),this.selectionModeChanged=new a.EventEmitter,this.selectionModeChanged$=this.selectionModeChanged.asObservable(),this.allAlarms=[],this.allAlarmsSubject=new K.a([]),this.allAlarms$=this.allAlarmsSubject.asObservable(),this.currentAlarm=null}return t.prototype.connect=function(t){return this.alarmsSubject.asObservable()},t.prototype.disconnect=function(t){this.alarmsSubject.complete(),this.pageDataSubject.complete()},t.prototype.loadAlarms=function(t){var e=this;this.selection.hasValue()&&(this.selection.clear(),this.onSelectionModeChanged(!1)),this.fetchAlarms(t).pipe(Object(b.a)((function(){return Object(c.a)(Object(Y.a)())}))).subscribe((function(t){e.alarmsSubject.next(t.data),e.pageDataSubject.next(t)}))},t.prototype.updateAlarms=function(t){var e,n=this;t.forEach((function(t){var e=n.allAlarms.findIndex((function(e){return e.id.id===t.id.id}));e>-1?Object.assign(n.allAlarms[e],t):n.allAlarms.push(t)}));for(var i=function(e){var n=a.allAlarms[e];-1===t.findIndex((function(t){return t.id.id===n.id.id}))&&a.allAlarms.splice(e,1)},a=this,o=this.allAlarms.length-1;o>=0;o--)i(o);if(this.selection.hasValue()){var r=[];this.selection.selected.forEach((function(t){n.allAlarms.find((function(e){return e.id.id===t.id.id}))||r.push(t)})),(e=this.selection).deselect.apply(e,r),this.selection.isEmpty()&&this.onSelectionModeChanged(!1)}this.allAlarmsSubject.next(this.allAlarms)},t.prototype.isAllSelected=function(){var t=this.selection.selected.length;return this.alarmsSubject.pipe(Object(y.a)((function(e){return t===e.length})))},t.prototype.isEmpty=function(){return this.alarmsSubject.pipe(Object(y.a)((function(t){return!t.length})))},t.prototype.total=function(){return this.pageDataSubject.pipe(Object(y.a)((function(t){return t.totalElements})))},t.prototype.toggleSelection=function(t){var e=this.selection.hasValue();this.selection.toggle(t),e!==this.selection.hasValue()&&this.onSelectionModeChanged(this.selection.hasValue())},t.prototype.isSelected=function(t){return this.selection.isSelected(t)},t.prototype.clearSelection=function(){this.selection.hasValue()&&(this.selection.clear(),this.onSelectionModeChanged(!1))},t.prototype.masterToggle=function(){var t=this;this.alarmsSubject.pipe(Object(Q.a)((function(e){var n=t.selection.selected.length;n===e.length?(t.selection.clear(),n>0&&t.onSelectionModeChanged(!1)):(e.forEach((function(e){t.selection.select(e)})),0===n&&t.onSelectionModeChanged(!0))})),Object(wt.a)(1)).subscribe()},t.prototype.toggleCurrentAlarm=function(t){return this.currentAlarm!==t&&(this.currentAlarm=t,!0)},t.prototype.isCurrentAlarm=function(t){return this.currentAlarm&&t&&this.currentAlarm.id&&t.id&&this.currentAlarm.id.id===t.id.id},t.prototype.onSelectionModeChanged=function(t){this.selectionModeChanged.emit(t)},t.prototype.fetchAlarms=function(t){return this.allAlarms$.pipe(Object(y.a)((function(e){return t.filterData(e)})))},t}(),At=n("wst2"),kt=function(t){function e(e,n,i,a,o,r,s,l,c){var d=t.call(this,e)||this;return d.store=e,d.elementRef=n,d.ngZone=i,d.overlay=a,d.viewContainerRef=o,d.utils=r,d.translate=s,d.domSanitizer=l,d.datePipe=c,d.displayPagination=!0,d.textSearchMode=!1,d.textSearch=null,d.defaultPageSize=10,d.defaultSortOrder="-0",d.hideEmptyLines=!1,d.showTimestamp=!0,d.searchAction={name:"action.search",show:!0,icon:"search",onAction:function(){d.enterFilterMode()}},d}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){this.ctx.$scope.timeseriesTableWidget=this,this.settings=this.ctx.settings,this.widgetConfig=this.ctx.widgetConfig,this.data=this.ctx.data,this.datasources=this.ctx.datasources,this.initialize(),this.ctx.updateWidgetParams()},e.prototype.ngAfterViewInit=function(){var t=this;Object(G.a)(this.searchInputField.nativeElement,"keyup").pipe(Object(q.a)(150),Object(X.a)(),Object(Q.a)((function(){t.displayPagination&&t.paginators.forEach((function(t){t.pageIndex=0})),t.sources.forEach((function(e){e.pageLink.textSearch=t.textSearch})),t.updateAllData()}))).subscribe(),this.displayPagination&&this.sorts.forEach((function(e,n){e.sortChange.subscribe((function(){return t.paginators.toArray()[n].pageIndex=0}))})),this.sorts.forEach((function(e,n){var i=t.displayPagination?t.paginators.toArray()[n]:null;e.sortChange.subscribe((function(){return t.paginators.toArray()[n].pageIndex=0})),(t.displayPagination?Object(H.a)(e.sortChange,i.page):e.sortChange).pipe(Object(Q.a)((function(){return t.updateData(e,i,n)}))).subscribe()})),this.updateAllData()},e.prototype.onDataUpdated=function(){var t=this;this.ngZone.run((function(){t.sources.forEach((function(e){e.timeseriesDatasource.dataUpdated(t.data)})),t.ctx.detectChanges()}))},e.prototype.initialize=function(){this.ctx.widgetActions=[this.searchAction],this.actionCellDescriptors=this.ctx.actionsApi.getActionDescriptors("actionCellButton"),this.displayPagination=!Object(w.k)(this.settings.displayPagination)||this.settings.displayPagination,this.hideEmptyLines=!!Object(w.k)(this.settings.hideEmptyLines)&&this.settings.hideEmptyLines,this.showTimestamp=!1!==this.settings.showTimestamp,this.dateFormatFilter=!0!==this.settings.showMilliseconds?"yyyy-MM-dd HH:mm:ss":"yyyy-MM-dd HH:mm:ss.sss";var t=this.settings.defaultPageSize;Object(w.k)(t)&&Object(w.q)(t)&&t>0&&(this.defaultPageSize=t),this.pageSizeOptions=[this.defaultPageSize,2*this.defaultPageSize,3*this.defaultPageSize];var e=ht(this.widgetConfig);e+=".tb-table-widget mat-toolbar.mat-table-toolbar:not([color=primary]) {\nbackground-color: "+(this.widgetConfig.backgroundColor||"rgb(255, 255, 255)")+" !important;\n}\n";var n=new h.a;n.testMode=!1;var i="ts-table-"+Object(w.i)(e);n.cssPreviewNamespace=i,n.createStyleElement(i,e),$(this.elementRef.nativeElement).addClass(i),this.updateDatasources()},e.prototype.updateDatasources=function(){this.sources=[],this.sourceIndex=0;var t=0,e=this.displayPagination?this.defaultPageSize:Number.POSITIVE_INFINITY;if(this.datasources)for(var n=0,i=this.datasources;n<i.length;n++){var a=i[n],o=Object(B.b)(this.defaultSortOrder),r={};r.keyStartIndex=t,t+=a.dataKeys.length,r.keyEndIndex=t,r.datasource=a,r.data=[],r.rawData=[],r.displayedColumns=[],r.pageLink=new z.b(e,0,null,o),r.header=[],r.stylesInfo=[],r.contentsInfo=[],r.rowDataTemplate={},r.rowDataTemplate.Timestamp=null,this.showTimestamp&&r.displayedColumns.push("0");for(var s=0;s<a.dataKeys.length;s++){var l=a.dataKeys[s],c=l.settings,d=s+1;r.header.push({index:d,dataKey:l}),r.displayedColumns.push(d+""),r.rowDataTemplate[l.label]=null,r.stylesInfo.push(lt(c));var u=ct(c,"value, rowData, ctx");u.units=l.units,u.decimals=l.decimals,r.contentsInfo.push(u)}r.displayedColumns.push("actions"),new Et(r,this.hideEmptyLines,this.dateFormatFilter,this.datePipe).dataUpdated(this.data),this.sources.push(r)}this.updateActiveEntityInfo()},e.prototype.updateActiveEntityInfo=function(){var t=this.sources[this.sourceIndex],e=null;if(t){var n=t.datasource;n.type===g.a.entity&&n.entityType&&n.entityId&&(e={entityId:{entityType:n.entityType,id:n.entityId},entityName:n.entityName,entityLabel:n.entityLabel})}this.ctx.activeEntityInfo=e},e.prototype.onSourceIndexChanged=function(){this.updateActiveEntityInfo()},e.prototype.enterFilterMode=function(){var t=this;this.textSearchMode=!0,this.textSearch="",this.sources.forEach((function(e){e.pageLink.textSearch=t.textSearch})),this.ctx.hideTitlePanel=!0,this.ctx.detectChanges(!0),setTimeout((function(){t.searchInputField.nativeElement.focus(),t.searchInputField.nativeElement.setSelectionRange(0,0)}),10)},e.prototype.exitFilterMode=function(){var t=this;this.textSearchMode=!1,this.textSearch=null,this.sources.forEach((function(e,n){e.pageLink.textSearch=t.textSearch;var i=t.sorts.toArray()[n],a=null;t.displayPagination&&((a=t.paginators.toArray()[n]).pageIndex=0),t.updateData(i,a,n)})),this.ctx.hideTitlePanel=!1,this.ctx.detectChanges(!0)},e.prototype.updateAllData=function(){var t=this;this.sources.forEach((function(e,n){var i=t.sorts.toArray()[n],a=t.displayPagination?t.paginators.toArray()[n]:null;t.updateData(i,a,n)}))},e.prototype.updateData=function(t,e,n){var i=this.sources[n];this.displayPagination?(i.pageLink.page=e.pageIndex,i.pageLink.pageSize=e.pageSize):i.pageLink.page=0,i.pageLink.sortOrder.property=t.active,i.pageLink.sortOrder.direction=B.a[t.direction.toUpperCase()],i.timeseriesDatasource.loadRows(),this.ctx.detectChanges()},e.prototype.trackByColumnIndex=function(t,e){return e.index},e.prototype.trackByRowIndex=function(t){return t},e.prototype.cellStyle=function(t,e,n){var i={};if(e>0){var a=t.stylesInfo[e-1];if(a.useCellStyleFunction&&a.cellStyleFunction)try{i=a.cellStyleFunction(n)}catch(o){i={}}}return i},e.prototype.cellContent=function(t,e,n,i){if(0===e)return n.formattedTs;var a=void 0,o=t.contentsInfo[e-1];if(o.useCellContentFunction&&o.cellContentFunction)try{var r=t.rowDataTemplate;r.Timestamp=n[0],t.header.forEach((function(t){r[t.dataKey.name]=n[t.index]})),a=o.cellContentFunction(i,r,this.ctx)}catch(c){a=""+i}else{var s=o.decimals||0===o.decimals?o.decimals:this.ctx.widgetConfig.decimals,l=o.units||this.ctx.widgetConfig.units;a=this.ctx.utils.formatValue(i,s,l,!0)}return Object(w.k)(a)?this.domSanitizer.bypassSecurityTrustHtml(a):""},e.prototype.onRowClick=function(t,e){var n=this.ctx.actionsApi.getActionDescriptors("rowClick");if(n.length){t&&t.stopPropagation();var i=void 0,a=void 0,o=void 0;this.ctx.activeEntityInfo&&(i=this.ctx.activeEntityInfo.entityId,a=this.ctx.activeEntityInfo.entityName,o=this.ctx.activeEntityInfo.entityLabel),this.ctx.actionsApi.handleWidgetAction(t,n[0],i,a,e,o)}},e.prototype.onActionButtonClick=function(t,e,n){var i,a,o;t&&t.stopPropagation(),this.ctx.activeEntityInfo&&(i=this.ctx.activeEntityInfo.entityId,a=this.ctx.activeEntityInfo.entityName,o=this.ctx.activeEntityInfo.entityLabel),this.ctx.actionsApi.handleWidgetAction(t,n,i,a,e,o)},e.ctorParameters=function(){return[{type:C.Store},{type:a.ElementRef},{type:a.NgZone},{type:pt.c},{type:a.ViewContainerRef},{type:p.a},{type:x.TranslateService},{type:et.b},{type:P.DatePipe}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",u.c)],e.prototype,"ctx",void 0),Object(i.c)([Object(a.ViewChild)("searchInput"),Object(i.g)("design:type",a.ElementRef)],e.prototype,"searchInputField",void 0),Object(i.c)([Object(a.ViewChildren)(J.a),Object(i.g)("design:type",a.QueryList)],e.prototype,"paginators",void 0),Object(i.c)([Object(a.ViewChildren)(tt.a),Object(i.g)("design:type",a.QueryList)],e.prototype,"sorts",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-timeseries-table-widget",template:Object(i.f)(n("GWMJ")).default,styles:[Object(i.f)(n("6JLT")).default,Object(i.f)(n("bAp8")).default]}),Object(i.g)("design:paramtypes",[C.Store,a.ElementRef,a.NgZone,pt.c,a.ViewContainerRef,p.a,x.TranslateService,et.b,P.DatePipe])],e)}(S.a),Et=function(){function t(t,e,n,i){this.source=t,this.hideEmptyLines=e,this.dateFormatFilter=n,this.datePipe=i,this.rowsSubject=new K.a([]),this.pageDataSubject=new K.a(Object(Y.a)()),this.allRowsSubject=new K.a([]),this.allRows$=this.allRowsSubject.asObservable(),this.source.timeseriesDatasource=this}return t.prototype.connect=function(t){return this.rowsSubject.asObservable()},t.prototype.disconnect=function(t){this.rowsSubject.complete(),this.pageDataSubject.complete()},t.prototype.loadRows=function(){var t=this;this.fetchRows(this.source.pageLink).pipe(Object(b.a)((function(){return Object(c.a)(Object(Y.a)())}))).subscribe((function(e){t.rowsSubject.next(e.data),t.pageDataSubject.next(e)}))},t.prototype.dataUpdated=function(t){this.source.rawData=t.slice(this.source.keyStartIndex,this.source.keyEndIndex),this.updateSourceData()},t.prototype.updateSourceData=function(){this.source.data=this.convertData(this.source.rawData),this.allRowsSubject.next(this.source.data)},t.prototype.convertData=function(t){for(var e=this,n={},i=function(i){t[i].data.forEach((function(a){var o=a[0],r=n[o];if(!r){(r={formattedTs:e.datePipe.transform(o,e.dateFormatFilter)})[0]=o;for(var s=0;s<t.length;s++)r[s+1]=void 0;n[o]=r}r[i+1]=a[1]}))},a=0;a<t.length;a++)i(a);for(var o=[],r=0,s=Object.keys(n);r<s.length;r++){var l=s[r];if(this.hideEmptyLines){for(var c=!0,d=0;d<t.length&&c;d++)n[l][d+1]&&(c=!1);c||o.push(n[l])}else o.push(n[l])}return o},t.prototype.isEmpty=function(){return this.rowsSubject.pipe(Object(y.a)((function(t){return!t.length})))},t.prototype.total=function(){return this.pageDataSubject.pipe(Object(y.a)((function(t){return t.totalElements})))},t.prototype.fetchRows=function(t){return this.allRows$.pipe(Object(y.a)((function(e){return t.filterData(e)})))},t}(),jt=n("7JTo");function Dt(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var a=null;if(Object(w.k)(t)&&t.length)try{var o=(a=new Function(e,t)).apply(null,n);Object(w.u)(o)&&(a=null)}catch(r){a=null}return a}var Ft=function(t){var e=t.entity;return{parameters:{rootId:e.id.id,rootType:e.id.entityType,direction:jt.b.FROM,relationTypeGroup:jt.d.COMMON,maxLevel:1},filters:[{relationType:"Contains",entityTypes:[]}]}},Mt=function(t){var e="insert_drive_file",n=t.entity;if(n&&n.id&&n.id.entityType)switch(n.id.entityType){case"function":e="functions";break;case Z.b.DEVICE:e="devices_other";break;case Z.b.ASSET:e="domain";break;case Z.b.TENANT:case Z.b.CUSTOMER:e="supervisor_account";break;case Z.b.USER:e="account_circle";break;case Z.b.DASHBOARD:e="dashboards";break;case Z.b.ALARM:e="notifications_active";break;case Z.b.ENTITY_VIEW:e="view_quilt"}return{materialIcon:e}},Rt=function(t){return t.level<=4},Nt=function(t,e){var n=t.entity.id.entityType.localeCompare(e.entity.id.entityType);return 0===n&&(n=t.entity.name.localeCompare(e.entity.name)),n},Pt=n("xKAQ"),Vt=function(t){function e(e,n,i,a,o,r,s){var c=t.call(this,e)||this;return c.store=e,c.elementRef=n,c.overlay=i,c.viewContainerRef=a,c.utils=o,c.entityService=r,c.entityRelationService=s,c.toastTargetId="entities-hierarchy-"+c.utils.guid(),c.textSearchMode=!1,c.textSearch=null,c.nodeEditCallbacks={},c.nodesMap={},c.pendingUpdateNodeTasks={},c.nodeIdCounter=0,c.searchAction={name:"action.search",show:!0,icon:"search",onAction:function(){c.enterFilterMode()}},c.loadNodes=function(t,e){if("#"===t.id){var n=[];c.datasources.forEach((function(t){n.push(c.datasourceToNode(t))})),Object(l.a)(n).subscribe((function(t){e(c.prepareNodes(t)),c.updateNodeData(c.subscription.data)}))}else if(t.data&&t.data.nodeCtx.entity&&t.data.nodeCtx.entity.id&&"function"!==t.data.nodeCtx.entity.id.entityType){var i=c.prepareNodeRelationQuery(t.data.nodeCtx);c.entityRelationService.findByQuery(i,{ignoreErrors:!0,ignoreLoading:!0}).subscribe((function(n){if(n.length){var a=[];n.forEach((function(e){var n=i.parameters.direction===jt.b.FROM?e.to:e.from;a.push(c.entityIdToNode(n.entityType,n.id,t.data.datasource,t.data.nodeCtx))})),Object(l.a)(a).subscribe((function(t){e(c.prepareNodes(t))}))}else e([])}),(function(t){var e="Failed to get relations!";t&&400===t.status&&(e="Invalid relations query returned by 'Node relations query function'! Please check widget configuration!"),c.showError(e)}))}else e([])},c.onNodeSelected=function(t,e){var n;if(-1!==(n=t?t.id:-1)){var i=c.nodesMap[n];if(i){var a=c.ctx.actionsApi.getActionDescriptors("nodeSelected");if(a.length){var o=i.data.nodeCtx.entity;c.ctx.actionsApi.handleWidgetAction(e,a[0],o.id,o.name,{nodeCtx:i.data.nodeCtx})}}}},c.onNodesInserted=function(t,e){t&&t.forEach((function(t){var e=c.pendingUpdateNodeTasks[t];e&&(e(),delete c.pendingUpdateNodeTasks[t])}))},c.searchCallback=function(t,e){var n=c.nodesMap[e.id];return!(!n||!n.data.searchText)&&n.data.searchText.includes(t.toLowerCase())},c}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){this.ctx.$scope.entitiesHierarchyWidget=this,this.settings=this.ctx.settings,this.widgetConfig=this.ctx.widgetConfig,this.subscription=this.ctx.defaultSubscription,this.datasources=this.subscription.datasources,this.initializeConfig(),this.ctx.updateWidgetParams()},e.prototype.ngAfterViewInit=function(){var t=this;Object(G.a)(this.searchInputField.nativeElement,"keyup").pipe(Object(q.a)(150),Object(X.a)(),Object(Q.a)((function(){t.updateSearchNodes()}))).subscribe()},e.prototype.onDataUpdated=function(){this.updateNodeData(this.subscription.data)},e.prototype.initializeConfig=function(){this.ctx.widgetActions=[this.searchAction];var t={entity:{id:{entityType:Z.b.DEVICE,id:"123"},name:"TEST DEV1"},data:{},level:2},e=Object(w.d)(t);e.level=1,t.parentNodeCtx=e,this.nodeRelationQueryFunction=Dt(this.settings.nodeRelationQueryFunction,"nodeCtx",t),this.nodeIconFunction=Dt(this.settings.nodeIconFunction,"nodeCtx",t),this.nodeTextFunction=Dt(this.settings.nodeTextFunction,"nodeCtx",t),this.nodeDisabledFunction=Dt(this.settings.nodeDisabledFunction,"nodeCtx",t),this.nodeOpenedFunction=Dt(this.settings.nodeOpenedFunction,"nodeCtx",t),this.nodeHasChildrenFunction=Dt(this.settings.nodeHasChildrenFunction,"nodeCtx",t);var n=Object(w.d)(t);n.entity.name="TEST DEV2",this.nodesSortFunction=Dt(this.settings.nodesSortFunction,"nodeCtx1,nodeCtx2",t,n),this.nodeRelationQueryFunction=this.nodeRelationQueryFunction||Ft,this.nodeIconFunction=this.nodeIconFunction||Mt,this.nodeTextFunction=this.nodeTextFunction||function(t){return t.entity.name},this.nodeDisabledFunction=this.nodeDisabledFunction||function(){return!1},this.nodeOpenedFunction=this.nodeOpenedFunction||Rt,this.nodeHasChildrenFunction=this.nodeHasChildrenFunction||function(){return!0},this.nodesSortFunction=this.nodesSortFunction||Nt;var i=ht(this.widgetConfig),a=new h.a;a.testMode=!1;var o="entities-hierarchy-"+Object(w.i)(i);a.cssPreviewNamespace=o,a.createStyleElement(o,i),$(this.elementRef.nativeElement).addClass(o)},e.prototype.enterFilterMode=function(){var t=this;this.textSearchMode=!0,this.textSearch="",this.ctx.hideTitlePanel=!0,this.ctx.detectChanges(!0),setTimeout((function(){t.searchInputField.nativeElement.focus(),t.searchInputField.nativeElement.setSelectionRange(0,0)}),10)},e.prototype.exitFilterMode=function(){this.textSearchMode=!1,this.textSearch=null,this.updateSearchNodes(),this.ctx.hideTitlePanel=!1,this.ctx.detectChanges(!0)},e.prototype.updateSearchNodes=function(){null!=this.textSearch?this.nodeEditCallbacks.search(this.textSearch):this.nodeEditCallbacks.clearSearch()},e.prototype.updateNodeData=function(t){var e=this,n=[];t&&t.forEach((function(t){var i=t.datasource;if(i.nodeId){var a=e.nodesMap[i.nodeId],o=t.dataKey.label,r=void 0;t.data&&t.data.length&&(r=t.data[0][1]),a.data.nodeCtx.data[o]!==r&&(-1===n.indexOf(i.nodeId)&&n.push(i.nodeId),a.data.nodeCtx.data[o]=r)}})),n.forEach((function(t){e.nodeEditCallbacks.getNode(t)?e.updateNodeStyle(e.nodesMap[t]):e.pendingUpdateNodeTasks[t]=function(){e.updateNodeStyle(e.nodesMap[t])}}))},e.prototype.updateNodeStyle=function(t){var e=this.prepareNodeText(t);t.text!==e&&(t.text=e,this.nodeEditCallbacks.updateNode(t.id,t.text));var n=this.nodeDisabledFunction(t.data.nodeCtx);t.state.disabled!==n&&(t.state.disabled=n,t.state.disabled?this.nodeEditCallbacks.disableNode(t.id):this.nodeEditCallbacks.enableNode(t.id));var i=this.nodeHasChildrenFunction(t.data.nodeCtx);t.children!==i&&(t.children=i,this.nodeEditCallbacks.setNodeHasChildren(t.id,t.children))},e.prototype.showError=function(t){this.store.dispatch(new Pt.b({message:t,type:"error",target:this.toastTargetId,verticalPosition:"bottom",horizontalPosition:"left"}))},e.prototype.prepareNodes=function(t){var e=this;return(t=t.filter((function(t){return null!==t}))).sort((function(t,n){return e.nodesSortFunction(t.data.nodeCtx,n.data.nodeCtx)})),t},e.prototype.prepareNodeText=function(t){var e=this.prepareNodeIcon(t.data.nodeCtx),n=this.nodeTextFunction(t.data.nodeCtx);return t.data.searchText=n?n.replace(/<[^>]+>/g,"").toLowerCase():"",e+n},e.prototype.prepareNodeIcon=function(t){var e=this.nodeIconFunction(t);return e?("default"===e&&(e=Mt(t)),e&&"default"!==e&&(e.iconUrl||e.materialIcon)?e.materialIcon?'<mat-icon class="node-icon material-icons" role="img" aria-hidden="false">'+e.materialIcon+"</mat-icon>":'<div class="node-icon" style="background-image: url('+e.iconUrl+');">&nbsp;</div>':""):""},e.prototype.datasourceToNode=function(t,e){var n=this;return this.resolveEntity(t).pipe(Object(y.a)((function(i){if(null!==i){var a={id:++n.nodeIdCounter+""};n.nodesMap[a.id]=a,t.nodeId=a.id,a.icon=!1;var o={parentNodeCtx:e,entity:i,data:{}};return o.level=e?e.level+1:1,a.data={datasource:t,nodeCtx:o},a.state={disabled:n.nodeDisabledFunction(a.data.nodeCtx),opened:n.nodeOpenedFunction(a.data.nodeCtx)},a.text=n.prepareNodeText(a),a.children=n.nodeHasChildrenFunction(a.data.nodeCtx),a}return null})))},e.prototype.entityIdToNode=function(t,e,n,i){var a=this,o={dataKeys:n.dataKeys,type:g.a.entity,entityType:t,entityId:e};return this.datasourceToNode(o,i).pipe(Object(f.a)((function(t){if(null!=t){var e={type:g.k.latest,datasources:[o],callbacks:{onDataUpdated:function(t){a.updateNodeData(t.data)}}};return a.ctx.subscriptionApi.createSubscription(e,!0).pipe(Object(y.a)((function(){return t})))}return Object(c.a)(t)})))},e.prototype.resolveEntity=function(t){if(t.type===g.a.function){var e={id:{entityType:"function"},name:t.name};return Object(c.a)(e)}return this.entityService.getEntity(t.entityType,t.entityId,{ignoreLoading:!0}).pipe(Object(b.a)((function(t){return Object(c.a)(null)})))},e.prototype.prepareNodeRelationQuery=function(t){var e=this.nodeRelationQueryFunction(t);return e&&"default"===e&&(e=Ft(t)),e},e.ctorParameters=function(){return[{type:C.Store},{type:a.ElementRef},{type:pt.c},{type:a.ViewContainerRef},{type:p.a},{type:M.a},{type:F.a}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",u.c)],e.prototype,"ctx",void 0),Object(i.c)([Object(a.ViewChild)("searchInput"),Object(i.g)("design:type",a.ElementRef)],e.prototype,"searchInputField",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-entities-hierarchy-widget",template:Object(i.f)(n("44to")).default,styles:[Object(i.f)(n("sJ4O")).default]}),Object(i.g)("design:paramtypes",[C.Store,a.ElementRef,pt.c,a.ViewContainerRef,p.a,M.a,F.a])],e)}(S.a),Wt=n("HR/i"),zt=it,Bt=function(t){function e(e,n){var i=t.call(this,n)||this;return i.utils=e,i.store=n,i.showTitle=!1,i.value=!1,i.error="",i.title="",i.destroyed=!1,i.subscriptionOptions={callbacks:{onDataUpdated:function(t,e){return i.ctx.ngZone.run((function(){i.onDataUpdated(t,e)}))},onDataUpdateError:function(t,e){return i.ctx.ngZone.run((function(){i.onDataUpdateError(t,e)}))},dataLoading:function(){}}},i}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){var t=this;this.led=$(this.ledRef.nativeElement),this.ledContainer=$(this.ledContainerRef.nativeElement),this.textMeasure=$(this.textMeasureRef.nativeElement),this.ledTitleContainer=$(this.ledTitleContainerRef.nativeElement),this.ledTitle=$(this.ledTitleRef.nativeElement),this.ledErrorContainer=$(this.ledErrorContainerRef.nativeElement),this.ledError=$(this.ledErrorRef.nativeElement),this.ledResize$=new Wt.a((function(){t.resize()})),this.ledResize$.observe(this.ledContainerRef.nativeElement),this.init()},e.prototype.ngOnDestroy=function(){this.destroyed=!0,this.checkStatusTimeoutHandle&&clearTimeout(this.checkStatusTimeoutHandle),this.subscription&&this.ctx.subscriptionApi.removeSubscription(this.subscription.id),this.ledResize$&&this.ledResize$.disconnect()},e.prototype.init=function(){var t=this.ctx.settings;this.title=Object(w.k)(t.title)?t.title:"",this.showTitle=!(!this.title||!this.title.length);var e=Object(w.k)(t.ledColor)?t.ledColor:"green";this.valueAttribute=Object(w.k)(t.valueAttribute)?t.valueAttribute:"value",this.ledColor=zt(e).brighten(30).toHexString(),this.ledMiddleColor=zt(e).toHexString(),this.disabledColor=zt(e).darken(40).toHexString(),this.disabledMiddleColor=zt(e).darken(60).toHexString();var n=!!Object(w.k)(t.initialValue)&&t.initialValue;this.setValue(n,!0);var i=this.ctx.defaultSubscription.rpcEnabled;if(this.isSimulated=this.utils.widgetEditMode,this.requestTimeout=500,t.requestTimeout&&(this.requestTimeout=t.requestTimeout),this.retrieveValueMethod="attribute",t.retrieveValueMethod&&t.retrieveValueMethod.length&&(this.retrieveValueMethod=t.retrieveValueMethod),this.parseValueFunction=function(t){return!!t},t.parseValueFunction&&t.parseValueFunction.length)try{this.parseValueFunction=new Function("data",t.parseValueFunction)}catch(a){this.parseValueFunction=function(t){return!!t}}this.performCheckStatus=!1!==t.performCheckStatus,this.performCheckStatus&&(this.checkStatusMethod="checkStatus",t.checkStatusMethod&&t.checkStatusMethod.length&&(this.checkStatusMethod=t.checkStatusMethod)),i?this.isSimulated||(this.performCheckStatus?this.rpcCheckStatus():this.subscribeForValue()):this.onError("Target device is not set!")},e.prototype.resize=function(){var t=this.ledContainer.width(),e=this.ledContainer.height(),n=Math.min(t,e);this.led.css({width:n,height:n}),this.showTitle&&this.setFontSize(this.ledTitle,this.title,2*this.ledTitleContainer.height()/3,this.ledTitleContainer.width()),this.setFontSize(this.ledError,this.error,this.ledErrorContainer.height(),this.ledErrorContainer.width())},e.prototype.setFontSize=function(t,e,n,i){for(var a=this.measureTextWidth(e,n);a>i;)n--,a=this.measureTextWidth(e,n);t.css({fontSize:n+"px",lineHeight:n+"px"})},e.prototype.measureTextWidth=function(t,e){return this.textMeasure.css({fontSize:e+"px",lineHeight:e+"px"}),this.textMeasure.text(t),this.textMeasure.width()},e.prototype.onError=function(t){this.error=t,this.setFontSize(this.ledError,this.error,this.ledErrorContainer.height(),this.ledErrorContainer.width()),this.ctx.detectChanges()},e.prototype.setValue=function(t,e){(this.value!==t||e)&&(this.value=t,this.updateColor())},e.prototype.updateColor=function(){var t=this.value?this.ledColor:this.disabledColor,e="#000 0 -1px 6px 1px, inset "+(this.value?this.ledMiddleColor:this.disabledMiddleColor)+" 0 -1px 8px, "+t+" 0 3px 11px";this.led.css({backgroundColor:t}),this.led.css({boxShadow:e}),this.value?this.led.removeClass("disabled"):this.led.addClass("disabled")},e.prototype.rpcCheckStatus=function(){var t=this;this.destroyed||(this.error="",this.ctx.controlApi.sendTwoWayCommand(this.checkStatusMethod,null,this.requestTimeout).subscribe((function(e){if(!!e)t.checkStatusTimeoutHandle&&(clearTimeout(t.checkStatusTimeoutHandle),t.checkStatusTimeoutHandle=null),t.subscribeForValue();else{t.onError("Unknown device status!"),t.checkStatusTimeoutHandle&&clearTimeout(t.checkStatusTimeoutHandle),t.checkStatusTimeoutHandle=setTimeout(t.rpcCheckStatus.bind(t),1e4)}}),(function(){var e=t.ctx.defaultSubscription.rpcErrorText;t.onError(e),t.checkStatusTimeoutHandle&&clearTimeout(t.checkStatusTimeoutHandle),t.checkStatusTimeoutHandle=setTimeout(t.rpcCheckStatus.bind(t),1e4)})))},e.prototype.subscribeForValue=function(){var t=this,e=[{type:g.a.entity,entityType:Z.b.DEVICE,entityId:this.ctx.defaultSubscription.targetDeviceId}];"attribute"===this.retrieveValueMethod?e[0].attributes=[{name:this.valueAttribute}]:e[0].timeseries=[{name:this.valueAttribute}],this.ctx.subscriptionApi.createSubscriptionFromInfo(g.k.latest,e,this.subscriptionOptions,!1,!0).subscribe((function(e){t.subscription=e}))},e.prototype.onDataUpdated=function(t,e){var n=!1,i=t.data;if(i.length){var a=i[0];if(a&&a.data&&a.data[0]){var o=a.data[0][1];if(o){var r=null;try{r=this.parseValueFunction(JSON.parse(o))}catch(s){}n=!!r}}}this.setValue(n),e&&this.ctx.detectChanges()},e.prototype.onDataUpdateError=function(t,e){var n=this.utils.parseException(e),i=n.name;n.message&&(i+=": "+n.message),this.onError(i)},e.ctorParameters=function(){return[{type:p.a},{type:C.Store}]},Object(i.c)([Object(a.ViewChild)("led",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"ledRef",void 0),Object(i.c)([Object(a.ViewChild)("ledContainer",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"ledContainerRef",void 0),Object(i.c)([Object(a.ViewChild)("textMeasure",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"textMeasureRef",void 0),Object(i.c)([Object(a.ViewChild)("ledTitleContainer",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"ledTitleContainerRef",void 0),Object(i.c)([Object(a.ViewChild)("ledTitle",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"ledTitleRef",void 0),Object(i.c)([Object(a.ViewChild)("ledErrorContainer",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"ledErrorContainerRef",void 0),Object(i.c)([Object(a.ViewChild)("ledError",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"ledErrorRef",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",u.c)],e.prototype,"ctx",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-led-indicator",template:Object(i.f)(n("qeFx")).default,styles:[Object(i.f)(n("6vJj")).default]}),Object(i.g)("design:paramtypes",[p.a,C.Store])],e)}(S.a),Ut=function(t){function e(e,n){var i=t.call(this,n)||this;return i.utils=e,i.store=n,i.showTitle=!1,i.value=!1,i.error="",i.title="",i.checkboxId="onoff-"+i.utils.guid(),i}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){var t=this;this.switchElement=$(this.switchElementRef.nativeElement),this.switchContainer=$(this.switchContainerRef.nativeElement),this.onoff=$(this.onoffRef.nativeElement),this.textMeasure=$(this.textMeasureRef.nativeElement),this.switchTitleContainer=$(this.switchTitleContainerRef.nativeElement),this.switchTitle=$(this.switchTitleRef.nativeElement),this.switchErrorContainer=$(this.switchErrorContainerRef.nativeElement),this.switchError=$(this.switchErrorRef.nativeElement),this.onoff.on("change",(function(){t.value=!1===t.onoff.prop("checked"),t.onValue()})),this.switchResize$=new Wt.a((function(){t.resize()})),this.switchResize$.observe(this.switchContainerRef.nativeElement),this.init()},e.prototype.ngOnDestroy=function(){this.valueSubscription&&this.ctx.subscriptionApi.removeSubscription(this.valueSubscription.id),this.switchResize$&&this.switchResize$.disconnect()},e.prototype.init=function(){var t=this.ctx.settings;this.title=Object(w.k)(t.title)?t.title:"",this.showTitle=!(!this.title||!this.title.length);var e=!!Object(w.k)(t.initialValue)&&t.initialValue;this.setValue(e);var n=this.ctx.defaultSubscription.rpcEnabled;if(this.isSimulated=this.utils.widgetEditMode,this.requestTimeout=500,t.requestTimeout&&(this.requestTimeout=t.requestTimeout),this.retrieveValueMethod="rpc",t.retrieveValueMethod&&t.retrieveValueMethod.length&&(this.retrieveValueMethod=t.retrieveValueMethod),this.valueKey="value",t.valueKey&&t.valueKey.length&&(this.valueKey=t.valueKey),this.parseValueFunction=function(t){return!!t},t.parseValueFunction&&t.parseValueFunction.length)try{this.parseValueFunction=new Function("data",t.parseValueFunction)}catch(i){this.parseValueFunction=function(t){return!!t}}if(this.convertValueFunction=function(t){return t},t.convertValueFunction&&t.convertValueFunction.length)try{this.convertValueFunction=new Function("value",t.convertValueFunction)}catch(i){this.convertValueFunction=function(t){return t}}this.getValueMethod="getValue",t.getValueMethod&&t.getValueMethod.length&&(this.getValueMethod=t.getValueMethod),this.setValueMethod="setValue",t.setValueMethod&&t.setValueMethod.length&&(this.setValueMethod=t.setValueMethod),n?this.isSimulated||("rpc"===this.retrieveValueMethod?this.rpcRequestValue():"attribute"!==this.retrieveValueMethod&&"timeseries"!==this.retrieveValueMethod||this.subscribeForValue()):this.onError("Target device is not set!")},e.prototype.resize=function(){var t=this.switchContainer.width(),e=this.switchContainer.height(),n=Math.min(t,e)/260;this.switchElement.css({"-webkit-transform":"scale("+n+")","-moz-transform":"scale("+n+")","-ms-transform":"scale("+n+")","-o-transform":"scale("+n+")",transform:"scale("+n+")"}),this.showTitle&&this.setFontSize(this.switchTitle,this.title,2*this.switchTitleContainer.height()/3,this.switchTitleContainer.width()),this.setFontSize(this.switchError,this.error,this.switchErrorContainer.height(),this.switchErrorContainer.width())},e.prototype.setFontSize=function(t,e,n,i){for(var a=this.measureTextWidth(e,n);a>i;)n--,a=this.measureTextWidth(e,n);t.css({fontSize:n+"px",lineHeight:n+"px"})},e.prototype.measureTextWidth=function(t,e){return this.textMeasure.css({fontSize:e+"px",lineHeight:e+"px"}),this.textMeasure.text(t),this.textMeasure.width()},e.prototype.onError=function(t){this.error=t,this.setFontSize(this.switchError,this.error,this.switchErrorContainer.height(),this.switchErrorContainer.width()),this.ctx.detectChanges()},e.prototype.setValue=function(t){this.value=!!t,this.onoff.prop("checked",!this.value)},e.prototype.onValue=function(){this.rpcUpdateValue(this.value)},e.prototype.rpcRequestValue=function(){var t=this;this.error="",this.ctx.controlApi.sendTwoWayCommand(this.getValueMethod,null,this.requestTimeout).subscribe((function(e){t.setValue(t.parseValueFunction(e))}),(function(){var e=t.ctx.defaultSubscription.rpcErrorText;t.onError(e)}))},e.prototype.rpcUpdateValue=function(t){var e=this;this.executingUpdateValue?this.scheduledValue=t:(this.scheduledValue=null,this.rpcValue=t,this.executingUpdateValue=!0,this.error="",this.ctx.controlApi.sendOneWayCommand(this.setValueMethod,this.convertValueFunction(t),this.requestTimeout).subscribe((function(){e.executingUpdateValue=!1,null!=e.scheduledValue&&e.scheduledValue!==e.rpcValue&&e.rpcUpdateValue(e.scheduledValue)}),(function(){e.executingUpdateValue=!1;var t=e.ctx.defaultSubscription.rpcErrorText;e.onError(t)})))},e.prototype.subscribeForValue=function(){var t=this,e=[{type:g.a.entity,entityType:Z.b.DEVICE,entityId:this.ctx.defaultSubscription.targetDeviceId}];"attribute"===this.retrieveValueMethod?e[0].attributes=[{name:this.valueKey}]:e[0].timeseries=[{name:this.valueKey}];var n={callbacks:{onDataUpdated:function(e,n){return t.ctx.ngZone.run((function(){t.onDataUpdated(e,n)}))},onDataUpdateError:function(e,n){return t.ctx.ngZone.run((function(){t.onDataUpdateError(e,n)}))}}};this.ctx.subscriptionApi.createSubscriptionFromInfo(g.k.latest,e,n,!1,!0).subscribe((function(e){t.valueSubscription=e}))},e.prototype.onDataUpdated=function(t,e){var n=!1,i=t.data;if(i.length){var a=i[0];if(a&&a.data&&a.data[0]){var o=a.data[0][1];if(o){var r=null;try{r=this.parseValueFunction(JSON.parse(o))}catch(s){}n=!!r}}}this.setValue(n),e&&this.ctx.detectChanges()},e.prototype.onDataUpdateError=function(t,e){var n=this.utils.parseException(e),i=n.name;n.message&&(i+=": "+n.message),this.onError(i)},e.ctorParameters=function(){return[{type:p.a},{type:C.Store}]},Object(i.c)([Object(a.ViewChild)("switch",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"switchElementRef",void 0),Object(i.c)([Object(a.ViewChild)("switchContainer",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"switchContainerRef",void 0),Object(i.c)([Object(a.ViewChild)("onoff",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"onoffRef",void 0),Object(i.c)([Object(a.ViewChild)("textMeasure",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"textMeasureRef",void 0),Object(i.c)([Object(a.ViewChild)("switchTitleContainer",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"switchTitleContainerRef",void 0),Object(i.c)([Object(a.ViewChild)("switchTitle",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"switchTitleRef",void 0),Object(i.c)([Object(a.ViewChild)("switchErrorContainer",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"switchErrorContainerRef",void 0),Object(i.c)([Object(a.ViewChild)("switchError",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"switchErrorRef",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",u.c)],e.prototype,"ctx",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-round-switch",template:Object(i.f)(n("xOh4")).default,styles:[Object(i.f)(n("abO1")).default]}),Object(i.g)("design:paramtypes",[p.a,C.Store])],e)}(S.a),Gt=n("Wjhp"),Ht=function(t){function e(e,n){var i=t.call(this,n)||this;return i.utils=e,i.store=n,i.showTitle=!1,i.value=!1,i.error="",i.title="",i.showOnOffLabels=!1,i}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){var t=this;this.switchElement=$(this.switchElementRef.nativeElement),this.switchContainer=$(this.switchContainerRef.nativeElement),this.matSlideToggle=$(this.matSlideToggleRef._elementRef.nativeElement),this.onoffContainer=$(this.onoffContainerRef.nativeElement),this.onLabel=$(this.onLabelRef.nativeElement),this.offLabel=$(this.offLabelRef.nativeElement),this.switchTitleContainer=$(this.switchTitleContainerRef.nativeElement),this.switchTitle=$(this.switchTitleRef.nativeElement),this.textMeasure=$(this.textMeasureRef.nativeElement),this.switchErrorContainer=$(this.switchErrorContainerRef.nativeElement),this.switchError=$(this.switchErrorRef.nativeElement),this.switchResize$=new Wt.a((function(){t.resize()})),this.switchResize$.observe(this.switchContainerRef.nativeElement),this.init()},e.prototype.ngOnDestroy=function(){this.valueSubscription&&this.ctx.subscriptionApi.removeSubscription(this.valueSubscription.id),this.switchResize$&&this.switchResize$.disconnect()},e.prototype.init=function(){var t=this.ctx.settings;this.title=Object(w.k)(t.title)?t.title:"",this.showTitle=!(!this.title||!this.title.length),this.showOnOffLabels=!Object(w.k)(t.showOnOffLabels)||t.showOnOffLabels;var e=!!Object(w.k)(t.initialValue)&&t.initialValue;this.setValue(e);var n=this.ctx.defaultSubscription.rpcEnabled;if(this.isSimulated=this.utils.widgetEditMode,this.requestTimeout=500,t.requestTimeout&&(this.requestTimeout=t.requestTimeout),this.retrieveValueMethod="rpc",t.retrieveValueMethod&&t.retrieveValueMethod.length&&(this.retrieveValueMethod=t.retrieveValueMethod),this.valueKey="value",t.valueKey&&t.valueKey.length&&(this.valueKey=t.valueKey),this.parseValueFunction=function(t){return!!t},t.parseValueFunction&&t.parseValueFunction.length)try{this.parseValueFunction=new Function("data",t.parseValueFunction)}catch(i){this.parseValueFunction=function(t){return!!t}}if(this.convertValueFunction=function(t){return t},t.convertValueFunction&&t.convertValueFunction.length)try{this.convertValueFunction=new Function("value",t.convertValueFunction)}catch(i){this.convertValueFunction=function(t){return t}}this.getValueMethod="getValue",t.getValueMethod&&t.getValueMethod.length&&(this.getValueMethod=t.getValueMethod),this.setValueMethod="setValue",t.setValueMethod&&t.setValueMethod.length&&(this.setValueMethod=t.setValueMethod),n?this.isSimulated||("rpc"===this.retrieveValueMethod?this.rpcRequestValue():"attribute"!==this.retrieveValueMethod&&"timeseries"!==this.retrieveValueMethod||this.subscribeForValue()):this.onError("Target device is not set!")},e.prototype.resize=function(){var t=this.switchContainer.width(),e=this.switchContainer.height();this.showOnOffLabels&&(e=2*e/3),t/e>2.7893?t=2.7893*e:e=t/2.7893,this.switchElement.css({width:t,height:e}),this.matSlideToggle.css({width:t,height:e,minWidth:t}),this.showTitle&&this.setFontSize(this.switchTitle,this.title,2*this.switchTitleContainer.height()/3,this.switchTitleContainer.width()),this.showOnOffLabels&&(this.onoffContainer.css({width:t,height:this.switchContainer.height()/3}),this.setFontSize(this.onLabel,"OFF",this.onoffContainer.height(),this.onoffContainer.width()/2),this.setFontSize(this.offLabel,"OFF",this.onoffContainer.height(),this.onoffContainer.width()/2)),this.setFontSize(this.switchError,this.error,this.switchErrorContainer.height(),this.switchErrorContainer.width())},e.prototype.setFontSize=function(t,e,n,i){for(var a=this.measureTextWidth(e,n);a>i;)n--,a=this.measureTextWidth(e,n);t.css({fontSize:n+"px",lineHeight:n+"px"})},e.prototype.measureTextWidth=function(t,e){return this.textMeasure.css({fontSize:e+"px",lineHeight:e+"px"}),this.textMeasure.text(t),this.textMeasure.width()},e.prototype.onError=function(t){this.error=t,this.setFontSize(this.switchError,this.error,this.switchErrorContainer.height(),this.switchErrorContainer.width()),this.ctx.detectChanges()},e.prototype.setValue=function(t){this.value=!!t},e.prototype.onValue=function(){this.rpcUpdateValue(this.value)},e.prototype.rpcRequestValue=function(){var t=this;this.error="",this.ctx.controlApi.sendTwoWayCommand(this.getValueMethod,null,this.requestTimeout).subscribe((function(e){t.setValue(t.parseValueFunction(e))}),(function(){var e=t.ctx.defaultSubscription.rpcErrorText;t.onError(e)}))},e.prototype.rpcUpdateValue=function(t){var e=this;this.executingUpdateValue?this.scheduledValue=t:(this.scheduledValue=null,this.rpcValue=t,this.executingUpdateValue=!0,this.error="",this.ctx.controlApi.sendOneWayCommand(this.setValueMethod,this.convertValueFunction(t),this.requestTimeout).subscribe((function(){e.executingUpdateValue=!1,null!=e.scheduledValue&&e.scheduledValue!==e.rpcValue&&e.rpcUpdateValue(e.scheduledValue)}),(function(){e.executingUpdateValue=!1;var t=e.ctx.defaultSubscription.rpcErrorText;e.onError(t)})))},e.prototype.subscribeForValue=function(){var t=this,e=[{type:g.a.entity,entityType:Z.b.DEVICE,entityId:this.ctx.defaultSubscription.targetDeviceId}];"attribute"===this.retrieveValueMethod?e[0].attributes=[{name:this.valueKey}]:e[0].timeseries=[{name:this.valueKey}];var n={callbacks:{onDataUpdated:function(e,n){return t.ctx.ngZone.run((function(){t.onDataUpdated(e,n)}))},onDataUpdateError:function(e,n){return t.ctx.ngZone.run((function(){t.onDataUpdateError(e,n)}))}}};this.ctx.subscriptionApi.createSubscriptionFromInfo(g.k.latest,e,n,!1,!0).subscribe((function(e){t.valueSubscription=e}))},e.prototype.onDataUpdated=function(t,e){var n=!1,i=t.data;if(i.length){var a=i[0];if(a&&a.data&&a.data[0]){var o=a.data[0][1];if(o){var r=null;try{r=this.parseValueFunction(JSON.parse(o))}catch(s){}n=!!r}}}this.setValue(n),e&&this.ctx.detectChanges()},e.prototype.onDataUpdateError=function(t,e){var n=this.utils.parseException(e),i=n.name;n.message&&(i+=": "+n.message),this.onError(i)},e.ctorParameters=function(){return[{type:p.a},{type:C.Store}]},Object(i.c)([Object(a.ViewChild)("switch",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"switchElementRef",void 0),Object(i.c)([Object(a.ViewChild)("switchContainer",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"switchContainerRef",void 0),Object(i.c)([Object(a.ViewChild)("matSlideToggle",{static:!0}),Object(i.g)("design:type",Gt.a)],e.prototype,"matSlideToggleRef",void 0),Object(i.c)([Object(a.ViewChild)("onoffContainer",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"onoffContainerRef",void 0),Object(i.c)([Object(a.ViewChild)("onLabel",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"onLabelRef",void 0),Object(i.c)([Object(a.ViewChild)("offLabel",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"offLabelRef",void 0),Object(i.c)([Object(a.ViewChild)("switchTitleContainer",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"switchTitleContainerRef",void 0),Object(i.c)([Object(a.ViewChild)("switchTitle",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"switchTitleRef",void 0),Object(i.c)([Object(a.ViewChild)("textMeasure",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"textMeasureRef",void 0),Object(i.c)([Object(a.ViewChild)("switchErrorContainer",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"switchErrorContainerRef",void 0),Object(i.c)([Object(a.ViewChild)("switchError",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"switchErrorRef",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",u.c)],e.prototype,"ctx",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-switch",template:Object(i.f)(n("L8ka")).default,styles:[Object(i.f)(n("wpRk")).default]}),Object(i.g)("design:paramtypes",[p.a,C.Store])],e)}(S.a),Kt=n("QR2c"),Yt=it,Zt=function(t){function e(e,n){var i=t.call(this,n)||this;return i.utils=e,i.store=n,i.value="0",i.error="",i.title="",i.startDeg=-1,i.currentDeg=0,i.rotation=0,i.lastDeg=0,i.moving=!1,i.minDeg=-45,i.maxDeg=225,i}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){var t=this;this.knob=$(this.knobRef.nativeElement),this.knobContainer=$(this.knobContainerRef.nativeElement),this.knobTopPointerContainer=$(this.knobTopPointerContainerRef.nativeElement),this.knobTopPointer=$(this.knobTopPointerRef.nativeElement),this.knobValueContainer=$(this.knobValueContainerRef.nativeElement),this.knobValue=$(this.knobValueRef.nativeElement),this.knobTitleContainer=$(this.knobTitleContainerRef.nativeElement),this.knobTitle=$(this.knobTitleRef.nativeElement),this.knobErrorContainer=$(this.knobErrorContainerRef.nativeElement),this.knobError=$(this.knobErrorRef.nativeElement),this.knobMinmaxContainer=$(this.knobMinmaxContainerRef.nativeElement),this.minmaxLabel=this.knobMinmaxContainer.find(".minmax-label"),this.textMeasure=$(this.textMeasureRef.nativeElement),this.canvasBarElement=this.canvasBarElementRef.nativeElement,this.knobResize$=new Wt.a((function(){t.resize()})),this.knobResize$.observe(this.knobContainerRef.nativeElement),this.init()},e.prototype.ngOnDestroy=function(){this.knobResize$&&this.knobResize$.disconnect()},e.prototype.init=function(){var t=this,e=this.ctx.settings;this.minValue=Object(w.k)(e.minValue)?e.minValue:0,this.maxValue=Object(w.k)(e.maxValue)?e.maxValue:100,this.title=Object(w.k)(e.title)?e.title:"";var n={renderTo:this.canvasBarElement,hideValue:!0,neonGlowBrightness:0,gaugeWidthScale:.4,gaugeColor:"rgba(0, 0, 0, 0)",levelColors:["#19ff4b","#ffff19","#ff3232"],minValue:this.minValue,maxValue:this.maxValue,gaugeType:"donut",dashThickness:2,donutStartAngle:3/4*Math.PI,donutEndAngle:9/4*Math.PI,animation:!1};this.canvasBar=new Kt.a(n).draw(),this.knob.on("click",(function(e){if(t.moving)return t.moving=!1,!1;e.preventDefault();var n=t.knob.offset(),i=n.top+t.knob.height()/2,a=n.left+t.knob.width()/2,o=180/Math.PI,r=e.originalEvent.touches?e.originalEvent.touches[0]:e,s=i-r.pageY,l=a-r.pageX,c=Math.atan2(s,l)*o;if(c<0&&(c=360+c),c>t.maxDeg){if(!(c-360>t.minDeg))return!1;c-=360}t.currentDeg=c,t.lastDeg=c,t.knobTopPointerContainer.css("transform","rotate("+t.currentDeg+"deg)"),t.turn(t.degreeToRatio(t.currentDeg)),t.rotation=t.currentDeg,t.startDeg=-1})),this.knob.on("mousedown touchstart",(function(e){e.preventDefault();var n=t.knob.offset(),i=n.top+t.knob.height()/2,a=n.left+t.knob.width()/2,o=180/Math.PI;t.knob.on("mousemove.rem touchmove.rem",(function(e){t.moving=!0;var n=e.originalEvent.touches?e.originalEvent.touches[0]:e,r=i-n.pageY,s=a-n.pageX,l=Math.atan2(r,s)*o;l<0&&(l=360+l),-1===t.startDeg&&(t.startDeg=l);var c=Math.floor(l-t.startDeg+t.rotation);(c<0?c=360+c:c>359&&(c%=360),c>t.maxDeg)&&(c-360>t.minDeg?c-=360:c=Math.abs(t.maxDeg-t.lastDeg)<Math.abs(t.minDeg-t.lastDeg)?t.maxDeg:t.minDeg);if(Math.abs(c-t.lastDeg)>180)return t.startDeg=l,t.rotation=t.currentDeg,!1;t.currentDeg=c,t.lastDeg=c,t.knobTopPointerContainer.css("transform","rotate("+t.currentDeg+"deg)"),t.turn(t.degreeToRatio(t.currentDeg))})),$(document).on("mouseup.rem  touchend.rem",(function(){t.knob.off(".rem"),$(document).off(".rem"),t.rotation=t.currentDeg,t.startDeg=-1}))}));var i=Object(w.k)(e.initialValue)?e.initialValue:this.minValue;this.setValue(i);var a=this.ctx.defaultSubscription.rpcEnabled;this.isSimulated=this.utils.widgetEditMode,this.requestTimeout=500,e.requestTimeout&&(this.requestTimeout=e.requestTimeout),this.getValueMethod="getValue",e.getValueMethod&&e.getValueMethod.length&&(this.getValueMethod=e.getValueMethod),this.setValueMethod="setValue",e.setValueMethod&&e.setValueMethod.length&&(this.setValueMethod=e.setValueMethod),a?this.isSimulated||this.rpcRequestValue():this.onError("Target device is not set!")},e.prototype.degreeToRatio=function(t){return(t-this.minDeg)/(this.maxDeg-this.minDeg)},e.prototype.ratioToDegree=function(t){return this.minDeg+t*(this.maxDeg-this.minDeg)},e.prototype.turn=function(t){var e=Number((this.minValue+(this.maxValue-this.minValue)*t).toFixed(this.ctx.decimals));this.canvasBar.value!==e&&(this.canvasBar.value=e),this.updateColor(this.canvasBar.getValueColor()),this.onValue(e)},e.prototype.resize=function(){var t=this.knobContainer.width(),e=this.knobContainer.height(),n=Math.min(t,e);this.knob.css({width:n,height:n}),this.canvasBar.update({width:n,height:n}),this.setFontSize(this.knobTitle,this.title,this.knobTitleContainer.height(),this.knobTitleContainer.width()),this.setFontSize(this.knobError,this.error,this.knobErrorContainer.height(),this.knobErrorContainer.width());var i=this.knobMinmaxContainer.height();this.minmaxLabel.css({fontSize:i+"px",lineHeight:i+"px"}),this.checkValueSize()},e.prototype.checkValueSize=function(){var t=this.knobValueContainer.height()/3.3,e=this.knobValueContainer.width();this.setFontSize(this.knobValue,this.value+"",t,e)},e.prototype.setFontSize=function(t,e,n,i){for(var a=this.measureTextWidth(e,n);a>i&&!(--n<0);)a=this.measureTextWidth(e,n);t.css({fontSize:n+"px",lineHeight:n+"px"})},e.prototype.measureTextWidth=function(t,e){return this.textMeasure.css({fontSize:e+"px",lineHeight:e+"px"}),this.textMeasure.html(t),this.textMeasure.width()},e.prototype.setValue=function(t){var e=(t-this.minValue)/(this.maxValue-this.minValue);this.rotation=this.lastDeg=this.currentDeg=this.ratioToDegree(e),this.knobTopPointerContainer.css("transform","rotate("+this.currentDeg+"deg)"),this.canvasBar.value!==t&&(this.canvasBar.value=t),this.updateColor(this.canvasBar.getValueColor()),this.value=this.formatValue(t),this.checkValueSize(),this.ctx.detectChanges()},e.prototype.updateColor=function(t){var e=Yt(t).brighten(30).toHexString();this.knobValue.css({color:e});var n=t+" 1px 1px 10px, "+e+" 1px 1px 10px";this.knobValue.css({textShadow:n}),this.knobTopPointer.css({backgroundColor:e});var i="inset 1px 0 2px #040404, 1px 1px 8px 2px "+e;this.knobTopPointer.css({boxShadow:i})},e.prototype.onValue=function(t){this.value=this.formatValue(t),this.checkValueSize(),this.rpcUpdateValue(t),this.ctx.detectChanges()},e.prototype.formatValue=function(t){return this.ctx.utils.formatValue(t,this.ctx.decimals,this.ctx.units,!0)},e.prototype.rpcRequestValue=function(){var t=this;this.error="",this.ctx.controlApi.sendTwoWayCommand(this.getValueMethod,null,this.requestTimeout).subscribe((function(e){if(Object(w.q)(e)){var n=Number(Number(e).toFixed(t.ctx.decimals));t.setValue(n)}else{var i="Unable to parse response: "+e;t.onError(i)}}),(function(){var e=t.ctx.defaultSubscription.rpcErrorText;t.onError(e)}))},e.prototype.rpcUpdateValue=function(t){var e=this;this.executingUpdateValue?this.scheduledValue=t:(this.scheduledValue=null,this.rpcValue=t,this.executingUpdateValue=!0,this.error="",this.ctx.controlApi.sendOneWayCommand(this.setValueMethod,t,this.requestTimeout).subscribe((function(){e.executingUpdateValue=!1,null!=e.scheduledValue&&e.scheduledValue!==e.rpcValue&&e.rpcUpdateValue(e.scheduledValue)}),(function(){e.executingUpdateValue=!1;var t=e.ctx.defaultSubscription.rpcErrorText;e.onError(t)})))},e.prototype.onError=function(t){this.error=t,this.setFontSize(this.knobError,this.error,this.knobErrorContainer.height(),this.knobErrorContainer.width()),this.ctx.detectChanges()},e.ctorParameters=function(){return[{type:p.a},{type:C.Store}]},Object(i.c)([Object(a.ViewChild)("knob",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"knobRef",void 0),Object(i.c)([Object(a.ViewChild)("knobContainer",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"knobContainerRef",void 0),Object(i.c)([Object(a.ViewChild)("knobTopPointerContainer",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"knobTopPointerContainerRef",void 0),Object(i.c)([Object(a.ViewChild)("knobTopPointer",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"knobTopPointerRef",void 0),Object(i.c)([Object(a.ViewChild)("knobValueContainer",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"knobValueContainerRef",void 0),Object(i.c)([Object(a.ViewChild)("knobValue",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"knobValueRef",void 0),Object(i.c)([Object(a.ViewChild)("knobErrorContainer",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"knobErrorContainerRef",void 0),Object(i.c)([Object(a.ViewChild)("knobError",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"knobErrorRef",void 0),Object(i.c)([Object(a.ViewChild)("knobTitleContainer",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"knobTitleContainerRef",void 0),Object(i.c)([Object(a.ViewChild)("knobTitle",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"knobTitleRef",void 0),Object(i.c)([Object(a.ViewChild)("knobMinmaxContainer",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"knobMinmaxContainerRef",void 0),Object(i.c)([Object(a.ViewChild)("textMeasure",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"textMeasureRef",void 0),Object(i.c)([Object(a.ViewChild)("canvasBar",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"canvasBarElementRef",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",u.c)],e.prototype,"ctx",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-knob",template:Object(i.f)(n("4eaF")).default,styles:[Object(i.f)(n("XHOO")).default]}),Object(i.g)("design:paramtypes",[p.a,C.Store])],e)}(S.a),qt=function(){function t(){}return t=Object(i.c)([Object(a.NgModule)({declarations:[Bt,Ut,Ht,Zt],imports:[P.CommonModule,W.a],exports:[Bt,Ut,Ht,Zt]})],t)}();function $t(t){var e,n=t.startDate,i=t.endDate;if(0===n.diff(i,"days"))e=n.format("DD MMM YYYY");else{var a="DD";n.month()===i.month()&&n.year()===i.year()||(a+=" MMM"),n.year()!==i.year()&&(a+=" YYYY"),e=n.format(a)+" - "+i.format("DD MMM YYYY")}return e}var Xt,Qt={hour:{ts:36e5,label:"Hour"},day:{ts:864e5,label:"Day"},week:{ts:6048e5,label:"Week"},twoWeeks:{ts:12096e5,label:"2 weeks"},month:{ts:2629743e3,label:"Month"},threeMonths:{ts:7889229e3,label:"3 months"},sixMonths:{ts:15778458e3,label:"6 months"}},Jt=n("wd/R"),te=n("agxM"),ee=n("aX2P"),ne=function(t){function e(e,n,i,a){var o=t.call(this,a)||this;return o.utils=e,o.overlay=n,o.viewContainerRef=i,o.store=a,o.datesMap=Qt,o.advancedModel={},o.firstUpdate=!0,o.originalOrder=function(t,e){return 0},o}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){var t,e=this;if(this.settings=this.ctx.settings,this.settings.useSessionStorage=!Object(w.k)(this.settings.useSessionStorage)||this.settings.useSessionStorage,this.settings.useSessionStorage&&(t=this.readFromStorage("date-range")),t)this.advancedModel={chosenLabel:t.name,startDate:Jt(t.start),endDate:Jt(t.end)};else{var n=new Date;n.setHours(23,59,59,999),this.advancedModel={startDate:Jt(n.getTime()+1-this.datesMap[this.settings.initialInterval||"week"].ts),endDate:Jt(n.getTime())},this.advancedModel.chosenLabel=$t(this.advancedModel)}this.selectedStepSize=this.datesMap[this.settings.stepSize||"day"].ts,this.widgetContextTimewindowSync(),this.dashboardTimewindowChangedSubscription=this.ctx.dashboard.dashboardTimewindowChanged.subscribe((function(){e.widgetContextTimewindowSync()}))},e.prototype.ngOnDestroy=function(){this.dashboardTimewindowChangedSubscription&&(this.dashboardTimewindowChangedSubscription.unsubscribe(),this.dashboardTimewindowChangedSubscription=null)},e.prototype.openNavigatorPanel=function(t){var e=this;t&&t.stopPropagation(),this.datePickerSelect.close();var n=t.target||t.srcElement||t.currentTarget,i=new pt.d;i.backdropClass="cdk-overlay-transparent-backdrop",i.hasBackdrop=!0,i.panelClass="tb-date-range-navigator-panel";i.positionStrategy=this.overlay.position().flexibleConnectedTo(n).withPositions([{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}]);var a=this.overlay.create(i);a.backdropClick().subscribe((function(){a.dispose()}));var o,r,s=new WeakMap([[ie,{model:(o=this.advancedModel,r={},r.chosenLabel=o.chosenLabel,r.startDate=o.startDate?o.startDate.clone():void 0,r.endDate=o.endDate?o.endDate.clone():void 0,r),settings:this.settings,onChange:function(t){e.advancedModel=t,e.triggerChange()}}],[pt.g,a]]),l=new mt.g(this.viewContainerRef.injector,s);a.attach(new mt.d(ae,this.viewContainerRef,l)),this.ctx.detectChanges()},e.prototype.widgetContextTimewindowSync=function(){this.firstUpdate||this.updateAdvancedModel(),this.updateDateInterval(),this.settings.useSessionStorage&&this.updateStorageDate(),this.firstUpdate&&(this.firstUpdate=!1,this.updateTimewindow(this.advancedModel.startDate.valueOf(),this.advancedModel.endDate.valueOf())),this.ctx.detectChanges()},e.prototype.updateAdvancedModel=function(){var t=this.ctx.dashboardTimewindow;if(t.selectedTab===ee.g.HISTORY&&t.history.historyType===ee.d.FIXED){var e=t.history.fixedTimewindow;this.advancedModel.startDate=Jt(e.startTimeMs),this.advancedModel.endDate=Jt(e.endTimeMs),this.advancedModel.chosenLabel=$t(this.advancedModel)}},e.prototype.updateTimewindow=function(t,e){this.ctx.dashboard.onUpdateTimewindow(t,e,10,!0)},e.prototype.updateDateInterval=function(){for(var t=this.advancedModel.endDate.valueOf()-this.advancedModel.startDate.valueOf(),e=0,n=Object.keys(this.datesMap);e<n.length;e++){var i=n[e];if(Object.prototype.hasOwnProperty.call(this.datesMap,i)&&(this.datesMap[i].ts===t||this.datesMap[i].ts===t+1||this.datesMap[i].ts===t-1))return this.selectedDateInterval=this.datesMap[i].ts,void(this.customInterval=void 0)}this.selectedDateInterval=t,this.customInterval={ts:t,label:"Custom interval"}},e.prototype.triggerChange=function(){this.updateTimewindow(this.advancedModel.startDate.valueOf(),this.advancedModel.endDate.valueOf())},e.prototype.changeInterval=function(){var t=this.ctx.dashboard.dashboardTimewindow.history?this.ctx.dashboard.dashboardTimewindow.history.fixedTimewindow.endTimeMs:this.advancedModel.endDate.valueOf();this.updateTimewindow(t-this.selectedDateInterval/2,t+this.selectedDateInterval/2)},e.prototype.goBack=function(){this.step(-1)},e.prototype.goForth=function(){this.step(1)},e.prototype.step=function(t){var e=this.ctx.dashboard.dashboardTimewindow.history?this.ctx.dashboard.dashboardTimewindow.history.fixedTimewindow.startTimeMs:this.advancedModel.startDate.valueOf(),n=this.ctx.dashboard.dashboardTimewindow.history?this.ctx.dashboard.dashboardTimewindow.history.fixedTimewindow.endTimeMs:this.advancedModel.endDate.valueOf();this.updateTimewindow(e+this.selectedStepSize*t,n+this.selectedStepSize*t)},e.prototype.readFromStorage=function(t){if(window.sessionStorage.getItem(t)){var e=JSON.parse(window.sessionStorage.getItem(t));return e.start=new Date(parseInt(e.start,10)),e.end=new Date(parseInt(e.end,10)),e}},e.prototype.updateStorageDate=function(){this.saveIntoStorage("date-range",{start:this.advancedModel.startDate.valueOf(),end:this.advancedModel.endDate.valueOf(),name:this.advancedModel.chosenLabel})},e.prototype.saveIntoStorage=function(t,e){e&&window.sessionStorage.setItem(t,JSON.stringify(e))},e.ctorParameters=function(){return[{type:p.a},{type:pt.c},{type:a.ViewContainerRef},{type:C.Store}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",u.c)],e.prototype,"ctx",void 0),Object(i.c)([Object(a.ViewChild)("datePicker",{static:!0}),Object(i.g)("design:type",te.a)],e.prototype,"datePickerSelect",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-date-range-navigator-widget",template:Object(i.f)(n("QtQQ")).default,styles:[Object(i.f)(n("rLQf")).default]}),Object(i.g)("design:paramtypes",[p.a,pt.c,a.ViewContainerRef,C.Store])],e)}(S.a),ie=new a.InjectionToken("DateRangeNavigatorPanelData"),ae=function(){function t(t,e){this.data=t,this.overlayRef=e,this.locale={},this.model=t.model,this.settings=t.settings,this.locale.firstDay=this.settings.firstDayOfWeek||1,this.locale.daysOfWeek=Jt.weekdaysMin(),this.locale.monthNames=Jt.monthsShort()}return t.prototype.choosedDate=function(t){this.model=t,this.model.chosenLabel=$t(this.model),this.settings.autoConfirm&&(this.data.onChange(this.model),this.overlayRef.dispose())},t.prototype.apply=function(){this.data.onChange(this.model),this.overlayRef.dispose()},t.ctorParameters=function(){return[{type:void 0,decorators:[{type:a.Inject,args:[ie]}]},{type:pt.g}]},t=Object(i.c)([Object(a.Component)({selector:"tb-date-range-navigator-panel",template:Object(i.f)(n("YmHn")).default,encapsulation:a.ViewEncapsulation.None,styles:[Object(i.f)(n("D2iO")).default]}),Object(i.h)(0,Object(a.Inject)(ie)),Object(i.g)("design:paramtypes",[Object,pt.g])],t)}(),oe=function(t){function e(e,n,i,a,o,r,s,l,c){var d=t.call(this,e)||this;return d.store=e,d.elementRef=n,d.ngZone=i,d.overlay=a,d.viewContainerRef=o,d.utils=r,d.fb=s,d.attributeService=l,d.translate=c,d.sources=[],d.entityDetected=!1,d.isAllParametersValid=!0,d.toastTargetId="multiple-input-widget"+d.utils.guid(),d}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){var t=this;this.ctx.$scope.multipleInputWidget=this,this.settings=this.ctx.settings,this.widgetConfig=this.ctx.widgetConfig,this.subscription=this.ctx.defaultSubscription,this.datasources=this.subscription.datasources,this.initializeConfig(),this.updateDatasources(),this.buildForm(),this.ctx.updateWidgetParams(),this.formResize$=new Wt.a((function(){t.resize()})),this.formResize$.observe(this.formContainerRef.nativeElement)},e.prototype.ngOnDestroy=function(){this.formResize$&&this.formResize$.disconnect()},e.prototype.initializeConfig=function(){this.settings.widgetTitle&&this.settings.widgetTitle.length?this.ctx.widgetTitle=this.utils.customTranslation(this.settings.widgetTitle,this.settings.widgetTitle):this.ctx.widgetTitle=this.ctx.widgetConfig.title,this.settings.groupTitle=this.settings.groupTitle||"${entityName}",Object(w.u)(this.settings.showActionButtons)&&(this.settings.showActionButtons=!0),Object(w.u)(this.settings.fieldsAlignment)&&(this.settings.fieldsAlignment="row"),Object(w.u)(this.settings.fieldsInRow)&&(this.settings.fieldsInRow=2),this.isVerticalAlignment=!("row"===this.settings.fieldsAlignment),!this.isVerticalAlignment&&this.settings.fieldsInRow&&(this.inputWidthSettings=100/this.settings.fieldsInRow+"%"),this.updateWidgetDisplaying()},e.prototype.updateDatasources=function(){var t=this;if(this.datasources&&this.datasources.length){this.entityDetected=!0;var e=0;this.datasources.forEach((function(n){var i={datasource:n,keys:[]};n.type===g.a.entity?n.dataKeys.forEach((function(a){n.entityType!==Z.b.DEVICE&&"shared"===a.settings.dataKeyType&&(t.isAllParametersValid=!1),a.units&&(a.label+=" ("+a.units+")"),a.formId=++e+"",a.isFocused=!1,Object(w.u)(a.settings.dataKeyType)&&(t.settings.attributesShared?a.settings.dataKeyType="shared":a.settings.dataKeyType="server"),Object(w.u)(a.settings.dataKeyValueType)&&(a.settings.inputTypeNumber?a.settings.dataKeyValueType="double":a.settings.dataKeyValueType="string"),Object(w.u)(a.settings.isEditable)&&(a.settings.readOnly?a.settings.isEditable="readonly":a.settings.isEditable="editable"),i.keys.push(a)})):t.entityDetected=!1,t.sources.push(i)}))}},e.prototype.buildForm=function(){var t=this;this.multipleInputFormGroup=this.fb.group({}),this.sources.forEach((function(e){for(var n=0,i=t.visibleKeys(e);n<i.length;n++){var a=i[n],o=[];a.settings.required&&o.push(_.Validators.required),"integer"===a.settings.dataKeyValueType&&o.push(_.Validators.pattern(/^-?[0-9]+$/));var r=t.fb.control({value:a.value,disabled:"disabled"===a.settings.isEditable||a.settings.disabledOnCondition},o);t.multipleInputFormGroup.addControl(a.formId,r)}}))},e.prototype.updateWidgetData=function(t){var e=this,n=0;this.sources.forEach((function(i){i.keys.forEach((function(a){var o=t[n].data;if(o&&o.length){var r=void 0;switch(a.settings.dataKeyValueType){case"dateTime":case"date":r=Jt(o[0][1]).toDate();break;case"time":r=Jt().startOf("day").add(o[0][1],"ms").toDate();break;case"booleanCheckbox":case"booleanSwitch":r="true"===o[0][1];break;default:r=o[0][1]}a.value=r}if("editable"===a.settings.isEditable&&a.settings.disabledOnDataKey){var s=t.filter((function(t){return i.datasource===t.datasource&&t.dataKey.name===a.settings.disabledOnDataKey}));s&&s.length&&s[0].data.length&&("false"===s[0].data[0][1]?a.settings.disabledOnCondition=!0:a.settings.disabledOnCondition=!s[0].data[0][1])}if(!a.settings.dataKeyHidden){"disabled"===a.settings.isEditable||a.settings.disabledOnCondition?e.multipleInputFormGroup.get(a.formId).disable({emitEvent:!1}):e.multipleInputFormGroup.get(a.formId).enable({emitEvent:!1});var l=e.multipleInputFormGroup.get(a.formId).dirty;a.isFocused||l||e.multipleInputFormGroup.get(a.formId).patchValue(a.value,{emitEvent:!1})}n++}))}))},e.prototype.updateWidgetDisplaying=function(){this.changeAlignment=this.ctx.$container&&this.ctx.$container[0].offsetWidth<620,this.smallWidthContainer=this.ctx.$container&&this.ctx.$container[0].offsetWidth<420},e.prototype.onDataUpdated=function(){var t=this;this.ngZone.run((function(){t.updateWidgetData(t.subscription.data),t.ctx.detectChanges()}))},e.prototype.resize=function(){var t=this;this.ngZone.run((function(){t.updateWidgetDisplaying(),t.ctx.detectChanges()}))},e.prototype.getGroupTitle=function(t){return Object(w.c)(t,this.settings.groupTitle)},e.prototype.visibleKeys=function(t){return t.keys.filter((function(t){return!t.settings.dataKeyHidden}))},e.prototype.datePickerType=function(t){switch(t){case"dateTime":return"datetime";case"date":return"date";case"time":return"time"}},e.prototype.focusInputElement=function(t){t.target.select()},e.prototype.inputChanged=function(t,e){if(!this.settings.showActionButtons){var n=this.multipleInputFormGroup.get(e.formId).value;if(!e.settings.required||e.settings.required&&Object(w.k)(n)){var i={datasource:t.datasource,keys:[e]};this.save(i)}}},e.prototype.save=function(t){var e,n=this,i={ignoreLoading:!this.settings.showActionButtons};e=t?[t]:this.sources;var a=[];e.forEach((function(t){for(var e=[],o=[],r=[],s=0,l=n.visibleKeys(t);s<l.length;s++){var c=l[s],d=n.multipleInputFormGroup.get(c.formId).value;if(!Object(w.n)(d,c.value)||n.settings.updateAllValues){var u={key:c.name,value:null};if(d)switch(c.settings.dataKeyValueType){case"dateTime":case"date":u.value=d.getTime();break;case"time":u.value=d.getTime()-Jt().startOf("day").valueOf();break;default:u.value=d}else u.value=""===d?null:d;switch(c.settings.dataKeyType){case"shared":o.push(u);break;case"timeseries":r.push(u);break;default:e.push(u)}}}var h={entityType:t.datasource.entityType,id:t.datasource.entityId};e.length&&a.push(n.attributeService.saveEntityAttributes(h,U.a.SERVER_SCOPE,e,i)),o.length&&a.push(n.attributeService.saveEntityAttributes(h,U.a.SHARED_SCOPE,o,i)),r.length&&a.push(n.attributeService.saveEntityTimeseries(h,U.e.LATEST_TELEMETRY,r,i))})),a.length?Object(l.a)(a).subscribe((function(){n.multipleInputFormGroup.reset(void 0,{emitEvent:!1}),n.multipleInputFormGroup.markAsPristine(),n.settings.showResultMessage&&n.ctx.showSuccessToast(n.translate.instant("widgets.input-widgets.update-successful"),1e3,"bottom","left",n.toastTargetId)}),(function(){n.settings.showResultMessage&&n.ctx.showErrorToast(n.translate.instant("widgets.input-widgets.update-failed"),"bottom","left",n.toastTargetId)})):(this.multipleInputFormGroup.reset(void 0,{emitEvent:!1}),this.multipleInputFormGroup.markAsPristine())},e.prototype.discardAll=function(){var t=this;this.multipleInputFormGroup.reset(void 0,{emitEvent:!1}),this.sources.forEach((function(e){for(var n=0,i=t.visibleKeys(e);n<i.length;n++){var a=i[n];t.multipleInputFormGroup.get(a.formId).patchValue(a.value,{emitEvent:!1})}})),this.multipleInputFormGroup.markAsPristine()},e.ctorParameters=function(){return[{type:C.Store},{type:a.ElementRef},{type:a.NgZone},{type:pt.c},{type:a.ViewContainerRef},{type:p.a},{type:_.FormBuilder},{type:D.a},{type:x.TranslateService}]},Object(i.c)([Object(a.ViewChild)("formContainer",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"formContainerRef",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",u.c)],e.prototype,"ctx",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-multiple-input-widget ",template:Object(i.f)(n("Ys3/")).default,styles:[Object(i.f)(n("3Dpw")).default]}),Object(i.g)("design:paramtypes",[C.Store,a.ElementRef,a.NgZone,pt.c,a.ViewContainerRef,p.a,_.FormBuilder,D.a,x.TranslateService])],e)}(S.a),re=n("oTDE"),se=n("wtyh"),le=function(t){function e(e,n,i,a,o,r,s){var l=t.call(this,n)||this;return l.window=e,l.store=n,l.elementRef=i,l.ngZone=a,l.overlay=o,l.utils=r,l.attributeService=s,l.videoInputsIndex=0,l.width=640,l.height=480,l.isEntityDetected=!1,l.dataKeyDetected=!1,l.isCameraSupport=!1,l.isDeviceDetect=!1,l.isShowCamera=!1,l.isPreviewPhoto=!1,l.singleDevice=!0,l.updatePhoto=!1,l}var o;return Object(i.d)(e,t),o=e,Object.defineProperty(e.prototype,"videoElement",{get:function(){return this.videoStreamRef.nativeElement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"canvasElement",{get:function(){return this.canvasRef.nativeElement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"videoWidth",{get:function(){var t=this.getVideoAspectRatio();return Math.min(this.width,this.height*t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"videoHeight",{get:function(){var t=this.getVideoAspectRatio();return Math.min(this.height,this.width/t)},enumerable:!0,configurable:!0}),e.hasGetUserMedia=function(){return!(!window.navigator.mediaDevices||!window.navigator.mediaDevices.getUserMedia)},e.getAvailableVideoInputs=function(){return new Promise((function(t,e){navigator.mediaDevices.enumerateDevices().then((function(e){t(e.filter((function(t){return"videoinput"===t.kind})))})).catch((function(t){e(t.message||t)}))}))},e.prototype.ngOnInit=function(){this.ctx.$scope.webCameraInputWidget=this,this.settings=this.ctx.settings,this.datasource=this.ctx.datasources[0],this.settings.widgetTitle&&this.settings.widgetTitle.length?this.ctx.widgetTitle=this.utils.customTranslation(this.settings.widgetTitle,this.settings.widgetTitle):this.ctx.widgetTitle=this.ctx.widgetConfig.title,this.width=this.settings.maxWidth?this.settings.maxWidth:640,this.height=this.settings.maxHeight?this.settings.maxWidth:480,this.datasource.type===g.a.entity&&this.datasource.entityType&&this.datasource.entityId&&(this.isEntityDetected=!0),this.datasource.dataKeys.length&&(this.dataKeyDetected=!0),this.detectAvailableDevices()},e.prototype.ngOnDestroy=function(){this.stopMediaTracks()},e.prototype.updateWidgetData=function(t){var e=t[0].data;e&&e.length&&(this.lastPhoto=e[0][1])},e.prototype.onDataUpdated=function(){var t=this;this.ngZone.run((function(){t.updateWidgetData(t.ctx.defaultSubscription.data),t.ctx.detectChanges()}))},e.prototype.detectAvailableDevices=function(){var t=this;o.hasGetUserMedia()&&(this.isCameraSupport=!0,o.getAvailableVideoInputs().then((function(e){t.isDeviceDetect=!!e.length,t.singleDevice=e.length<2,t.availableVideoInputs=e,t.ctx.detectChanges()}),(function(){t.availableVideoInputs=[]})))},e.prototype.getVideoAspectRatio=function(){return this.videoElement.videoWidth&&this.videoElement.videoWidth>0&&this.videoElement.videoHeight&&this.videoElement.videoHeight>0?this.videoElement.videoWidth/this.videoElement.videoHeight:this.width/this.height},e.prototype.stopMediaTracks=function(){this.mediaStream&&this.mediaStream.getTracks&&this.mediaStream.getTracks().forEach((function(t){return t.stop()}))},e.prototype.takePhoto=function(){this.isShowCamera=!0,this.initWebCamera(this.availableVideoInputs[this.videoInputsIndex].deviceId)},e.prototype.closeCamera=function(){this.stopMediaTracks(),this.videoElement.srcObject=null,this.isShowCamera=!1},e.prototype.cancelPhoto=function(){this.isPreviewPhoto=!1,this.previewPhoto=""},e.prototype.savePhoto=function(){var t,e=this;this.updatePhoto=!0;var n={entityType:this.datasource.entityType,id:this.datasource.entityId},i=[{key:this.datasource.dataKeys[0].name,value:this.previewPhoto}];this.datasource.dataKeys[0].type===U.c.attribute?t=this.attributeService.saveEntityAttributes(n,U.a.SERVER_SCOPE,i):this.datasource.dataKeys[0].type===U.c.timeseries&&(t=this.attributeService.saveEntityTimeseries(n,"scope",i)),t.subscribe((function(){e.isPreviewPhoto=!1,e.updatePhoto=!1,e.closeCamera()}),(function(){e.updatePhoto=!1}))},e.prototype.switchWebCamera=function(){this.videoInputsIndex=(this.videoInputsIndex+1)%this.availableVideoInputs.length,this.stopMediaTracks(),this.initWebCamera(this.availableVideoInputs[this.videoInputsIndex].deviceId)},e.prototype.createPhoto=function(){this.canvasElement.width=this.videoWidth,this.canvasElement.height=this.videoHeight,this.canvasElement.getContext("2d").drawImage(this.videoElement,0,0,this.videoWidth,this.videoHeight);var t=this.settings.imageFormat?this.settings.imageFormat:o.DEFAULT_IMAGE_TYPE,e=this.settings.imageQuality?this.settings.imageQuality:o.DEFAULT_IMAGE_QUALITY;this.previewPhoto=this.canvasElement.toDataURL(t,e),this.isPreviewPhoto=!0},e.prototype.initWebCamera=function(t){var e=this;if(window.navigator.mediaDevices&&window.navigator.mediaDevices.getUserMedia){var n={video:{deviceId:""!==t?{exact:t}:void 0}};window.navigator.mediaDevices.getUserMedia(n).then((function(t){e.mediaStream=t,e.videoElement.srcObject=t}))}},e.ctorParameters=function(){return[{type:Window,decorators:[{type:a.Inject,args:[se.b]}]},{type:C.Store},{type:a.ElementRef},{type:a.NgZone},{type:pt.c},{type:p.a},{type:D.a}]},e.DEFAULT_IMAGE_TYPE="image/jpeg",e.DEFAULT_IMAGE_QUALITY=.92,Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",u.c)],e.prototype,"ctx",void 0),Object(i.c)([Object(a.ViewChild)("videoStream",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"videoStreamRef",void 0),Object(i.c)([Object(a.ViewChild)("canvas",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"canvasRef",void 0),e=o=Object(i.c)([Object(a.Component)({selector:"tb-web-camera-widget",template:Object(i.f)(n("Eso2")).default,encapsulation:a.ViewEncapsulation.None,styles:[Object(i.f)(n("nPkc")).default]}),Object(i.h)(0,Object(a.Inject)(se.b)),Object(i.g)("design:paramtypes",[Window,C.Store,a.ElementRef,a.NgZone,pt.c,p.a,D.a])],e)}(S.a);!function(t){t.tls="tls",t.accessToken="accessToken"}(Xt||(Xt={}));var ce,de,ue=new Map([[Xt.tls,"gateway.security-types.tls"],[Xt.accessToken,"gateway.security-types.access-token"]]);!function(t){t.none="NONE",t.critical="CRITICAL",t.error="ERROR",t.warning="WARNING",t.info="INFO",t.debug="DEBUG"}(ce||(ce={})),function(t){t.memory="memory",t.file="file"}(de||(de={}));var he,pe=new Map([[de.memory,"gateway.storage-types.memory-storage"],[de.file,"gateway.storage-types.file-storage"]]);!function(t){t.mqtt="MQTT",t.modbus="Modbus",t.opcua="OPC-UA",t.ble="BLE",t.request="Request",t.can="CAN",t.bacnet="BACnet",t.custom="Custom"}(he||(he={}));var me={config:{},name:"",configType:null,enabled:!1};function ge(t){return JSON.stringify(t.value)===JSON.stringify({})?{validJSON:!0}:null}function fe(t){return t.replace("_","").replace("-","").replace(/^\s+|\s+/g,"").toLowerCase()+".json"}function be(t,e){return'[loggers]}}keys=root, service, connector, converter, tb_connection, storage, extension}}[handlers]}}keys=consoleHandler, serviceHandler, connectorHandler, converterHandler, tb_connectionHandler, storageHandler, extensionHandler}}[formatters]}}keys=LogFormatter}}[logger_root]}}level=ERROR}}handlers=consoleHandler}}[logger_connector]}}level={ERROR}}}handlers=connectorHandler}}formatter=LogFormatter}}qualname=connector}}[logger_storage]}}level={ERROR}}}handlers=storageHandler}}formatter=LogFormatter}}qualname=storage}}[logger_tb_connection]}}level={ERROR}}}handlers=tb_connectionHandler}}formatter=LogFormatter}}qualname=tb_connection}}[logger_service]}}level={ERROR}}}handlers=serviceHandler}}formatter=LogFormatter}}qualname=service}}[logger_converter]}}level={ERROR}}}handlers=converterHandler}}formatter=LogFormatter}}qualname=converter}}[logger_extension]}}level={ERROR}}}handlers=connectorHandler}}formatter=LogFormatter}}qualname=extension}}[handler_consoleHandler]}}class=StreamHandler}}level={ERROR}}}formatter=LogFormatter}}args=(sys.stdout,)}}[handler_connectorHandler]}}level={ERROR}}}class=logging.handlers.TimedRotatingFileHandler}}formatter=LogFormatter}}args=("{./logs/}connector.log", "d", 1, 7,)}}[handler_storageHandler]}}level={ERROR}}}class=logging.handlers.TimedRotatingFileHandler}}formatter=LogFormatter}}args=("{./logs/}storage.log", "d", 1, 7,)}}[handler_serviceHandler]}}level={ERROR}}}class=logging.handlers.TimedRotatingFileHandler}}formatter=LogFormatter}}args=("{./logs/}service.log", "d", 1, 7,)}}[handler_converterHandler]}}level={ERROR}}}class=logging.handlers.TimedRotatingFileHandler}}formatter=LogFormatter}}args=("{./logs/}converter.log", "d", 1, 3,)}}[handler_extensionHandler]}}level={ERROR}}}class=logging.handlers.TimedRotatingFileHandler}}formatter=LogFormatter}}args=("{./logs/}extension.log", "d", 1, 3,)}}[handler_tb_connectionHandler]}}level={ERROR}}}class=logging.handlers.TimedRotatingFileHandler}}formatter=LogFormatter}}args=("{./logs/}tb_connection.log", "d", 1, 3,)}}[formatter_LogFormatter]}}format="%(asctime)s - %(levelname)s - [%(filename)s] - %(module)s - %(lineno)d - %(message)s" }}datefmt="%Y-%m-%d %H:%M:%S"'.replace(/{ERROR}/g,t).replace(/{.\/logs\/}/g,e)}function ye(t){return{id:t,entityType:Z.b.DEVICE}}function ve(t){var e={};return Object.prototype.hasOwnProperty.call(t,"thingsboard")&&(e.host=t.thingsboard.host,e.port=t.thingsboard.port,e.remoteConfiguration=t.thingsboard.remoteConfiguration,Object.prototype.hasOwnProperty.call(t.thingsboard.security,Xt.accessToken)?(e.securityType=Xt.accessToken,e.accessToken=t.thingsboard.security.accessToken):(e.securityType=Xt.tls,e.caCertPath=t.thingsboard.security.caCert,e.privateKeyPath=t.thingsboard.security.privateKey,e.certPath=t.thingsboard.security.cert)),Object.prototype.hasOwnProperty.call(t,"storage")&&Object.prototype.hasOwnProperty.call(t.storage,"type")&&(t.storage.type===de.memory?(e.storageType=de.memory,e.readRecordsCount=t.storage.read_records_count,e.maxRecordsCount=t.storage.max_records_count):t.storage.type===de.file&&(e.storageType=de.file,e.dataFolderPath=t.storage.data_folder_path,e.maxFilesCount=t.storage.max_file_count,e.readRecordsCount=t.storage.read_records_count,e.maxRecordsCount=t.storage.max_records_count)),e}function we(t){for(var e={},n=0,i=t;n<i.length;n++){var a=i[n];a.enabled||(e[a.name]={connector:a.configType,config:a.config})}return e}function xe(t){var e={thingsboard:Se(t)};return function(t,e){for(var n=0,i=e;n<i.length;n++){var a=i[n];if(a.enabled){var o=a.configType;Array.isArray(t[o])||(t[o]=[]);var r={name:a.name,config:a.config};t[o].push(r)}}}(e,t.connectors),e}function Se(t){var e;e=t.securityType===Xt.accessToken?{accessToken:t.accessToken}:{caCert:t.caCertPath,privateKey:t.privateKeyPath,cert:t.certPath};var n,i={host:t.host,remoteConfiguration:t.remoteConfiguration,port:t.port,security:e};n=t.storageType===de.memory?{type:de.memory,read_records_count:t.readRecordsCount,max_records_count:t.maxRecordsCount}:{type:de.file,data_folder_path:t.dataFolderPath,max_file_count:t.maxFilesCount,max_read_records_count:t.readRecordsCount,max_records_per_file:t.maxRecordsCount};for(var a=[],o=0,r=t.connectors;o<r.length;o++){var s=r[o];if(s.enabled){var l={configuration:fe(s.name),name:s.name,type:s.configType};a.push(l)}}return{thingsboard:i,connectors:a,storage:n,logs:window.btoa(be(t.remoteLoggingLevel,t.remoteLoggingPathToLogs))}}var Ce=n("HeHW"),Te=n("9HAa"),Oe=function(t){function e(e,n,i,a,o,r,s,l,c,d,u){var h=t.call(this,e)||this;return h.store=e,h.elementRef=n,h.utils=i,h.ngZone=a,h.fb=o,h.window=r,h.dialog=s,h.translate=l,h.deviceService=c,h.attributeService=d,h.importExport=u,h.alignment="row",h.layoutGap="5px",h.securityTypes=ue,h.gatewayLogLevels=Object.values(ce),h.connectorTypes=Object.keys(he),h.storageTypes=pe,h.toastTargetId="gateway-configuration-widget"+h.utils.guid(),h.isReadOnlyForm=!1,h}return Object(i.d)(e,t),Object.defineProperty(e.prototype,"connectors",{get:function(){return this.gatewayConfigurationGroup.get("connectors")},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){var t=this;this.initWidgetSettings(this.ctx.settings),this.ctx.datasources&&this.ctx.datasources.length&&(this.deviceNameForm=this.ctx.datasources[0].name),this.buildForm(),this.ctx.updateWidgetParams(),this.formResize$=new Wt.a((function(){t.resize()})),this.formResize$.observe(this.formContainerRef.nativeElement)},e.prototype.ngOnDestroy=function(){this.formResize$&&this.formResize$.disconnect(),this.subscribeGateway$.unsubscribe(),this.subscribeStorageType$.unsubscribe()},e.prototype.initWidgetSettings=function(t){var e,n,i;i=t.gatewayTitle&&t.gatewayTitle.length?this.utils.customTranslation(t.gatewayTitle,t.gatewayTitle):this.translate.instant("gateway.gateway"),this.ctx.widgetTitle=i,this.isReadOnlyForm=!!t.readOnly&&t.readOnly,this.archiveFileName=(null===(e=t.archiveFileName)||void 0===e?void 0:e.length)?t.archiveFileName:"gatewayConfiguration",this.gatewayType=(null===(n=t.gatewayType)||void 0===n?void 0:n.length)?t.gatewayType:"Gateway",this.gatewayNameExists=this.utils.customTranslation(t.gatewayNameExists,t.gatewayNameExists)||this.translate.instant("gateway.gateway-exists"),this.successfulSaved=this.utils.customTranslation(t.successfulSave,t.successfulSave)||this.translate.instant("gateway.gateway-saved"),this.updateWidgetDisplaying()},e.prototype.resize=function(){var t=this;this.ngZone.run((function(){t.updateWidgetDisplaying(),t.ctx.detectChanges()}))},e.prototype.updateWidgetDisplaying=function(){this.ctx.$container&&this.ctx.$container[0].offsetWidth<=425?(this.layoutGap="0",this.alignment="column"):(this.layoutGap="5px",this.alignment="row")},e.prototype.saveAttribute=function(t,e,n){var i=this.gatewayConfigurationGroup.get("gateway").value,a={key:t,value:e};return this.attributeService.saveEntityAttributes(ye(i),n,[a])},e.prototype.createConnector=function(t){void 0===t&&(t=me),this.connectors.push(this.fb.group({enabled:[t.enabled],configType:[t.configType,[_.Validators.required]],name:[t.name,[_.Validators.required]],config:[t.config,[_.Validators.nullValidator,ge]]}))},e.prototype.getFormField=function(t){return this.gatewayConfigurationGroup.get(t)},e.prototype.buildForm=function(){var t=this;this.gatewayConfigurationGroup=this.fb.group({gateway:[null,[]],accessToken:[null,[_.Validators.required]],securityType:[Xt.accessToken],host:[this.window.location.hostname,[_.Validators.required]],port:[1883,[_.Validators.required,_.Validators.min(1),_.Validators.max(65535),_.Validators.pattern(/^-?[0-9]+$/)]],remoteConfiguration:[!0],caCertPath:["/etc/thingsboard-gateway/ca.pem"],privateKeyPath:["/etc/thingsboard-gateway/privateKey.pem"],certPath:["/etc/thingsboard-gateway/certificate.pem"],remoteLoggingLevel:[ce.debug],remoteLoggingPathToLogs:["./logs/",[_.Validators.required]],storageType:[de.memory],readRecordsCount:[100,[_.Validators.required,_.Validators.min(1),_.Validators.pattern(/^-?[0-9]+$/)]],maxRecordsCount:[1e4,[_.Validators.required,_.Validators.min(1),_.Validators.pattern(/^-?[0-9]+$/)]],maxFilesCount:[5,[_.Validators.required,_.Validators.min(1),_.Validators.pattern(/^-?[0-9]+$/)]],dataFolderPath:["./data/",[_.Validators.required]],connectors:this.fb.array([])}),this.isReadOnlyForm&&this.gatewayConfigurationGroup.disable({emitEvent:!1}),this.subscribeStorageType$=this.getFormField("storageType").valueChanges.subscribe((function(e){e===de.memory?(t.getFormField("maxFilesCount").disable(),t.getFormField("dataFolderPath").disable()):(t.getFormField("maxFilesCount").enable(),t.getFormField("dataFolderPath").enable())})),this.subscribeGateway$=this.getFormField("gateway").valueChanges.subscribe((function(e){null!==e?Object(l.a)(Object(i.l)([t.deviceService.getDeviceCredentials(e).pipe(Object(Q.a)((function(e){t.getFormField("accessToken").patchValue(e.credentialsId)})))],t.getAttributes(e))).subscribe((function(){t.gatewayConfigurationGroup.markAsPristine(),t.ctx.detectChanges()})):t.getFormField("accessToken").patchValue("")}))},e.prototype.gatewayExist=function(){this.ctx.showErrorToast(this.gatewayNameExists,"top","left",this.toastTargetId)},e.prototype.exportConfig=function(){var t,e,n,i=this.gatewayConfigurationGroup.value,a={};a["tb_gateway.yaml"]=function(t){var e;e="thingsboard:\n",e+="  host: "+t.host+"\n",e+="  remoteConfiguration: "+t.remoteConfiguration+"\n",e+="  port: "+t.port+"\n",e+="  security:\n",t.securityType===Xt.accessToken?e+="    access-token: "+t.accessToken+"\n":(e+="    ca_cert: "+t.caCertPath+"\n",e+="    privateKey: "+t.privateKeyPath+"\n",e+="    cert: "+t.certPath+"\n"),e+="storage:\n",t.storageType===de.memory?(e+="  type: memory\n",e+="  read_records_count: "+t.readRecordsCount+"\n",e+="  max_records_count: "+t.maxRecordsCount+"\n"):(e+="  type: file\n",e+="  data_folder_path: "+t.dataFolderPath+"\n",e+="  max_file_count: "+t.maxFilesCount+"\n",e+="  max_read_records_count: "+t.readRecordsCount+"\n",e+="  max_records_per_file: "+t.maxRecordsCount+"\n"),e+="connectors:\n";for(var n=0,i=t.connectors;n<i.length;n++){var a=i[n];a.enabled&&(e+="  -\n",e+="    name: "+a.name+"\n",e+="    type: "+a.configType+"\n",e+="    configuration: "+fe(a.name)+"\n")}return e}(i),function(t,e){for(var n=0,i=e;n<i.length;n++){var a=i[n];a.enabled&&(t[fe(a.name)]=JSON.stringify(a.config))}}(a,i.connectors),t=a,e=i.remoteLoggingLevel,n=i.remoteLoggingPathToLogs,t["logs.conf"]=be(e,n),this.importExport.exportJSZip(a,this.archiveFileName),this.saveAttribute("RemoteLoggingLevel",this.gatewayConfigurationGroup.value.remoteLoggingLevel.toUpperCase(),U.a.SHARED_SCOPE)},e.prototype.addNewConnector=function(){this.createConnector()},e.prototype.removeConnector=function(t){t>-1&&(this.connectors.removeAt(t),this.connectors.markAsDirty())},e.prototype.openConfigDialog=function(t,e,n,i){var a=this;t&&(t.stopPropagation(),t.preventDefault()),this.dialog.open(Ce.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{jsonValue:n,title:this.translate.instant("gateway.title-connectors-json",{typeName:i})}}).afterClosed().subscribe((function(t){t&&(a.connectors.at(e).get("config").patchValue(t),a.ctx.detectChanges())}))},e.prototype.createConnectorName=function(t,e,n){void 0===n&&(n=0);var i=n?e+n:e;return-1===t.findIndex((function(t){return t.name===i}))?i:this.createConnectorName(t,e,++n)},e.prototype.validateConnectorName=function(t,e,n,i){void 0===i&&(i=0);for(var a=0;a<t.length;a++){var o=0===i?e:e+i;a!==n&&t[a].name===o&&this.validateConnectorName(t,e,n,++i)}return 0===i?e:e+i},e.prototype.changeConnectorType=function(t){if(!t.get("name").value){var e=t.get("configType").value,n=this.gatewayConfigurationGroup.value.connectors;t.get("name").patchValue(this.createConnectorName(n,he[e]))}},e.prototype.changeConnectorName=function(t,e){var n=this.gatewayConfigurationGroup.value.connectors;t.get("name").patchValue(this.validateConnectorName(n,t.get("name").value,e))},e.prototype.save=function(){var t=this,e=this.gatewayConfigurationGroup.value;Object(l.a)([this.saveAttribute("configuration",window.btoa(JSON.stringify(xe(e))),U.a.SHARED_SCOPE),this.saveAttribute("configuration_drafts",window.btoa(JSON.stringify(we(e.connectors))),U.a.SERVER_SCOPE),this.saveAttribute("RemoteLoggingLevel",this.gatewayConfigurationGroup.value.remoteLoggingLevel.toUpperCase(),U.a.SHARED_SCOPE)]).subscribe((function(){t.ctx.showSuccessToast(t.successfulSaved,2e3,"top","left",t.toastTargetId),t.gatewayConfigurationGroup.markAsPristine()}))},e.prototype.getAttributes=function(t){var e=this,n=[];return n.push(Object(l.a)([this.getAttribute("current_configuration",U.a.CLIENT_SCOPE,t),this.getAttribute("configuration_drafts",U.a.SERVER_SCOPE,t)]).pipe(Object(Q.a)((function(t){var n=t[0],i=t[1];e.setFormGatewaySettings(n),e.setFormConnectorsDraft(i),e.isReadOnlyForm&&e.gatewayConfigurationGroup.disable({emitEvent:!1})})))),n.push(this.getAttribute("RemoteLoggingLevel",U.a.SHARED_SCOPE,t).pipe(Object(Q.a)((function(t){return e.processLoggingLevel(t)})))),n},e.prototype.getAttribute=function(t,e,n){return this.attributeService.getEntityAttributes(ye(n),e,[t])},e.prototype.setFormGatewaySettings=function(t){if(this.connectors.clear(),t.length>0)for(var e=JSON.parse(window.atob(t[0].value)),n=0,i=Object.keys(e);n<i.length;n++){var a=i[n],o=e[a];if("thingsboard"===a)null!==o&&Object.keys(o).length>0&&this.gatewayConfigurationGroup.patchValue(ve(o));else for(var r=0,s=Object.keys(o);r<s.length;r++){var l=s[r],c="No name";Object.prototype.hasOwnProperty.call(o[l],"name")&&(c=o[l].name);var d={enabled:!0,configType:a,config:o[l].config,name:c};this.createConnector(d)}}},e.prototype.setFormConnectorsDraft=function(t){if(t.length>0)for(var e=JSON.parse(window.atob(t[0].value)),n=0,i=Object.keys(e);n<i.length;n++){var a=i[n],o={enabled:!1,configType:e[a].connector,config:e[a].config,name:a};this.createConnector(o)}},e.prototype.processLoggingLevel=function(t){var e=ce.debug;t.length>0&&ce[t[0].value.toLowerCase()]&&(e=ce[t[0].value.toLowerCase()]),this.getFormField("remoteLoggingLevel").patchValue(e)},e.ctorParameters=function(){return[{type:C.Store},{type:a.ElementRef},{type:p.a},{type:a.NgZone},{type:_.FormBuilder},{type:Window,decorators:[{type:a.Inject,args:[se.b]}]},{type:Tt.MatDialog},{type:x.TranslateService},{type:L.a},{type:D.a},{type:Te.a}]},Object(i.c)([Object(a.ViewChild)("formContainer",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"formContainerRef",void 0),Object(i.c)([Object(a.ViewChild)("gatewayConfigurationForm",{static:!0}),Object(i.g)("design:type",_.NgForm)],e.prototype,"multipleInputForm",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",u.c)],e.prototype,"ctx",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"isStateForm",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-gateway-form",template:Object(i.f)(n("UDFY")).default,styles:[Object(i.f)(n("vwmd")).default]}),Object(i.h)(5,Object(a.Inject)(se.b)),Object(i.g)("design:paramtypes",[C.Store,a.ElementRef,p.a,a.NgZone,_.FormBuilder,Window,Tt.MatDialog,x.TranslateService,L.a,D.a,Te.a])],e)}(S.a),_e=function(){function t(){}return t=Object(i.c)([Object(a.NgModule)({declarations:[ft,St,bt,Lt,kt,Vt,ne,ae,oe,re.b,le,Oe],imports:[P.CommonModule,W.a,qt,At.a],exports:[bt,Lt,kt,Vt,qt,ne,oe,re.b,le,Oe],providers:[N.a,Te.a]})],t)}(),Le=n("do/i"),Ie=n("KMMH"),Ae=function(){function t(t,e,n,i,a,o){var r=this;this.window=t,this.dynamicComponentFactoryService=e,this.widgetService=n,this.utils=i,this.resources=a,this.translate=o,this.cssParser=new h.a,this.widgetsInfoInMemoryCache=new Map,this.widgetsInfoFetchQueue=new Map,this.cssParser.testMode=!1,this.widgetService.onWidgetTypeUpdated().subscribe((function(t){r.deleteWidgetInfoFromCache(t.bundleAlias,t.alias,t.tenantId.id===Ot.a)})),this.widgetService.onWidgetBundleDeleted().subscribe((function(t){r.deleteWidgetsBundleFromCache(t.alias,t.tenantId.id===Ot.a)})),this.init()}return t.prototype.init=function(){var t=this;if(this.init$)return this.init$;this.missingWidgetType=Object(i.a)({},u.b),this.errorWidgetType=Object(i.a)({},u.a),this.utils.widgetEditMode&&(this.editingWidgetType=Object(u.e)({widgetName:this.utils.editWidgetInfo.widgetName,alias:"customWidget",type:this.utils.editWidgetInfo.type,sizeX:this.utils.editWidgetInfo.sizeX,sizeY:this.utils.editWidgetInfo.sizeY,resources:this.utils.editWidgetInfo.resources,templateHtml:this.utils.editWidgetInfo.templateHtml,templateCss:this.utils.editWidgetInfo.templateCss,controllerScript:this.utils.editWidgetInfo.controllerScript,settingsSchema:this.utils.editWidgetInfo.settingsSchema,dataKeySettingsSchema:this.utils.editWidgetInfo.dataKeySettingsSchema,defaultConfig:this.utils.editWidgetInfo.defaultConfig},new Le.a("1"),new Ie.a(Ot.a),"customWidgetBundle"));var e=new s.a;this.init$=e.asObservable();var n=[this.loadWidgetResources(this.missingWidgetType,"global-widget-missing-type",[W.a]),this.loadWidgetResources(this.errorWidgetType,"global-widget-error-type",[W.a])];return Object(l.a)(n).subscribe((function(){e.next()}),(function(n){var i=["Failed to load default widget types!"];n&&n.length&&(i=i.concat(n)),console.error("Failed to load default widget types!"),e.error({widgetInfo:t.errorWidgetType,errorMessages:i})})),this.init$},t.prototype.getInstantWidgetInfo=function(t){var e=this.getWidgetInfoFromCache(t.bundleAlias,t.typeAlias,t.isSystemType);return e||{}},t.prototype.getWidgetInfo=function(t,e,n){var i=this;return this.init().pipe(Object(f.a)((function(){return i.getWidgetInfoInternal(t,e,n)})))},t.prototype.getWidgetInfoInternal=function(t,e,n){var i=this,a=new s.a,o=this.getWidgetInfoFromCache(t,e,n);if(o)a.next(o),a.complete();else if(this.utils.widgetEditMode)this.loadWidget(this.editingWidgetType,t,n,a);else{var r=this.createWidgetInfoCacheKey(t,e,n),l=this.widgetsInfoFetchQueue.get(r);l?l.push(a):(l=new Array,this.widgetsInfoFetchQueue.set(r,l),this.widgetService.getWidgetType(t,e,n,{ignoreErrors:!0}).subscribe((function(e){i.loadWidget(e,t,n,a)}),(function(){a.next(i.missingWidgetType),a.complete(),i.resolveWidgetsInfoFetchQueue(r,i.missingWidgetType)})))}return a.asObservable()},t.prototype.loadWidget=function(t,e,n,i){var a=this,o=Object(u.d)(t),r=this.createWidgetInfoCacheKey(e,o.alias,n),s=null;try{s=this.createWidgetControllerDescriptor(o,r)}catch(d){var l="Failed to compile widget script. \n Error: "+this.utils.parseException(d).message;this.processWidgetLoadError([l],r,i)}if(s){var c="widget-type-"+(n?"sys-":"")+e+"-"+o.alias;this.loadWidgetResources(o,c,[W.a,_e]).subscribe((function(){s.settingsSchema&&(o.typeSettingsSchema=s.settingsSchema),s.dataKeySettingsSchema&&(o.typeDataKeySettingsSchema=s.dataKeySettingsSchema),o.typeParameters=s.typeParameters,o.actionSources=s.actionSources,o.widgetTypeFunction=s.widgetTypeFunction,a.putWidgetInfoToCache(o,e,o.alias,n),i&&(i.next(o),i.complete()),a.resolveWidgetsInfoFetchQueue(r,o)}),(function(t){a.processWidgetLoadError(t,r,i)}))}},t.prototype.loadWidgetResources=function(t,e,n){var a=this;this.cssParser.cssPreviewNamespace=e,this.cssParser.createStyleElement(e,t.templateCss);var o=[];return t.resources.length>0&&t.resources.forEach((function(t){o.push(a.resources.loadResource(t.url).pipe(Object(b.a)((function(e){return Object(c.a)("Failed to load widget resource: '"+t.url+"'")}))))})),o.push(this.dynamicComponentFactoryService.createDynamicComponentFactory(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.d)(e,t),e}(V),t.templateHtml,n).pipe(Object(y.a)((function(e){return t.componentFactory=e,null})),Object(b.a)((function(t){var e="Failed to compile widget html. \n Error: "+a.utils.parseException(t).message;return Object(c.a)(e)})))),Object(l.a)(o).pipe(Object(v.a)((function(t){var e;return t&&t.length&&(e=t.filter((function(t){return t&&t.length>0}))),e&&e.length?Object(d.a)(e):Object(c.a)(null)})))},t.prototype.createWidgetControllerDescriptor=function(t,e){var n="return function "+e+" (ctx) {\n    var self = this;\n    self.ctx = ctx;\n\n";n+=t.controllerScript,n+="\n};\n";try{var a=new Function(n).apply(this),o=new a,r={widgetTypeFunction:a};Object(w.o)(o.getSettingsSchema)&&(r.settingsSchema=o.getSettingsSchema()),Object(w.o)(o.getDataKeySettingsSchema)&&(r.dataKeySettingsSchema=o.getDataKeySettingsSchema()),Object(w.o)(o.typeParameters)?r.typeParameters=o.typeParameters():r.typeParameters={},Object(w.o)(o.useCustomDatasources)?r.typeParameters.useCustomDatasources=o.useCustomDatasources():r.typeParameters.useCustomDatasources=!1,Object(w.u)(r.typeParameters.maxDatasources)&&(r.typeParameters.maxDatasources=-1),Object(w.u)(r.typeParameters.maxDataKeys)&&(r.typeParameters.maxDataKeys=-1),Object(w.u)(r.typeParameters.dataKeysOptional)&&(r.typeParameters.dataKeysOptional=!1),Object(w.u)(r.typeParameters.stateData)&&(r.typeParameters.stateData=!1),Object(w.o)(o.actionSources)?r.actionSources=o.actionSources():r.actionSources={};for(var s=0,l=Object.keys(g.i);s<l.length;s++){var c=l[s];r.actionSources[c]=Object(i.a)({},g.i[c]),r.actionSources[c].name=this.translate.instant(r.actionSources[c].name)}return r}catch(d){throw this.utils.processWidgetException(d),d}},t.prototype.processWidgetLoadError=function(t,e,n){n&&n.error({widgetInfo:this.errorWidgetType,errorMessages:t}),this.resolveWidgetsInfoFetchQueue(e,this.errorWidgetType,t)},t.prototype.resolveWidgetsInfoFetchQueue=function(t,e,n){var i=this.widgetsInfoFetchQueue.get(t);i&&(i.forEach((function(t){n?t.error({widgetInfo:e,errorMessages:n}):(t.next(e),t.complete())})),this.widgetsInfoFetchQueue.delete(t))},t.prototype.createWidgetInfoCacheKey=function(t,e,n){return(n?"sys_":"")+t+"_"+e},t.prototype.getWidgetInfoFromCache=function(t,e,n){var i=this.createWidgetInfoCacheKey(t,e,n);return this.widgetsInfoInMemoryCache.get(i)},t.prototype.putWidgetInfoToCache=function(t,e,n,i){var a=this.createWidgetInfoCacheKey(e,n,i);this.widgetsInfoInMemoryCache.set(a,t)},t.prototype.deleteWidgetInfoFromCache=function(t,e,n){var i=this.createWidgetInfoCacheKey(t,e,n);this.widgetsInfoInMemoryCache.delete(i)},t.prototype.deleteWidgetsBundleFromCache=function(t,e){var n=this,i=(e?"sys_":"")+t;this.widgetsInfoInMemoryCache.forEach((function(t,e){e.startsWith(i)&&n.widgetsInfoInMemoryCache.delete(e)}))},t.ctorParameters=function(){return[{type:Window,decorators:[{type:a.Inject,args:[se.b]}]},{type:o.a},{type:r.a},{type:p.a},{type:m.a},{type:x.TranslateService}]},t=Object(i.c)([Object(a.Injectable)(),Object(i.h)(0,Object(a.Inject)(se.b)),Object(i.g)("design:paramtypes",[Window,o.a,r.a,p.a,m.a,x.TranslateService])],t)}()},"C/AO":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form [formGroup]="statesFormGroup" (ngSubmit)="save()" style="min-width: 480px;">\n  <mat-toolbar color="primary">\n    <h2 translate>dashboard.manage-states</h2>\n    <span fxFlex></span>\n    <button mat-button mat-icon-button\n            (click)="cancel()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div mat-dialog-content>\n    <fieldset [disabled]="isLoading$ | async">\n      <div class="manage-dashboard-states">\n        <div class="tb-entity-table">\n          <div fxLayout="column" class="tb-entity-table-content">\n            <mat-toolbar class="mat-table-toolbar" [fxShow]="!textSearchMode">\n              <div class="mat-toolbar-tools">\n                <span class="tb-entity-table-title" translate>dashboard.states</span>\n                <span fxFlex></span>\n                <button mat-icon-button [disabled]="isLoading$ | async"\n                        type="button"\n                        (click)="addState($event)"\n                        matTooltip="{{ \'dashboard.add-state\' | translate }}"\n                        matTooltipPosition="above">\n                  <mat-icon>add</mat-icon>\n                </button>\n                <button mat-icon-button [disabled]="isLoading$ | async" (click)="enterFilterMode()"\n                        type="button"\n                        matTooltip="{{ \'action.search\' | translate }}"\n                        matTooltipPosition="above">\n                  <mat-icon>search</mat-icon>\n                </button>\n              </div>\n            </mat-toolbar>\n            <mat-toolbar class="mat-table-toolbar" [fxShow]="textSearchMode">\n              <div class="mat-toolbar-tools">\n                <button mat-icon-button\n                        type="button"\n                        matTooltip="{{ \'dashboard.search-states\' | translate }}"\n                        matTooltipPosition="above">\n                  <mat-icon>search</mat-icon>\n                </button>\n                <mat-form-field fxFlex>\n                  <mat-label>&nbsp;</mat-label>\n                  <input #searchInput matInput\n                         [(ngModel)]="pageLink.textSearch"\n                         [ngModelOptions]="{standalone: true}"\n                         placeholder="{{ \'dashboard.search-states\' | translate }}"/>\n                </mat-form-field>\n                <button mat-icon-button (click)="exitFilterMode()"\n                        type="button"\n                        matTooltip="{{ \'action.close\' | translate }}"\n                        matTooltipPosition="above">\n                  <mat-icon>close</mat-icon>\n                </button>\n              </div>\n            </mat-toolbar>\n            <div class="table-container">\n              <table  mat-table [dataSource]="dataSource"\n                         matSort [matSortActive]="pageLink.sortOrder.property" [matSortDirection]="pageLink.sortDirection()" matSortDisableClear>\n                <ng-container matColumnDef="name">\n                  <mat-header-cell *matHeaderCellDef mat-sort-header style="width: 60%"> {{ \'dashboard.state-name\' | translate }} </mat-header-cell>\n                  <mat-cell *matCellDef="let state">\n                    {{ state.name }}\n                  </mat-cell>\n                </ng-container>\n                <ng-container matColumnDef="id">\n                  <mat-header-cell *matHeaderCellDef mat-sort-header style="width: 40%"> {{ \'dashboard.state-id\' | translate }} </mat-header-cell>\n                  <mat-cell *matCellDef="let state">\n                    {{ state.id }}\n                  </mat-cell>\n                </ng-container>\n                <ng-container matColumnDef="root">\n                  <mat-header-cell *matHeaderCellDef mat-sort-header style="width: 80px"> {{ \'dashboard.is-root-state\' | translate }} </mat-header-cell>\n                  <mat-cell *matCellDef="let state">\n                    <mat-icon class="material-icons mat-icon">{{state.root ? \'check_box\' : \'check_box_outline_blank\'}}</mat-icon>\n                  </mat-cell>\n                </ng-container>\n                <ng-container matColumnDef="actions" stickyEnd>\n                  <mat-header-cell *matHeaderCellDef style="min-width: 80px; max-width: 80px; width: 80px">\n                  </mat-header-cell>\n                  <mat-cell *matCellDef="let state">\n                    <div fxFlex fxLayout="row">\n                      <button mat-icon-button [disabled]="isLoading$ | async"\n                              type="button"\n                              matTooltip="{{ \'dashboard.edit-state\' | translate }}"\n                              matTooltipPosition="above"\n                              (click)="editState($event, state)">\n                        <mat-icon>edit</mat-icon>\n                      </button>\n                      <button [fxShow]="!state.root" mat-icon-button [disabled]="isLoading$ | async"\n                              type="button"\n                              matTooltip="{{ \'dashboard.delete-state\' | translate }}"\n                              matTooltipPosition="above"\n                              (click)="deleteState($event, state)">\n                        <mat-icon>delete</mat-icon>\n                      </button>\n                    </div>\n                  </mat-cell>\n                </ng-container>\n                <mat-header-row class="mat-row-select" *matHeaderRowDef="displayedColumns; sticky: true"></mat-header-row>\n                <mat-row class="mat-row-select"\n                         *matRowDef="let state; columns: displayedColumns;"></mat-row>\n              </table>\n              <span [fxShow]="dataSource.isEmpty() | async"\n                    fxLayoutAlign="center center"\n                    class="no-data-found" translate>{{ \'dashboard.no-states-text\' }}</span>\n            </div>\n            <mat-divider></mat-divider>\n            <mat-paginator [length]="dataSource.total() | async"\n                           [pageIndex]="pageLink.page"\n                           [pageSize]="pageLink.pageSize"\n                           [pageSizeOptions]="[5, 10, 15]"></mat-paginator>\n          </div>\n        </div>\n      </div>\n    </fieldset>\n  </div>\n  <div mat-dialog-actions fxLayoutAlign="end center">\n    <button mat-raised-button color="primary"\n            type="submit"\n            [disabled]="(isLoading$ | async) || statesFormGroup.invalid || !statesFormGroup.dirty">\n      {{ \'action.save\' | translate }}\n    </button>\n    <button mat-button color="primary"\n            type="button"\n            [disabled]="(isLoading$ | async)"\n            (click)="cancel()" cdkFocusInitial>\n      {{ \'action.cancel\' | translate }}\n    </button>\n  </div>\n</form>\n'},CRDJ:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host ::ng-deep .mat-checkbox-label {\n  white-space: normal;\n}'},D2iO:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n.tb-date-range-navigator-panel {\n  overflow: auto;\n  background: #fff;\n  border-radius: 4px;\n  box-shadow: 0 7px 8px -4px rgba(0, 0, 0, 0.2), 0 13px 19px 2px rgba(0, 0, 0, 0.14), 0 5px 24px 4px rgba(0, 0, 0, 0.12);\n}\n.tb-date-range-navigator-panel .mat-content {\n  overflow: hidden;\n  background-color: #fff;\n}\n.tb-date-range-navigator-panel .mat-padding {\n  padding: 16px;\n}'},"Di+U":function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */'},DkIy:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n("mrSG"),a=n("TYT/"),o=n("//Q6"),r=function(){function t(t){this.componentFactoryResolver=t,this.statesControllers={}}return t.prototype.registerStatesController=function(t,e){var n=this.componentFactoryResolver.resolveComponentFactory(e);this.statesControllers[t]={factory:n}},t.prototype.getStateControllers=function(){return this.statesControllers},t.prototype.getStateController=function(t){return this.statesControllers[t]},t.prototype.preserveStateControllerState=function(t,e){this.statesControllers[t].state=Object(o.d)(e)},t.prototype.withdrawStateControllerState=function(t){var e=this.statesControllers[t].state;return this.statesControllers[t].state=null,e},t.prototype.cleanupPreservedStates=function(){for(var t=0,e=Object.keys(this.statesControllers);t<e.length;t++){var n=e[t];this.statesControllers[n].state=null}},t.ctorParameters=function(){return[{type:a.ComponentFactoryResolver}]},t=Object(i.c)([Object(a.Injectable)(),Object(i.g)("design:paramtypes",[a.ComponentFactoryResolver])],t)}()},EKUr:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form [formGroup]="dataKeyFormGroup" (ngSubmit)="save()" style="min-width: 480px;">\n  <mat-toolbar color="primary">\n    <h2>{{ \'datakey.configuration\' | translate }}</h2>\n    <span fxFlex></span>\n    <button mat-button mat-icon-button\n            (click)="cancel()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div style="height: 4px;" *ngIf="!(isLoading$ | async)"></div>\n  <div mat-dialog-content>\n    <tb-data-key-config #dataKeyConfig\n      [dataKeySettingsSchema]="data.dataKeySettingsSchema"\n      [entityAliasId]="data.entityAliasId"\n      [callbacks]="data.callbacks"\n      formControlName="dataKey">\n    </tb-data-key-config>\n  </div>\n  <div mat-dialog-actions fxLayoutAlign="end center">\n    <button mat-raised-button color="primary"\n            type="submit"\n            [disabled]="(isLoading$ | async) || dataKeyFormGroup.invalid || !dataKeyFormGroup.dirty">\n      {{ \'action.save\' | translate }}\n    </button>\n    <button mat-button color="primary"\n            type="button"\n            [disabled]="(isLoading$ | async)"\n            (click)="cancel()" cdkFocusInitial>\n      {{ \'action.cancel\' | translate }}\n    </button>\n  </div>\n</form>\n'},EUjX:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div class="tb-details-buttons" fxLayout.xs="column">\n  <button mat-raised-button color="primary"\n          [disabled]="(isLoading$ | async)"\n          (click)="onEntityAction($event, \'open\')"\n          [fxShow]="!isEdit">\n    {{\'dashboard.open-dashboard\' | translate }}\n  </button>\n  <button mat-raised-button color="primary"\n          [disabled]="(isLoading$ | async)"\n          (click)="onEntityAction($event, \'export\')"\n          [fxShow]="!isEdit && dashboardScope === \'tenant\'">\n    {{\'dashboard.export\' | translate }}\n  </button>\n  <button mat-raised-button color="primary"\n          [disabled]="(isLoading$ | async)"\n          (click)="onEntityAction($event, \'makePublic\')"\n          [fxShow]="!isEdit && dashboardScope === \'tenant\' && !isPublic(entity)">\n    {{\'dashboard.make-public\' | translate }}\n  </button>\n  <button mat-raised-button color="primary"\n          [disabled]="(isLoading$ | async)"\n          (click)="onEntityAction($event, \'makePrivate\')"\n          [fxShow]="!isEdit && (dashboardScope === \'tenant\' && isPublic(entity)\n                                || dashboardScope === \'customer\' && isCurrentPublicCustomer(entity))">\n    {{\'dashboard.make-private\' | translate }}\n  </button>\n  <button mat-raised-button color="primary"\n          [disabled]="(isLoading$ | async)"\n          (click)="onEntityAction($event, \'manageAssignedCustomers\')"\n          [fxShow]="!isEdit && dashboardScope === \'tenant\'">\n    {{\'dashboard.manage-assigned-customers\' | translate }}\n  </button>\n  <button mat-raised-button color="primary"\n          [disabled]="(isLoading$ | async)"\n          (click)="onEntityAction($event, \'unassignFromCustomer\')"\n          [fxShow]="!isEdit && dashboardScope === \'customer\' && !isCurrentPublicCustomer(entity)">\n    {{ \'dashboard.unassign-from-customer\' | translate }}\n  </button>\n  <button mat-raised-button color="primary"\n          [disabled]="(isLoading$ | async)"\n          (click)="onEntityAction($event, \'delete\')"\n          [fxShow]="!hideDelete() && !isEdit">\n    {{\'dashboard.delete\' | translate }}\n  </button>\n</div>\n<div class="mat-padding" fxLayout="column">\n  <mat-form-field class="mat-block"\n                  [fxShow]="!isEdit && assignedCustomersText?.length\n                              && dashboardScope === \'tenant\'">\n    <mat-label translate>dashboard.assignedToCustomers</mat-label>\n    <input matInput disabled [ngModel]="assignedCustomersText">\n  </mat-form-field>\n  <div fxLayout="column" [fxShow]="!isEdit && (dashboardScope === \'tenant\' && isPublic(entity)\n                                || dashboardScope === \'customer\' && isCurrentPublicCustomer(entity))">\n    <tb-social-share-panel style="padding-bottom: 1.25em;"\n                           shareTitle="{{ \'dashboard.socialshare-title\' | translate:{dashboardTitle: entity?.title} }}"\n                           shareText="{{ \'dashboard.socialshare-text\' | translate:{dashboardTitle: entity?.title} }}"\n                           shareLink="{{ publicLink }}"\n                           shareHashTags="thingsboard, iot">\n    </tb-social-share-panel>\n    <div fxLayout="row">\n      <mat-form-field class="mat-block" fxFlex>\n        <mat-label translate>dashboard.public-link</mat-label>\n        <input matInput disabled [ngModel]="publicLink">\n      </mat-form-field>\n      <button mat-button mat-icon-button style="margin-top: 8px;"\n              ngxClipboard\n              (cbOnSuccess)="onPublicLinkCopied($event)"\n              cbContent="{{ publicLink }}"\n              matTooltipPosition="above"\n              matTooltip="{{ \'dashboard.copy-public-link\' | translate }}">\n        <mat-icon svgIcon="mdi:clipboard-arrow-left"></mat-icon>\n      </button>\n    </div>\n  </div>\n  <form [formGroup]="entityForm">\n    <fieldset [disabled]="(isLoading$ | async) || !isEdit">\n      <mat-form-field class="mat-block">\n        <mat-label translate>dashboard.title</mat-label>\n        <input matInput formControlName="title" required>\n        <mat-error *ngIf="entityForm.get(\'title\').hasError(\'required\')">\n          {{ \'dashboard.title-required\' | translate }}\n        </mat-error>\n      </mat-form-field>\n      <div formGroupName="configuration" fxLayout="column">\n        <mat-form-field class="mat-block">\n          <mat-label translate>dashboard.description</mat-label>\n          <textarea matInput formControlName="description" rows="2"></textarea>\n        </mat-form-field>\n      </div>\n    </fieldset>\n  </form>\n</div>\n'},EWcq:function(t,e,n){"use strict";n.d(e,"a",(function(){return y}));var i=n("mrSG"),a=n("TYT/"),o=n("MqYC"),r=n("ea4N"),s=n("6onV"),l=n("QJY3"),c=n("DUip"),d=n("gmuX"),u=n("0lYY"),h=n("OiFK"),p=n("o8Qb"),m=n("xKAQ"),g=n("S+vS"),f=n("//Q6"),b=n("hqxT"),y=function(t){function e(e,n,i,a,o,r,s,l,c,d){var h,p=t.call(this,e,n,o)||this;if(p.store=e,p.router=n,p.data=i,p.errorStateMatcher=a,p.dialogRef=o,p.fb=r,p.utils=s,p.translate=l,p.dialogs=c,p.dialog=d,p.aliasToWidgetsMap={},p.submitted=!1,p.title=i.customTitle?i.customTitle:"entity.aliases",p.disableAdd=p.data.disableAdd,p.allowedEntityTypes=p.data.allowedEntityTypes,i.widgets)if(p.data.isSingleWidget&&1===p.data.widgets.length){var m=p.data.widgets[0];h=[m.config.title];for(var g=0,b=Object.keys(p.data.entityAliases);g<b.length;g++){var y=b[g];p.aliasToWidgetsMap[y]=h}}else p.data.widgets.forEach((function(t){if(t.type===u.k.rpc){if(t.config.targetDeviceAliasIds&&t.config.targetDeviceAliasIds.length>0){var e=t.config.targetDeviceAliasIds[0];(h=p.aliasToWidgetsMap[e])||(h=[],p.aliasToWidgetsMap[e]=h),h.push(t.config.title)}}else p.utils.validateDatasources(t.config.datasources).forEach((function(e){e.type===u.a.entity&&e.entityAliasId&&((h=p.aliasToWidgetsMap[e.entityAliasId])||(h=[],p.aliasToWidgetsMap[e.entityAliasId]=h),h.push(t.config.title))}))}));for(var v=[],w=0,x=Object.keys(p.data.entityAliases);w<x.length;w++){y=x[w];var S=p.data.entityAliases[y];S.filter||(S.filter={resolveMultiple:!1}),Object(f.u)(S.filter.resolveMultiple)&&(S.filter.resolveMultiple=!1),v.push(p.createEntityAliasFormControl(y,S))}return p.entityAliasesFormGroup=p.fb.group({entityAliases:p.fb.array(v)}),p}var d;return Object(i.d)(e,t),d=e,e.prototype.createEntityAliasFormControl=function(t,e){var n=this.fb.group({id:[t],alias:[e?e.alias:null,[l.Validators.required]],filter:[e?e.filter:null],resolveMultiple:[!!e&&e.filter.resolveMultiple]});return n.get("resolveMultiple").valueChanges.subscribe((function(t){n.get("filter").value.resolveMultiple=t})),n},e.prototype.entityAliasesFormArray=function(){return this.entityAliasesFormGroup.get("entityAliases")},e.prototype.ngOnInit=function(){},e.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=!!(t&&t.invalid&&this.submitted);return n||i},e.prototype.removeAlias=function(t){var e=this.entityAliasesFormGroup.get("entityAliases").value[t],n=this.aliasToWidgetsMap[e.id];if(n){for(var i="",a=0,o=n;a<o.length;a++){i+="<br/>'"+o[a]+"'"}var r=this.translate.instant("entity.unable-delete-entity-alias-text",{entityAlias:e.alias,widgetsList:i});this.dialogs.alert(this.translate.instant("entity.unable-delete-entity-alias-title"),r,this.translate.instant("action.close"),!0)}else this.entityAliasesFormGroup.get("entityAliases").removeAt(t),this.entityAliasesFormGroup.markAsDirty()},e.prototype.addAlias=function(){this.openAliasDialog(-1)},e.prototype.editAlias=function(t){this.openAliasDialog(t)},e.prototype.openAliasDialog=function(t){var e,n=this,i=-1===t,a=this.entityAliasesFormGroup.get("entityAliases").value;i||(e=a[t]),this.dialog.open(b.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{isAdd:i,allowedEntityTypes:this.allowedEntityTypes,entityAliases:a,alias:i?null:Object(f.d)(e)}}).afterClosed().subscribe((function(e){if(e){if(i)n.entityAliasesFormGroup.get("entityAliases").push(n.createEntityAliasFormControl(e.id,e));else{var a=n.entityAliasesFormGroup.get("entityAliases").at(t);a.get("alias").patchValue(e.alias),a.get("filter").patchValue(e.filter),a.get("resolveMultiple").patchValue(e.filter.resolveMultiple)}n.entityAliasesFormGroup.markAsDirty()}}))},e.prototype.cancel=function(){this.dialogRef.close(null)},e.prototype.save=function(){this.submitted=!0;for(var t,e={},n={},i=!0,a=0,o=this.entityAliasesFormGroup.get("entityAliases").value;a<o.length;a++){var r=o[a],s=r.id,l=r.alias,c=r.filter;if(n[l]){i=!1,t=this.translate.instant("entity.duplicate-alias-error",{alias:l});break}if(!c||!c.type){i=!1,t=this.translate.instant("entity.missing-entity-filter-error",{alias:l});break}n[l]=l,e[s]={id:s,alias:l,filter:c}}i?this.dialogRef.close(e):this.store.dispatch(new m.b({message:t,type:"error"}))},e.ctorParameters=function(){return[{type:s.Store},{type:c.Router},{type:void 0,decorators:[{type:a.Inject,args:[r.MAT_DIALOG_DATA]}]},{type:o.d,decorators:[{type:a.SkipSelf}]},{type:r.MatDialogRef},{type:l.FormBuilder},{type:h.a},{type:p.TranslateService},{type:g.a},{type:r.MatDialog}]},e=d=Object(i.c)([Object(a.Component)({selector:"tb-entity-aliases-dialog",template:Object(i.f)(n("t+c0")).default,providers:[{provide:o.d,useExisting:d}],styles:[Object(i.f)(n("K9Fk")).default]}),Object(i.h)(2,Object(a.Inject)(r.MAT_DIALOG_DATA)),Object(i.h)(3,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[s.Store,c.Router,Object,o.d,r.MatDialogRef,l.FormBuilder,h.a,p.TranslateService,g.a,r.MatDialog])],e)}(d.a)},Eso2:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div fxLayout="column" fxLayoutAlign="center center" class="tb-web-camera" tb-fullscreen [fullscreen]="isShowCamera">\n  <div [fxShow]="isEntityDetected && dataKeyDetected && isCameraSupport && isDeviceDetect" fxFlexFill>\n    <div [fxShow]="!isShowCamera" fxLayout="column" fxLayoutAlign="space-between center" fxFlexFill>\n      <div class="tb-web-camera__last-photo" fxFlex>\n        <span [fxShow]="!lastPhoto" class="tb-web-camera__last-photo_text" translate>widgets.input-widgets.no-image</span>\n        <img [fxShow]="lastPhoto" class="tb-web-camera__last-photo_img" [src]="lastPhoto" alt="last photo"/>\n      </div>\n      <button mat-raised-button color="primary" (click)="takePhoto()">\n        {{ "widgets.input-widgets.take-photo" | translate }}\n      </button>\n    </div>\n    <div [fxShow]="isShowCamera" fxLayout="column" fxLayoutAlign="center center" class="camera-container">\n      <div class="camera" [fxShow]="!isPreviewPhoto">\n        <video autoplay muted playsinline class="camera-stream" #videoStream></video>\n        <div class="camera-controls" fxLayout="row wrap" fxLayoutAlign="space-between end">\n          <div fxFlex></div>\n          <button mat-mini-fab color="primary" (click)="switchWebCamera()" [disabled]="singleDevice">\n            <mat-icon>switch_camera</mat-icon>\n          </button>\n          <button mat-fab color="accent" (click)="createPhoto()">\n            <mat-icon>photo_camera</mat-icon>\n          </button>\n          <button mat-mini-fab color="primary" (click)="closeCamera()">\n            <mat-icon>close</mat-icon>\n          </button>\n          <div fxFlex></div>\n        </div>\n      </div>\n      <div class="camera" [fxShow]="isPreviewPhoto">\n        <img alt="preview photo" class="camera-stream" [src]="previewPhoto">\n        <canvas #canvas style="display:none;"></canvas>\n        <div class="camera-controls" fxLayout="row" fxLayoutAlign="space-between end">\n          <div fxFlex></div>\n          <button mat-fab color="primary" [disabled]="updatePhoto" (click)="cancelPhoto()">\n            <mat-icon>close</mat-icon>\n          </button>\n          <button mat-fab color="accent" [disabled]="updatePhoto" (click)="savePhoto()">\n            <mat-icon>check</mat-icon>\n          </button>\n          <div fxFlex></div>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class="message-text" [fxHide]="isEntityDetected">\n    {{ \'widgets.input-widgets.no-entity-selected\' | translate }}\n  </div>\n  <div class="message-text" [fxShow]="isEntityDetected && !dataKeyDetected">\n    {{ \'widgets.input-widgets.no-datakey-selected\' | translate }}\n  </div>\n  <div class="message-text" [fxShow]="isEntityDetected && dataKeyDetected && !isCameraSupport">\n    {{ \'widgets.input-widgets.no-support-web-camera\' | translate }}\n  </div>\n  <div class="message-text" [fxShow]="isEntityDetected && dataKeyDetected && isCameraSupport && !isDeviceDetect">\n    {{ \'widgets.input-widgets.no-support-web-camera\' | translate }}\n  </div>\n</div>\n'},FBAY:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var i=n("mrSG"),a=n("TYT/"),o=n("0lYY"),r=n("4j5O"),s=n("//Q6"),l=n("OiFK"),c=n("XlPw"),d=n("F/XL"),u=n("67Y/"),h=n("+5dr"),p=n("C4fA"),m=function(){function t(t,e,n){this.dashboardUtils=t,this.ruleChainService=e,this.utils=n,this.namespace="tbBufferStore",this.delimiter="."}return t.prototype.prepareWidgetItem=function(t,e,n,i){var a={datasourceAliases:{},targetDeviceAliases:{}},r=this.getOriginalColumns(t,e,n),s=this.getOriginalSize(t,e,n,i);if(i.config&&t.configuration&&t.configuration.entityAliases){var l=void 0;if(i.config.datasources)for(var c=0;c<i.config.datasources.length;c++){var d=i.config.datasources[c];d.type===o.a.entity&&d.entityAliasId&&(l=t.configuration.entityAliases[d.entityAliasId])&&(a.datasourceAliases[c]=this.prepareAliasInfo(l))}if(i.config.targetDeviceAliasIds)for(c=0;c<i.config.targetDeviceAliasIds.length;c++){var u=i.config.targetDeviceAliasIds[c];u&&(l=t.configuration.entityAliases[u])&&(a.targetDeviceAliases[c]=this.prepareAliasInfo(l))}}return{widget:i,aliasesInfo:a,originalSize:s,originalColumns:r}},t.prototype.copyWidget=function(t,e,n,i){var a=this.prepareWidgetItem(t,e,n,i);this.storeSet("widget_item",a)},t.prototype.copyWidgetReference=function(t,e,n,i){var a=this.prepareWidgetReference(t,e,n,i);this.storeSet("widget_reference",a)},t.prototype.hasWidget=function(){return this.storeHas("widget_item")},t.prototype.canPasteWidgetReference=function(t,e,n){var i=this.storeGet("widget_reference");return!(!i||i.dashboardId!==t.id.id||i.sourceState===e&&i.sourceLayout===n||!t.configuration.widgets[i.widgetId])},t.prototype.pasteWidget=function(t,e,n,i,a){var o=this.storeGet("widget_item");if(o){var r=o.widget,s=o.aliasesInfo,l=o.originalColumns,d=o.originalSize,h=-1,p=-1;return i&&(h=i.row,p=i.column),r.id=this.utils.guid(),this.addWidgetToDashboard(t,e,n,r,s,a,l,d,h,p).pipe(Object(u.a)((function(){return r})))}return Object(c.a)("Failed to read widget from buffer!")},t.prototype.pasteWidgetReference=function(t,e,n,i){var a=this.storeGet("widget_reference");if(a){var o=t.configuration.widgets[a.widgetId];if(o){var r=a.originalColumns,s=a.originalSize,l=-1,d=-1;return i&&(l=i.row,d=i.column),this.addWidgetToDashboard(t,e,n,o,null,null,r,s,l,d).pipe(Object(u.a)((function(){return o})))}return Object(c.a)("Failed to read widget reference from buffer!")}return Object(c.a)("Failed to read widget reference from buffer!")},t.prototype.addWidgetToDashboard=function(t,e,n,i,a,o,r,l,c,u){var h;h=t||{},h=this.dashboardUtils.validateAndUpdateDashboard(h);var p=!1;if(a){var m=this.updateAliases(h,i,a);!Object(s.n)(m,h.configuration.entityAliases)&&(h.configuration.entityAliases=m,o&&(p=!0))}return this.dashboardUtils.addWidgetToLayout(h,e,n,i,r,l,c,u),p&&o(),Object(d.a)(h)},t.prototype.copyRuleNodes=function(t,e){for(var n={nodes:[],connections:[]},i=-1,a=-1,o=-1,r=-1,s=0;s<t.length;s++){var l=t[s],c={id:"",connectors:[],additionalInfo:l.additionalInfo,configuration:l.configuration,debugMode:l.debugMode,x:l.x,y:l.y,name:l.name,componentClazz:l.component.clazz};l.targetRuleChainId&&(c.targetRuleChainId=l.targetRuleChainId),l.error&&(c.error=l.error),n.nodes.push(c),0===s?(i=c.y,a=c.x,o=c.y+50,r=c.x+170):(i=Math.min(i,c.y),a=Math.min(a,c.x),o=Math.max(o,c.y+50),r=Math.max(r,c.x+170))}n.originX=a+(r-a)/2,n.originY=i+(o-i)/2,e.forEach((function(t){n.connections.push(t)})),this.storeSet("rule_nodes",n)},t.prototype.hasRuleNodes=function(){return this.storeHas("rule_nodes")},t.prototype.pasteRuleNodes=function(t,e){var n=this.storeGet("rule_nodes");if(n){for(var i=t-n.originX,a=e-n.originY,o=0,r=n.nodes;o<r.length;o++){var s=r[o],l=this.ruleChainService.getRuleNodeComponentByClazz(s.componentClazz);if(!l)return null;var c=h.f.get(l.type).icon,d=null;l.configurationDescriptor.nodeDefinition.icon&&(c=l.configurationDescriptor.nodeDefinition.icon),l.configurationDescriptor.nodeDefinition.iconUrl&&(d=l.configurationDescriptor.nodeDefinition.iconUrl),delete s.componentClazz,s.component=l,s.nodeClass=h.f.get(l.type).nodeClass,s.icon=c,s.iconUrl=d,s.connectors=[],s.x=Math.round(s.x+i),s.y=Math.round(s.y+a)}return n}return null},t.prototype.hasRuleChainImport=function(){return this.storeHas("rule_chain_import")},t.prototype.storeRuleChainImport=function(t){this.storeSet("rule_chain_import",t)},t.prototype.getRuleChainImport=function(){var t=this.storeGet("rule_chain_import");return this.storeRemove("rule_chain_import"),t},t.prototype.getOriginalColumns=function(t,e,n){var i=24,a=null,o=t.configuration.states[e],r=Object.keys(o.layouts).length;if(o){var s=o.layouts[n];s&&(a=s.gridSettings)}return a&&a.columns&&(i=a.columns),i*=r},t.prototype.getOriginalSize=function(t,e,n,i){var a=t.configuration.states[e].layouts[n].widgets[i.id];return{sizeX:a.sizeX,sizeY:a.sizeY}},t.prototype.prepareAliasInfo=function(t){return{alias:t.alias,filter:t.filter}},t.prototype.prepareWidgetReference=function(t,e,n,i){var a=this.getOriginalColumns(t,e,n),o=this.getOriginalSize(t,e,n,i);return{dashboardId:t.id.id,sourceState:e,sourceLayout:n,widgetId:i.id,originalSize:o,originalColumns:a}},t.prototype.updateAliases=function(t,e,n){for(var i,a,o=Object(s.d)(t.configuration.entityAliases),r=0,l=Object.keys(n.datasourceAliases);r<l.length;r++){var c=l[r],d=Number(c);i=n.datasourceAliases[d],a=this.getEntityAliasId(o,i),e.config.datasources[d].entityAliasId=a}for(var u=0,h=Object.keys(n.targetDeviceAliases);u<h.length;u++){var p=h[u],m=Number(p);i=n.targetDeviceAliases[m],a=this.getEntityAliasId(o,i),e.config.targetDeviceAliasIds[m]=a}return o},t.prototype.isEntityAliasEqual=function(t,e){return Object(s.n)(t.filter,e.filter)},t.prototype.getEntityAliasId=function(t,e){for(var n,i=0,a=Object.keys(t);i<a.length;i++){var o=a[i];if(this.isEntityAliasEqual(t[o],e)){n=o;break}}if(!n){var r=this.createEntityAliasName(t,e.alias);t[n=this.utils.guid()]={id:n,alias:r,filter:e.filter}}return n},t.prototype.createEntityAliasName=function(t,e){for(var n=0,i=e,a=!1;!a;){a=!0;for(var o=0,r=Object.keys(t);o<r.length;o++){i===t[r[o]].alias&&(i=e+ ++n,a=!1)}}return i},t.prototype.storeSet=function(t,e){localStorage.setItem(this.getNamespacedKey(t),JSON.stringify(e))},t.prototype.storeGet=function(t){var e=null,n=localStorage.getItem(this.getNamespacedKey(t));try{e=void 0===n||"undefined"===n?void 0:JSON.parse(n)}catch(i){this.storeRemove(t)}return e},t.prototype.storeHas=function(t){var e=localStorage.getItem(this.getNamespacedKey(t));return void 0!==e&&"undefined"!==e&&null!==e},t.prototype.storeRemove=function(t){localStorage.removeItem(this.getNamespacedKey(t))},t.prototype.getNamespacedKey=function(t){return[this.namespace,t].join(this.delimiter)},t.ctorParameters=function(){return[{type:r.a},{type:p.a},{type:l.a}]},t=Object(i.c)([Object(a.Injectable)({providedIn:"root"}),Object(i.g)("design:paramtypes",[r.a,p.a,l.a])],t)}()},FjzW:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form [formGroup]="widgetFormGroup">\n  <fieldset [disabled]="isLoading$ | async">\n    <tb-widget-config\n      [aliasController]="aliasController"\n      [functionsOnly]="widgetEditMode"\n      [entityAliases]="dashboard.configuration.entityAliases"\n      [dashboardStates]="dashboard.configuration.states"\n      formControlName="widgetConfig">\n    </tb-widget-config>\n  </fieldset>\n</form>\n'},FoVK:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n.tb-custom-action-editor-container mat-form-field.resource-field {\n  max-height: 40px;\n  margin: 10px 0 0;\n}\n.tb-custom-action-editor-container mat-form-field.resource-field .mat-form-field-wrapper {\n  padding-bottom: 0;\n}\n.tb-custom-action-editor-container mat-form-field.resource-field .mat-form-field-wrapper .mat-form-field-flex {\n  max-height: 40px;\n}\n.tb-custom-action-editor-container mat-form-field.resource-field .mat-form-field-wrapper .mat-form-field-flex .mat-form-field-infix {\n  border: 0;\n}\n.tb-custom-action-editor-container mat-form-field.resource-field .mat-form-field-wrapper .mat-form-field-underline {\n  bottom: 0;\n}\n.tb-custom-action-editor-container .html-panel,\n.tb-custom-action-editor-container .css-panel {\n  width: 100%;\n  min-width: 200px;\n  height: 100%;\n  min-height: 200px;\n}\n.tb-custom-action-editor-container div.tb-editor-area-title-panel {\n  position: absolute;\n  top: 5px;\n  right: 20px;\n  z-index: 5;\n  font-size: 0.8rem;\n  font-weight: 500;\n}\n.tb-custom-action-editor-container div.tb-editor-area-title-panel label {\n  padding: 4px;\n  color: #00acc1;\n  text-transform: uppercase;\n  background: rgba(220, 220, 220, 0.35);\n  border-radius: 5px;\n}\n.tb-custom-action-editor-container div.tb-editor-area-title-panel label:not(:last-child) {\n  margin-right: 4px;\n}\n.tb-custom-action-editor-container div.tb-editor-area-title-panel button.mat-button, .tb-custom-action-editor-container div.tb-editor-area-title-panel button.mat-icon-button, .tb-custom-action-editor-container div.tb-editor-area-title-panel button.mat-icon-button.tb-mat-32 {\n  -ms-flex-align: center;\n      align-items: center;\n  vertical-align: middle;\n  min-width: 32px;\n  min-height: 15px;\n  padding: 4px;\n  margin: 0;\n  font-size: 0.8rem;\n  line-height: 15px;\n  color: #7b7b7b;\n  background: rgba(220, 220, 220, 0.35);\n}\n.tb-custom-action-editor-container div.tb-editor-area-title-panel button.mat-button:not(:last-child), .tb-custom-action-editor-container div.tb-editor-area-title-panel button.mat-icon-button:not(:last-child), .tb-custom-action-editor-container div.tb-editor-area-title-panel button.mat-icon-button.tb-mat-32:not(:last-child) {\n  margin-right: 4px;\n}'},FpxQ:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .mat-chip.mat-standard-chip {\n  overflow: hidden;\n}\n:host .mat-chip.mat-standard-chip .tb-attribute-chip {\n  max-width: 100%;\n  color: #424242;\n  font-weight: normal;\n  font-size: 16px;\n}\n:host .mat-chip.mat-standard-chip .tb-attribute-chip .tb-chip-drag-handle {\n  cursor: move;\n}\n:host .mat-chip.mat-standard-chip .tb-attribute-chip .tb-chip-drag-handle mat-icon {\n  pointer-events: none;\n}\n:host .mat-chip.mat-standard-chip .tb-attribute-chip .tb-chip-labels {\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-direction: row;\n      flex-direction: row;\n  -ms-flex-align: end;\n      align-items: flex-end;\n  min-width: 0;\n}\n:host .mat-chip.mat-standard-chip .tb-attribute-chip .tb-chip-labels .tb-chip-label {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n:host .mat-chip.mat-standard-chip .tb-attribute-chip .tb-chip-labels .tb-chip-separator {\n  white-space: pre;\n}\n:host .mat-chip.mat-standard-chip .tb-attribute-chip .mat-chip-remove.mat-icon {\n  width: 24px;\n  height: 24px;\n  font-size: 24px;\n  margin-left: 0;\n  color: inherit;\n  opacity: inherit;\n}\n:host ::ng-deep .mat-form-field-flex {\n  padding-top: 0;\n}\n:host ::ng-deep .mat-form-field-flex .mat-form-field-infix {\n  border-top: 0;\n}'},G1wd:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host ::ng-deep tb-entities-table .mat-drawer-container {\n  background-color: white;\n}'},G4cQ:function(t,e,n){"use strict";n.d(e,"a",(function(){return bn}));var i=n("mrSG"),a=n("TYT/"),o=n("Valr"),r=n("PCNd"),s=n("LrsY"),l=n("UaJx"),c=n("RxGS"),d=n("6onV"),u=n("QJY3"),h=function(t){function e(e){var n=t.call(this,e)||this;return n.store=e,n.headerHeightPx=100,n.headerTitle="",n.headerSubtitle="",n.isReadOnly=!1,n.isAlwaysEdit=!1,n.closeDetails=new a.EventEmitter,n.toggleDetailsEditMode=new a.EventEmitter,n.applyDetails=new a.EventEmitter,n.isEditValue=!1,n.isEditChange=new a.EventEmitter,n}return Object(i.d)(e,t),Object.defineProperty(e.prototype,"theForm",{get:function(){return this.theFormValue},set:function(t){this.theFormValue=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEdit",{get:function(){return this.isAlwaysEdit||this.isEditValue},set:function(t){this.isEditValue=t,this.isEditChange.emit(this.isEditValue)},enumerable:!0,configurable:!0}),e.prototype.onCloseDetails=function(){this.closeDetails.emit()},e.prototype.onToggleDetailsEditMode=function(){this.isAlwaysEdit||(this.isEdit=!this.isEdit),this.toggleDetailsEditMode.emit(this.isEditValue)},e.prototype.onApplyDetails=function(){this.theForm&&this.theForm.valid&&this.applyDetails.emit()},e.ctorParameters=function(){return[{type:d.Store}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"headerHeightPx",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"headerTitle",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"headerSubtitle",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"isReadOnly",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"isAlwaysEdit",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",u.FormGroup),Object(i.g)("design:paramtypes",[u.FormGroup])],e.prototype,"theForm",null),Object(i.c)([Object(a.Output)(),Object(i.g)("design:type",Object)],e.prototype,"closeDetails",void 0),Object(i.c)([Object(a.Output)(),Object(i.g)("design:type",Object)],e.prototype,"toggleDetailsEditMode",void 0),Object(i.c)([Object(a.Output)(),Object(i.g)("design:type",Object)],e.prototype,"applyDetails",void 0),Object(i.c)([Object(a.Output)(),Object(i.g)("design:type",Object)],e.prototype,"isEditChange",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean),Object(i.g)("design:paramtypes",[Boolean])],e.prototype,"isEdit",null),e=Object(i.c)([Object(a.Component)({selector:"tb-details-panel",template:Object(i.f)(n("AU9W")).default,styles:[Object(i.f)(n("1KgG")).default]}),Object(i.g)("design:paramtypes",[d.Store])],e)}(c.a),p=n("qxrw"),m=n("U3y+"),g=n("HnHJ"),f=n("IzAD"),b=n("//Q6"),y=function(t){function e(e,n,i,o){var r=t.call(this,e)||this;return r.store=e,r.injector=n,r.cd=i,r.componentFactoryResolver=o,r.closeEntityDetails=new a.EventEmitter,r.entityUpdated=new a.EventEmitter,r.entityAction=new a.EventEmitter,r.isEditValue=!1,r.selectedTab=0,r.entityTypes=m.b,r.subscriptions=[],r.viewInited=!1,r}return Object(i.d)(e,t),Object.defineProperty(e.prototype,"entityId",{set:function(t){t&&t!==this.currentEntityId&&(this.currentEntityId=t,this.reload())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"entitiesTableConfig",{get:function(){return this.entitiesTableConfigValue},set:function(t){this.entitiesTableConfigValue!==t&&(this.entitiesTableConfigValue=t,this.entitiesTableConfigValue&&(this.currentEntityId=null,this.isEdit=!1,this.entity=null,this.init()))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEdit",{get:function(){return this.isEditValue},set:function(t){this.isEditValue=t,this.entityComponent&&(this.entityComponent.isEdit=t),this.entityTabsComponent&&(this.entityTabsComponent.isEdit=t)},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){this.init()},e.prototype.init=function(){this.translations=this.entitiesTableConfig.entityTranslations,this.resources=this.entitiesTableConfig.entityResources,this.buildEntityComponent()},e.prototype.clearSubscriptions=function(){this.subscriptions.forEach((function(t){t.unsubscribe()})),this.subscriptions.length=0},e.prototype.ngOnDestroy=function(){t.prototype.ngOnDestroy.call(this),this.clearSubscriptions()},e.prototype.buildEntityComponent=function(){var t=this;this.clearSubscriptions(),this.entityComponentRef&&(this.entityComponentRef.destroy(),this.entityComponentRef=null);var e=this.componentFactoryResolver.resolveComponentFactory(this.entitiesTableConfig.entityComponent),n=this.entityDetailsFormAnchor.viewContainerRef;n.clear();var i=a.Injector.create({providers:[{provide:"entity",useValue:this.entity},{provide:"entitiesTableConfig",useValue:this.entitiesTableConfig}],parent:this.injector});this.entityComponentRef=n.createComponent(e,0,i),this.entityComponent=this.entityComponentRef.instance,this.entityComponent.isEdit=this.isEdit,this.detailsForm=this.entityComponent.entityForm,this.subscriptions.push(this.entityComponent.entityAction.subscribe((function(e){t.entityAction.emit(e)}))),this.buildEntityTabsComponent(),this.subscriptions.push(this.entityComponent.entityForm.valueChanges.subscribe((function(){t.cd.detectChanges()})))},e.prototype.buildEntityTabsComponent=function(){var t=this;this.entityTabsComponentRef&&(this.entityTabsComponentRef.destroy(),this.entityTabsComponentRef=null);var e=this.entityTabsAnchor.viewContainerRef;if(e.clear(),this.entityTabsComponent=null,this.entitiesTableConfig.entityTabsComponent){var n=this.componentFactoryResolver.resolveComponentFactory(this.entitiesTableConfig.entityTabsComponent);this.entityTabsComponentRef=e.createComponent(n),this.entityTabsComponent=this.entityTabsComponentRef.instance,this.entityTabsComponent.isEdit=this.isEdit,this.entityTabsComponent.entitiesTableConfig=this.entitiesTableConfig,this.entityTabsComponent.detailsForm=this.detailsForm,this.subscriptions.push(this.entityTabsComponent.entityTabsChanged.subscribe((function(e){e&&(t.viewInited?(t.matTabGroup._tabs.reset(Object(i.l)(t.inclusiveTabs.toArray(),e)),t.matTabGroup._tabs.notifyOnChanges()):t.pendingTabs=e)})))}},e.prototype.hideDetailsTabs=function(){return this.isEditValue&&this.entitiesTableConfig.hideDetailsTabsOnEdit},e.prototype.reload=function(){var t=this;this.isEdit=!1,this.entitiesTableConfig.loadEntity(this.currentEntityId).subscribe((function(e){t.entity=e,t.entityComponent.entity=e,t.entityTabsComponent&&(t.entityTabsComponent.entity=e)}))},e.prototype.onCloseEntityDetails=function(){this.closeEntityDetails.emit()},e.prototype.onToggleEditMode=function(t){this.isEdit=t,this.isEdit?(this.editingEntity=Object(b.d)(this.entity),this.entityComponent.entity=this.editingEntity,this.entityTabsComponent&&(this.entityTabsComponent.entity=this.editingEntity),this.entitiesTableConfig.hideDetailsTabsOnEdit&&(this.selectedTab=0)):(this.entityComponent.entity=this.entity,this.entityTabsComponent&&(this.entityTabsComponent.entity=this.entity))},e.prototype.helpLinkId=function(){return this.resources.helpLinkIdForEntity&&this.entityComponent.entityForm?this.resources.helpLinkIdForEntity(this.entityComponent.entityForm.getRawValue()):this.resources.helpLinkId},e.prototype.saveEntity=function(){var t=this;if(this.detailsForm.valid){var e=Object(i.a)(Object(i.a)({},this.editingEntity),this.entityComponent.entityFormValue());this.entitiesTableConfig.saveEntity(e).subscribe((function(e){t.entity=e,t.entityComponent.entity=e,t.entityTabsComponent&&(t.entityTabsComponent.entity=e),t.isEdit=!1,t.entityUpdated.emit(t.entity)}))}},e.prototype.ngAfterViewInit=function(){this.viewInited=!0,this.pendingTabs&&(this.matTabGroup._tabs.reset(Object(i.l)(this.inclusiveTabs.toArray(),this.pendingTabs)),this.matTabGroup._tabs.notifyOnChanges(),this.pendingTabs=null)},e.ctorParameters=function(){return[{type:d.Store},{type:a.Injector},{type:a.ChangeDetectorRef},{type:a.ComponentFactoryResolver}]},Object(i.c)([Object(a.Output)(),Object(i.g)("design:type",Object)],e.prototype,"closeEntityDetails",void 0),Object(i.c)([Object(a.Output)(),Object(i.g)("design:type",Object)],e.prototype,"entityUpdated",void 0),Object(i.c)([Object(a.Output)(),Object(i.g)("design:type",Object)],e.prototype,"entityAction",void 0),Object(i.c)([Object(a.ViewChild)("entityDetailsForm",{static:!0}),Object(i.g)("design:type",g.a)],e.prototype,"entityDetailsFormAnchor",void 0),Object(i.c)([Object(a.ViewChild)("entityTabs",{static:!0}),Object(i.g)("design:type",g.a)],e.prototype,"entityTabsAnchor",void 0),Object(i.c)([Object(a.ViewChild)(f.b,{static:!0}),Object(i.g)("design:type",f.b)],e.prototype,"matTabGroup",void 0),Object(i.c)([Object(a.ViewChildren)(f.a),Object(i.g)("design:type",a.QueryList)],e.prototype,"inclusiveTabs",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object),Object(i.g)("design:paramtypes",[Object])],e.prototype,"entityId",null),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",p.d),Object(i.g)("design:paramtypes",[p.d])],e.prototype,"entitiesTableConfig",null),e=Object(i.c)([Object(a.Component)({selector:"tb-entity-details-panel",template:Object(i.f)(n("lGaB")).default,changeDetection:a.ChangeDetectionStrategy.OnPush,styles:[Object(i.f)(n("thwt")).default]}),Object(i.g)("design:paramtypes",[d.Store,a.Injector,a.ChangeDetectorRef,a.ComponentFactoryResolver])],e)}(c.a),v=n("5pw5"),w=n("igfJ"),x=n("JTB5"),S=n("90vD"),C=function(t){function e(e){var n=t.call(this,e)||this;return n.store=e,n.eventTypeTranslationsMap=S.c,n}return Object(i.d)(e,t),Object.defineProperty(e.prototype,"eventTableConfig",{get:function(){return this.entitiesTableConfig},enumerable:!0,configurable:!0}),e.prototype.eventTypeChanged=function(t){this.eventTableConfig.eventType=t,this.eventTableConfig.table.resetSortAndFilter(!0,!0)},e.ctorParameters=function(){return[{type:d.Store}]},e=Object(i.c)([Object(a.Component)({selector:"tb-event-table-header",template:Object(i.f)(n("q1F0")).default,styles:[Object(i.f)(n("+XbJ")).default]}),Object(i.g)("design:paramtypes",[d.Store])],e)}(x.a),T=n("o8Qb"),O=n("ea4N"),_=n("4r/P"),L=n("he9t"),I=n("bU/s"),A=n("gmuX"),k=n("DUip"),E=function(t){function e(e,n,i,a,o){var r=t.call(this,e,n,a)||this;return r.store=e,r.router=n,r.data=i,r.dialogRef=a,r.renderer=o,r}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){this.content=this.data.content,this.title=this.data.title,this.contentType=this.data.contentType,this.eventContentEditor=this.createEditor(this.eventContentEditorElmRef,this.content)},e.prototype.createEditor=function(t,e){var n=t.nativeElement,a="java";this.contentType&&(a=L.f.get(this.contentType).code,this.contentType===L.b.JSON&&e&&(e=js_beautify(e,{indent_size:4})));var o={mode:"ace/mode/"+a,theme:"ace/theme/github",showGutter:!1,showPrintMargin:!1,readOnly:!0};o=Object(i.a)(Object(i.a)({},o),{enableSnippets:!1,enableBasicAutocompletion:!1,enableLiveAutocompletion:!1});var r=I.edit(n,o);return r.session.setUseWrapMode(!1),r.setValue(e,-1),this.updateEditorSize(n,e,r),r},e.prototype.updateEditorSize=function(t,e,n){var i=400,a=600;if(e&&e.length>0){var o=e.split("\n");i=16*o.length+16;var r=0;o.forEach((function(t){var e=t.replace(/\t/g,"    ").replace(/\n/g,"").length;r=Math.max(r,e)})),a=8*r+16}this.renderer.setStyle(t,"minHeight",i.toString()+"px"),this.renderer.setStyle(t,"height",i.toString()+"px"),this.renderer.setStyle(t,"width",a.toString()+"px"),n.resize()},e.ctorParameters=function(){return[{type:d.Store},{type:k.Router},{type:void 0,decorators:[{type:a.Inject,args:[O.MAT_DIALOG_DATA]}]},{type:O.MatDialogRef},{type:a.Renderer2}]},Object(i.c)([Object(a.ViewChild)("eventContentEditor",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"eventContentEditorElmRef",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-event-content-dialog",template:Object(i.f)(n("nYlx")).default,styles:[Object(i.f)(n("TPjs")).default]}),Object(i.h)(2,Object(a.Inject)(O.MAT_DIALOG_DATA)),Object(i.g)("design:paramtypes",[d.Store,k.Router,Object,O.MatDialogRef,a.Renderer2])],e)}(A.a),j=function(t){function e(e,n,a,o,r,s,l,c,d,u){void 0===d&&(d=null),void 0===u&&(u=null);var h=t.call(this)||this;return h.eventService=e,h.dialogService=n,h.translate=a,h.datePipe=o,h.dialog=r,h.entityId=s,h.tenantId=l,h.defaultEventType=c,h.disabledEventTypes=d,h.debugEventTypes=u,h.loadDataOnInit=!1,h.tableTitle="",h.useTimePageLink=!0,h.detailsPanelEnabled=!1,h.selectionEnabled=!1,h.searchEnabled=!1,h.addEnabled=!1,h.entitiesDeleteEnabled=!1,h.headerComponent=C,h.eventTypes=Object.keys(S.b).map((function(t){return S.b[t]})),d&&d.length&&(h.eventTypes=h.eventTypes.filter((function(t){return-1===d.indexOf(t)}))),u&&u.length&&(h.eventTypes=Object(i.l)(h.eventTypes,u)),h.eventTypeValue=c,h.entityTranslations={noEntities:"event.no-events-prompt"},h.entityResources={},h.entitiesFetchFunction=function(t){return h.fetchEvents(t)},h.defaultSortOrder={property:"createdTime",direction:_.a.DESC},h.updateColumns(),h}return Object(i.d)(e,t),Object.defineProperty(e.prototype,"eventType",{get:function(){return this.eventTypeValue},set:function(t){this.eventTypeValue!==t&&(this.eventTypeValue=t,this.updateColumns(!0))},enumerable:!0,configurable:!0}),e.prototype.fetchEvents=function(t){return this.eventService.getEvents(this.entityId,this.eventType,this.tenantId,t)},e.prototype.updateColumns=function(t){var e=this;switch(void 0===t&&(t=!1),this.columns=[],this.columns.push(new p.a("createdTime","event.event-time",this.datePipe,"120px"),new p.c("server","event.server","100px",(function(t){return t.body.server}),(function(t){return{}}),!1)),this.eventType){case S.b.ERROR:this.columns.push(new p.c("method","event.method","100%",(function(t){return t.body.method}),(function(t){return{}}),!1),new p.b("error","event.error",{name:this.translate.instant("action.view"),icon:"more_horiz",isEnabled:function(t){return t.body.error&&t.body.error.length>0},onAction:function(t,n){return e.showContent(t,n.body.error,"event.error")}},"100px"));break;case S.b.LC_EVENT:this.columns.push(new p.c("method","event.event","100%",(function(t){return t.body.event}),(function(t){return{}}),!1),new p.c("status","event.status","100%",(function(t){return e.translate.instant(t.body.success?"event.success":"event.failed")}),(function(t){return{}}),!1),new p.b("error","event.error",{name:this.translate.instant("action.view"),icon:"more_horiz",isEnabled:function(t){return t.body.error&&t.body.error.length>0},onAction:function(t,n){return e.showContent(t,n.body.error,"event.error")}},"100px"));break;case S.b.STATS:this.columns.push(new p.c("messagesProcessed","event.messages-processed","50%",(function(t){return t.body.messagesProcessed+""}),(function(){return{}}),!1,(function(){return{}}),(function(){}),!0),new p.c("errorsOccurred","event.errors-occurred","50%",(function(t){return t.body.errorsOccurred+""}),(function(){return{}}),!1,(function(){return{}}),(function(){}),!0));break;case S.a.DEBUG_RULE_NODE:case S.a.DEBUG_RULE_CHAIN:this.columns[0].width="100px",this.columns.push(new p.c("type","event.type","40px",(function(t){return t.body.type}),(function(t){return{padding:"0 12px 0 0"}}),!1,(function(t){return{padding:"0 12px 0 0"}})),new p.c("entity","event.entity","100px",(function(t){return t.body.entityName}),(function(t){return{padding:"0 12px 0 0"}}),!1,(function(t){return{padding:"0 12px 0 0"}})),new p.c("msgId","event.message-id","100px",(function(t){return t.body.msgId}),(function(t){return{whiteSpace:"nowrap",padding:"0 12px 0 0"}}),!1,(function(t){return{padding:"0 12px 0 0"}}),(function(t){return t.body.msgId})),new p.c("msgType","event.message-type","100px",(function(t){return t.body.msgType}),(function(t){return{whiteSpace:"nowrap",padding:"0 12px 0 0"}}),!1,(function(t){return{padding:"0 12px 0 0"}}),(function(t){return t.body.msgType})),new p.c("relationType","event.relation-type","100px",(function(t){return t.body.relationType}),(function(t){return{padding:"0 12px 0 0"}}),!1,(function(t){return{padding:"0 12px 0 0"}})),new p.b("data","event.data",{name:this.translate.instant("action.view"),icon:"more_horiz",isEnabled:function(t){return!!t.body.data&&t.body.data.length>0},onAction:function(t,n){return e.showContent(t,n.body.data,"event.data",n.body.dataType)}},"40px"),new p.b("metadata","event.metadata",{name:this.translate.instant("action.view"),icon:"more_horiz",isEnabled:function(t){return!!t.body.metadata&&t.body.metadata.length>0},onAction:function(t,n){return e.showContent(t,n.body.metadata,"event.metadata",L.b.JSON)}},"40px"),new p.b("error","event.error",{name:this.translate.instant("action.view"),icon:"more_horiz",isEnabled:function(t){return t.body.error&&t.body.error.length>0},onAction:function(t,n){return e.showContent(t,n.body.error,"event.error")}},"40px"))}t&&this.table.columnsUpdated(!0)},e.prototype.showContent=function(t,e,n,i){void 0===i&&(i=null),t&&t.stopPropagation(),this.dialog.open(E,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{content:e,title:n,contentType:i}})},e}(p.d),D=n("mopS"),F=n("S+vS"),M=function(){function t(t,e,n,i,a){this.eventService=t,this.dialogService=e,this.translate=n,this.datePipe=i,this.dialog=a,this.activeValue=!1,this.dirtyValue=!1}return Object.defineProperty(t.prototype,"active",{set:function(t){this.activeValue!==t&&(this.activeValue=t,this.activeValue&&this.dirtyValue&&(this.dirtyValue=!1,this.entitiesTable.updateData()))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"entityId",{set:function(t){this.entityIdValue=t,this.eventTableConfig&&this.eventTableConfig.entityId!==t&&(this.eventTableConfig.eventType=this.defaultEventType,this.eventTableConfig.entityId=t,this.entitiesTable.resetSortAndFilter(this.activeValue),this.activeValue||(this.dirtyValue=!0))},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){this.dirtyValue=!this.activeValue,this.eventTableConfig=new j(this.eventService,this.dialogService,this.translate,this.datePipe,this.dialog,this.entityIdValue,this.tenantId,this.defaultEventType,this.disabledEventTypes,this.debugEventTypes)},t.ctorParameters=function(){return[{type:D.a},{type:F.a},{type:T.TranslateService},{type:o.DatePipe},{type:O.MatDialog}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",String)],t.prototype,"tenantId",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",String)],t.prototype,"defaultEventType",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Array)],t.prototype,"disabledEventTypes",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Array)],t.prototype,"debugEventTypes",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean),Object(i.g)("design:paramtypes",[Boolean])],t.prototype,"active",null),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object),Object(i.g)("design:paramtypes",[Object])],t.prototype,"entityId",null),Object(i.c)([Object(a.ViewChild)(l.a,{static:!0}),Object(i.g)("design:type",l.a)],t.prototype,"entitiesTable",void 0),t=Object(i.c)([Object(a.Component)({selector:"tb-event-table",template:Object(i.f)(n("71y5")).default,styles:[Object(i.f)(n("c69d")).default]}),Object(i.g)("design:paramtypes",[D.a,F.a,T.TranslateService,o.DatePipe,O.MatDialog])],t)}(),R=n("mbhL"),N=n("nbAZ"),P=n("Byqp"),V=n("Bjlt"),W=n("bne5"),z=n("p0ib"),B=n("VNr4"),U=n("Gi3i"),G=n("ad02"),H=n("xMyE"),K=n("7JTo"),Y=n("QWsF"),Z=n("26FU"),q=n("S5bw"),X=n("F/XL"),Q=n("Duvn"),J=n("9Z1F"),tt=n("67Y/"),et=n("s4kO"),nt=n("yGWI"),it=n("t9fZ"),at=function(){function t(t,e){this.entityRelationService=t,this.translate=e,this.relationsSubject=new Z.a([]),this.pageDataSubject=new Z.a(Object(Q.a)()),this.pageData$=this.pageDataSubject.asObservable(),this.selection=new Y.c(!0,[])}return t.prototype.connect=function(t){return this.relationsSubject.asObservable()},t.prototype.disconnect=function(t){this.relationsSubject.complete(),this.pageDataSubject.complete()},t.prototype.loadRelations=function(t,e,n,i){var a=this;void 0===i&&(i=!1),i&&(this.allRelations=null);var o=new q.a;return this.fetchRelations(t,e,n).pipe(Object(H.a)((function(){a.selection.clear()})),Object(J.a)((function(){return Object(X.a)(Object(Q.a)())}))).subscribe((function(t){a.relationsSubject.next(t.data),a.pageDataSubject.next(t),o.next(t)})),o},t.prototype.fetchRelations=function(t,e,n){return this.getAllRelations(t,e).pipe(Object(tt.a)((function(t){return n.filterData(t)})))},t.prototype.getAllRelations=function(t,e){var n=this;if(!this.allRelations){var i=void 0;switch(t){case K.b.FROM:i=this.entityRelationService.findInfoByFrom(e);break;case K.b.TO:i=this.entityRelationService.findInfoByTo(e)}this.allRelations=i.pipe(Object(tt.a)((function(e){return e.forEach((function(e){t===K.b.FROM?e.toEntityTypeName=n.translate.instant(m.d.get(e.to.entityType).type):e.fromEntityTypeName=n.translate.instant(m.d.get(e.from.entityType).type)})),e})),Object(et.a)(1),Object(nt.a)())}return this.allRelations},t.prototype.isAllSelected=function(){var t=this.selection.selected.length;return this.relationsSubject.pipe(Object(tt.a)((function(e){return t===e.length})))},t.prototype.isEmpty=function(){return this.relationsSubject.pipe(Object(tt.a)((function(t){return!t.length})))},t.prototype.total=function(){return this.pageDataSubject.pipe(Object(tt.a)((function(t){return t.totalElements})))},t.prototype.masterToggle=function(){var t=this;this.relationsSubject.pipe(Object(H.a)((function(e){t.selection.selected.length===e.length?t.selection.clear():e.forEach((function(e){t.selection.select(e)}))})),Object(it.a)(1)).subscribe()},t}(),ot=n("MqYC"),rt=n("H3So"),st=function(t){function e(e,n,i,a,o,r,s){var l=t.call(this,e,n,r)||this;return l.store=e,l.router=n,l.data=i,l.entityRelationService=a,l.errorStateMatcher=o,l.dialogRef=r,l.fb=s,l.entitySearchDirection=K.b,l.submitted=!1,l.isAdd=i.isAdd,l.direction=i.direction,l}var o;return Object(i.d)(e,t),o=e,e.prototype.ngOnInit=function(){var t=this;this.relationFormGroup=this.fb.group({type:[this.isAdd?K.a:this.data.relation.type,[u.Validators.required]],targetEntityIds:[this.isAdd?null:[this.direction===K.b.FROM?this.data.relation.to:this.data.relation.from],[u.Validators.required]]}),this.additionalInfo=new u.FormControl(this.data.relation.additionalInfo?Object(i.a)({},this.data.relation.additionalInfo):null),this.isAdd||(this.relationFormGroup.get("type").disable(),this.relationFormGroup.get("targetEntityIds").disable()),this.additionalInfo.valueChanges.subscribe((function(){t.submitted=!1}))},e.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=!!(t&&t.invalid&&this.submitted);return n||i},e.prototype.cancel=function(){this.dialogRef.close(!1)},e.prototype.save=function(){var t=this;if(this.submitted=!0,this.additionalInfoEdit.validateOnSubmit(),!this.relationFormGroup.invalid&&!this.additionalInfo.invalid)if(this.isAdd){var e=[],n=this.relationFormGroup.get("type").value;this.relationFormGroup.get("targetEntityIds").value.forEach((function(i){var a={type:n,additionalInfo:t.additionalInfo.value,typeGroup:K.d.COMMON};t.direction===K.b.FROM?(a.from=t.data.relation.from,a.to=i):(a.from=i,a.to=t.data.relation.to),e.push(t.entityRelationService.saveRelation(a))})),Object(B.a)(e).subscribe((function(){t.dialogRef.close(!0)}))}else{var a=Object(i.a)({},this.data.relation);a.additionalInfo=this.additionalInfo.value,this.entityRelationService.saveRelation(a).subscribe((function(){t.dialogRef.close(!0)}))}},e.ctorParameters=function(){return[{type:d.Store},{type:k.Router},{type:void 0,decorators:[{type:a.Inject,args:[O.MAT_DIALOG_DATA]}]},{type:V.a},{type:ot.d,decorators:[{type:a.SkipSelf}]},{type:O.MatDialogRef},{type:u.FormBuilder}]},Object(i.c)([Object(a.ViewChild)("additionalInfoEdit",{static:!0}),Object(i.g)("design:type",rt.a)],e.prototype,"additionalInfoEdit",void 0),e=o=Object(i.c)([Object(a.Component)({selector:"tb-relation-dialog",template:Object(i.f)(n("tDk6")).default,providers:[{provide:ot.d,useExisting:o}],styles:[Object(i.f)(n("/tmG")).default]}),Object(i.h)(2,Object(a.Inject)(O.MAT_DIALOG_DATA)),Object(i.h)(4,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[d.Store,k.Router,Object,V.a,ot.d,O.MatDialogRef,u.FormBuilder])],e)}(A.a),lt=function(t){function e(e,n,i,a,o){var r=t.call(this,e)||this;r.store=e,r.entityRelationService=n,r.translate=i,r.dialog=a,r.dialogService=o,r.directions=K.b,r.directionTypes=Object.keys(K.b),r.directionTypeTranslations=K.g,r.textSearchMode=!1,r.activeValue=!1,r.dirtyValue=!1,r.viewsInited=!1,r.dirtyValue=!r.activeValue;var s={property:"type",direction:_.a.ASC};return r.direction=K.b.FROM,r.pageLink=new R.b(10,0,null,s),r.dataSource=new at(r.entityRelationService,r.translate),r.updateColumns(),r}return Object(i.d)(e,t),Object.defineProperty(e.prototype,"active",{set:function(t){this.activeValue!==t&&(this.activeValue=t,this.activeValue&&this.dirtyValue&&(this.dirtyValue=!1,this.viewsInited&&this.updateData(!0)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"entityId",{set:function(t){this.entityIdValue!==t&&(this.entityIdValue=t,this.viewsInited&&(this.resetSortAndFilter(this.activeValue),this.activeValue||(this.dirtyValue=!0)))},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){},e.prototype.updateColumns=function(){this.direction===K.b.FROM?this.displayedColumns=["select","type","toEntityTypeName","toName","actions"]:this.displayedColumns=["select","type","fromEntityTypeName","fromName","actions"]},e.prototype.directionChanged=function(t){this.direction=t,this.updateColumns(),this.updateData(!0)},e.prototype.ngAfterViewInit=function(){var t=this;Object(W.a)(this.searchInputField.nativeElement,"keyup").pipe(Object(U.a)(150),Object(G.a)(),Object(H.a)((function(){t.paginator.pageIndex=0,t.updateData()}))).subscribe(),this.sort.sortChange.subscribe((function(){return t.paginator.pageIndex=0})),Object(z.a)(this.sort.sortChange,this.paginator.page).pipe(Object(H.a)((function(){return t.updateData()}))).subscribe(),this.viewsInited=!0,this.activeValue&&this.entityIdValue&&this.updateData(!0)},e.prototype.updateData=function(t){void 0===t&&(t=!1),this.pageLink.page=this.paginator.pageIndex,this.pageLink.pageSize=this.paginator.pageSize,this.pageLink.sortOrder.property=this.sort.active,this.pageLink.sortOrder.direction=_.a[this.sort.direction.toUpperCase()],this.dataSource.loadRelations(this.direction,this.entityIdValue,this.pageLink,t)},e.prototype.enterFilterMode=function(){var t=this;this.textSearchMode=!0,this.pageLink.textSearch="",setTimeout((function(){t.searchInputField.nativeElement.focus(),t.searchInputField.nativeElement.setSelectionRange(0,0)}),10)},e.prototype.exitFilterMode=function(){this.textSearchMode=!1,this.pageLink.textSearch=null,this.paginator.pageIndex=0,this.updateData()},e.prototype.resetSortAndFilter=function(t){void 0===t&&(t=!0),this.direction=K.b.FROM,this.updateColumns(),this.pageLink.textSearch=null,this.paginator.pageIndex=0;var e=this.sort.sortables.get("type");this.sort.active=e.id,this.sort.direction="asc",t&&this.updateData(!0)},e.prototype.reloadRelations=function(){this.updateData(!0)},e.prototype.addRelation=function(t){this.openRelationDialog(t)},e.prototype.editRelation=function(t,e){this.openRelationDialog(t,e)},e.prototype.deleteRelation=function(t,e){var n,i,a=this;t&&t.stopPropagation(),this.direction===K.b.FROM?(n=this.translate.instant("relation.delete-to-relation-title",{entityName:e.toName}),i=this.translate.instant("relation.delete-to-relation-text",{entityName:e.toName})):(n=this.translate.instant("relation.delete-from-relation-title",{entityName:e.fromName}),i=this.translate.instant("relation.delete-from-relation-text",{entityName:e.fromName})),this.dialogService.confirm(n,i,this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe((function(t){t&&a.entityRelationService.deleteRelation(e.from,e.type,e.to).subscribe((function(){a.reloadRelations()}))}))},e.prototype.deleteRelations=function(t){var e=this;if(t&&t.stopPropagation(),this.dataSource.selection.selected.length>0){var n=void 0,i=void 0;this.direction===K.b.FROM?(n=this.translate.instant("relation.delete-to-relations-title",{count:this.dataSource.selection.selected.length}),i=this.translate.instant("relation.delete-to-relations-text")):(n=this.translate.instant("relation.delete-from-relations-title",{count:this.dataSource.selection.selected.length}),i=this.translate.instant("relation.delete-from-relations-text")),this.dialogService.confirm(n,i,this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe((function(t){if(t){var n=[];e.dataSource.selection.selected.forEach((function(t){n.push(e.entityRelationService.deleteRelation(t.from,t.type,t.to))})),Object(B.a)(n).subscribe((function(){e.reloadRelations()}))}}))}},e.prototype.openRelationDialog=function(t,e){var n=this;void 0===e&&(e=null),t&&t.stopPropagation();var a=!1;e||(a=!0,e={from:null,to:null,type:null,typeGroup:K.d.COMMON},this.direction===K.b.FROM?e.from=this.entityIdValue:e.to=this.entityIdValue),this.dialog.open(st,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{isAdd:a,direction:this.direction,relation:Object(i.a)({},e)}}).afterClosed().subscribe((function(t){t&&n.reloadRelations()}))},e.ctorParameters=function(){return[{type:d.Store},{type:V.a},{type:T.TranslateService},{type:O.MatDialog},{type:F.a}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean),Object(i.g)("design:paramtypes",[Boolean])],e.prototype,"active",null),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object),Object(i.g)("design:paramtypes",[Object])],e.prototype,"entityId",null),Object(i.c)([Object(a.ViewChild)("searchInput"),Object(i.g)("design:type",a.ElementRef)],e.prototype,"searchInputField",void 0),Object(i.c)([Object(a.ViewChild)(N.a),Object(i.g)("design:type",N.a)],e.prototype,"paginator",void 0),Object(i.c)([Object(a.ViewChild)(P.a),Object(i.g)("design:type",P.a)],e.prototype,"sort",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-relation-table",template:Object(i.f)(n("TVBz")).default,changeDetection:a.ChangeDetectionStrategy.OnPush,styles:[Object(i.f)(n("6epM")).default]}),Object(i.g)("design:paramtypes",[d.Store,V.a,T.TranslateService,O.MatDialog,F.a])],e)}(c.a),ct=n("UZbx"),dt=function(t){function e(e){var n=t.call(this,e)||this;return n.store=e,n.alarmSearchStatusTranslationsMap=ct.f,n.alarmSearchStatusTypes=Object.keys(ct.b),n.alarmSearchStatusEnum=ct.b,n}return Object(i.d)(e,t),Object.defineProperty(e.prototype,"alarmTableConfig",{get:function(){return this.entitiesTableConfig},enumerable:!0,configurable:!0}),e.prototype.searchStatusChanged=function(t){this.alarmTableConfig.searchStatus=t,this.alarmTableConfig.table.resetSortAndFilter(!0,!0)},e.ctorParameters=function(){return[{type:d.Store}]},e=Object(i.c)([Object(a.Component)({selector:"tb-alarm-table-header",template:Object(i.f)(n("880C")).default,styles:[Object(i.f)(n("Qxzm")).default]}),Object(i.g)("design:paramtypes",[d.Store])],e)}(x.a),ut=n("10j8"),ht=function(t){function e(e,n,i,a,o,r,s){void 0===r&&(r=null),void 0===s&&(s=ct.b.ANY);var l=t.call(this)||this;return l.alarmService=e,l.dialogService=n,l.translate=i,l.datePipe=a,l.dialog=o,l.entityId=r,l.defaultSearchStatus=s,l.loadDataOnInit=!1,l.tableTitle="",l.useTimePageLink=!0,l.detailsPanelEnabled=!1,l.selectionEnabled=!1,l.searchEnabled=!0,l.addEnabled=!1,l.entitiesDeleteEnabled=!1,l.actionsColumnTitle="alarm.details",l.entityType=m.b.ALARM,l.entityTranslations=m.d.get(m.b.ALARM),l.entityResources={},l.searchStatus=s,l.headerComponent=dt,l.entitiesFetchFunction=function(t){return l.fetchAlarms(t)},l.defaultSortOrder={property:"createdTime",direction:_.a.DESC},l.columns.push(new p.a("createdTime","alarm.created-time",l.datePipe,"150px")),l.columns.push(new p.c("originatorName","alarm.originator","25%",(function(t){return t.originatorName}),(function(t){return{}}),!1)),l.columns.push(new p.c("type","alarm.type","25%")),l.columns.push(new p.c("severity","alarm.severity","25%",(function(t){return l.translate.instant(ct.h.get(t.severity))}),(function(t){return{fontWeight:"bold",color:ct.g.get(t.severity)}}))),l.columns.push(new p.c("status","alarm.status","25%",(function(t){return l.translate.instant(ct.i.get(t.status))}))),l.cellActionDescriptors.push({name:l.translate.instant("alarm.details"),icon:"more_horiz",isEnabled:function(){return!0},onAction:function(t,e){return l.showAlarmDetails(e)}}),l}return Object(i.d)(e,t),e.prototype.fetchAlarms=function(t){var e=new ct.a(this.entityId,t,this.searchStatus,null,!0,null);return this.alarmService.getAlarms(e)},e.prototype.showAlarmDetails=function(t){var e=this;this.dialog.open(ut.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{alarmId:t.id.id,allowAcknowledgment:!0,allowClear:!0,displayDetails:!0}}).afterClosed().subscribe((function(t){t&&e.table.updateData()}))},e}(p.d),pt=n("7ZKe"),mt=function(){function t(t,e,n,i,a){this.alarmService=t,this.dialogService=e,this.translate=n,this.datePipe=i,this.dialog=a,this.activeValue=!1,this.dirtyValue=!1}return Object.defineProperty(t.prototype,"active",{set:function(t){this.activeValue!==t&&(this.activeValue=t,this.activeValue&&this.dirtyValue&&(this.dirtyValue=!1,this.entitiesTable.updateData()))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"entityId",{set:function(t){this.entityIdValue=t,this.alarmTableConfig&&this.alarmTableConfig.entityId!==t&&(this.alarmTableConfig.searchStatus=ct.b.ANY,this.alarmTableConfig.entityId=t,this.entitiesTable.resetSortAndFilter(this.activeValue),this.activeValue||(this.dirtyValue=!0))},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){this.dirtyValue=!this.activeValue,this.alarmTableConfig=new ht(this.alarmService,this.dialogService,this.translate,this.datePipe,this.dialog,this.entityIdValue,ct.b.ANY)},t.ctorParameters=function(){return[{type:pt.a},{type:F.a},{type:T.TranslateService},{type:o.DatePipe},{type:O.MatDialog}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean),Object(i.g)("design:paramtypes",[Boolean])],t.prototype,"active",null),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object),Object(i.g)("design:paramtypes",[Object])],t.prototype,"entityId",null),Object(i.c)([Object(a.ViewChild)(l.a,{static:!0}),Object(i.g)("design:type",l.a)],t.prototype,"entitiesTable",void 0),t=Object(i.c)([Object(a.Component)({selector:"tb-alarm-table",template:Object(i.f)(n("Soa6")).default,styles:[Object(i.f)(n("G1wd")).default]}),Object(i.g)("design:paramtypes",[pt.a,F.a,T.TranslateService,o.DatePipe,O.MatDialog])],t)}(),gt=n("3Tyt"),ft=function(){function t(t,e,n,i){this.attributeService=t,this.telemetryWsService=e,this.zone=n,this.translate=i,this.attributesSubject=new Z.a([]),this.pageDataSubject=new Z.a(Object(Q.a)()),this.pageData$=this.pageDataSubject.asObservable(),this.selection=new Y.c(!0,[])}return t.prototype.connect=function(t){return this.attributesSubject.asObservable()},t.prototype.disconnect=function(t){this.attributesSubject.complete(),this.pageDataSubject.complete(),this.telemetrySubscriber&&(this.telemetrySubscriber.unsubscribe(),this.telemetrySubscriber=null)},t.prototype.loadAttributes=function(t,e,n,i){var a=this;void 0===i&&(i=!1),i&&(this.allAttributes=null,this.telemetrySubscriber&&(this.telemetrySubscriber.unsubscribe(),this.telemetrySubscriber=null)),this.selection.clear();var o=new q.a;return this.fetchAttributes(t,e,n).pipe(Object(J.a)((function(){return Object(X.a)(Object(Q.a)())}))).subscribe((function(t){a.attributesSubject.next(t.data),a.pageDataSubject.next(t),o.next(t)})),o},t.prototype.fetchAttributes=function(t,e,n){return this.getAllAttributes(t,e).pipe(Object(tt.a)((function(t){return n.filterData(t)})))},t.prototype.getAllAttributes=function(t,e){if(!this.allAttributes){var n=void 0;gt.l.get(e)?(this.telemetrySubscriber=gt.j.createEntityAttributesSubscription(this.telemetryWsService,t,e,this.zone),this.telemetrySubscriber.subscribe(),n=this.telemetrySubscriber.attributeData$()):n=this.attributeService.getEntityAttributes(t,e),this.allAttributes=n.pipe(Object(et.a)(1),Object(nt.a)())}return this.allAttributes},t.prototype.isAllSelected=function(){var t=this.selection.selected.length;return this.attributesSubject.pipe(Object(tt.a)((function(e){return t===e.length})))},t.prototype.isEmpty=function(){return this.attributesSubject.pipe(Object(tt.a)((function(t){return!t.length})))},t.prototype.total=function(){return this.pageDataSubject.pipe(Object(tt.a)((function(t){return t.totalElements})))},t.prototype.masterToggle=function(){var t=this;this.attributesSubject.pipe(Object(H.a)((function(e){t.selection.selected.length===e.length?t.selection.clear():e.forEach((function(e){t.selection.select(e)}))})),Object(it.a)(1)).subscribe()},t}(),bt=n("BsGH"),yt=n("349r"),vt=function(t){function e(e,n,i,a,o,r,s){var l=t.call(this,e,n,r)||this;return l.store=e,l.router=n,l.data=i,l.attributeService=a,l.errorStateMatcher=o,l.dialogRef=r,l.fb=s,l.submitted=!1,l}var o;return Object(i.d)(e,t),o=e,e.prototype.ngOnInit=function(){this.attributeFormGroup=this.fb.group({key:["",[u.Validators.required]],value:[null,[u.Validators.required]]})},e.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=!!(t&&t.invalid&&this.submitted);return n||i},e.prototype.cancel=function(){this.dialogRef.close(!1)},e.prototype.add=function(){var t=this;this.submitted=!0;var e={lastUpdateTs:null,key:this.attributeFormGroup.get("key").value,value:this.attributeFormGroup.get("value").value};this.attributeService.saveEntityAttributes(this.data.entityId,this.data.attributeScope,[e]).subscribe((function(){t.dialogRef.close(!0)}))},e.ctorParameters=function(){return[{type:d.Store},{type:k.Router},{type:void 0,decorators:[{type:a.Inject,args:[O.MAT_DIALOG_DATA]}]},{type:bt.a},{type:ot.d,decorators:[{type:a.SkipSelf}]},{type:O.MatDialogRef},{type:u.FormBuilder}]},e=o=Object(i.c)([Object(a.Component)({selector:"tb-add-attribute-dialog",template:Object(i.f)(n("TLQs")).default,providers:[{provide:ot.d,useExisting:o}]}),Object(i.h)(2,Object(a.Inject)(O.MAT_DIALOG_DATA)),Object(i.h)(4,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[d.Store,k.Router,Object,bt.a,ot.d,O.MatDialogRef,u.FormBuilder])],e)}(A.a),wt=n("bYjt"),xt=new a.InjectionToken("EditAttributeValuePanelData"),St=function(t){function e(e,n,i,a,o){var r=t.call(this,e)||this;return r.store=e,r.data=n,r.errorStateMatcher=i,r.overlayRef=a,r.fb=o,r.result=null,r.submitted=!1,r}var o;return Object(i.d)(e,t),o=e,e.prototype.ngOnInit=function(){this.attributeFormGroup=this.fb.group({value:[this.data.attributeValue,[u.Validators.required]]})},e.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=!!(t&&t.invalid&&this.submitted);return n||i},e.prototype.cancel=function(){this.overlayRef.dispose()},e.prototype.update=function(){this.submitted=!0,this.result=this.attributeFormGroup.get("value").value,this.overlayRef.dispose()},e.ctorParameters=function(){return[{type:d.Store},{type:void 0,decorators:[{type:a.Inject,args:[xt]}]},{type:ot.d,decorators:[{type:a.SkipSelf}]},{type:wt.g},{type:u.FormBuilder}]},e=o=Object(i.c)([Object(a.Component)({selector:"tb-edit-attribute-value-panel",template:Object(i.f)(n("vFi6")).default,providers:[{provide:ot.d,useExisting:o}],styles:[Object(i.f)(n("zt1W")).default]}),Object(i.h)(1,Object(a.Inject)(xt)),Object(i.h)(2,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[d.Store,Object,ot.d,wt.g,u.FormBuilder])],e)}(c.a),Ct=n("2J3F"),Tt=n("2lgB"),Ot=n("0lYY"),_t=n("Xk9D"),Lt=n("OiFK"),It=n("4j5O"),At=n("oKkZ"),kt=n("5xOD"),Et=n("0G7Z"),jt=n("21Fy"),Dt=n("YnEf"),Ft=n("6opy"),Mt=function(t){function e(e,n,i,a,o,r,s){var l=t.call(this,e,n,o)||this;return l.store=e,l.router=n,l.data=i,l.errorStateMatcher=a,l.dialogRef=o,l.fb=r,l.dashboardUtils=s,l.submitted=!1,l.states=l.data.states,l.stateFormGroup=l.fb.group({stateId:[l.dashboardUtils.getRootStateId(l.states),[u.Validators.required]]}),l}var o;return Object(i.d)(e,t),o=e,e.prototype.ngOnInit=function(){},e.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=!!(t&&t.invalid&&this.submitted);return n||i},e.prototype.cancel=function(){this.dialogRef.close(null)},e.prototype.save=function(){this.submitted=!0;var t=this.stateFormGroup.get("stateId").value;this.dialogRef.close(t)},e.ctorParameters=function(){return[{type:d.Store},{type:k.Router},{type:void 0,decorators:[{type:a.Inject,args:[O.MAT_DIALOG_DATA]}]},{type:ot.d,decorators:[{type:a.SkipSelf}]},{type:O.MatDialogRef},{type:u.FormBuilder},{type:It.a}]},e=o=Object(i.c)([Object(a.Component)({selector:"tb-select-target-state-dialog",template:Object(i.f)(n("1sVU")).default,providers:[{provide:ot.d,useExisting:o}]}),Object(i.h)(2,Object(a.Inject)(O.MAT_DIALOG_DATA)),Object(i.h)(3,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[d.Store,k.Router,Object,ot.d,O.MatDialogRef,u.FormBuilder,It.a])],e)}(A.a),Rt=n("psW0"),Nt=n("FBAY"),Pt=function(t){function e(e,n,i,a,o,r,s,l,c,d,h){var p=t.call(this,e,n,o)||this;return p.store=e,p.router=n,p.data=i,p.errorStateMatcher=a,p.dialogRef=o,p.fb=r,p.utils=s,p.dashboardUtils=l,p.dashboardService=c,p.itembuffer=d,p.dialog=h,p.submitted=!1,p.addWidgetFormGroup=p.fb.group({addToDashboardType:[0,[]],dashboardId:[null,[u.Validators.required]],newDashboardTitle:[{value:null,disabled:!0},[]],openDashboard:[!1,[]]}),p.addWidgetFormGroup.get("addToDashboardType").valueChanges.subscribe((function(t){0===t?(p.addWidgetFormGroup.get("dashboardId").setValidators([u.Validators.required]),p.addWidgetFormGroup.get("dashboardId").enable(),p.addWidgetFormGroup.get("newDashboardTitle").setValidators([]),p.addWidgetFormGroup.get("newDashboardTitle").disable(),p.addWidgetFormGroup.get("dashboardId").updateValueAndValidity(),p.addWidgetFormGroup.get("newDashboardTitle").updateValueAndValidity()):(p.addWidgetFormGroup.get("dashboardId").setValidators([]),p.addWidgetFormGroup.get("dashboardId").disable(),p.addWidgetFormGroup.get("newDashboardTitle").setValidators([u.Validators.required]),p.addWidgetFormGroup.get("newDashboardTitle").enable(),p.addWidgetFormGroup.get("dashboardId").updateValueAndValidity(),p.addWidgetFormGroup.get("newDashboardTitle").updateValueAndValidity())})),p}var o;return Object(i.d)(e,t),o=e,e.prototype.ngOnInit=function(){},e.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=!!(t&&t.invalid&&this.submitted);return n||i},e.prototype.cancel=function(){this.dialogRef.close(null)},e.prototype.add=function(){var t=this;if(this.submitted=!0,0===this.addWidgetFormGroup.get("addToDashboardType").value){var e=this.addWidgetFormGroup.get("dashboardId").value;this.dashboardService.getDashboard(e).pipe(Object(Rt.a)((function(e){return e=t.dashboardUtils.validateAndUpdateDashboard(e),t.selectTargetState(e).pipe(Object(Rt.a)((function(n){return Object(B.a)([Object(X.a)(e),Object(X.a)(n),t.selectTargetLayout(e,n)])})))}))).subscribe((function(e){t.addWidgetToDashboard(e[0],e[1],e[2])}))}else{var n={title:this.addWidgetFormGroup.get("newDashboardTitle").value};this.addWidgetToDashboard(n,"default","main")}},e.prototype.selectTargetState=function(t){var e=t.configuration.states,n=Object.keys(e);return n.length>1?this.dialog.open(Mt,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{states:e}}).afterClosed():Object(X.a)(n[0])},e.prototype.selectTargetLayout=function(t,e){var n=t.configuration.states[e].layouts,i=Object.keys(n);return i.length>1?this.dialog.open(Ft.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"]}).afterClosed():Object(X.a)(i[0])},e.prototype.addWidgetToDashboard=function(t,e,n){var i=this,a={datasourceAliases:{},targetDeviceAliases:{}};a.datasourceAliases[0]={alias:this.data.entityName,filter:this.dashboardUtils.createSingleEntityFilter(this.data.entityId)},this.itembuffer.addWidgetToDashboard(t,e,n,this.data.widget,a,null,48,null,-1,-1).pipe(Object(Rt.a)((function(t){return i.dashboardService.saveDashboard(t)}))).subscribe((function(n){var a=i.addWidgetFormGroup.get("openDashboard").value;if(i.dialogRef.close(),a){var o=void 0;if(Object.keys(t.configuration.states).indexOf(e)>0){var r={id:e,params:{}},s=Object(b.w)([r]);o="/dashboards/"+n.id.id+"?state="+s}else o="/dashboards/"+n.id.id;i.router.parseUrl(o);i.router.navigateByUrl(o)}}))},e.ctorParameters=function(){return[{type:d.Store},{type:k.Router},{type:void 0,decorators:[{type:a.Inject,args:[O.MAT_DIALOG_DATA]}]},{type:ot.d,decorators:[{type:a.SkipSelf}]},{type:O.MatDialogRef},{type:u.FormBuilder},{type:Lt.a},{type:It.a},{type:Dt.a},{type:Nt.a},{type:O.MatDialog}]},e=o=Object(i.c)([Object(a.Component)({selector:"tb-add-widget-to-dashboard-dialog",template:Object(i.f)(n("3s2E")).default,providers:[{provide:ot.d,useExisting:o}],styles:[Object(i.f)(n("KU6p")).default]}),Object(i.h)(2,Object(a.Inject)(O.MAT_DIALOG_DATA)),Object(i.h)(3,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[d.Store,k.Router,Object,ot.d,O.MatDialogRef,u.FormBuilder,Lt.a,It.a,Dt.a,Nt.a,O.MatDialog])],e)}(A.a),Vt=function(t){function e(e,n,i,a,o,r,s,l,c,d,u,h,p){var m=t.call(this,e)||this;m.store=e,m.attributeService=n,m.telemetryWsService=i,m.translate=a,m.dialog=o,m.overlay=r,m.viewContainerRef=s,m.dialogService=l,m.entityService=c,m.utils=d,m.dashboardUtils=u,m.widgetService=h,m.zone=p,m.telemetryTypeTranslationsMap=gt.m,m.isClientSideTelemetryTypeMap=gt.l,m.latestTelemetryTypes=gt.e,m.mode="default",m.attributeScopes=[],m.toTelemetryTypeFunc=gt.n,m.displayedColumns=["select","lastUpdateTs","key","value"],m.textSearchMode=!1,m.activeValue=!1,m.dirtyValue=!1,m.attributeScopeSelectionReadonly=!1,m.viewsInited=!1,m.selectedWidgetsBundleAlias=null,m.widgetsBundle=null,m.widgetsLoaded=!1,m.widgetsCarouselIndex=0,m.widgetsList=[],m.widgetsListCache=[],m.dirtyValue=!m.activeValue;var g={property:"key",direction:_.a.ASC};return m.pageLink=new R.b(10,0,null,g),m.dataSource=new ft(m.attributeService,m.telemetryWsService,m.zone,m.translate),m}return Object(i.d)(e,t),Object.defineProperty(e.prototype,"disableAttributeScopeSelection",{get:function(){return this.disableAttributeScopeSelectionValue},set:function(t){this.disableAttributeScopeSelectionValue=Object(yt.coerceBooleanProperty)(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"active",{set:function(t){this.activeValue!==t&&(this.activeValue=t,this.activeValue&&this.dirtyValue&&(this.dirtyValue=!1,this.viewsInited&&this.updateData(!0)))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"entityId",{set:function(t){this.entityIdValue!==t&&(this.entityIdValue=t,this.resetSortAndFilter(this.activeValue),this.activeValue||(this.dirtyValue=!0))},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){},e.prototype.attributeScopeChanged=function(t){this.attributeScope=t,this.mode="default",this.updateData(!0)},e.prototype.ngAfterViewInit=function(){var t=this;Object(W.a)(this.searchInputField.nativeElement,"keyup").pipe(Object(U.a)(150),Object(G.a)(),Object(H.a)((function(){t.paginator.pageIndex=0,t.updateData()}))).subscribe(),this.sort.sortChange.subscribe((function(){return t.paginator.pageIndex=0})),Object(z.a)(this.sort.sortChange,this.paginator.page).pipe(Object(H.a)((function(){return t.updateData()}))).subscribe(),this.viewsInited=!0,this.activeValue&&this.entityIdValue&&this.updateData(!0)},e.prototype.updateData=function(t){void 0===t&&(t=!1),this.pageLink.page=this.paginator.pageIndex,this.pageLink.pageSize=this.paginator.pageSize,this.pageLink.sortOrder.property=this.sort.active,this.pageLink.sortOrder.direction=_.a[this.sort.direction.toUpperCase()],this.dataSource.loadAttributes(this.entityIdValue,this.attributeScope,this.pageLink,t)},e.prototype.enterFilterMode=function(){var t=this;this.textSearchMode=!0,this.pageLink.textSearch="",setTimeout((function(){t.searchInputField.nativeElement.focus(),t.searchInputField.nativeElement.setSelectionRange(0,0)}),10)},e.prototype.exitFilterMode=function(){this.textSearchMode=!1,this.pageLink.textSearch=null,this.paginator.pageIndex=0,this.updateData()},e.prototype.resetSortAndFilter=function(t){void 0===t&&(t=!0);var e=this.entityIdValue.entityType;if(e===m.b.DEVICE||e===m.b.ENTITY_VIEW?(this.attributeScopes=Object.keys(gt.a),this.attributeScopeSelectionReadonly=!1):(this.attributeScopes=[gt.a.SERVER_SCOPE],this.attributeScopeSelectionReadonly=!0),this.mode="default",this.attributeScope=this.defaultAttributeScope,this.pageLink.textSearch=null,this.viewsInited){this.paginator.pageIndex=0;var n=this.sort.sortables.get("key");this.sort.active=n.id,this.sort.direction="asc",t&&this.updateData(!0)}},e.prototype.reloadAttributes=function(){this.updateData(!0)},e.prototype.addAttribute=function(t){var e=this;t&&t.stopPropagation(),this.dialog.open(vt,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{entityId:this.entityIdValue,attributeScope:this.attributeScope}}).afterClosed().subscribe((function(t){t&&e.reloadAttributes()}))},e.prototype.editAttribute=function(t,e){var n=this;if(t&&t.stopPropagation(),!this.isClientSideTelemetryTypeMap.get(this.attributeScope)){var a=t.target||t.srcElement||t.currentTarget,o=new wt.d;o.backdropClass="cdk-overlay-transparent-backdrop",o.hasBackdrop=!0;o.positionStrategy=this.overlay.position().flexibleConnectedTo(a).withPositions([{originX:"end",originY:"center",overlayX:"end",overlayY:"center"}]);var r=this.overlay.create(o);r.backdropClick().subscribe((function(){r.dispose()}));var s=new WeakMap([[xt,{attributeValue:e.value}],[wt.g,r]]),l=new Ct.g(this.viewContainerRef.injector,s),c=r.attach(new Ct.d(St,this.viewContainerRef,l));c.onDestroy((function(){if(null!==c.instance.result){var t=c.instance.result,a=Object(i.a)({},e);a.value=t,n.attributeService.saveEntityAttributes(n.entityIdValue,n.attributeScope,[a]).subscribe((function(){n.reloadAttributes()}))}}))}},e.prototype.deleteAttributes=function(t){var e=this;t&&t.stopPropagation(),this.dataSource.selection.selected.length>0&&this.dialogService.confirm(this.translate.instant("attribute.delete-attributes-title",{count:this.dataSource.selection.selected.length}),this.translate.instant("attribute.delete-attributes-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe((function(t){t&&e.attributeService.deleteEntityAttributes(e.entityIdValue,e.attributeScope,e.dataSource.selection.selected).subscribe((function(){e.reloadAttributes()}))}))},e.prototype.enterWidgetMode=function(){this.mode="widget",this.widgetsList=[],this.widgetsListCache=[],this.widgetsLoaded=!1,this.widgetsCarouselIndex=0,this.widgetsBundle=null,this.selectedWidgetsBundleAlias="cards";var t={id:this.utils.guid(),alias:this.entityName,filter:this.dashboardUtils.createSingleEntityFilter(this.entityIdValue)},e={};e[t.id]=t;var n={getStateParams:function(){return{}}};this.aliasController=new _t.a(this.utils,this.entityService,(function(){return n}),e);var i=this.attributeScope===gt.e.LATEST_TELEMETRY?gt.c.timeseries:gt.c.attribute;this.widgetDatasource={type:Ot.a.entity,entityAliasId:t.id,dataKeys:[]};for(var a=0;a<this.dataSource.selection.selected.length;a++){var o=this.dataSource.selection.selected[a],r={name:o.key,label:o.key,type:i,color:this.utils.getMaterialColor(a),settings:{},_hash:Math.random()};this.widgetDatasource.dataKeys.push(r)}},e.prototype.onWidgetsCarouselIndexChanged=function(){if("widget"===this.mode)for(var t=0;t<this.widgetsList.length;t++)this.widgetsList[t].splice(0,this.widgetsList[t].length),t===this.widgetsCarouselIndex&&this.widgetsList[t].push(this.widgetsListCache[t][0])},e.prototype.onWidgetsBundleChanged=function(){var t=this;if("widget"===this.mode&&(this.widgetsList=[],this.widgetsListCache=[],this.widgetsCarouselIndex=0,this.widgetsBundle)){this.widgetsLoaded=!1;var e=this.widgetsBundle.alias,n=this.widgetsBundle.tenantId.id===At.a;this.widgetService.getBundleWidgetTypes(e,n).subscribe((function(i){for(var a=0,o=i=i.sort((function(t,e){var n=Ot.k[e.descriptor.type].localeCompare(Ot.k[t.descriptor.type]);return 0===n&&(n=e.createdTime-t.createdTime),n}));a<o.length;a++){var r=o[a],s=Object(Et.d)(r);if(s.type!==Ot.k.static){var l=2*s.sizeX,c=2*s.sizeY,d=Math.floor(Math.max(0,(20-l)/2)),u={isSystemType:n,bundleAlias:e,typeAlias:s.alias,type:s.type,title:s.widgetName,sizeX:l,sizeY:c,row:0,col:d,config:JSON.parse(s.defaultConfig)};if(u.config.title=s.widgetName,u.config.datasources=[t.widgetDatasource],t.attributeScope===gt.e.LATEST_TELEMETRY&&s.type!==Ot.k.rpc||s.type===Ot.k.latest){var h=t.widgetsListCache.push([u]);t.widgetsList.push(1===h?[u]:[])}}}t.widgetsLoaded=!0}))}},e.prototype.addWidgetToDashboard=function(){if("widget"===this.mode&&this.widgetsListCache.length>0){var t=this.widgetsListCache[this.widgetsCarouselIndex][0];this.dialog.open(Pt,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{entityId:this.entityIdValue,entityName:this.entityName,widget:Object(b.d)(t)}}).afterClosed()}},e.prototype.exitWidgetMode=function(){this.selectedWidgetsBundleAlias=null,this.mode="default"},e.ctorParameters=function(){return[{type:d.Store},{type:bt.a},{type:Tt.a},{type:T.TranslateService},{type:O.MatDialog},{type:wt.c},{type:a.ViewContainerRef},{type:F.a},{type:jt.a},{type:Lt.a},{type:It.a},{type:kt.a},{type:a.NgZone}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean),Object(i.g)("design:paramtypes",[Boolean])],e.prototype,"disableAttributeScopeSelection",null),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",String)],e.prototype,"defaultAttributeScope",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean),Object(i.g)("design:paramtypes",[Boolean])],e.prototype,"active",null),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object),Object(i.g)("design:paramtypes",[Object])],e.prototype,"entityId",null),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",String)],e.prototype,"entityName",void 0),Object(i.c)([Object(a.ViewChild)("searchInput"),Object(i.g)("design:type",a.ElementRef)],e.prototype,"searchInputField",void 0),Object(i.c)([Object(a.ViewChild)(N.a),Object(i.g)("design:type",N.a)],e.prototype,"paginator",void 0),Object(i.c)([Object(a.ViewChild)(P.a),Object(i.g)("design:type",P.a)],e.prototype,"sort",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-attribute-table",template:Object(i.f)(n("a3eP")).default,changeDetection:a.ChangeDetectionStrategy.OnPush,styles:[Object(i.f)(n("lfP9")).default]}),Object(i.g)("design:paramtypes",[d.Store,bt.a,Tt.a,T.TranslateService,O.MatDialog,wt.c,a.ViewContainerRef,F.a,jt.a,Lt.a,It.a,kt.a,a.NgZone])],e)}(c.a),Wt=n("C/rb"),zt=n("aX2P"),Bt=n("k9IB"),Ut=n("cS2x"),Gt=n("K9Ia"),Ht=function(){function t(t,e,n){this.dashboard=t,this.widgetsDiffer=e,this.widgetLayoutsDiffer=n,this.highlightedMode=!1,this.dashboardWidgets=[]}return t.prototype[Symbol.iterator]=function(){return this.dashboardWidgets[Symbol.iterator]()},t.prototype.doCheck=function(){var t=this,e=this.widgetsDiffer.diff(this.widgets),n=this.widgetLayoutsDiffer.diff(this.widgetLayouts),i=[];null!==e&&(e.forEachAddedItem((function(e){i.push({widget:e.item,widgetId:e.item.id,widgetLayout:t.widgetLayouts?t.widgetLayouts[e.item.id]:null,operation:"add"})})),e.forEachRemovedItem((function(t){var e=i.find((function(e){return e.widgetId===t.item.id}));e?e.operation="update":(e={widgetId:t.item.id,operation:"remove"},i.push(e))}))),null!==n&&n.forEachChangedItem((function(e){if(!i.find((function(t){return t.widgetId===e.key}))){var n=t.dashboardWidgets.find((function(t){return t.widgetId===e.key}));n&&i.push({widget:n.widget,widgetId:e.key,widgetLayout:e.currentValue,operation:"update"})}})),i.length&&(i.forEach((function(e){switch(e.operation){case"add":t.dashboardWidgets.push(new Kt(t.dashboard,e.widget,e.widgetLayout));break;case"remove":var n=t.dashboardWidgets.findIndex((function(t){return t.widgetId===e.widgetId}));n>-1&&t.dashboardWidgets.splice(n,1);break;case"update":if((n=t.dashboardWidgets.findIndex((function(t){return t.widgetId===e.widgetId})))>-1){var i=t.dashboardWidgets[n];Object(b.n)(i.widget,e.widget)&&Object(b.n)(i.widgetLayout,e.widgetLayout)?(t.dashboardWidgets[n].widget=e.widget,t.dashboardWidgets[n].widgetLayout=e.widgetLayout):(t.dashboardWidgets[n]=new Kt(t.dashboard,e.widget,e.widgetLayout),t.dashboardWidgets[n].highlighted=i.highlighted,t.dashboardWidgets[n].selected=i.selected)}}})),this.updateRowsAndSort())},t.prototype.widgetLayoutsUpdated=function(){for(var t=function(t){var n=e.widgetLayouts[t],i=e.dashboardWidgets.findIndex((function(e){return e.widgetId===t}));i>-1&&(e.dashboardWidgets[i].widgetLayout=n)},e=this,n=0,i=Object.keys(this.widgetLayouts);n<i.length;n++){t(i[n])}this.updateRowsAndSort()},t.prototype.setWidgets=function(t,e){this.highlightedMode=!1,this.widgets=t,this.widgetLayouts=e},t.prototype.highlightWidget=function(t){var e=this.findWidgetById(t);return e&&(!this.highlightedMode||!e.highlighted||this.highlightedMode&&e.highlighted)?(this.highlightedMode=!0,e.highlighted=!0,this.dashboardWidgets.forEach((function(t){t!==e&&(t.highlighted=!1)})),e):null},t.prototype.selectWidget=function(t){var e=this.findWidgetById(t);return e&&!e.selected?(e.selected=!0,this.dashboardWidgets.forEach((function(t){t!==e&&(t.selected=!1)})),e):null},t.prototype.resetHighlight=function(){var t=this.dashboardWidgets.find((function(t){return t.highlighted}));return this.highlightedMode=!1,this.dashboardWidgets.forEach((function(t){t.highlighted=!1,t.selected=!1})),t},t.prototype.isHighlighted=function(t){return this.highlightedMode&&t.highlighted||t.selected},t.prototype.isNotHighlighted=function(t){return this.highlightedMode&&!t.highlighted},t.prototype.getSelectedWidget=function(){return this.dashboardWidgets.find((function(t){return t.selected}))},t.prototype.findWidgetById=function(t){return this.dashboardWidgets.find((function(e){return e.widgetId===t}))},t.prototype.updateRowsAndSort=function(){var t=this.dashboard.gridsterOpts.maxRows;this.dashboardWidgets.forEach((function(e){var n=e.y+e.rows;t=Math.max(t,n)})),this.sortWidgets(),this.dashboard.gridsterOpts.maxRows=t,this.dashboard.notifyGridsterOptionsChanged()},t.prototype.sortWidgets=function(){this.dashboardWidgets.sort((function(t,e){var n=t.widgetOrder-e.widgetOrder;return 0===n&&(n=t.x-e.x),n}))},t}(),Kt=function(){function t(t,e,n){this.dashboard=t,this.widget=e,this.widgetLayout=n,this.highlighted=!1,this.selected=!1,this.isFullscreen=!1,this.widgetContext=new Et.c(this.dashboard,this,this.widget),this.gridsterItemComponentSubject=new Gt.b,e.id||(e.id=Object(b.h)()),this.widgetId=e.id,this.updateWidgetParams()}return Object.defineProperty(t.prototype,"gridsterItemComponent",{set:function(t){this.gridsterItemComponentValue=t,this.gridsterItemComponentSubject.next(this.gridsterItemComponentValue),this.gridsterItemComponentSubject.complete()},enumerable:!0,configurable:!0}),t.prototype.gridsterItemComponent$=function(){return this.gridsterItemComponentValue?Object(X.a)(this.gridsterItemComponentValue):this.gridsterItemComponentSubject.asObservable()},t.prototype.updateWidgetParams=function(){this.color=this.widget.config.color||"rgba(0, 0, 0, 0.87)",this.backgroundColor=this.widget.config.backgroundColor||"#fff",this.padding=this.widget.config.padding||"8px",this.margin=this.widget.config.margin||"0px",this.title=Object(b.k)(this.widgetContext.widgetTitle)&&this.widgetContext.widgetTitle.length?this.widgetContext.widgetTitle:this.widget.config.title,this.titleTooltip=Object(b.k)(this.widgetContext.widgetTitleTooltip)&&this.widgetContext.widgetTitleTooltip.length?this.widgetContext.widgetTitleTooltip:this.widget.config.titleTooltip,this.showTitle=!Object(b.k)(this.widget.config.showTitle)||this.widget.config.showTitle,this.titleStyle=this.widget.config.titleStyle?this.widget.config.titleStyle:{},this.titleIcon=Object(b.k)(this.widget.config.titleIcon)?this.widget.config.titleIcon:"",this.showTitleIcon=!!Object(b.k)(this.widget.config.showTitleIcon)&&this.widget.config.showTitleIcon,this.titleIconStyle={},this.widget.config.iconColor&&(this.titleIconStyle.color=this.widget.config.iconColor),this.widget.config.iconSize&&(this.titleIconStyle.fontSize=this.widget.config.iconSize),this.dropShadow=!Object(b.k)(this.widget.config.dropShadow)||this.widget.config.dropShadow,this.enableFullscreen=!Object(b.k)(this.widget.config.enableFullscreen)||this.widget.config.enableFullscreen,this.hasTimewindow=(this.widget.type===Ot.k.timeseries||this.widget.type===Ot.k.alarm)&&(!!Object(b.k)(this.widget.config.useDashboardTimewindow)&&(!this.widget.config.useDashboardTimewindow&&(Object(b.u)(this.widget.config.displayTimewindow)||this.widget.config.displayTimewindow))),this.hasAggregation=this.widget.type===Ot.k.timeseries,this.style={cursor:"pointer",color:this.color,backgroundColor:this.backgroundColor,padding:this.padding,margin:this.margin},this.widget.config.widgetStyle&&(this.style=Object(i.a)(Object(i.a)({},this.style),this.widget.config.widgetStyle)),this.showWidgetTitlePanel=!this.widgetContext.hideTitlePanel&&(this.showTitle||this.hasTimewindow),this.showWidgetActions=!this.widgetContext.hideTitlePanel,this.customHeaderActions=this.widgetContext.customHeaderActions?this.widgetContext.customHeaderActions:[],this.widgetActions=this.widgetContext.widgetActions?this.widgetContext.widgetActions:[]},Object.defineProperty(t.prototype,"x",{get:function(){var t;return t=this.widgetLayout?this.widgetLayout.col:this.widget.col,Math.floor(t)},set:function(t){this.dashboard.isMobileSize||(this.widgetLayout?this.widgetLayout.col=t:this.widget.col=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){var t;return t=this.widgetLayout?this.widgetLayout.row:this.widget.row,Math.floor(t)},set:function(t){this.dashboard.isMobileSize||(this.widgetLayout?this.widgetLayout.row=t:this.widget.row=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cols",{get:function(){var t;return t=this.widgetLayout?this.widgetLayout.sizeX:this.widget.sizeX,Math.floor(t)},set:function(t){this.dashboard.isMobileSize||(this.widgetLayout?this.widgetLayout.sizeX=t:this.widget.sizeX=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rows",{get:function(){var t;if(this.dashboard.isMobileSize&&!this.dashboard.mobileAutofillHeight){var e=void 0;if(this.widgetLayout&&(e=this.widgetLayout.mobileHeight),!e&&this.widget.config.mobileHeight&&(e=this.widget.config.mobileHeight),e)t=e;else t=24*(this.widgetLayout?this.widgetLayout.sizeY:this.widget.sizeY)/this.dashboard.gridsterOpts.minCols}else t=this.widgetLayout?this.widgetLayout.sizeY:this.widget.sizeY;return Math.floor(t)},set:function(t){this.dashboard.isMobileSize||this.dashboard.autofillHeight||(this.widgetLayout?this.widgetLayout.sizeY=t:this.widget.sizeY=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"widgetOrder",{get:function(){return this.widgetLayout&&Object(b.k)(this.widgetLayout.mobileOrder)&&this.widgetLayout.mobileOrder>=0?this.widgetLayout.mobileOrder:Object(b.k)(this.widget.config.mobileOrder)&&this.widget.config.mobileOrder>=0?this.widget.config.mobileOrder:this.widgetLayout?this.widgetLayout.row:this.widget.row},enumerable:!0,configurable:!0}),t}(),Yt=n("nNBm"),Zt=n("OJ6B"),qt=n("ou9H"),$t=n("HR/i"),Xt=function(t){function e(e,n,i,a,o,r,s){var l=t.call(this,e)||this;return l.store=e,l.timeService=n,l.dialogService=i,l.breakpointObserver=a,l.differs=o,l.kvDiffers=r,l.ngZone=s,l.ignoreLoading=!0,l.dashboardTimewindowChangedSubject=new q.a,l.dashboardTimewindowChanged=l.dashboardTimewindowChangedSubject.asObservable().pipe(Object(qt.a)()),l.isWidgetExpanded=!1,l.isMobileSize=!1,l.dashboardMenuPosition={x:"0px",y:"0px"},l.widgetMenuPosition={x:"0px",y:"0px"},l.dashboardWidgets=new Ht(l,l.differs.find([]).create((function(t,e){return e})),l.kvDiffers.find([]).create()),l.optionsChangeNotificationsPaused=!1,l.authUser=Object(Wt.b)(e),l}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){var t=this;this.dashboardTimewindow||(this.dashboardTimewindow=this.timeService.defaultTimewindow()),this.gridsterOpts={gridType:"scrollVertical",keepFixedHeightInMobile:!0,disableWarnings:!1,disableAutoPositionOnConflict:!1,pushItems:!1,swap:!1,maxRows:100,minCols:this.columns?this.columns:24,maxCols:3e3,maxItemCols:1e3,maxItemRows:1e3,maxItemArea:1e6,outerMargin:!0,margin:Object(b.k)(this.margin)?this.margin:10,minItemCols:1,minItemRows:1,defaultItemCols:8,defaultItemRows:6,resizable:{enabled:this.isEdit},draggable:{enabled:this.isEdit},itemChangeCallback:function(e){return t.dashboardWidgets.sortWidgets()},itemInitCallback:function(t,e){e.item.gridsterItemComponent=e}},this.updateMobileOpts(),this.breakpointObserverSubscription=this.breakpointObserver.observe(L.d["gt-sm"]).subscribe((function(){t.updateMobileOpts(),t.notifyGridsterOptionsChanged()})),this.updateWidgets()},e.prototype.ngOnDestroy=function(){t.prototype.ngOnDestroy.call(this),this.gridsterResize$&&this.gridsterResize$.disconnect(),this.breakpointObserverSubscription&&this.breakpointObserverSubscription.unsubscribe(),this.gridster=null},e.prototype.ngDoCheck=function(){this.optionsChangeNotificationsPaused||this.dashboardWidgets.doCheck()},e.prototype.ngOnChanges=function(t){for(var e=!1,n=!1,i=!1,a=!1,o=0,r=Object.keys(t);o<r.length;o++){var s=r[o],l=t[s];l.firstChange||l.currentValue===l.previousValue||(["isMobile","isMobileDisabled","autofillHeight","mobileAutofillHeight","mobileRowHeight"].includes(s)?e=!0:["margin","columns"].includes(s)?n=!0:"isEdit"===s?i=!0:["widgets","widgetLayouts"].includes(s)?a=!0:"dashboardTimewindow"===s&&this.dashboardTimewindowChangedSubject.next(this.dashboardTimewindow))}a&&this.updateWidgets(),e&&this.updateMobileOpts(),n&&this.updateLayoutOpts(),i&&this.updateEditingOpts(),(e||n||i)&&this.notifyGridsterOptionsChanged()},e.prototype.updateWidgets=function(){this.dashboardWidgets.setWidgets(this.widgets,this.widgetLayouts),this.dashboardWidgets.doCheck()},e.prototype.updateWidgetLayouts=function(){this.dashboardWidgets.widgetLayoutsUpdated()},e.prototype.ngAfterViewInit=function(){var t=this;this.gridsterResize$=new $t.a((function(){t.onGridsterParentResize()})),this.gridsterResize$.observe(this.gridster.el)},e.prototype.onUpdateTimewindow=function(t,e,n,i){var a=this;this.ngZone.run((function(){a.originalDashboardTimewindow||i||(a.originalDashboardTimewindow=Object(b.d)(a.dashboardTimewindow)),a.dashboardTimewindow=Object(zt.r)(a.dashboardTimewindow,t,e,n,a.timeService),a.dashboardTimewindowChangedSubject.next(a.dashboardTimewindow)}))},e.prototype.onResetTimewindow=function(){var t=this;this.ngZone.run((function(){t.originalDashboardTimewindow&&(t.dashboardTimewindow=Object(b.d)(t.originalDashboardTimewindow),t.originalDashboardTimewindow=null,t.dashboardTimewindowChangedSubject.next(t.dashboardTimewindow))}))},e.prototype.isAutofillHeight=function(){return this.isMobileSize?!!Object(b.k)(this.mobileAutofillHeight)&&this.mobileAutofillHeight:!!Object(b.k)(this.autofillHeight)&&this.autofillHeight},e.prototype.openDashboardContextMenu=function(t){if(this.callbacks&&this.callbacks.prepareDashboardContextMenu){var e=this.callbacks.prepareDashboardContextMenu(t);e&&e.length&&(t.preventDefault(),t.stopPropagation(),this.dashboardContextMenuEvent=t,this.dashboardMenuPosition.x=t.clientX+"px",this.dashboardMenuPosition.y=t.clientY+"px",this.dashboardMenuTrigger.menuData={items:e},this.dashboardMenuTrigger.openMenu())}},e.prototype.openWidgetContextMenu=function(t,e){if(this.callbacks&&this.callbacks.prepareWidgetContextMenu){var n=this.callbacks.prepareWidgetContextMenu(t,e.widget);n&&n.length&&(t.preventDefault(),t.stopPropagation(),this.widgetContextMenuEvent=t,this.widgetMenuPosition.x=t.clientX+"px",this.widgetMenuPosition.y=t.clientY+"px",this.widgetMenuTrigger.menuData={items:n,widget:e.widget},this.widgetMenuTrigger.openMenu())}},e.prototype.onWidgetFullscreenChanged=function(t,e){this.isWidgetExpanded=t},e.prototype.widgetMouseDown=function(t,e){this.callbacks&&this.callbacks.onWidgetMouseDown&&this.callbacks.onWidgetMouseDown(t,e.widget)},e.prototype.widgetClicked=function(t,e){this.callbacks&&this.callbacks.onWidgetClicked&&this.callbacks.onWidgetClicked(t,e.widget)},e.prototype.editWidget=function(t,e){t&&t.stopPropagation(),this.isEditActionEnabled&&this.callbacks&&this.callbacks.onEditWidget&&this.callbacks.onEditWidget(t,e.widget)},e.prototype.exportWidget=function(t,e){t&&t.stopPropagation(),this.isExportActionEnabled&&this.callbacks&&this.callbacks.onExportWidget&&this.callbacks.onExportWidget(t,e.widget)},e.prototype.removeWidget=function(t,e){t&&t.stopPropagation(),this.isRemoveActionEnabled&&this.callbacks&&this.callbacks.onRemoveWidget&&this.callbacks.onRemoveWidget(t,e.widget)},e.prototype.highlightWidget=function(t,e){var n=this.dashboardWidgets.highlightWidget(t);n&&this.scrollToWidget(n,e)},e.prototype.selectWidget=function(t,e){var n=this.dashboardWidgets.selectWidget(t);n&&this.scrollToWidget(n,e)},e.prototype.getSelectedWidget=function(){var t=this.dashboardWidgets.getSelectedWidget();return t?t.widget:null},e.prototype.getEventGridPosition=function(t){var e={row:0,column:0},n=$(this.gridster.el),i=0,a=0;t instanceof MouseEvent&&(i=t.pageX,a=t.pageY);var o=n.offset(),r=i-o.left+n.scrollLeft(),s=a-o.top+n.scrollTop();return e.row=this.gridster.pixelsToPositionY(s,Math.floor),e.column=this.gridster.pixelsToPositionX(r,Math.floor),e},e.prototype.resetHighlight=function(){var t=this,e=this.dashboardWidgets.resetHighlight();e&&setTimeout((function(){t.scrollToWidget(e,0)}),0)},e.prototype.isHighlighted=function(t){return this.dashboardWidgets.isHighlighted(t)},e.prototype.isNotHighlighted=function(t){return this.dashboardWidgets.isNotHighlighted(t)},e.prototype.scrollToWidget=function(t,e){var n=this,i=this.gridster.el;t.gridsterItemComponent$().subscribe((function(t){var a,o=t.el,r=(i.clientHeight-o.clientHeight)/2;a=n.isMobileSize?o.offsetTop:a=t.top,r>0&&(a-=r),Object(b.a)(i,a,e)}))},e.prototype.updateMobileOpts=function(t){this.isMobileSize=this.checkIsMobileSize();var e=this.isAutofillHeight();this.gridsterOpts.gridType=e?this.isMobileSize?"fixed":"fit":this.isMobileSize?"fixed":"scrollVertical";var n=this.isMobileSize?2e4:0;this.gridsterOpts.mobileBreakpoint=n;var i=this.detectRowSize(this.isMobileSize,e,t);this.gridsterOpts.fixedRowHeight!==i&&(this.gridsterOpts.fixedRowHeight=i)},e.prototype.onGridsterParentResize=function(){var t=this.gridster.el.offsetHeight;this.isMobileSize&&this.mobileAutofillHeight&&t&&this.updateMobileOpts(t),this.notifyGridsterOptionsChanged()},e.prototype.updateLayoutOpts=function(){this.gridsterOpts.minCols=this.columns?this.columns:24,this.gridsterOpts.margin=Object(b.k)(this.margin)?this.margin:10},e.prototype.updateEditingOpts=function(){this.gridsterOpts.resizable.enabled=this.isEdit,this.gridsterOpts.draggable.enabled=this.isEdit},e.prototype.notifyGridsterOptionsChanged=function(){this.optionsChangeNotificationsPaused||this.gridster&&this.gridster.options&&this.gridster.optionsChanged()},e.prototype.pauseChangeNotifications=function(){this.optionsChangeNotificationsPaused=!0},e.prototype.resumeChangeNotifications=function(){this.optionsChangeNotificationsPaused=!1},e.prototype.notifyLayoutUpdated=function(){this.updateWidgetLayouts()},e.prototype.detectRowSize=function(t,e,n){var i=null;if(e){if(e&&t&&(n||(n=this.gridster.el.offsetHeight),n)){for(var a=0,o=0,r=this.dashboardWidgets.dashboardWidgets;o<r.length;o++){a+=r[o].rows}i=(n-this.gridsterOpts.margin*(this.dashboardWidgets.dashboardWidgets.length+2))/a}}else t&&(i=Object(b.k)(this.mobileRowHeight)?this.mobileRowHeight:70);return i},e.prototype.checkIsMobileSize=function(){var t=!0===this.isMobileDisabled,e=!0===this.isMobile&&!t;return e||t||(e=!this.breakpointObserver.isMatched(L.d["gt-sm"])),e},e.ctorParameters=function(){return[{type:d.Store},{type:Bt.a},{type:F.a},{type:Yt.a},{type:a.IterableDiffers},{type:a.KeyValueDiffers},{type:a.NgZone}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"widgets",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"widgetLayouts",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"callbacks",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"aliasController",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"stateController",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Number)],e.prototype,"columns",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Number)],e.prototype,"margin",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"isEdit",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"autofillHeight",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"mobileAutofillHeight",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Number)],e.prototype,"mobileRowHeight",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"isMobile",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"isMobileDisabled",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"isEditActionEnabled",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"isExportActionEnabled",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"isRemoveActionEnabled",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"dashboardStyle",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"backgroundImage",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",String)],e.prototype,"dashboardClass",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"ignoreLoading",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"dashboardTimewindow",void 0),Object(i.c)([Object(a.ViewChild)("gridster",{static:!0}),Object(i.g)("design:type",Ut.a)],e.prototype,"gridster",void 0),Object(i.c)([Object(a.ViewChild)("dashboardMenuTrigger",{static:!0}),Object(i.g)("design:type",Zt.b)],e.prototype,"dashboardMenuTrigger",void 0),Object(i.c)([Object(a.ViewChild)("widgetMenuTrigger",{static:!0}),Object(i.g)("design:type",Zt.b)],e.prototype,"widgetMenuTrigger",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-dashboard",template:Object(i.f)(n("Vg08")).default,styles:[Object(i.f)(n("nFN6")).default]}),Object(i.g)("design:paramtypes",[d.Store,Bt.a,F.a,Yt.a,a.IterableDiffers,a.KeyValueDiffers,a.NgZone])],e)}(c.a),Qt=n("XlPw"),Jt=n("OMGm"),te=n("Neop"),ee=n("OCOE"),ne=n("15JJ"),ie=n("xKAQ"),ae=n("DaoB"),oe=n("BOYq"),re=n("nhHW"),se=n("ncsw"),le=n("c6cM"),ce=n("1y+p"),de=n("g8Nv"),ue=n("cUzu"),he=n("j37L"),pe=n("ktVl"),me=n("9D3k"),ge=new Map([["deviceService",ae.a],["assetService",ce.a],["entityViewService",he.a],["customerService",pe.a],["dashboardService",Dt.a],["userService",me.a],["attributeService",bt.a],["entityRelationService",V.a],["entityService",jt.a],["dialogs",F.a],["customDialog",de.a],["date",o.DatePipe],["utils",Lt.a],["translate",T.TranslateService],["http",ue.b]]),fe=function(t){function e(e,n,i,a,o,r,s,l,c,d,u,h,p,m,g,f,b,y,v){var w=t.call(this,e)||this;return w.store=e,w.route=n,w.router=i,w.widgetComponentService=a,w.componentFactoryResolver=o,w.elementRef=r,w.injector=s,w.widgetService=l,w.resources=c,w.timeService=d,w.deviceService=u,w.entityService=h,w.alarmService=p,w.dashboardService=m,w.datasourceService=g,w.utils=f,w.raf=b,w.ngZone=y,w.cd=v,w.subscriptionInited=!1,w.destroyed=!1,w.widgetSizeDetected=!1,w.cafs={},w.cssParser=new te.a,w.rxSubscriptions=new Array,w.cssParser.testMode=!1,w}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){var t=this;if(this.loadingData=!0,this.widget=this.dashboardWidget.widget,this.displayLegend=Object(b.k)(this.widget.config.showLegend)?this.widget.config.showLegend:this.widget.type===Ot.k.timeseries,this.legendContainerLayoutType="column",this.displayLegend)switch(this.legendConfig=this.widget.config.legendConfig||Object(Ot.f)(this.widget.type),this.legendData={keys:[],data:[]},this.legendConfig.position===Ot.c.top||this.legendConfig.position===Ot.c.bottom?(this.legendContainerLayoutType="column",this.isLegendFirst=this.legendConfig.position===Ot.c.top):(this.legendContainerLayoutType="row",this.isLegendFirst=this.legendConfig.position===Ot.c.left),this.legendConfig.position){case Ot.c.top:this.legendStyle={paddingBottom:"8px",maxHeight:"50%",overflowY:"auto"};break;case Ot.c.bottom:this.legendStyle={paddingTop:"8px",maxHeight:"50%",overflowY:"auto"};break;case Ot.c.left:this.legendStyle={paddingRight:"0px",maxWidth:"50%",overflowY:"auto"};break;case Ot.c.right:this.legendStyle={paddingLeft:"0px",maxWidth:"50%",overflowY:"auto"}}var e={};if(this.widget.config.actions)for(var n=function(n){var a=i.widget.config.actions[n],o=[];a.forEach((function(e){var n=Object(b.d)(e);n.displayName=t.utils.customTranslation(e.name,e.name),o.push(n)})),e[n]=o},i=this,a=0,o=Object.keys(this.widget.config.actions);a<o.length;a++){n(o[a])}this.widgetContext=this.dashboardWidget.widgetContext,this.widgetContext.changeDetector=this.cd,this.widgetContext.ngZone=this.ngZone,this.widgetContext.store=this.store,this.widgetContext.servicesMap=ge,this.widgetContext.isEdit=this.isEdit,this.widgetContext.isMobile=this.isMobile,this.widgetContext.subscriptionApi={createSubscription:this.createSubscription.bind(this),createSubscriptionFromInfo:this.createSubscriptionFromInfo.bind(this),removeSubscription:function(e){var n=t.widgetContext.subscriptions[e];n&&(n.destroy(),delete t.widgetContext.subscriptions[e])}},this.widgetContext.actionsApi={actionDescriptorsBySourceId:e,getActionDescriptors:this.getActionDescriptors.bind(this),handleWidgetAction:this.handleWidgetAction.bind(this),elementClick:this.elementClick.bind(this),getActiveEntityInfo:this.getActiveEntityInfo.bind(this)},this.widgetContext.customHeaderActions=[],this.getActionDescriptors(Ot.i.headerButton.value).forEach((function(e){var n={name:e.name,displayName:e.displayName,icon:e.icon,descriptor:e,onAction:function(n){var i=t.getActiveEntityInfo(),a=i?i.entityId:null,o=i?i.entityName:null,r=i?i.entityLabel:null;t.handleWidgetAction(n,e,a,o,null,r)}};t.widgetContext.customHeaderActions.push(n)})),this.subscriptionContext=new Jt.a(this.widgetContext.dashboard),this.subscriptionContext.timeService=this.timeService,this.subscriptionContext.deviceService=this.deviceService,this.subscriptionContext.alarmService=this.alarmService,this.subscriptionContext.datasourceService=this.datasourceService,this.subscriptionContext.utils=this.utils,this.subscriptionContext.raf=this.raf,this.subscriptionContext.widgetUtils=this.widgetContext.utils,this.subscriptionContext.getServerTimeDiff=this.dashboardService.getServerTimeDiff.bind(this.dashboardService),this.widgetComponentService.getWidgetInfo(this.widget.bundleAlias,this.widget.typeAlias,this.widget.isSystemType).subscribe((function(e){t.widgetInfo=e,t.loadFromWidgetInfo()}),(function(e){t.widgetInfo=e.widgetInfo,t.errorMessages=e.errorMessages,t.loadFromWidgetInfo()})),setTimeout((function(){t.dashboardWidget.updateWidgetParams()}),0)},e.prototype.ngAfterViewInit=function(){},e.prototype.ngOnChanges=function(t){for(var e=0,n=Object.keys(t);e<n.length;e++){var i=n[e],a=t[i];a.firstChange||a.currentValue===a.previousValue||("isEdit"===i?this.onEditModeChanged():"isMobile"===i&&this.onMobileModeChanged())}},e.prototype.ngOnDestroy=function(){this.destroyed=!0,this.rxSubscriptions.forEach((function(t){t.unsubscribe()})),this.rxSubscriptions.length=0,this.onDestroy()},e.prototype.displayWidgetInstance=function(){if(this.widget.type!==Ot.k.static){for(var t=0,e=Object.keys(this.widgetContext.subscriptions);t<e.length;t++){var n=e[t];if(this.widgetContext.subscriptions[n].isDataResolved())return!0}return!1}return!0},e.prototype.onDestroy=function(){if(this.widgetContext){for(var t=this.displayWidgetInstance(),e=0,n=Object.keys(this.widgetContext.subscriptions);e<n.length;e++){var i=n[e];this.widgetContext.subscriptions[i].destroy()}if(this.subscriptionInited=!1,this.widgetContext.subscriptions={},this.widgetContext.inited){this.widgetContext.inited=!1;for(var a=0,o=Object.keys(this.cafs);a<o.length;a++){var r=o[a];this.cafs[r]&&(this.cafs[r](),this.cafs[r]=null)}try{t&&this.widgetTypeInstance.onDestroy()}catch(s){this.handleWidgetException(s)}}this.widgetContext.destroyed=!0,this.destroyDynamicWidgetComponent()}},e.prototype.onTimewindowChanged=function(t){for(var e=0,n=Object.keys(this.widgetContext.subscriptions);e<n.length;e++){var i=n[e],a=this.widgetContext.subscriptions[i];a.useDashboardTimewindow||a.updateTimewindowConfig(t)}},e.prototype.onLegendKeyHiddenChange=function(t){for(var e=0,n=Object.keys(this.widgetContext.subscriptions);e<n.length;e++){var i=n[e];this.widgetContext.subscriptions[i].updateDataVisibility(t)}},e.prototype.loadFromWidgetInfo=function(){var t=this;this.widgetContext.widgetNamespace="widget-type-"+(this.widget.isSystemType?"sys-":"")+this.widget.bundleAlias+"-"+this.widget.typeAlias;var e=this.elementRef.nativeElement;if(e.classList.add("tb-widget"),e.classList.add(this.widgetContext.widgetNamespace),this.widgetType=this.widgetInfo.widgetTypeFunction,this.typeParameters=this.widgetInfo.typeParameters,this.widgetType)try{this.widgetTypeInstance=new this.widgetType(this.widgetContext)}catch(n){this.handleWidgetException(n),this.widgetTypeInstance={}}else this.widgetTypeInstance={};this.widgetTypeInstance.onInit||(this.widgetTypeInstance.onInit=function(){}),this.widgetTypeInstance.onDataUpdated||(this.widgetTypeInstance.onDataUpdated=function(){}),this.widgetTypeInstance.onResize||(this.widgetTypeInstance.onResize=function(){}),this.widgetTypeInstance.onEditModeChanged||(this.widgetTypeInstance.onEditModeChanged=function(){}),this.widgetTypeInstance.onMobileModeChanged||(this.widgetTypeInstance.onMobileModeChanged=function(){}),this.widgetTypeInstance.onDestroy||(this.widgetTypeInstance.onDestroy=function(){}),this.initialize().subscribe((function(){t.onInit()}),(function(t){}))},e.prototype.detectChanges=function(){if(!this.destroyed)try{this.cd.detectChanges()}catch(t){}},e.prototype.isReady=function(){return this.subscriptionInited&&this.widgetSizeDetected},e.prototype.onInit=function(t){var e=this;this.widgetContext.$containerParent&&!this.destroyed&&(t||this.checkSize(),!this.widgetContext.inited&&this.isReady()&&(this.widgetContext.inited=!0,this.cafs.init&&(this.cafs.init(),this.cafs.init=null),this.cafs.init=this.raf.raf((function(){try{e.displayWidgetInstance()?e.widgetTypeInstance.onInit():e.loadingData=!1,e.detectChanges()}catch(t){e.handleWidgetException(t)}})),!this.typeParameters.useCustomDatasources&&this.widgetContext.defaultSubscription&&this.widgetContext.defaultSubscription.subscribe()))},e.prototype.onResize=function(){var t=this;this.checkSize()&&(this.widgetContext.inited?(this.cafs.resize&&(this.cafs.resize(),this.cafs.resize=null),this.cafs.resize=this.raf.raf((function(){try{t.displayWidgetInstance()&&t.widgetTypeInstance.onResize()}catch(e){t.handleWidgetException(e)}}))):this.onInit(!0))},e.prototype.onEditModeChanged=function(){var t=this;this.widgetContext.isEdit!==this.isEdit&&(this.widgetContext.isEdit=this.isEdit,this.widgetContext.inited&&(this.cafs.editMode&&(this.cafs.editMode(),this.cafs.editMode=null),this.cafs.editMode=this.raf.raf((function(){try{t.displayWidgetInstance()&&t.widgetTypeInstance.onEditModeChanged()}catch(e){t.handleWidgetException(e)}}))))},e.prototype.onMobileModeChanged=function(){var t=this;this.widgetContext.isMobile!==this.isMobile&&(this.widgetContext.isMobile=this.isMobile,this.widgetContext.inited&&(this.cafs.mobileMode&&(this.cafs.mobileMode(),this.cafs.mobileMode=null),this.cafs.mobileMode=this.raf.raf((function(){try{t.displayWidgetInstance()&&t.widgetTypeInstance.onMobileModeChanged()}catch(e){t.handleWidgetException(e)}}))))},e.prototype.reInit=function(){var t=this;this.cafs.reinit&&(this.cafs.reinit(),this.cafs.reinit=null),this.cafs.reinit=this.raf.raf((function(){t.ngZone.run((function(){t.reInitImpl()}))}))},e.prototype.reInitImpl=function(){var t=this;this.onDestroy(),this.typeParameters.useCustomDatasources?(this.widgetContext.reset(),this.subscriptionInited=!0,this.configureDynamicWidgetComponent(),this.onInit()):this.createDefaultSubscription().subscribe((function(){t.destroyed?t.onDestroy():(t.widgetContext.reset(),t.subscriptionInited=!0,t.configureDynamicWidgetComponent(),t.onInit())}),(function(){t.destroyed?t.onDestroy():(t.widgetContext.reset(),t.subscriptionInited=!0,t.onInit())}))},e.prototype.initialize=function(){var t=this,e=new q.a;return this.rxSubscriptions.push(this.widgetContext.aliasController.entityAliasesChanged.subscribe((function(e){for(var n=!1,i=0,a=Object.keys(t.widgetContext.subscriptions);i<a.length;i++){var o=a[i],r=t.widgetContext.subscriptions[o];n=n||r.onAliasesChanged(e)}n&&!t.typeParameters.useCustomDatasources&&t.reInit()}))),this.rxSubscriptions.push(this.widgetContext.dashboard.dashboardTimewindowChanged.subscribe((function(e){for(var n=0,i=Object.keys(t.widgetContext.subscriptions);n<i.length;n++){var a=i[n];t.widgetContext.subscriptions[a].onDashboardTimewindowChanged(e)}}))),this.typeParameters.useCustomDatasources?(this.loadingData=!1,this.subscriptionInited=!0,this.configureDynamicWidgetComponent(),e.next(),e.complete()):this.createDefaultSubscription().subscribe((function(){t.subscriptionInited=!0,t.configureDynamicWidgetComponent(),e.next(),e.complete()}),(function(n){t.subscriptionInited=!0,e.error(n)})),e.asObservable()},e.prototype.destroyDynamicWidgetComponent=function(){this.widgetContext.$containerParent&&this.widgetResize$&&this.widgetResize$.disconnect(),this.dynamicWidgetComponentRef&&(this.dynamicWidgetComponentRef.destroy(),this.dynamicWidgetComponentRef=null)},e.prototype.handleWidgetException=function(t){console.error(t),this.widgetErrorData=this.utils.processWidgetException(t),this.detectChanges()},e.prototype.configureDynamicWidgetComponent=function(){var t=this;this.widgetContentContainer.clear();var e=a.Injector.create({providers:[{provide:"widgetContext",useValue:this.widgetContext},{provide:"errorMessages",useValue:this.errorMessages}],parent:this.injector}),n=$(this.elementRef.nativeElement.querySelector("#widget-container"));this.widgetContext.$containerParent=$(n);try{this.dynamicWidgetComponentRef=this.widgetContentContainer.createComponent(this.widgetInfo.componentFactory,0,e),this.cd.detectChanges()}catch(i){console.error(i),this.dynamicWidgetComponentRef&&(this.dynamicWidgetComponentRef.destroy(),this.dynamicWidgetComponentRef=null),this.widgetContentContainer.clear()}this.dynamicWidgetComponentRef&&(this.dynamicWidgetComponent=this.dynamicWidgetComponentRef.instance,this.widgetContext.$container=$(this.dynamicWidgetComponentRef.location.nativeElement),this.widgetContext.$container.css("display","block"),this.widgetContext.$container.css("user-select","none"),this.widgetContext.$container.attr("id","container"),this.widgetSizeDetected&&(this.widgetContext.$container.css("height",this.widgetContext.height+"px"),this.widgetContext.$container.css("width",this.widgetContext.width+"px"))),this.widgetResize$=new $t.a((function(){t.onResize()})),this.widgetResize$.observe(this.widgetContext.$containerParent[0])},e.prototype.createSubscription=function(t,e){var n=this,i=new q.a;t.dashboardTimewindow=this.widgetContext.dashboardTimewindow;var a=new le.a(this.subscriptionContext,t);return a.init$.subscribe((function(){n.widgetContext.subscriptions[a.id]=a,e&&a.subscribe(),i.next(a),i.complete()}),(function(t){i.error(t)})),i.asObservable()},e.prototype.createSubscriptionFromInfo=function(t,e,n,i,a){var o=this,r=new q.a;return n.type=t,i?this.defaultComponentsOptions(n):n.timeWindowConfig||(n.useDashboardTimewindow=!0),(n.type===Ot.k.alarm?this.entityService.createAlarmSourceFromSubscriptionInfo(e[0]):this.entityService.createDatasourcesFromSubscriptionsInfo(e)).subscribe((function(t){n.type===Ot.k.alarm?n.alarmSource=t:n.datasources=t,o.createSubscription(n,a).subscribe((function(t){i&&o.defaultSubscriptionOptions(t,n),r.next(t),r.complete()}),(function(t){r.error(t)}))}),(function(t){r.error(t)})),r.asObservable()},e.prototype.defaultComponentsOptions=function(t){var e=this;t.useDashboardTimewindow=!Object(b.k)(this.widget.config.useDashboardTimewindow)||this.widget.config.useDashboardTimewindow,t.displayTimewindow=Object(b.k)(this.widget.config.displayTimewindow)?this.widget.config.displayTimewindow:!t.useDashboardTimewindow,t.timeWindowConfig=t.useDashboardTimewindow?this.widgetContext.dashboardTimewindow:this.widget.config.timewindow,t.legendConfig=null,this.displayLegend&&(t.legendConfig=this.legendConfig),t.decimals=this.widgetContext.decimals,t.units=this.widgetContext.units,t.callbacks={onDataUpdated:function(){try{e.displayWidgetInstance()&&e.widgetTypeInstance.onDataUpdated()}catch(t){}},onDataUpdateError:function(t,n){e.handleWidgetException(n)},dataLoading:function(t){e.loadingData!==t.loadingData&&(e.loadingData=t.loadingData,e.detectChanges())},legendDataUpdated:function(t,n){n&&e.detectChanges()},timeWindowUpdated:function(t,n){e.ngZone.run((function(){e.widget.config.timewindow=n,e.detectChanges()}))}}},e.prototype.defaultSubscriptionOptions=function(t,e){this.displayLegend&&(this.legendData=t.legendData)},e.prototype.createDefaultSubscription=function(){var t,e=this,n=new q.a;if(this.widget.type!==Ot.k.rpc&&this.widget.type!==Ot.k.static){var i=this.widgetContext.settings;t={type:this.widget.type,stateData:this.typeParameters.stateData,comparisonEnabled:i.comparisonEnabled,timeForComparison:i.timeForComparison},this.widget.type===Ot.k.alarm?(t.alarmSource=Object(b.d)(this.widget.config.alarmSource),t.alarmSearchStatus=Object(b.k)(this.widget.config.alarmSearchStatus)?this.widget.config.alarmSearchStatus:ct.b.ANY,t.alarmsPollingInterval=Object(b.k)(this.widget.config.alarmsPollingInterval)?1e3*this.widget.config.alarmsPollingInterval:5e3,t.alarmsMaxCountLoad=Object(b.k)(this.widget.config.alarmsMaxCountLoad)?this.widget.config.alarmsMaxCountLoad:0,t.alarmsFetchSize=Object(b.k)(this.widget.config.alarmsFetchSize)?this.widget.config.alarmsFetchSize:100):t.datasources=Object(b.d)(this.widget.config.datasources),this.defaultComponentsOptions(t),this.createSubscription(t).subscribe((function(i){e.defaultSubscriptionOptions(i,t),e.widgetContext.datasources=i.datasources,e.widgetContext.data=i.data,e.widgetContext.hiddenData=i.hiddenData,e.widgetContext.timeWindow=i.timeWindow,e.widgetContext.defaultSubscription=i,n.next(),n.complete()}),(function(t){n.error(t)}))}else this.widget.type===Ot.k.rpc?(this.loadingData=!1,(t={type:this.widget.type,targetDeviceAliasIds:this.widget.config.targetDeviceAliasIds}).callbacks={rpcStateChanged:function(t){e.dynamicWidgetComponent&&(e.dynamicWidgetComponent.rpcEnabled=t.rpcEnabled,e.dynamicWidgetComponent.executingRpcRequest=t.executingRpcRequest,e.detectChanges())},onRpcSuccess:function(t){e.dynamicWidgetComponent&&(e.dynamicWidgetComponent.executingRpcRequest=t.executingRpcRequest,e.dynamicWidgetComponent.rpcErrorText=t.rpcErrorText,e.dynamicWidgetComponent.rpcRejection=t.rpcRejection,e.detectChanges())},onRpcFailed:function(t){e.dynamicWidgetComponent&&(e.dynamicWidgetComponent.executingRpcRequest=t.executingRpcRequest,e.dynamicWidgetComponent.rpcErrorText=t.rpcErrorText,e.dynamicWidgetComponent.rpcRejection=t.rpcRejection,e.detectChanges())},onRpcErrorCleared:function(t){e.dynamicWidgetComponent&&(e.dynamicWidgetComponent.rpcErrorText=null,e.dynamicWidgetComponent.rpcRejection=null,e.detectChanges())}},this.createSubscription(t).subscribe((function(t){e.widgetContext.defaultSubscription=t,n.next(),n.complete()}),(function(t){n.error(t)})),this.detectChanges()):this.widget.type===Ot.k.static?(this.loadingData=!1,n.next(),n.complete(),this.detectChanges()):(n.next(),n.complete(),this.detectChanges());return n.asObservable()},e.prototype.getActionDescriptors=function(t){var e=this.widgetContext.actionsApi.actionDescriptorsBySourceId[t];return e||(e=[]),e},e.prototype.handleWidgetAction=function(t,e,n,i,a,o){var r,s=this,l=e.type,c=e.stateEntityParamName;switch(e.setEntityId&&(r=n),l){case Ot.d.openDashboardState:case Ot.d.updateDashboardState:var d=e.targetDashboardStateId,u=Object(b.d)(this.widgetContext.stateController.getStateParams());this.updateEntityParams(u,c,r,i,o),l===Ot.d.openDashboardState?this.widgetContext.stateController.openState(d,u,e.openRightLayout):this.widgetContext.stateController.updateState(d,u,e.openRightLayout);break;case Ot.d.openDashboard:var h=e.targetDashboardId;d=e.targetDashboardStateId;var p={params:{}};this.updateEntityParams(p.params,c,r,i,o),d&&(p.id=d);var m=Object(b.w)([p]),g=void 0;g=this.route.snapshot.data.singlePageMode?"/dashboard/"+h+"?state="+m:"/dashboards/"+h+"?state="+m,this.router.navigateByUrl(g);break;case Ot.d.custom:var f=e.customFunction;if(f&&f.length>0)try{a||(a={}),new Function("$event","widgetContext","entityId","entityName","additionalParams","entityLabel",f)(t,this.widgetContext,n,i,a,o)}catch(T){console.error(T)}break;case Ot.d.customPretty:var y=e.customFunction,v=e.customHtml,w=e.customCss,x=e.customResources,S="custom-action-pretty-"+e.name.toLowerCase(),C="";Object(b.k)(v)&&v.length>0&&(C=v),this.loadCustomActionResources(S,w,x).subscribe((function(){if(Object(b.k)(y)&&y.length>0)try{a||(a={}),new Function("$event","widgetContext","entityId","entityName","htmlTemplate","additionalParams","entityLabel",y)(t,s.widgetContext,n,i,C,a,o)}catch(T){console.error(T)}}),(function(t){s.processResourcesLoadErrors(t)}))}},e.prototype.elementClick=function(t){var e=this,n=t.target||t.srcElement;if(n.id){var i=this.getActionDescriptors("elementClick");i.length&&i.forEach((function(i){if(i.name===n.id){t.stopPropagation();var a=e.getActiveEntityInfo(),o=a?a.entityId:null,r=a?a.entityName:null,s=a&&a.entityLabel?a.entityLabel:null;e.handleWidgetAction(t,i,o,r,null,s)}}))}},e.prototype.updateEntityParams=function(t,e,n,i,a){if(n){var o=void 0;e&&e.length?(o=t[e])||(o={},t[e]=o,t.targetEntityParamName=e):o=t,o.entityId=n,i&&(o.entityName=i),a&&(o.entityLabel=a)}},e.prototype.loadCustomActionResources=function(t,e,n){var i=this;Object(b.k)(e)&&e.length>0&&(this.cssParser.cssPreviewNamespace=t,this.cssParser.createStyleElement(t,e,"nonamespace"));var a=[];return Object(b.k)(n)&&n.length>0?(n.forEach((function(t){a.push(i.resources.loadResource(t.url).pipe(Object(J.a)((function(e){return Object(X.a)("Failed to load custom action resource: '"+t.url+"'")}))))})),Object(B.a)(a).pipe(Object(ne.a)((function(t){var e;return t&&t.length&&(e=t.filter((function(t){return t&&t.length>0}))),e&&e.length?Object(Qt.a)(e):Object(X.a)(null)})))):Object(X.a)(null)},e.prototype.processResourcesLoadErrors=function(t){var e="";t.forEach((function(t){e+="<div>"+t+"</div>"})),this.store.dispatch(new ie.b({message:e,type:"error"}))},e.prototype.getActiveEntityInfo=function(){var t=this.widgetContext.activeEntityInfo;if(!t)for(var e=0,n=Object.keys(this.widgetContext.subscriptions);e<n.length;e++){var i=n[e];if(t=this.widgetContext.subscriptions[i].getFirstEntityInfo())break}return t},e.prototype.checkSize=function(){var t=this.widgetContext.$containerParent.width(),e=this.widgetContext.$containerParent.height(),n=!1;return this.widgetContext.width&&this.widgetContext.width===t&&this.widgetContext.height&&this.widgetContext.height===e||t>0&&e>0&&(this.widgetContext.$container&&(this.widgetContext.$container.css("height",e+"px"),this.widgetContext.$container.css("width",t+"px")),this.widgetContext.width=t,this.widgetContext.height=e,n=!0,this.widgetSizeDetected=!0),n},e.ctorParameters=function(){return[{type:d.Store},{type:k.ActivatedRoute},{type:k.Router},{type:oe.a},{type:a.ComponentFactoryResolver},{type:a.ElementRef},{type:a.Injector},{type:kt.a},{type:ee.a},{type:Bt.a},{type:ae.a},{type:jt.a},{type:pt.a},{type:Dt.a},{type:se.a},{type:Lt.a},{type:re.a},{type:a.NgZone},{type:a.ChangeDetectorRef}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"isEdit",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"isMobile",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Kt)],e.prototype,"dashboardWidget",void 0),Object(i.c)([Object(a.ViewChild)("widgetContent",{read:a.ViewContainerRef,static:!0}),Object(i.g)("design:type",a.ViewContainerRef)],e.prototype,"widgetContentContainer",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-widget",template:Object(i.f)(n("oEEf")).default,encapsulation:a.ViewEncapsulation.None,changeDetection:a.ChangeDetectionStrategy.OnPush,styles:[Object(i.f)(n("veKH")).default]}),Object(i.g)("design:paramtypes",[d.Store,k.ActivatedRoute,k.Router,oe.a,a.ComponentFactoryResolver,a.ElementRef,a.Injector,kt.a,ee.a,Bt.a,ae.a,jt.a,pt.a,Dt.a,se.a,Lt.a,re.a,a.NgZone,a.ChangeDetectorRef])],e)}(c.a),be=function(){function t(){this.legendKeyHiddenChange=new a.EventEmitter}return t.prototype.ngOnInit=function(){this.displayHeader=!0===this.legendConfig.showMin||!0===this.legendConfig.showMax||!0===this.legendConfig.showAvg||!0===this.legendConfig.showTotal,this.isHorizontal=this.legendConfig.position===Ot.c.bottom||this.legendConfig.position===Ot.c.top,this.isRowDirection=this.legendConfig.direction===Ot.b.row},t.prototype.toggleHideData=function(t){this.legendData.keys[t].dataKey.settings.disableDataHiding||(this.legendData.keys[t].dataKey.hidden=!this.legendData.keys[t].dataKey.hidden,this.legendKeyHiddenChange.emit(t))},t.prototype.legendKeys=function(){var t=this;return this.legendData.keys.filter((function(e){return t.legendData.keys[e.dataIndex].dataKey.inLegend}))},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],t.prototype,"legendConfig",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],t.prototype,"legendData",void 0),Object(i.c)([Object(a.Output)(),Object(i.g)("design:type",Object)],t.prototype,"legendKeyHiddenChange",void 0),t=Object(i.c)([Object(a.Component)({selector:"tb-legend",template:Object(i.f)(n("ab/a")).default,styles:[Object(i.f)(n("tFEo")).default]})],t)}(),ye=new a.InjectionToken("AliasesEntitySelectPanelData"),ve=function(){function t(t){this.data=t,this.entityAliasesInfo=this.data.entityAliasesInfo}return t.prototype.currentAliasEntityChanged=function(t,e){var n=this.entityAliasesInfo[t].resolvedEntities.find((function(t){return t.id===e}));n&&this.data.aliasController.updateCurrentAliasEntity(t,n)},t.ctorParameters=function(){return[{type:void 0,decorators:[{type:a.Inject,args:[ye]}]}]},t=Object(i.c)([Object(a.Component)({selector:"tb-aliases-entity-select-panel",template:Object(i.f)(n("s/fD")).default,styles:[Object(i.f)(n("wefO")).default]}),Object(i.h)(0,Object(a.Inject)(ye)),Object(i.g)("design:paramtypes",[Object])],t)}(),we=function(){function t(t,e,n,i){this.translate=t,this.overlay=e,this.breakpointObserver=n,this.viewContainerRef=i,this.tooltipPosition="above",this.entityAliasesInfo={},this.hasSelectableAliasEntities=!1,this.rxSubscriptions=new Array}return Object.defineProperty(t.prototype,"aliasController",{get:function(){return this.aliasControllerValue},set:function(t){this.aliasControllerValue=t,this.setupAliasController(this.aliasControllerValue)},enumerable:!0,configurable:!0}),t.prototype.setupAliasController=function(t){var e=this;this.rxSubscriptions.forEach((function(t){t.unsubscribe()})),this.rxSubscriptions.length=0,t&&(this.rxSubscriptions.push(t.entityAliasesChanged.subscribe((function(){setTimeout((function(){e.updateDisplayValue(),e.updateEntityAliasesInfo()}),0)}))),this.rxSubscriptions.push(t.entityAliasResolved.subscribe((function(){setTimeout((function(){e.updateDisplayValue(),e.updateEntityAliasesInfo()}),0)}))))},t.prototype.ngOnInit=function(){},t.prototype.ngOnDestroy=function(){this.rxSubscriptions.forEach((function(t){t.unsubscribe()})),this.rxSubscriptions.length=0},t.prototype.openEditMode=function(){if(!this.disabled&&this.hasSelectableAliasEntities){var t=this.overlay.position(),e=new wt.d({panelClass:"tb-aliases-entity-select-panel",backdropClass:"cdk-overlay-transparent-backdrop",hasBackdrop:!0});e.positionStrategy=t.flexibleConnectedTo(this.aliasEntitySelectPanelOrigin.elementRef).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"}]);var n=this.overlay.create(e);n.backdropClick().subscribe((function(){n.dispose()}));var i=this._createAliasesEntitySelectPanelInjector(n,{aliasController:this.aliasController,entityAliasesInfo:this.entityAliasesInfo});n.attach(new Ct.d(ve,this.viewContainerRef,i))}},t.prototype._createAliasesEntitySelectPanelInjector=function(t,e){var n=new WeakMap([[ye,e],[wt.g,t]]);return new Ct.g(this.viewContainerRef.injector,n)},t.prototype.updateDisplayValue=function(){for(var t,e,n=!0,i=this.aliasController.getEntityAliases(),a=0,o=Object.keys(i);a<o.length;a++){var r=o[a];if(!i[r].filter.resolveMultiple){var s=this.aliasController.getInstantAliasInfo(r);if(s&&s.currentEntity){if(e){n=!1;break}e=r}}}n&&e?t=this.aliasController.getInstantAliasInfo(e).currentEntity.name:t=this.translate.instant("entity.entities");this.displayValue=t},t.prototype.updateEntityAliasesInfo=function(){var t=this.aliasController.getEntityAliases();this.entityAliasesInfo={},this.hasSelectableAliasEntities=!1;for(var e=0,n=Object.keys(t);e<n.length;e++){var i=n[e],a=this.aliasController.getInstantAliasInfo(i);a&&!a.resolveMultiple&&a.currentEntity&&a.resolvedEntities.length>1&&(this.entityAliasesInfo[i]=Object(b.d)(a),this.entityAliasesInfo[i].selectedId=a.currentEntity.id,this.hasSelectableAliasEntities=!0)}},t.ctorParameters=function(){return[{type:T.TranslateService},{type:wt.c},{type:Yt.a},{type:a.ViewContainerRef}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object),Object(i.g)("design:paramtypes",[Object])],t.prototype,"aliasController",null),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",String)],t.prototype,"tooltipPosition",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],t.prototype,"disabled",void 0),Object(i.c)([Object(a.ViewChild)("aliasEntitySelectPanelOrigin"),Object(i.g)("design:type",wt.b)],t.prototype,"aliasEntitySelectPanelOrigin",void 0),t=Object(i.c)([Object(a.Component)({selector:"tb-aliases-entity-select",template:Object(i.f)(n("Q2GN")).default,styles:[Object(i.f)(n("YbRx")).default]}),Object(i.g)("design:paramtypes",[T.TranslateService,wt.c,Yt.a,a.ViewContainerRef])],t)}(),xe=n("hqxT"),Se=n("6OOC"),Ce={type:"object",properties:{}},Te=[],Oe=["*"],_e=function(t){function e(e,n,i,a,o,r){var s=t.call(this,e)||this;return s.store=e,s.utils=n,s.entityService=i,s.dialog=a,s.translate=o,s.fb=r,s.widgetTypes=Ot.k,s.entityTypes=m.b,s.alarmSearchStatuses=Object.keys(ct.b),s.datasourceType=Ot.a,s.datasourceTypesTranslations=Ot.e,s.widgetConfigCallbacks={createEntityAlias:s.createEntityAlias.bind(s),generateDataKey:s.generateDataKey.bind(s),fetchEntityKeys:s.fetchEntityKeys.bind(s),fetchDashboardStates:s.fetchDashboardStates.bind(s)},s.widgetEditMode=s.utils.widgetEditMode,s.propagateChange=null,s}var o;return Object(i.d)(e,t),o=e,e.prototype.ngOnInit=function(){var t=this;this.functionsOnly?this.datasourceTypes=[Ot.a.function]:this.datasourceTypes=[Ot.a.function,Ot.a.entity],this.dataSettings=this.fb.group({}),this.targetDeviceSettings=this.fb.group({}),this.alarmSourceSettings=this.fb.group({}),this.advancedSettings=this.fb.group({}),this.widgetSettings=this.fb.group({title:[null,[]],showTitleIcon:[null,[]],titleIcon:[null,[]],iconColor:[null,[]],iconSize:[null,[]],titleTooltip:[null,[]],showTitle:[null,[]],dropShadow:[null,[]],enableFullscreen:[null,[]],backgroundColor:[null,[]],color:[null,[]],padding:[null,[]],margin:[null,[]],widgetStyle:[null,[]],titleStyle:[null,[]],units:[null,[]],decimals:[null,[u.Validators.min(0),u.Validators.max(15),u.Validators.pattern(/^\d*$/)]],showLegend:[null,[]],legendConfig:[null,[]]}),this.widgetSettings.get("showTitleIcon").valueChanges.subscribe((function(e){e?t.widgetSettings.get("titleIcon").enable({emitEvent:!1}):t.widgetSettings.get("titleIcon").disable({emitEvent:!1})})),this.widgetSettings.get("showLegend").valueChanges.subscribe((function(e){e?t.widgetSettings.get("legendConfig").enable({emitEvent:!1}):t.widgetSettings.get("legendConfig").disable({emitEvent:!1})})),this.layoutSettings=this.fb.group({mobileOrder:[null,[u.Validators.pattern(/^-?[0-9]+$/)]],mobileHeight:[null,[u.Validators.min(1),u.Validators.max(10),u.Validators.pattern(/^\d*$/)]]}),this.actionsSettings=this.fb.group({actionsData:[null,[]]})},e.prototype.removeChangeSubscriptions=function(){this.dataSettingsChangesSubscription&&(this.dataSettingsChangesSubscription.unsubscribe(),this.dataSettingsChangesSubscription=null),this.targetDeviceSettingsSubscription&&(this.targetDeviceSettingsSubscription.unsubscribe(),this.targetDeviceSettingsSubscription=null),this.alarmSourceSettingsSubscription&&(this.alarmSourceSettingsSubscription.unsubscribe(),this.alarmSourceSettingsSubscription=null),this.widgetSettingsSubscription&&(this.widgetSettingsSubscription.unsubscribe(),this.widgetSettingsSubscription=null),this.layoutSettingsSubscription&&(this.layoutSettingsSubscription.unsubscribe(),this.layoutSettingsSubscription=null),this.advancedSettingsSubscription&&(this.advancedSettingsSubscription.unsubscribe(),this.advancedSettingsSubscription=null),this.actionsSettingsSubscription&&(this.actionsSettingsSubscription.unsubscribe(),this.actionsSettingsSubscription=null)},e.prototype.createChangeSubscriptions=function(){var t=this;this.dataSettingsChangesSubscription=this.dataSettings.valueChanges.subscribe((function(){return t.updateDataSettings()})),this.targetDeviceSettingsSubscription=this.targetDeviceSettings.valueChanges.subscribe((function(){return t.updateTargetDeviceSettings()})),this.alarmSourceSettingsSubscription=this.alarmSourceSettings.valueChanges.subscribe((function(){return t.updateAlarmSourceSettings()})),this.widgetSettingsSubscription=this.widgetSettings.valueChanges.subscribe((function(){return t.updateWidgetSettings()})),this.layoutSettingsSubscription=this.layoutSettings.valueChanges.subscribe((function(){return t.updateLayoutSettings()})),this.advancedSettingsSubscription=this.advancedSettings.valueChanges.subscribe((function(){return t.updateAdvancedSettings()})),this.actionsSettingsSubscription=this.actionsSettings.valueChanges.subscribe((function(){return t.updateActionSettings()}))},e.prototype.buildForms=function(){var t=this;this.dataSettings=this.fb.group({}),this.targetDeviceSettings=this.fb.group({}),this.alarmSourceSettings=this.fb.group({}),this.advancedSettings=this.fb.group({}),this.widgetType!==Ot.k.timeseries&&this.widgetType!==Ot.k.alarm||(this.dataSettings.addControl("useDashboardTimewindow",this.fb.control(null)),this.dataSettings.addControl("displayTimewindow",this.fb.control(null)),this.dataSettings.addControl("timewindow",this.fb.control(null)),this.dataSettings.get("useDashboardTimewindow").valueChanges.subscribe((function(e){e?(t.dataSettings.get("displayTimewindow").disable({emitEvent:!1}),t.dataSettings.get("timewindow").disable({emitEvent:!1})):(t.dataSettings.get("displayTimewindow").enable({emitEvent:!1}),t.dataSettings.get("timewindow").enable({emitEvent:!1}))})),this.widgetType===Ot.k.alarm&&(this.dataSettings.addControl("alarmSearchStatus",this.fb.control(null)),this.dataSettings.addControl("alarmsPollingInterval",this.fb.control(null,[u.Validators.required,u.Validators.min(1)])),this.dataSettings.addControl("alarmsMaxCountLoad",this.fb.control(null,[u.Validators.required,u.Validators.min(0)])),this.dataSettings.addControl("alarmsFetchSize",this.fb.control(null,[u.Validators.required,u.Validators.min(10)])))),this.modelValue.isDataEnabled&&(this.widgetType!==Ot.k.rpc&&this.widgetType!==Ot.k.alarm&&this.widgetType!==Ot.k.static?this.dataSettings.addControl("datasources",this.fb.array([])):this.widgetType===Ot.k.rpc?this.targetDeviceSettings.addControl("targetDeviceAliasId",this.fb.control(null,this.widgetEditMode?[]:[u.Validators.required])):this.widgetType===Ot.k.alarm&&(this.alarmSourceSettings=this.buildDatasourceForm())),this.advancedSettings.addControl("settings",this.fb.control(null,[]))},e.prototype.datasourcesFormArray=function(){return this.dataSettings.get("datasources")},e.prototype.registerOnChange=function(t){this.propagateChange=t},e.prototype.registerOnTouched=function(t){},e.prototype.setDisabledState=function(t){this.disabled=t},e.prototype.writeValue=function(t){var e=this;if(this.modelValue=t,this.removeChangeSubscriptions(),this.modelValue){this.widgetType!==this.modelValue.widgetType&&(this.widgetType=this.modelValue.widgetType,this.buildForms());var n=this.modelValue.config,i=this.modelValue.layout;if(n){this.selectedTab=0,this.widgetSettings.patchValue({title:n.title,showTitleIcon:!!Object(b.k)(n.showTitleIcon)&&n.showTitleIcon,titleIcon:Object(b.k)(n.titleIcon)?n.titleIcon:"",iconColor:Object(b.k)(n.iconColor)?n.iconColor:"rgba(0, 0, 0, 0.87)",iconSize:Object(b.k)(n.iconSize)?n.iconSize:"24px",titleTooltip:Object(b.k)(n.titleTooltip)?n.titleTooltip:"",showTitle:n.showTitle,dropShadow:!Object(b.k)(n.dropShadow)||n.dropShadow,enableFullscreen:!Object(b.k)(n.enableFullscreen)||n.enableFullscreen,backgroundColor:n.backgroundColor,color:n.color,padding:n.padding,margin:n.margin,widgetStyle:Object(b.k)(n.widgetStyle)?n.widgetStyle:{},titleStyle:Object(b.k)(n.titleStyle)?n.titleStyle:{fontSize:"16px",fontWeight:400},units:n.units,decimals:n.decimals,showLegend:Object(b.k)(n.showLegend)?n.showLegend:this.widgetType===Ot.k.timeseries,legendConfig:n.legendConfig||Object(Ot.f)(this.widgetType)},{emitEvent:!1}),this.widgetSettings.get("showTitleIcon").value?this.widgetSettings.get("titleIcon").enable({emitEvent:!1}):this.widgetSettings.get("titleIcon").disable({emitEvent:!1}),this.widgetSettings.get("showLegend").value?this.widgetSettings.get("legendConfig").enable({emitEvent:!1}):this.widgetSettings.get("legendConfig").disable({emitEvent:!1});var a={actionsMap:n.actions||{},actionSources:this.modelValue.actionSources||{}};if(this.actionsSettings.patchValue({actionsData:a},{emitEvent:!1}),this.widgetType===Ot.k.timeseries||this.widgetType===Ot.k.alarm){var o=!Object(b.k)(n.useDashboardTimewindow)||n.useDashboardTimewindow;this.dataSettings.patchValue({useDashboardTimewindow:o},{emitEvent:!1}),o?(this.dataSettings.get("displayTimewindow").disable({emitEvent:!1}),this.dataSettings.get("timewindow").disable({emitEvent:!1})):(this.dataSettings.get("displayTimewindow").enable({emitEvent:!1}),this.dataSettings.get("timewindow").enable({emitEvent:!1})),this.dataSettings.patchValue({displayTimewindow:!Object(b.k)(n.displayTimewindow)||n.displayTimewindow},{emitEvent:!1}),this.dataSettings.patchValue({timewindow:n.timewindow},{emitEvent:!1})}if(this.modelValue.isDataEnabled)if(this.widgetType!==Ot.k.rpc&&this.widgetType!==Ot.k.alarm&&this.widgetType!==Ot.k.static){var r=this.dataSettings.get("datasources");r.clear(),n.datasources&&n.datasources.forEach((function(t){r.push(e.buildDatasourceForm(t))}))}else if(this.widgetType===Ot.k.rpc){var s=void 0;if(n.targetDeviceAliasIds&&n.targetDeviceAliasIds.length>0){var l=n.targetDeviceAliasIds[0],c=this.aliasController.getEntityAliases();s=c[l]?c[l].id:null}else s=null;this.targetDeviceSettings.patchValue({targetDeviceAliasId:s},{emitEvent:!1})}else if(this.widgetType===Ot.k.alarm){this.dataSettings.patchValue({alarmSearchStatus:Object(b.k)(n.alarmSearchStatus)?n.alarmSearchStatus:ct.b.ANY},{emitEvent:!1}),this.dataSettings.patchValue({alarmsPollingInterval:Object(b.k)(n.alarmsPollingInterval)?n.alarmsPollingInterval:5},{emitEvent:!1}),this.dataSettings.patchValue({alarmsMaxCountLoad:Object(b.k)(n.alarmsMaxCountLoad)?n.alarmsMaxCountLoad:0},{emitEvent:!1}),this.dataSettings.patchValue({alarmsFetchSize:Object(b.k)(n.alarmsFetchSize)?n.alarmsFetchSize:100},{emitEvent:!1}),this.alarmSourceSettings.patchValue(n.alarmSource,{emitEvent:!1});var d=this.alarmSourceSettings.get("type").value;this.alarmSourceSettings.get("entityAliasId").setValidators(d===Ot.a.entity?[u.Validators.required]:[]),this.alarmSourceSettings.get("entityAliasId").updateValueAndValidity({emitEvent:!1})}this.updateSchemaForm(n.settings),i?this.layoutSettings.patchValue({mobileOrder:i.mobileOrder,mobileHeight:i.mobileHeight},{emitEvent:!1}):this.layoutSettings.patchValue({mobileOrder:null,mobileHeight:null},{emitEvent:!1})}this.createChangeSubscriptions()}},e.prototype.buildDatasourceForm=function(t){var e=!this.modelValue.typeParameters||!this.modelValue.typeParameters.dataKeysOptional,n=this.fb.group({type:[t?t.type:null,[u.Validators.required]],name:[t?t.name:null,[]],entityAliasId:[t?t.entityAliasId:null,t&&t.type===Ot.a.entity?[u.Validators.required]:[]],dataKeys:[t?t.dataKeys:null,e?[u.Validators.required]:[]]});return n.get("type").valueChanges.subscribe((function(t){n.get("entityAliasId").setValidators(t===Ot.a.entity?[u.Validators.required]:[]),n.get("entityAliasId").updateValueAndValidity()})),n},e.prototype.updateSchemaForm=function(t){var e={};this.modelValue.settingsSchema&&this.modelValue.settingsSchema.schema?(e.schema=this.modelValue.settingsSchema.schema,e.form=this.modelValue.settingsSchema.form||Object(b.d)(Oe),e.groupInfoes=this.modelValue.settingsSchema.groupInfoes,e.model=t):(e.schema=Object(b.d)(Ce),e.form=Object(b.d)(Oe),e.groupInfoes=Object(b.d)(Te),e.model={}),this.advancedSettings.patchValue({settings:e},{emitEvent:!1})},e.prototype.updateDataSettings=function(){this.modelValue&&(this.modelValue.config&&Object.assign(this.modelValue.config,this.dataSettings.value),this.propagateChange(this.modelValue))},e.prototype.updateTargetDeviceSettings=function(){if(this.modelValue){if(this.modelValue.config){var t=this.targetDeviceSettings.get("targetDeviceAliasId").value;this.modelValue.config.targetDeviceAliasIds=t?[t]:[]}this.propagateChange(this.modelValue)}},e.prototype.updateAlarmSourceSettings=function(){if(this.modelValue){if(this.modelValue.config){var t=this.alarmSourceSettings.value;this.modelValue.config.alarmSource=t}this.propagateChange(this.modelValue)}},e.prototype.updateWidgetSettings=function(){this.modelValue&&(this.modelValue.config&&Object.assign(this.modelValue.config,this.widgetSettings.value),this.propagateChange(this.modelValue))},e.prototype.updateLayoutSettings=function(){this.modelValue&&(this.modelValue.layout&&Object.assign(this.modelValue.layout,this.layoutSettings.value),this.propagateChange(this.modelValue))},e.prototype.updateAdvancedSettings=function(){if(this.modelValue){if(this.modelValue.config){var t=this.advancedSettings.get("settings").value.model;this.modelValue.config.settings=t}this.propagateChange(this.modelValue)}},e.prototype.updateActionSettings=function(){if(this.modelValue){if(this.modelValue.config){var t=this.actionsSettings.get("actionsData").value.actionsMap;this.modelValue.config.actions=t}this.propagateChange(this.modelValue)}},e.prototype.displayAdvanced=function(){return!!this.modelValue&&!!this.modelValue.settingsSchema&&!!this.modelValue.settingsSchema.schema},e.prototype.removeDatasource=function(t){this.dataSettings.get("datasources").removeAt(t)},e.prototype.addDatasource=function(){var t;this.functionsOnly?(t=Object(b.d)(this.utils.getDefaultDatasource(this.modelValue.dataKeySettingsSchema.schema))).dataKeys=[this.generateDataKey("Sin",gt.c.function)]:t={type:Ot.a.entity,dataKeys:[]},this.dataSettings.get("datasources").push(this.buildDatasourceForm(t))},e.prototype.generateDataKey=function(t,e){if(Object(b.s)(t))return t._hash=Math.random(),t;var n=t;if(e===gt.c.alarm||e===gt.c.entityField){var i=e===gt.c.alarm?ct.e[n]:Se.a[t];i&&(n=this.translate.instant(i.name))}var a={name:t,type:e,label:n=this.genNextLabel(n),color:this.genNextColor(),settings:{},_hash:Math.random()};return e===gt.c.function&&(a.name="f(x)",a.funcBody=this.utils.getPredefinedFunctionBody(t),a.funcBody||(a.funcBody="return prevValue + 1;")),Object(b.k)(this.modelValue.dataKeySettingsSchema.schema)&&(a.settings=this.utils.generateObjectFromJsonSchema(this.modelValue.dataKeySettingsSchema.schema)),a},e.prototype.genNextLabel=function(t){var e=t,n=1,i=!1,a=this.widgetType===Ot.k.alarm?[this.modelValue.config.alarmSource]:this.modelValue.config.datasources;if(a)do{i=!1,a.forEach((function(a){a&&a.dataKeys&&a.dataKeys.forEach((function(a){a.label===e&&(n++,e=t+" "+n,i=!0)}))}))}while(i);return e},e.prototype.genNextColor=function(){var t=0,e=this.widgetType===Ot.k.alarm?[this.modelValue.config.alarmSource]:this.modelValue.config.datasources;return e&&e.forEach((function(e){e&&e.dataKeys&&(t+=e.dataKeys.length)})),this.utils.getMaterialColor(t)},e.prototype.createEntityAlias=function(t,e){var n=this,i={id:null,alias:t,filter:{resolveMultiple:!1}};return this.dialog.open(xe.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{isAdd:!0,allowedEntityTypes:e,entityAliases:this.entityAliases,alias:i}}).afterClosed().pipe(Object(H.a)((function(t){t&&(n.entityAliases[t.id]=t,n.aliasController.updateEntityAliases(n.entityAliases))})))},e.prototype.fetchEntityKeys=function(t,e,n){var i=this;return this.aliasController.getAliasInfo(t).pipe(Object(Rt.a)((function(t){var a=t.currentEntity;if(a){for(var o=[],r=function(t){o.push(i.entityService.getEntityKeys({entityType:a.entityType,id:a.id},e,t,{ignoreLoading:!0,ignoreErrors:!0}).pipe(Object(tt.a)((function(e){for(var n=[],i=0,a=e;i<a.length;i++){var o=a[i];n.push({name:o,type:t})}return n})),Object(J.a)((function(t){return Object(X.a)([])}))))},s=0,l=n;s<l.length;s++){r(l[s])}return Object(B.a)(o).pipe(Object(tt.a)((function(t){var e=new Array;return t.forEach((function(t){e.push.apply(e,t)})),e})))}return Object(X.a)([])})),Object(J.a)((function(t){return Object(X.a)([])})))},e.prototype.fetchDashboardStates=function(t){var e=Object.keys(this.dashboardStates),n=t?e.filter(this.createFilterForDashboardState(t)):e;return n&&n.length?n:[t]},e.prototype.createFilterForDashboardState=function(t){var e=t.toLowerCase();return function(t){return 0===t.toLowerCase().indexOf(e)}},e.prototype.validate=function(t){if(!this.dataSettings.valid)return{dataSettings:{valid:!1}};if(!this.widgetSettings.valid)return{widgetSettings:{valid:!1}};if(!this.layoutSettings.valid)return{widgetSettings:{valid:!1}};if(!this.advancedSettings.valid)return{advancedSettings:{valid:!1}};if(this.modelValue){var e=this.modelValue.config;if(this.widgetType===Ot.k.rpc&&this.modelValue.isDataEnabled){if(!e.targetDeviceAliasIds||!e.targetDeviceAliasIds.length)return{targetDeviceAliasIds:{valid:!1}}}else if(this.widgetType===Ot.k.alarm&&this.modelValue.isDataEnabled){if(!e.alarmSource)return{alarmSource:{valid:!1}}}else if(this.widgetType!==Ot.k.static&&this.modelValue.isDataEnabled&&(!e.datasources||!e.datasources.length))return{datasources:{valid:!1}}}return null},e.ctorParameters=function(){return[{type:d.Store},{type:Lt.a},{type:jt.a},{type:O.MatDialog},{type:T.TranslateService},{type:u.FormBuilder}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"forceExpandDatasources",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"aliasController",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"entityAliases",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"functionsOnly",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"dashboardStates",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"disabled",void 0),e=o=Object(i.c)([Object(a.Component)({selector:"tb-widget-config",template:Object(i.f)(n("yDMV")).default,providers:[{provide:u.NG_VALUE_ACCESSOR,useExisting:Object(a.forwardRef)((function(){return o})),multi:!0},{provide:u.NG_VALIDATORS,useExisting:Object(a.forwardRef)((function(){return o})),multi:!0}],styles:[Object(i.f)(n("rdEc")).default]}),Object(i.g)("design:paramtypes",[d.Store,Lt.a,jt.a,O.MatDialog,T.TranslateService,u.FormBuilder])],e)}(c.a),Le=n("EWcq"),Ie=n("MBk6"),Ae=function(){function t(t){this.translate=t}var e;return e=t,t.prototype.registerOnChange=function(t){},t.prototype.registerOnTouched=function(t){},t.prototype.setDisabledState=function(t){},t.prototype.writeValue=function(t){var e=this;if(this.filter=t,this.filter&&this.filter.type){var n,i,a,o,r,s=void 0,l=void 0;switch(this.filter.type){case Ie.a.singleEntity:s=this.filter.singleEntity.entityType,this.filterDisplayValue=this.translate.instant(m.d.get(s).list,{count:1});break;case Ie.a.entityList:s=this.filter.entityType;var c=this.filter.entityList.length;this.filterDisplayValue=this.translate.instant(m.d.get(s).list,{count:c});break;case Ie.a.entityName:s=this.filter.entityType,l=this.filter.entityNameFilter,this.filterDisplayValue=this.translate.instant(m.d.get(s).nameStartsWith,{prefix:l});break;case Ie.a.stateEntity:this.filterDisplayValue=this.translate.instant("alias.filter-type-state-entity-description");break;case Ie.a.assetType:var d=this.filter.assetType;(l=this.filter.assetNameFilter)&&l.length?this.filterDisplayValue=this.translate.instant("alias.filter-type-asset-type-and-name-description",{assetType:d,prefix:l}):this.filterDisplayValue=this.translate.instant("alias.filter-type-asset-type-description",{assetType:d});break;case Ie.a.deviceType:var u=this.filter.deviceType;(l=this.filter.deviceNameFilter)&&l.length?this.filterDisplayValue=this.translate.instant("alias.filter-type-device-type-and-name-description",{deviceType:u,prefix:l}):this.filterDisplayValue=this.translate.instant("alias.filter-type-device-type-description",{deviceType:u});break;case Ie.a.entityViewType:var h=this.filter.entityViewType;(l=this.filter.entityViewNameFilter)&&l.length?this.filterDisplayValue=this.translate.instant("alias.filter-type-entity-view-type-and-name-description",{entityView:h,prefix:l}):this.filterDisplayValue=this.translate.instant("alias.filter-type-entity-view-type-description",{entityView:h});break;case Ie.a.relationsQuery:n=this.translate.instant("alias.all-entities"),i=this.translate.instant("alias.any-relation"),o=this.filter.rootStateEntity?this.translate.instant("alias.state-entity"):this.translate.instant(m.d.get(this.filter.rootEntity.entityType).type),r=this.translate.instant("relation.direction-type."+this.filter.direction);var p=this.filter.filters;if(p&&p.length){var g=[];p.forEach((function(t){var s;if(t.entityTypes&&t.entityTypes.length){var l=[];t.entityTypes.forEach((function(t){l.push(e.translate.instant(m.d.get(t).typePlural))})),s=l.join(", ")}else s=n;a=t.relationType&&t.relationType.length?"'"+t.relationType+"'":i;var c=e.translate.instant("alias.filter-type-relations-query-description",{entities:s,relationType:a,direction:r,rootEntity:o});g.push(c)})),this.filterDisplayValue=g.join(", ")}else this.filterDisplayValue=this.translate.instant("alias.filter-type-relations-query-description",{entities:n,relationType:i,direction:r,rootEntity:o});break;case Ie.a.assetSearchQuery:case Ie.a.deviceSearchQuery:case Ie.a.entityViewSearchQuery:n=this.translate.instant("alias.all-entities"),i=this.translate.instant("alias.any-relation"),o=this.filter.rootStateEntity?this.translate.instant("alias.state-entity"):this.translate.instant(m.d.get(this.filter.rootEntity.entityType).type),r=this.translate.instant("relation.direction-type."+this.filter.direction);var f={relationType:a=this.filter.relationType&&this.filter.relationType.length?"'"+t.relationType+"'":i,direction:r,rootEntity:o};if(this.filter.type===Ie.a.assetSearchQuery){var b=[];this.filter.assetTypes.forEach((function(t){b.push("'"+t+"'")}));var y=b.join(", ");f.assetTypes=y,this.filterDisplayValue=this.translate.instant("alias.filter-type-asset-search-query-description",f)}else if(this.filter.type===Ie.a.deviceSearchQuery){var v=[];this.filter.deviceTypes.forEach((function(t){v.push("'"+t+"'")}));var w=v.join(", ");f.deviceTypes=w,this.filterDisplayValue=this.translate.instant("alias.filter-type-device-search-query-description",f)}else if(this.filter.type===Ie.a.entityViewSearchQuery){var x=[];this.filter.entityViewTypes.forEach((function(t){x.push("'"+t+"'")}));var S=x.join(", ");f.entityViewTypes=S,this.filterDisplayValue=this.translate.instant("alias.filter-type-entity-view-search-query-description",f)}break;default:this.filterDisplayValue=this.filter.type}}else this.filterDisplayValue=""},t.ctorParameters=function(){return[{type:T.TranslateService}]},t=e=Object(i.c)([Object(a.Component)({selector:"tb-entity-filter-view",template:Object(i.f)(n("n3Zx")).default,providers:[{provide:u.NG_VALUE_ACCESSOR,useExisting:Object(a.forwardRef)((function(){return e})),multi:!0}],styles:[Object(i.f)(n("TTrM")).default]}),Object(i.g)("design:paramtypes",[T.TranslateService])],t)}(),ke=function(){function t(t,e,n){this.translate=t,this.entityService=e,this.fb=n,this.resolveMultipleChanged=new a.EventEmitter,this.aliasFilterType=Ie.a,this.aliasFilterTypeTranslations=Ie.b,this.entityType=m.b,this.directionTypes=Object.keys(K.b),this.directionTypeTranslations=K.g,this.directionTypeEnum=K.b,this.propagateChange=null}var e;return e=t,t.prototype.ngOnInit=function(){var t=this;this.aliasFilterTypes=this.entityService.getAliasFilterTypesByEntityTypes(this.allowedEntityTypes),this.entityFilterFormGroup=this.fb.group({type:[null,[u.Validators.required]]}),this.entityFilterFormGroup.get("type").valueChanges.subscribe((function(e){t.filterTypeChanged(e)})),this.entityFilterFormGroup.valueChanges.subscribe((function(){t.updateModel()})),this.filterFormGroup=this.fb.group({})},t.prototype.registerOnChange=function(t){this.propagateChange=t},t.prototype.registerOnTouched=function(t){},t.prototype.setDisabledState=function(t){this.disabled=t},t.prototype.writeValue=function(t){t||(t={type:null,resolveMultiple:this.resolveMultiple}),this.entityFilterFormGroup.get("type").patchValue(t.type,{emitEvent:!1}),t&&t.type&&this.updateFilterFormGroup(t.type,t)},t.prototype.updateFilterFormGroup=function(t,e){var n=this;switch(t){case Ie.a.singleEntity:this.filterFormGroup=this.fb.group({singleEntity:[e?e.singleEntity:null,[u.Validators.required]]});break;case Ie.a.entityList:this.filterFormGroup=this.fb.group({entityType:[e?e.entityType:null,[u.Validators.required]],entityList:[e?e.entityList:[],[u.Validators.required]]});break;case Ie.a.entityName:this.filterFormGroup=this.fb.group({entityType:[e?e.entityType:null,[u.Validators.required]],entityNameFilter:[e?e.entityNameFilter:"",[u.Validators.required]]});break;case Ie.a.stateEntity:this.filterFormGroup=this.fb.group({stateEntityParamName:[e?e.stateEntityParamName:null,[]],defaultStateEntity:[e?e.defaultStateEntity:null,[]]});break;case Ie.a.assetType:this.filterFormGroup=this.fb.group({assetType:[e?e.assetType:null,[u.Validators.required]],assetNameFilter:[e?e.assetNameFilter:"",[]]});break;case Ie.a.deviceType:this.filterFormGroup=this.fb.group({deviceType:[e?e.deviceType:null,[u.Validators.required]],deviceNameFilter:[e?e.deviceNameFilter:"",[]]});break;case Ie.a.entityViewType:this.filterFormGroup=this.fb.group({entityViewType:[e?e.entityViewType:null,[u.Validators.required]],entityViewNameFilter:[e?e.entityViewNameFilter:"",[]]});break;case Ie.a.relationsQuery:case Ie.a.assetSearchQuery:case Ie.a.deviceSearchQuery:case Ie.a.entityViewSearchQuery:this.filterFormGroup=this.fb.group({rootStateEntity:[!!e&&e.rootStateEntity,[]],stateEntityParamName:[e?e.stateEntityParamName:null,[]],defaultStateEntity:[e?e.defaultStateEntity:null,[]],rootEntity:[e?e.rootEntity:null,e&&e.rootStateEntity?[]:[u.Validators.required]],direction:[e?e.direction:K.b.FROM,[u.Validators.required]],maxLevel:[e?e.maxLevel:1,[]],fetchLastLevelOnly:[!!e&&e.fetchLastLevelOnly,[]]}),this.filterFormGroup.get("rootStateEntity").valueChanges.subscribe((function(t){n.filterFormGroup.get("rootEntity").setValidators(t?[]:[u.Validators.required]),n.filterFormGroup.get("rootEntity").updateValueAndValidity()})),t===Ie.a.relationsQuery?this.filterFormGroup.addControl("filters",this.fb.control(e?e.filters:[],[])):(this.filterFormGroup.addControl("relationType",this.fb.control(e?e.relationType:null,[])),t===Ie.a.assetSearchQuery?this.filterFormGroup.addControl("assetTypes",this.fb.control(e?e.assetTypes:[],[u.Validators.required])):t===Ie.a.deviceSearchQuery?this.filterFormGroup.addControl("deviceTypes",this.fb.control(e?e.deviceTypes:[],[u.Validators.required])):t===Ie.a.entityViewSearchQuery&&this.filterFormGroup.addControl("entityViewTypes",this.fb.control(e?e.entityViewTypes:[],[u.Validators.required])))}this.filterFormGroup.valueChanges.subscribe((function(){n.updateModel()}))},t.prototype.filterTypeChanged=function(t){var e=!0;t!==Ie.a.singleEntity&&t!==Ie.a.stateEntity||(e=!1),this.resolveMultiple!==e&&this.resolveMultipleChanged.emit(e),this.updateFilterFormGroup(t)},t.prototype.updateModel=function(){var t=null;this.entityFilterFormGroup.valid&&this.filterFormGroup.valid&&(t={type:this.entityFilterFormGroup.get("type").value,resolveMultiple:this.resolveMultiple},t=Object(i.a)(Object(i.a)({},t),this.filterFormGroup.value)),this.propagateChange(t)},t.ctorParameters=function(){return[{type:T.TranslateService},{type:jt.a},{type:u.FormBuilder}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],t.prototype,"disabled",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Array)],t.prototype,"allowedEntityTypes",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],t.prototype,"resolveMultiple",void 0),Object(i.c)([Object(a.Output)(),Object(i.g)("design:type",a.EventEmitter)],t.prototype,"resolveMultipleChanged",void 0),t=e=Object(i.c)([Object(a.Component)({selector:"tb-entity-filter",template:Object(i.f)(n("fxBt")).default,providers:[{provide:u.NG_VALUE_ACCESSOR,useExisting:Object(a.forwardRef)((function(){return e})),multi:!0}],styles:[Object(i.f)(n("rbUU")).default]}),Object(i.g)("design:paramtypes",[T.TranslateService,jt.a,u.FormBuilder])],t)}(),Ee=function(t){function e(e,n){var i=t.call(this,e)||this;return i.store=e,i.fb=n,i.propagateChange=null,i.valueChangeSubscription=null,i}var o;return Object(i.d)(e,t),o=e,e.prototype.ngOnInit=function(){this.relationFiltersFormGroup=this.fb.group({}),this.relationFiltersFormGroup.addControl("relationFilters",this.fb.array([]))},e.prototype.relationFiltersFormArray=function(){return this.relationFiltersFormGroup.get("relationFilters")},e.prototype.registerOnChange=function(t){this.propagateChange=t},e.prototype.registerOnTouched=function(t){},e.prototype.setDisabledState=function(t){this.disabled=t},e.prototype.writeValue=function(t){var e=this;this.valueChangeSubscription&&this.valueChangeSubscription.unsubscribe();var n=[];t&&t.length&&t.forEach((function(t){n.push(e.createRelationFilterFormGroup(t))})),this.relationFiltersFormGroup.setControl("relationFilters",this.fb.array(n)),this.valueChangeSubscription=this.relationFiltersFormGroup.valueChanges.subscribe((function(){e.updateModel()}))},e.prototype.removeFilter=function(t){this.relationFiltersFormGroup.get("relationFilters").removeAt(t)},e.prototype.addFilter=function(){this.relationFiltersFormGroup.get("relationFilters").push(this.createRelationFilterFormGroup({relationType:null,entityTypes:[]}))},e.prototype.createRelationFilterFormGroup=function(t){return this.fb.group({relationType:[t?t.relationType:null],entityTypes:[t?t.entityTypes:[]]})},e.prototype.updateModel=function(){var t=this.relationFiltersFormGroup.get("relationFilters").value;this.propagateChange(t)},e.ctorParameters=function(){return[{type:d.Store},{type:u.FormBuilder}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"disabled",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Array)],e.prototype,"allowedEntityTypes",void 0),e=o=Object(i.c)([Object(a.Component)({selector:"tb-relation-filters",template:Object(i.f)(n("zkmH")).default,providers:[{provide:u.NG_VALUE_ACCESSOR,useExisting:Object(a.forwardRef)((function(){return o})),multi:!0}],styles:[Object(i.f)(n("q2GY")).default]}),Object(i.g)("design:paramtypes",[d.Store,u.FormBuilder])],e)}(c.a),je=n("S1nX"),De=n("T4sd"),Fe=n("iYur"),Me=n("qjWv"),Re=function(){function t(t,e,n,i,a,o){this.store=t,this.errorStateMatcher=e,this.entityService=n,this.translate=i,this.truncate=a,this.fb=o,this.entityAliasList=[],this.searchText="",this.dirty=!1,this.creatingEntityAlias=!1,this.propagateChange=function(t){},this.selectEntityAliasFormGroup=this.fb.group({entityAlias:[null]})}var e;return e=t,Object.defineProperty(t.prototype,"tbRequired",{get:function(){return this.requiredValue},set:function(t){this.requiredValue=Object(yt.coerceBooleanProperty)(t)},enumerable:!0,configurable:!0}),t.prototype.registerOnChange=function(t){this.propagateChange=t},t.prototype.registerOnTouched=function(t){},t.prototype.ngOnInit=function(){for(var t=this,e=this.aliasController.getEntityAliases(),n=0,i=Object.keys(e);n<i.length;n++){var a=i[n];this.allowedEntityTypes&&this.allowedEntityTypes.length&&!this.entityService.filterAliasByEntityTypes(e[a],this.allowedEntityTypes)||this.entityAliasList.push(e[a])}this.filteredEntityAliases=this.selectEntityAliasFormGroup.get("entityAlias").valueChanges.pipe(Object(H.a)((function(e){var n;n="string"!=typeof e&&e?e:null,t.updateView(n),null===e&&t.clear()})),Object(tt.a)((function(t){return t?"string"==typeof t?t:t.alias:""})),Object(Rt.a)((function(e){return t.fetchEntityAliases(e)})),Object(je.a)())},t.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=this.tbRequired&&!this.modelValue;return n||i},t.prototype.ngAfterViewInit=function(){},t.prototype.setDisabledState=function(t){this.disabled=t,this.disabled?this.selectEntityAliasFormGroup.disable({emitEvent:!1}):this.selectEntityAliasFormGroup.enable({emitEvent:!1})},t.prototype.writeValue=function(t){this.searchText="";var e=null;if(null!=t){var n=this.aliasController.getEntityAliases();n[t]&&(e=n[t])}null!=e?(this.modelValue=e.id,this.selectEntityAliasFormGroup.get("entityAlias").patchValue(e,{emitEvent:!1})):(this.modelValue=null,this.selectEntityAliasFormGroup.get("entityAlias").patchValue("",{emitEvent:!1})),this.dirty=!0},t.prototype.onFocus=function(){this.dirty&&(this.selectEntityAliasFormGroup.get("entityAlias").updateValueAndValidity({onlySelf:!0,emitEvent:!0}),this.dirty=!1)},t.prototype.updateView=function(t){var e=t?t.id:null;this.modelValue!==e&&(this.modelValue=e,this.propagateChange(this.modelValue))},t.prototype.displayEntityAliasFn=function(t){return t?t.alias:void 0},t.prototype.fetchEntityAliases=function(t){this.searchText=t;var e=this.entityAliasList;return t&&t.length&&(e=this.entityAliasList.filter((function(e){return e.alias.toLowerCase().includes(t.toLowerCase())}))),Object(X.a)(e)},t.prototype.clear=function(t){var e=this;void 0===t&&(t=""),this.entityAliasInput.nativeElement.value=t,this.selectEntityAliasFormGroup.get("entityAlias").patchValue(t,{emitEvent:!0}),setTimeout((function(){e.entityAliasInput.nativeElement.blur(),e.entityAliasInput.nativeElement.focus()}),0)},t.prototype.textIsNotEmpty=function(t){return!!(t&&null!=t&&t.length>0)},t.prototype.entityAliasEnter=function(t){t.keyCode===Me.ENTER&&(t.preventDefault(),this.modelValue||this.createEntityAlias(t,this.searchText))},t.prototype.createEntityAlias=function(t,e){var n=this;t.preventDefault(),this.creatingEntityAlias=!0,this.callbacks&&this.callbacks.createEntityAlias&&this.callbacks.createEntityAlias(e,this.allowedEntityTypes).subscribe((function(t){t?(n.entityAliasList.push(t),n.modelValue=t.id,n.selectEntityAliasFormGroup.get("entityAlias").patchValue(t,{emitEvent:!0}),n.propagateChange(n.modelValue)):setTimeout((function(){n.entityAliasInput.nativeElement.blur(),n.entityAliasInput.nativeElement.focus()}),0)}))},t.ctorParameters=function(){return[{type:d.Store},{type:ot.d,decorators:[{type:a.SkipSelf}]},{type:jt.a},{type:T.TranslateService},{type:De.a},{type:u.FormBuilder}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],t.prototype,"aliasController",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Array)],t.prototype,"allowedEntityTypes",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],t.prototype,"callbacks",void 0),Object(i.c)([Object(a.ViewChild)("entityAliasAutocomplete"),Object(i.g)("design:type",Fe.MatAutocomplete)],t.prototype,"entityAliasAutocomplete",void 0),Object(i.c)([Object(a.ViewChild)("autocomplete",{read:Fe.MatAutocompleteTrigger}),Object(i.g)("design:type",Fe.MatAutocompleteTrigger)],t.prototype,"autoCompleteTrigger",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean),Object(i.g)("design:paramtypes",[Boolean])],t.prototype,"tbRequired",null),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],t.prototype,"disabled",void 0),Object(i.c)([Object(a.ViewChild)("entityAliasInput",{static:!0}),Object(i.g)("design:type",a.ElementRef)],t.prototype,"entityAliasInput",void 0),t=e=Object(i.c)([Object(a.Component)({selector:"tb-entity-alias-select",template:Object(i.f)(n("4+Bt")).default,providers:[{provide:u.NG_VALUE_ACCESSOR,useExisting:Object(a.forwardRef)((function(){return e})),multi:!0},{provide:ot.d,useExisting:e}],styles:[Object(i.f)(n("y4O+")).default]}),Object(i.h)(1,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[d.Store,ot.d,jt.a,T.TranslateService,De.a,u.FormBuilder])],t)}(),Ne=n("VnD/"),Pe=n("S9aa"),Ve=n("yAAm"),We=function(t){function e(e,n,i,a,o,r){var s=t.call(this,e)||this;return s.store=e,s.utils=n,s.entityService=i,s.dialog=a,s.translate=o,s.fb=r,s.dataKeyTypes=gt.c,s.displayAdvanced=!1,s.propagateChange=null,s.latestKeySearchResult=null,s.keySearchText="",s}var o;return Object(i.d)(e,t),o=e,e.prototype.ngOnInit=function(){var t=this;this.alarmKeys=[];for(var e=0,n=Object.keys(ct.e);e<n.length;e++){var i=n[e];this.alarmKeys.push({name:i,type:gt.c.alarm})}this.dataKeySettingsSchema&&this.dataKeySettingsSchema.schema&&(this.displayAdvanced=!0,this.dataKeySettingsData={schema:this.dataKeySettingsSchema.schema,form:this.dataKeySettingsSchema.form||["*"]},this.dataKeySettingsFormGroup=this.fb.group({settings:[null,[]]}),this.dataKeySettingsFormGroup.valueChanges.subscribe((function(){t.updateModel()}))),this.dataKeyFormGroup=this.fb.group({name:[null,[]],label:[null,[u.Validators.required]],color:[null,[u.Validators.required]],units:[null,[]],decimals:[null,[u.Validators.min(0),u.Validators.max(15),u.Validators.pattern(/^\d*$/)]],funcBody:[null,[]],usePostProcessing:[null,[]],postFuncBody:[null,[]]}),this.dataKeyFormGroup.valueChanges.subscribe((function(){t.updateModel()})),this.dataKeyFormGroup.get("usePostProcessing").valueChanges.subscribe((function(e){var n=t.dataKeyFormGroup.get("postFuncBody").value;!e||n&&n.length?!e&&n&&n.length&&t.dataKeyFormGroup.get("postFuncBody").patchValue(null):t.dataKeyFormGroup.get("postFuncBody").patchValue("return value;")})),this.filteredKeys=this.dataKeyFormGroup.get("name").valueChanges.pipe(Object(tt.a)((function(t){return t||""})),Object(Rt.a)((function(e){return t.fetchKeys(e)})))},e.prototype.registerOnChange=function(t){this.propagateChange=t},e.prototype.registerOnTouched=function(t){},e.prototype.setDisabledState=function(t){},e.prototype.writeValue=function(t){this.modelValue=t,this.dataKeyFormGroup.patchValue(this.modelValue,{emitEvent:!1}),this.dataKeyFormGroup.get("name").setValidators(this.modelValue.type!==gt.c.function?[u.Validators.required]:[]),this.dataKeyFormGroup.get("name").updateValueAndValidity({emitEvent:!1}),this.displayAdvanced&&(this.dataKeySettingsData.model=this.modelValue.settings,this.dataKeySettingsFormGroup.patchValue({settings:this.dataKeySettingsData},{emitEvent:!1}))},e.prototype.updateModel=function(){this.modelValue=Object(i.a)(Object(i.a)({},this.modelValue),this.dataKeyFormGroup.value),this.displayAdvanced&&(this.modelValue.settings=this.dataKeySettingsFormGroup.get("settings").value.model),this.propagateChange(this.modelValue)},e.prototype.clearKey=function(){var t=this;this.dataKeyFormGroup.get("name").patchValue(null,{emitEvent:!0}),setTimeout((function(){t.keyInput.nativeElement.blur(),t.keyInput.nativeElement.focus()}),0)},e.prototype.fetchKeys=function(t){var e=this;if(null===this.latestKeySearchResult||this.keySearchText!==t){this.keySearchText=t;var n=null;if(this.modelValue.type===gt.c.alarm){var i=this.createDataKeyFilter(this.keySearchText);n=Object(X.a)(this.alarmKeys.filter(i))}else if(this.entityAliasId){var a=[this.modelValue.type];n=this.callbacks.fetchEntityKeys(this.entityAliasId,this.keySearchText,a)}else n=Object(X.a)([]);return n.pipe(Object(tt.a)((function(t){return t.map((function(t){return t.name}))})),Object(H.a)((function(t){return e.latestKeySearchResult=t})))}return Object(X.a)(this.latestKeySearchResult)},e.prototype.createDataKeyFilter=function(t){var e=t.toLowerCase();return function(t){return 0===t.name.toLowerCase().indexOf(e)}},e.prototype.validateOnSubmit=function(){this.modelValue.type===gt.c.function?this.funcBodyEdit.validateOnSubmit():this.modelValue.type!==gt.c.timeseries&&this.modelValue.type!==gt.c.attribute||!this.dataKeyFormGroup.get("usePostProcessing").value||this.postFuncBodyEdit.validateOnSubmit()},e.prototype.validate=function(t){return this.dataKeyFormGroup.valid?this.displayAdvanced&&!this.dataKeySettingsFormGroup.valid?{dataKeySettings:{valid:!1}}:null:{dataKey:{valid:!1}}},e.ctorParameters=function(){return[{type:d.Store},{type:Lt.a},{type:jt.a},{type:O.MatDialog},{type:T.TranslateService},{type:u.FormBuilder}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",String)],e.prototype,"entityAliasId",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"callbacks",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"dataKeySettingsSchema",void 0),Object(i.c)([Object(a.ViewChild)("keyInput"),Object(i.g)("design:type",a.ElementRef)],e.prototype,"keyInput",void 0),Object(i.c)([Object(a.ViewChild)("funcBodyEdit"),Object(i.g)("design:type",Ve.a)],e.prototype,"funcBodyEdit",void 0),Object(i.c)([Object(a.ViewChild)("postFuncBodyEdit"),Object(i.g)("design:type",Ve.a)],e.prototype,"postFuncBodyEdit",void 0),e=o=Object(i.c)([Object(a.Component)({selector:"tb-data-key-config",template:Object(i.f)(n("58+T")).default,providers:[{provide:u.NG_VALUE_ACCESSOR,useExisting:Object(a.forwardRef)((function(){return o})),multi:!0},{provide:u.NG_VALIDATORS,useExisting:Object(a.forwardRef)((function(){return o})),multi:!0}],styles:[Object(i.f)(n("4Pg0")).default]}),Object(i.g)("design:paramtypes",[d.Store,Lt.a,jt.a,O.MatDialog,T.TranslateService,u.FormBuilder])],e)}(c.a),ze=function(t){function e(e,n,i,a,o,r){var s=t.call(this,e,n,o)||this;return s.store=e,s.router=n,s.data=i,s.errorStateMatcher=a,s.dialogRef=o,s.fb=r,s.submitted=!1,s}var o;return Object(i.d)(e,t),o=e,e.prototype.ngOnInit=function(){this.dataKeyFormGroup=this.fb.group({dataKey:[this.data.dataKey,[u.Validators.required]]})},e.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=!!(t&&t.invalid&&this.submitted);return n||i},e.prototype.cancel=function(){this.dialogRef.close(null)},e.prototype.save=function(){if(this.submitted=!0,this.dataKeyConfig.validateOnSubmit(),this.dataKeyFormGroup.valid){var t=this.dataKeyFormGroup.get("dataKey").value;this.dialogRef.close(t)}},e.ctorParameters=function(){return[{type:d.Store},{type:k.Router},{type:void 0,decorators:[{type:a.Inject,args:[O.MAT_DIALOG_DATA]}]},{type:ot.d,decorators:[{type:a.SkipSelf}]},{type:O.MatDialogRef},{type:u.FormBuilder}]},Object(i.c)([Object(a.ViewChild)("dataKeyConfig",{static:!0}),Object(i.g)("design:type",We)],e.prototype,"dataKeyConfig",void 0),e=o=Object(i.c)([Object(a.Component)({selector:"tb-data-key-config-dialog",template:Object(i.f)(n("EKUr")).default,providers:[{provide:ot.d,useExisting:o}],styles:[Object(i.f)(n("xK7S")).default]}),Object(i.h)(2,Object(a.Inject)(O.MAT_DIALOG_DATA)),Object(i.h)(3,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[d.Store,k.Router,Object,ot.d,O.MatDialogRef,u.FormBuilder])],e)}(A.a),Be=function(){function t(t,e,n,i,a,o,r,s){this.store=t,this.errorStateMatcher=e,this.translate=n,this.utils=i,this.dialogs=a,this.dialog=o,this.fb=r,this.truncate=s,this.datasourceTypes=Ot.a,this.widgetTypes=Ot.k,this.dataKeyTypes=gt.c,this.keys=[],this.separatorKeysCodes=[Me.ENTER,Me.COMMA,Me.SEMICOLON],this.searchText="",this.latestSearchTextResult=null,this.dirty=!1,this.propagateChange=function(t){},this.keysListFormGroup=this.fb.group({keys:[null,this.required?[u.Validators.required]:[]],key:[null]})}var e;return e=t,Object.defineProperty(t.prototype,"required",{get:function(){return this.requiredValue||!this.optDataKeys},set:function(t){this.requiredValue=Object(yt.coerceBooleanProperty)(t)},enumerable:!0,configurable:!0}),t.prototype.updateValidators=function(){this.keysListFormGroup.get("keys").setValidators(this.required?[u.Validators.required]:[]),this.keysListFormGroup.get("keys").updateValueAndValidity()},t.prototype.registerOnChange=function(t){this.propagateChange=t},t.prototype.registerOnTouched=function(t){},t.prototype.ngOnInit=function(){var t=this;this.alarmKeys=[];for(var e=0,n=Object.keys(ct.e);e<n.length;e++){var i=n[e];this.alarmKeys.push({name:i,type:gt.c.alarm})}this.functionTypeKeys=[];for(var a=0,o=this.utils.getPredefinedFunctionsList();a<o.length;a++){var r=o[a];this.functionTypeKeys.push({name:r,type:gt.c.function})}this.updateParams(),this.filteredKeys=this.keysListFormGroup.get("key").valueChanges.pipe(Object(H.a)((function(e){e&&"string"!=typeof e?t.addFromChipValue(e):null===e&&t.clear(t.keyInput.nativeElement.value)})),Object(Ne.a)((function(t){return"string"==typeof t})),Object(tt.a)((function(t){return t?"string"==typeof t?t:t.name:""})),Object(Rt.a)((function(e){return t.fetchKeys(e)})),Object(je.a)())},t.prototype.maxDataKeysText=function(){return null!==this.maxDataKeys&&this.maxDataKeys>-1?this.datasourceType===Ot.a.function?this.translate.instant("datakey.maximum-function-types",{count:this.maxDataKeys}):this.translate.instant("datakey.maximum-timeseries-or-attributes",{count:this.maxDataKeys}):""},t.prototype.updateParams=function(){this.widgetType===Ot.k.alarm?(this.dataKeyType=gt.c.alarm,this.placeholder=this.translate.instant("datakey.alarm"),this.requiredText=this.translate.instant("datakey.alarm-fields-required")):this.datasourceType===Ot.a.function?(this.dataKeyType=gt.c.function,this.placeholder=this.translate.instant("datakey.function-types"),this.requiredText=this.translate.instant("datakey.function-types-required")):(this.widgetType===Ot.k.latest?(this.dataKeyType=null,this.requiredText=this.translate.instant("datakey.timeseries-or-attributes-required")):(this.dataKeyType=gt.c.timeseries,this.requiredText=this.translate.instant("datakey.timeseries-required")),this.placeholder="")},t.prototype.reset=function(){this.widgetType===Ot.k.alarm?this.keys=this.utils.getDefaultAlarmDataKeys():this.keys=[],this.keysListFormGroup.get("keys").setValue(this.keys),this.modelValue=this.keys.length?Object(i.l)(this.keys):null,this.keyInput&&(this.keyInput.nativeElement.value=""),this.keysListFormGroup.get("key").patchValue("",{emitEvent:!1}),this.propagateChange(this.modelValue),this.dirty=!0,this.latestSearchTextResult=null},t.prototype.ngOnChanges=function(t){for(var e=this,n=0,i=Object.keys(t);n<i.length;n++){var a=i[n],o=t[a];o.firstChange||o.currentValue===o.previousValue||("entityAliasId"===a?(this.searchText="",this.latestSearchTextResult=null,this.dirty=!0):["widgetType","datasourceType"].includes(a)?(this.updateParams(),setTimeout((function(){e.reset()}),1)):["required","optDataKeys"].includes("propName")&&this.updateValidators())}},t.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=this.required&&!this.modelValue;return n||i},t.prototype.ngAfterViewInit=function(){},t.prototype.setDisabledState=function(t){this.disabled=t,this.disabled?this.keysListFormGroup.disable({emitEvent:!1}):this.keysListFormGroup.enable({emitEvent:!1})},t.prototype.writeValue=function(t){this.searchText="",null!=t&&t.length?(this.modelValue=Object(i.l)(t),this.keys=Object(i.l)(t),this.keysListFormGroup.get("keys").setValue(this.keys)):(this.keys=[],this.keysListFormGroup.get("keys").setValue(this.keys),this.modelValue=null),this.dirty=!0},t.prototype.onFocus=function(){this.dirty&&(this.keysListFormGroup.get("key").updateValueAndValidity({onlySelf:!0,emitEvent:!0}),this.dirty=!1)},t.prototype.addFromChipValue=function(t){var e=this.callbacks.generateDataKey(t.name,t.type);this.addKey(e)},t.prototype.addKey=function(t){(!this.maxDataKeys||this.maxDataKeys<0||!this.modelValue||this.modelValue.length<this.maxDataKeys)&&(this.modelValue||(this.modelValue=[]),this.modelValue.push(t),this.keys.push(t),this.keysListFormGroup.get("keys").setValue(this.keys)),this.propagateChange(this.modelValue),this.clear()},t.prototype.add=function(t){var e=t.value;(e||"").trim()&&this.dataKeyType&&this.addFromChipValue({name:e.trim(),type:this.dataKeyType}),this.clear()},t.prototype.remove=function(t){var e=this.keys.indexOf(t);e>=0&&(this.keys.splice(e,1),this.keysListFormGroup.get("keys").setValue(this.keys),this.modelValue.splice(e,1),this.modelValue.length||(this.modelValue=null),this.propagateChange(this.modelValue),this.clear())},t.prototype.onChipDrop=function(t){var e=t.from,n=t.to;this.keys.splice(n,0,this.keys.splice(e,1)[0]),this.keysListFormGroup.get("keys").setValue(this.keys),this.modelValue.splice(n,0,this.modelValue.splice(e,1)[0]),this.propagateChange(this.modelValue)},t.prototype.showColorPicker=function(t){var e=this;this.dialogs.colorPicker(t.color).subscribe((function(n){n&&t.color!==n&&(t.color=n,e.propagateChange(e.modelValue))}))},t.prototype.editDataKey=function(t,e){var n=this;this.dialog.open(ze,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{dataKey:Object(b.d)(t),dataKeySettingsSchema:this.datakeySettingsSchema,entityAliasId:this.entityAliasId,callbacks:this.callbacks}}).afterClosed().subscribe((function(t){t&&(n.keys[e]=t,n.keysListFormGroup.get("keys").setValue(n.keys),n.modelValue[e]=t,n.propagateChange(n.modelValue))}))},t.prototype.createKey=function(t,e){void 0===e&&(e=this.dataKeyType),this.addFromChipValue({name:t,type:e})},t.prototype.displayKeyFn=function(t){return t?t.name:void 0},t.prototype.fetchKeys=function(t){var e=this;if(null===this.latestSearchTextResult||this.searchText!==t){this.searchText=t;var n=null;if(this.datasourceType===Ot.a.function||this.widgetType===Ot.k.alarm){var i=this.createDataKeyFilter(this.searchText),a=this.widgetType===Ot.k.alarm?this.alarmKeys:this.functionTypeKeys;n=Object(X.a)(a.filter(i))}else if(this.entityAliasId){var o=[gt.c.timeseries];this.widgetType===Ot.k.latest&&(o.push(gt.c.attribute),o.push(gt.c.entityField)),n=this.callbacks.fetchEntityKeys(this.entityAliasId,this.searchText,o)}else n=Object(X.a)([]);return n.pipe(Object(H.a)((function(t){return e.latestSearchTextResult=t})))}return Object(X.a)(this.latestSearchTextResult)},t.prototype.createDataKeyFilter=function(t){var e=t.toLowerCase();return function(t){return 0===t.name.toLowerCase().indexOf(e)}},t.prototype.textIsNotEmpty=function(t){return!!(t&&null!=t&&t.length>0)},t.prototype.clear=function(t){var e=this;void 0===t&&(t=""),this.keyInput.nativeElement.value=t,this.keysListFormGroup.get("key").patchValue(t,{emitEvent:!0}),setTimeout((function(){e.keyInput.nativeElement.blur(),e.keyInput.nativeElement.focus()}),0)},t.ctorParameters=function(){return[{type:d.Store},{type:ot.d,decorators:[{type:a.SkipSelf}]},{type:T.TranslateService},{type:Lt.a},{type:F.a},{type:O.MatDialog},{type:u.FormBuilder},{type:De.a}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",String)],t.prototype,"widgetType",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",String)],t.prototype,"datasourceType",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Number)],t.prototype,"maxDataKeys",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],t.prototype,"optDataKeys",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],t.prototype,"aliasController",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],t.prototype,"datakeySettingsSchema",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],t.prototype,"callbacks",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",String)],t.prototype,"entityAliasId",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean),Object(i.g)("design:paramtypes",[Boolean])],t.prototype,"required",null),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],t.prototype,"disabled",void 0),Object(i.c)([Object(a.ViewChild)("keyInput"),Object(i.g)("design:type",a.ElementRef)],t.prototype,"keyInput",void 0),Object(i.c)([Object(a.ViewChild)("keyAutocomplete"),Object(i.g)("design:type",Fe.MatAutocomplete)],t.prototype,"matAutocomplete",void 0),Object(i.c)([Object(a.ViewChild)("chipList"),Object(i.g)("design:type",Pe.MatChipList)],t.prototype,"chipList",void 0),t=e=Object(i.c)([Object(a.Component)({selector:"tb-data-keys",template:Object(i.f)(n("cRoh")).default,providers:[{provide:u.NG_VALUE_ACCESSOR,useExisting:Object(a.forwardRef)((function(){return e})),multi:!0},{provide:ot.d,useExisting:e}],styles:[Object(i.f)(n("FpxQ")).default]}),Object(i.h)(1,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[d.Store,ot.d,T.TranslateService,Lt.a,F.a,O.MatDialog,u.FormBuilder,De.a])],t)}(),Ue=new a.InjectionToken("LegendConfigPanelData"),Ge=function(t){function e(e,n,i,a,o){var r=t.call(this,i)||this;return r.data=e,r.overlayRef=n,r.store=i,r.fb=a,r.viewContainerRef=o,r.legendDirection=Ot.b,r.legendDirections=Object.keys(Ot.b),r.legendDirectionTranslations=Ot.g,r.legendPosition=Ot.c,r.legendPositions=Object.keys(Ot.c),r.legendPositionTranslations=Ot.h,r}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){var t=this;this.legendConfigForm=this.fb.group({direction:[this.data.legendConfig.direction,[]],position:[this.data.legendConfig.position,[]],showMin:[this.data.legendConfig.showMin,[]],showMax:[this.data.legendConfig.showMax,[]],showAvg:[this.data.legendConfig.showAvg,[]],showTotal:[this.data.legendConfig.showTotal,[]]}),this.legendConfigForm.get("direction").valueChanges.subscribe((function(e){t.onDirectionChanged(e)})),this.onDirectionChanged(this.data.legendConfig.direction),this.legendConfigForm.valueChanges.subscribe((function(){t.update()}))},e.prototype.onDirectionChanged=function(t){if(t===Ot.b.row){var e=this.legendConfigForm.get("position").value;e!==Ot.c.bottom&&e!==Ot.c.top&&(e=Ot.c.bottom),this.legendConfigForm.patchValue({position:e},{emitEvent:!1})}},e.prototype.update=function(){var t=this.legendConfigForm.value;this.data.legendConfigUpdated(t)},e.ctorParameters=function(){return[{type:void 0,decorators:[{type:a.Inject,args:[Ue]}]},{type:wt.g},{type:d.Store},{type:u.FormBuilder},{type:a.ViewContainerRef}]},e=Object(i.c)([Object(a.Component)({selector:"tb-legend-config-panel",template:Object(i.f)(n("01JT")).default,styles:[Object(i.f)(n("ztIS")).default]}),Object(i.h)(0,Object(a.Inject)(Ue)),Object(i.g)("design:paramtypes",[Object,wt.g,d.Store,u.FormBuilder,a.ViewContainerRef])],e)}(c.a),He=n("wtyh"),Ke=function(){function t(t,e,n,i,a){this.overlay=t,this.viewContainerRef=e,this.breakpointObserver=n,this.document=i,this.window=a,this.propagateChange=function(t){}}var e;return e=t,t.prototype.ngOnInit=function(){},t.prototype.ngOnDestroy=function(){},t.prototype.openEditMode=function(){if(!this.disabled){var t=this.breakpointObserver.isMatched(L.d["gt-sm"]),e=this.overlay.position(),n=new wt.d({panelClass:"tb-legend-config-panel",backdropClass:"cdk-overlay-transparent-backdrop",hasBackdrop:t});if(t){n.minWidth="220px",n.maxHeight="300px";var i=this.legendConfigPanelOrigin.elementRef.nativeElement.getBoundingClientRect(),a=this.window.pageYOffset||this.document.documentElement.scrollTop||this.document.body.scrollTop||0,o=this.window.pageXOffset||this.document.documentElement.scrollLeft||this.document.body.scrollLeft||0,r=i.bottom-a,s=i.left-o,l=void 0,c=void 0,d=void 0,u=void 0;r+220>this.document.documentElement.clientHeight?(c="top",u="bottom"):(c="bottom",u="top"),s+220>this.document.documentElement.clientWidth?(l="end",d="end"):(l="start",d="start");var h={originX:l,originY:c,overlayX:d,overlayY:u};n.positionStrategy=e.flexibleConnectedTo(this.legendConfigPanelOrigin.elementRef).withPositions([h])}else n.minWidth="100%",n.minHeight="100%",n.positionStrategy=e.global().top("0%").left("0%").right("0%").bottom("0%");var p=this.overlay.create(n);p.backdropClick().subscribe((function(){p.dispose()}));var m=this._createLegendConfigPanelInjector(p,{legendConfig:Object(b.d)(this.innerValue),legendConfigUpdated:this.legendConfigUpdated.bind(this)});p.attach(new Ct.d(Ge,this.viewContainerRef,m))}},t.prototype._createLegendConfigPanelInjector=function(t,e){var n=new WeakMap([[Ue,e],[wt.g,t]]);return new Ct.g(this.viewContainerRef.injector,n)},t.prototype.registerOnChange=function(t){this.propagateChange=t},t.prototype.registerOnTouched=function(t){},t.prototype.setDisabledState=function(t){this.disabled=t},t.prototype.writeValue=function(t){this.innerValue=t},t.prototype.legendConfigUpdated=function(t){this.innerValue=t,this.propagateChange(this.innerValue)},t.ctorParameters=function(){return[{type:wt.c},{type:a.ViewContainerRef},{type:Yt.a},{type:Document,decorators:[{type:a.Inject,args:[o.DOCUMENT]}]},{type:Window,decorators:[{type:a.Inject,args:[He.b]}]}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],t.prototype,"disabled",void 0),Object(i.c)([Object(a.ViewChild)("legendConfigPanelOrigin"),Object(i.g)("design:type",wt.b)],t.prototype,"legendConfigPanelOrigin",void 0),t=e=Object(i.c)([Object(a.Component)({selector:"tb-legend-config",template:Object(i.f)(n("PX9o")).default,providers:[{provide:u.NG_VALUE_ACCESSOR,useExisting:Object(a.forwardRef)((function(){return e})),multi:!0}]}),Object(i.h)(3,Object(a.Inject)(o.DOCUMENT)),Object(i.h)(4,Object(a.Inject)(He.b)),Object(i.g)("design:paramtypes",[wt.c,a.ViewContainerRef,Yt.a,Document,Window])],t)}();var Ye=function(){function t(t,e){this.translate=t,this.utils=e,this.actionsSubject=new Z.a([]),this.pageDataSubject=new Z.a(Object(Q.a)()),this.pageData$=this.pageDataSubject.asObservable()}return t.prototype.connect=function(t){return this.actionsSubject.asObservable()},t.prototype.disconnect=function(t){this.actionsSubject.complete(),this.pageDataSubject.complete()},t.prototype.setActions=function(t){this.actionsMap=t.actionsMap,this.actionSources=t.actionSources},t.prototype.loadActions=function(t,e){var n=this;void 0===e&&(e=!1),e&&(this.allActions=null);var i=new q.a;return this.fetchActions(t).pipe(Object(J.a)((function(){return Object(X.a)(Object(Q.a)())}))).subscribe((function(t){n.actionsSubject.next(t.data),n.pageDataSubject.next(t),i.next(t)})),i},t.prototype.fetchActions=function(t){return this.getAllActions().pipe(Object(tt.a)((function(e){return t.filterData(e)})))},t.prototype.getAllActions=function(){var t=this;if(!this.allActions){for(var e=[],n=function(n){i.actionsMap[n].forEach((function(i){e.push(t.toWidgetActionDescriptorInfo(n,i))}))},i=this,a=0,o=Object.keys(this.actionsMap);a<o.length;a++){n(o[a])}this.allActions=Object(X.a)(e).pipe(Object(et.a)(1),Object(nt.a)())}return this.allActions},t.prototype.toWidgetActionDescriptorInfo=function(t,e){var n=this.actionSources[t],a=n?this.utils.customTranslation(n.name,n.name):t,o=this.translate.instant(Ot.j.get(e.type));return Object(i.a)({actionSourceId:t,actionSourceName:a,typeName:o},e)},t.prototype.isEmpty=function(){return this.actionsSubject.pipe(Object(tt.a)((function(t){return!t.length})))},t.prototype.total=function(){return this.pageDataSubject.pipe(Object(tt.a)((function(t){return t.totalElements})))},t}(),Ze=n("p0Sj"),qe=n("gaqQ"),$e=n("RLvv"),Xe=n("Lm6k"),Qe=Object(i.a)({$event:{meta:"argument",type:"Event",description:"The DOM event that triggered this action."},widgetContext:$e.a.ctx,entityId:{meta:"argument",type:Xe.a,description:"Id of the entity for which the action was triggered.",children:{id:{meta:"property",type:"string",description:"UUID Id string"},entityType:{meta:"property",type:Xe.b,description:"Entity type"}}},entityName:{meta:"argument",type:"string",description:"Name of the entity for which the action was triggered."},additionalParams:{meta:"argument",type:"object",description:"Optional object holding additional information."},entityLabel:{meta:"argument",type:"string",description:"Label of the entity for which the action was triggered."}},Xe.c),Je=Object(i.a)({htmlTemplate:{meta:"argument",type:"string",description:"HTML template used to render custom dialog."}},Qe),tn=new qe.a(Qe),en=new qe.a(Je),nn=function(t){function e(e,n,i,a,o,r,s,l,c){var d=t.call(this,e,n,l)||this;return d.store=e,d.router=n,d.utils=i,d.dashboardService=a,d.dashboardUtils=o,d.data=r,d.errorStateMatcher=s,d.dialogRef=l,d.fb=c,d.widgetActionTypes=Object.keys(Ot.d),d.widgetActionTypeTranslations=Ot.j,d.widgetActionType=Ot.d,d.targetDashboardStateSearchText="",d.customActionEditorCompleter=tn,d.submitted=!1,d.isAdd=r.isAdd,d.isAdd?d.action={id:d.utils.guid(),name:"",icon:"more_horiz",type:null}:d.action=d.data.action,d}var o;return Object(i.d)(e,t),o=e,e.prototype.ngOnInit=function(){var t=this;this.widgetActionFormGroup=this.fb.group({}),this.widgetActionFormGroup.addControl("actionSourceId",this.fb.control(this.action.actionSourceId,[u.Validators.required])),this.widgetActionFormGroup.addControl("name",this.fb.control(this.action.name,[this.validateActionName(),u.Validators.required])),this.widgetActionFormGroup.addControl("icon",this.fb.control(this.action.icon,[u.Validators.required])),this.widgetActionFormGroup.addControl("type",this.fb.control(this.action.type,[u.Validators.required])),this.updateActionTypeFormGroup(this.action.type,this.action),this.widgetActionFormGroup.get("type").valueChanges.subscribe((function(e){t.updateActionTypeFormGroup(e)})),this.widgetActionFormGroup.get("actionSourceId").valueChanges.subscribe((function(){t.widgetActionFormGroup.get("name").updateValueAndValidity()}))},e.prototype.updateActionTypeFormGroup=function(t,e){if(this.actionTypeFormGroup=this.fb.group({}),t)switch(t){case Ot.d.openDashboard:case Ot.d.openDashboardState:case Ot.d.updateDashboardState:this.actionTypeFormGroup.addControl("targetDashboardStateId",this.fb.control(e?e.targetDashboardStateId:null,t===Ot.d.openDashboardState?[u.Validators.required]:[])),this.actionTypeFormGroup.addControl("setEntityId",this.fb.control(!e||e.setEntityId,[])),this.actionTypeFormGroup.addControl("stateEntityParamName",this.fb.control(e?e.stateEntityParamName:null,[])),t===Ot.d.openDashboard?(this.actionTypeFormGroup.addControl("targetDashboardId",this.fb.control(e?e.targetDashboardId:null,[u.Validators.required])),this.setupSelectedDashboardStateIds(e?e.targetDashboardId:null)):this.actionTypeFormGroup.addControl("openRightLayout",this.fb.control(!!e&&e.openRightLayout,[])),this.setupFilteredDashboardStates();break;case Ot.d.custom:this.actionTypeFormGroup.addControl("customFunction",this.fb.control(e?e.customFunction:null,[]));break;case Ot.d.customPretty:this.actionTypeFormGroup.addControl("customAction",this.fb.control(function(t){var e;return(e=!t||Object(b.u)(t.customFunction)&&Object(b.u)(t.customHtml)&&Object(b.u)(t.customCss)?{customHtml:'\x3c!--=======================================================================--\x3e\n\x3c!--=====  There are two example templates: for edit and add entity   =====--\x3e\n\x3c!--=======================================================================--\x3e\n\x3c!--========================  Edit entity example  ========================--\x3e\n\x3c!--=======================================================================--\x3e\n\x3c!-- --\x3e\n\x3c!--<form #editEntityForm="ngForm" [formGroup]="editEntityFormGroup"--\x3e\n\x3c!--      (ngSubmit)="save()"  class="edit-entity-form">--\x3e\n\x3c!--    <mat-toolbar fxLayout="row" color="primary">--\x3e\n\x3c!--        <h2>Edit {{entityType.toLowerCase()}} {{entityName}}</h2>--\x3e\n\x3c!--        <span fxFlex></span>--\x3e\n\x3c!--        <button mat-icon-button (click)="cancel()" type="button">--\x3e\n\x3c!--            <mat-icon class="material-icons">close</mat-icon>--\x3e\n\x3c!--        </button>--\x3e\n\x3c!--    </mat-toolbar>--\x3e\n\x3c!--    <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">--\x3e\n\x3c!--    </mat-progress-bar>--\x3e\n\x3c!--    <div style="height: 4px;" *ngIf="!(isLoading$ | async)"></div>--\x3e\n\x3c!--    <div mat-dialog-content fxLayout="column">--\x3e\n\x3c!--        <div fxLayout="row" fxLayoutGap="8px" fxLayout.xs="column"  fxLayoutGap.xs="0">--\x3e\n\x3c!--            <mat-form-field fxFlex class="mat-block">--\x3e\n\x3c!--                <mat-label>Entity Name</mat-label>--\x3e\n\x3c!--                <input matInput formControlName="entityName" required readonly="">--\x3e\n\x3c!--            </mat-form-field>--\x3e\n\x3c!--            <mat-form-field fxFlex class="mat-block">--\x3e\n\x3c!--                <mat-label>Entity Label</mat-label>--\x3e\n\x3c!--                <input matInput formControlName="entityLabel">--\x3e\n\x3c!--            </mat-form-field>--\x3e\n\x3c!--        </div>--\x3e\n\x3c!--        <div fxLayout="row" fxLayoutGap="8px" fxLayout.xs="column"  fxLayoutGap.xs="0">--\x3e\n\x3c!--            <mat-form-field fxFlex class="mat-block">--\x3e\n\x3c!--                <mat-label>Entity Type</mat-label>--\x3e\n\x3c!--                <input matInput formControlName="entityType" readonly>--\x3e\n\x3c!--            </mat-form-field>--\x3e\n\x3c!--            <mat-form-field fxFlex class="mat-block">--\x3e\n\x3c!--                <mat-label>Type</mat-label>--\x3e\n\x3c!--                <input matInput formControlName="type" readonly>--\x3e\n\x3c!--            </mat-form-field>--\x3e\n\x3c!--        </div>--\x3e\n\x3c!--        <div formGroupName="attributes" fxLayout="column">--\x3e\n\x3c!--            <div fxLayout="row" fxLayoutGap="8px" fxLayout.xs="column"  fxLayoutGap.xs="0">--\x3e\n\x3c!--                <mat-form-field fxFlex class="mat-block">--\x3e\n\x3c!--                    <mat-label>Latitude</mat-label>--\x3e\n\x3c!--                    <input type="number" step="any" matInput formControlName="latitude">--\x3e\n\x3c!--                </mat-form-field>--\x3e\n\x3c!--                <mat-form-field fxFlex class="mat-block">--\x3e\n\x3c!--                    <mat-label>Longitude</mat-label>--\x3e\n\x3c!--                    <input type="number" step="any" matInput formControlName="longitude">--\x3e\n\x3c!--                </mat-form-field>--\x3e\n\x3c!--            </div>--\x3e\n\x3c!--            <div fxLayout="row" fxLayoutGap="8px" fxLayout.xs="column"  fxLayoutGap.xs="0">--\x3e\n\x3c!--                <mat-form-field fxFlex class="mat-block">--\x3e\n\x3c!--                    <mat-label>Address</mat-label>--\x3e\n\x3c!--                    <input matInput formControlName="address">--\x3e\n\x3c!--                </mat-form-field>--\x3e\n\x3c!--                <mat-form-field fxFlex class="mat-block">--\x3e\n\x3c!--                    <mat-label>Owner</mat-label>--\x3e\n\x3c!--                    <input matInput formControlName="owner">--\x3e\n\x3c!--                </mat-form-field>--\x3e\n\x3c!--            </div>--\x3e\n\x3c!--            <div fxLayout="row" fxLayoutGap="8px" fxLayout.xs="column"  fxLayoutGap.xs="0">--\x3e\n\x3c!--                <mat-form-field fxFlex class="mat-block">--\x3e\n\x3c!--                    <mat-label>Integer Value</mat-label>--\x3e\n\x3c!--                    <input type="number" step="1" matInput formControlName="number">--\x3e\n\x3c!--                    <mat-error *ngIf="editEntityFormGroup.get(\'attributes\').get(\'number\').hasError(\'pattern\')">--\x3e\n\x3c!--                        Invalid integer value.--\x3e\n\x3c!--                    </mat-error>--\x3e\n\x3c!--                </mat-form-field>--\x3e\n\x3c!--                <div class="boolean-value-input" fxLayout="column" fxLayoutAlign="center start" fxFlex>--\x3e\n\x3c!--                    <label class="checkbox-label">Boolean Value</label>--\x3e\n\x3c!--                    <mat-checkbox formControlName="booleanValue" style="margin-bottom: 40px;">--\x3e\n\x3c!--                        {{ (editEntityFormGroup.get(\'attributes\').get(\'booleanValue\').value ? "value.true" : "value.false") | translate }}--\x3e\n\x3c!--                    </mat-checkbox>--\x3e\n\x3c!--                </div>--\x3e\n\x3c!--            </div>--\x3e\n\x3c!--        </div>--\x3e\n\x3c!--        <div class="relations-list old-relations">--\x3e\n\x3c!--            <div class="mat-body-1" style="padding-bottom: 10px; color: rgba(0,0,0,0.57);">Relations</div>--\x3e\n\x3c!--            <div class="body" [fxShow]="oldRelations().length">--\x3e\n\x3c!--                <div class="row" fxLayout="row" fxLayoutAlign="start center" formArrayName="oldRelations" --\x3e\n\x3c!--                     *ngFor="let relation of oldRelations().controls; let i = index;">--\x3e\n\x3c!--                    <div [formGroupName]="i" class="mat-elevation-z2" fxFlex fxLayout="row" style="padding: 5px 0 5px 5px;">--\x3e\n\x3c!--                        <div fxFlex fxLayout="column">--\x3e\n\x3c!--                            <div fxLayout="row" fxLayoutGap="8px" fxLayout.xs="column"  fxLayoutGap.xs="0">--\x3e\n\x3c!--                                <mat-form-field class="mat-block" style="min-width: 100px;">--\x3e\n\x3c!--                                    <mat-label>Direction</mat-label>--\x3e\n\x3c!--                                    <mat-select formControlName="direction" name="direction">--\x3e\n\x3c!--                                        <mat-option *ngFor="let direction of entitySearchDirection | keyvalue" [value]="direction.value">--\x3e\n\x3c!--                                            {{ ("relation.search-direction." + direction.value) | translate}}--\x3e\n\x3c!--                                        </mat-option>--\x3e\n\x3c!--                                    </mat-select>--\x3e\n\x3c!--                                    <mat-error *ngIf="relation.get(\'direction\').hasError(\'required\')">--\x3e\n\x3c!--                                        Relation direction is required.--\x3e\n\x3c!--                                    </mat-error>--\x3e\n\x3c!--                                </mat-form-field>--\x3e\n\x3c!--                                <tb-relation-type-autocomplete--\x3e\n\x3c!--                                        fxFlex class="mat-block"--\x3e\n\x3c!--                                        formControlName="relationType"--\x3e\n\x3c!--                                        required="true">--\x3e\n\x3c!--                                </tb-relation-type-autocomplete>--\x3e\n\x3c!--                            </div>--\x3e\n\x3c!--                            <div fxLayout="row" fxLayout.xs="column">--\x3e\n\x3c!--                                <tb-entity-select--\x3e\n\x3c!--                                        fxFlex class="mat-block"--\x3e\n\x3c!--                                        required="true"--\x3e\n\x3c!--                                        formControlName="relatedEntity">--\x3e\n\x3c!--                                </tb-entity-select>--\x3e\n\x3c!--                            </div>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div fxLayout="column" fxLayoutAlign="center center">--\x3e\n\x3c!--                            <button mat-icon-button color="primary"--\x3e\n\x3c!--                                    aria-label="Remove"--\x3e\n\x3c!--                                    type="button"--\x3e\n\x3c!--                                    (click)="removeOldRelation(i)"--\x3e\n\x3c!--                                    matTooltip="Remove relation"--\x3e\n\x3c!--                                    matTooltipPosition="above">--\x3e\n\x3c!--                                <mat-icon>close</mat-icon>--\x3e\n\x3c!--                            </button>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                    </div>--\x3e\n\x3c!--                </div>--\x3e\n\x3c!--            </div>--\x3e\n\x3c!--        </div>--\x3e\n\x3c!--        <div class="relations-list">--\x3e\n\x3c!--            <div class="mat-body-1" style="padding-bottom: 10px; color: rgba(0,0,0,0.57);">New Relations</div>--\x3e\n\x3c!--            <div class="body" [fxShow]="relations().length">--\x3e\n\x3c!--                <div class="row" fxLayout="row" fxLayoutAlign="start center" formArrayName="relations" *ngFor="let relation of relations().controls; let i = index;">--\x3e\n\x3c!--                    <div [formGroupName]="i" class="mat-elevation-z2" fxFlex fxLayout="row" style="padding: 5px 0 5px 5px;">--\x3e\n\x3c!--                        <div fxFlex fxLayout="column">--\x3e\n\x3c!--                            <div fxLayout="row" fxLayoutGap="8px" fxLayout.xs="column"  fxLayoutGap.xs="0">--\x3e\n\x3c!--                                <mat-form-field class="mat-block" style="min-width: 100px;">--\x3e\n\x3c!--                                    <mat-label>Direction</mat-label>--\x3e\n\x3c!--                                    <mat-select formControlName="direction" name="direction">--\x3e\n\x3c!--                                        <mat-option *ngFor="let direction of entitySearchDirection | keyvalue" [value]="direction.value">--\x3e\n\x3c!--                                            {{ ("relation.search-direction." + direction.value) | translate}}--\x3e\n\x3c!--                                        </mat-option>--\x3e\n\x3c!--                                    </mat-select>--\x3e\n\x3c!--                                    <mat-error *ngIf="relation.get(\'direction\').hasError(\'required\')">--\x3e\n\x3c!--                                        Relation direction is required.--\x3e\n\x3c!--                                    </mat-error>--\x3e\n\x3c!--                                </mat-form-field>--\x3e\n\x3c!--                                <tb-relation-type-autocomplete--\x3e\n\x3c!--                                        fxFlex class="mat-block"--\x3e\n\x3c!--                                        formControlName="relationType"--\x3e\n\x3c!--                                        [required]="true">--\x3e\n\x3c!--                                </tb-relation-type-autocomplete>--\x3e\n\x3c!--                            </div>--\x3e\n\x3c!--                            <div fxLayout="row" fxLayout.xs="column">--\x3e\n\x3c!--                                <tb-entity-select--\x3e\n\x3c!--                                        fxFlex class="mat-block"--\x3e\n\x3c!--                                        [required]="true"--\x3e\n\x3c!--                                        formControlName="relatedEntity">--\x3e\n\x3c!--                                </tb-entity-select>--\x3e\n\x3c!--                            </div>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div fxLayout="column" fxLayoutAlign="center center">--\x3e\n\x3c!--                            <button mat-icon-button color="primary"--\x3e\n\x3c!--                                    aria-label="Remove"--\x3e\n\x3c!--                                    type="button"--\x3e\n\x3c!--                                    (click)="removeRelation(i)"--\x3e\n\x3c!--                                    matTooltip="Remove relation"--\x3e\n\x3c!--                                    matTooltipPosition="above">--\x3e\n\x3c!--                                <mat-icon>close</mat-icon>--\x3e\n\x3c!--                            </button>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                    </div>--\x3e\n\x3c!--                </div>--\x3e\n\x3c!--            </div>--\x3e\n\x3c!--            <div>--\x3e\n\x3c!--                <button mat-raised-button color="primary"--\x3e\n\x3c!--                        type="button"--\x3e\n\x3c!--                        (click)="addRelation()"--\x3e\n\x3c!--                        matTooltip="Add Relation"--\x3e\n\x3c!--                        matTooltipPosition="above">--\x3e\n\x3c!--                    Add--\x3e\n\x3c!--                </button>--\x3e\n\x3c!--            </div>--\x3e\n\x3c!--        </div>--\x3e\n\x3c!--    </div>--\x3e\n\x3c!--    <div mat-dialog-actions fxLayout="row" fxLayoutAlign="end center">--\x3e\n\x3c!--        <button mat-button mat-raised-button color="primary"--\x3e\n\x3c!--                type="submit"--\x3e\n\x3c!--                [disabled]="(isLoading$ | async) || editEntityForm.invalid || !editEntityForm.dirty">--\x3e\n\x3c!--            Save--\x3e\n\x3c!--        </button>--\x3e\n\x3c!--        <button mat-button color="primary"--\x3e\n\x3c!--                style="margin-right: 20px;"--\x3e\n\x3c!--                type="button"--\x3e\n\x3c!--                [disabled]="(isLoading$ | async)"--\x3e\n\x3c!--                (click)="cancel()" cdkFocusInitial>--\x3e\n\x3c!--            Cancel--\x3e\n\x3c!--        </button>--\x3e\n\x3c!--    </div>--\x3e\n\x3c!--</form>--\x3e\n\x3c!----\x3e\n\x3c!--========================================================================--\x3e\n\x3c!--=========================  Add entity example  =========================--\x3e\n\x3c!--========================================================================--\x3e\n\x3c!----\x3e\n\x3c!--<form #addEntityForm="ngForm" [formGroup]="addEntityFormGroup"--\x3e\n\x3c!--      (ngSubmit)="save()" class="add-entity-form">--\x3e\n\x3c!--    <mat-toolbar fxLayout="row" color="primary">--\x3e\n\x3c!--        <h2>Add entity</h2>--\x3e\n\x3c!--        <span fxFlex></span>--\x3e\n\x3c!--        <button mat-icon-button (click)="cancel()" type="button">--\x3e\n\x3c!--            <mat-icon class="material-icons">close</mat-icon>--\x3e\n\x3c!--        </button>--\x3e\n\x3c!--    </mat-toolbar>--\x3e\n\x3c!--    <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">--\x3e\n\x3c!--    </mat-progress-bar>--\x3e\n\x3c!--    <div style="height: 4px;" *ngIf="!(isLoading$ | async)"></div>--\x3e\n\x3c!--    <div mat-dialog-content fxLayout="column">--\x3e\n\x3c!--        <div fxLayout="row" fxLayoutGap="8px" fxLayout.xs="column"  fxLayoutGap.xs="0">--\x3e\n\x3c!--            <mat-form-field fxFlex class="mat-block">--\x3e\n\x3c!--                <mat-label>Entity Name</mat-label>--\x3e\n\x3c!--                <input matInput formControlName="entityName" required>--\x3e\n\x3c!--                <mat-error *ngIf="addEntityFormGroup.get(\'entityName\').hasError(\'required\')">--\x3e\n\x3c!--                    Entity name is required.--\x3e\n\x3c!--                </mat-error>--\x3e\n\x3c!--            </mat-form-field>--\x3e\n\x3c!--            <mat-form-field fxFlex class="mat-block">--\x3e\n\x3c!--                <mat-label>Entity Label</mat-label>--\x3e\n\x3c!--                <input matInput formControlName="entityLabel" >--\x3e\n\x3c!--            </mat-form-field>--\x3e\n\x3c!--        </div>--\x3e\n\x3c!--        <div fxLayout="row" fxLayoutGap="8px" fxLayout.xs="column"  fxLayoutGap.xs="0">--\x3e\n\x3c!--            <tb-entity-type-select--\x3e\n\x3c!--                    class="mat-block"--\x3e\n\x3c!--                    formControlName="entityType"--\x3e\n\x3c!--                    [showLabel]="true"--\x3e\n\x3c!--                    [allowedEntityTypes]="allowedEntityTypes"--\x3e\n\x3c!--            ></tb-entity-type-select>--\x3e\n\x3c!--            <tb-entity-subtype-autocomplete--\x3e\n\x3c!--                    fxFlex *ngIf="addEntityFormGroup.get(\'entityType\').value == \'ASSET\'"--\x3e\n\x3c!--                    class="mat-block"--\x3e\n\x3c!--                    formControlName="type"--\x3e\n\x3c!--                    [required]="true"--\x3e\n\x3c!--                    [entityType]="\'ASSET\'"--\x3e\n\x3c!--            ></tb-entity-subtype-autocomplete>--\x3e\n\x3c!--            <tb-entity-subtype-autocomplete--\x3e\n\x3c!--                    fxFlex *ngIf="addEntityFormGroup.get(\'entityType\').value != \'ASSET\'"--\x3e\n\x3c!--                    class="mat-block"--\x3e\n\x3c!--                    formControlName="type"--\x3e\n\x3c!--                    [required]="true"--\x3e\n\x3c!--                    [entityType]="\'DEVICE\'"--\x3e\n\x3c!--            ></tb-entity-subtype-autocomplete>--\x3e\n\x3c!--        </div>--\x3e\n\x3c!--        <div formGroupName="attributes" fxLayout="column">--\x3e\n\x3c!--            <div fxLayout="row" fxLayoutGap="8px" fxLayout.xs="column"  fxLayoutGap.xs="0">--\x3e\n\x3c!--                <mat-form-field fxFlex class="mat-block">--\x3e\n\x3c!--                    <mat-label>Latitude</mat-label>--\x3e\n\x3c!--                    <input type="number" step="any" matInput formControlName="latitude">--\x3e\n\x3c!--                </mat-form-field>--\x3e\n\x3c!--                <mat-form-field fxFlex class="mat-block">--\x3e\n\x3c!--                    <mat-label>Longitude</mat-label>--\x3e\n\x3c!--                    <input type="number" step="any" matInput formControlName="longitude">--\x3e\n\x3c!--                </mat-form-field>--\x3e\n\x3c!--            </div>--\x3e\n\x3c!--            <div fxLayout="row" fxLayoutGap="8px" fxLayout.xs="column"  fxLayoutGap.xs="0">--\x3e\n\x3c!--                <mat-form-field fxFlex class="mat-block">--\x3e\n\x3c!--                    <mat-label>Address</mat-label>--\x3e\n\x3c!--                    <input matInput formControlName="address">--\x3e\n\x3c!--                </mat-form-field>--\x3e\n\x3c!--                <mat-form-field fxFlex class="mat-block">--\x3e\n\x3c!--                    <mat-label>Owner</mat-label>--\x3e\n\x3c!--                    <input matInput formControlName="owner">--\x3e\n\x3c!--                </mat-form-field>--\x3e\n\x3c!--            </div>--\x3e\n\x3c!--            <div fxLayout="row" fxLayoutGap="8px" fxLayout.xs="column"  fxLayoutGap.xs="0">--\x3e\n\x3c!--                <mat-form-field fxFlex class="mat-block">--\x3e\n\x3c!--                    <mat-label>Integer Value</mat-label>--\x3e\n\x3c!--                    <input type="number" step="1" matInput formControlName="number">--\x3e\n\x3c!--                    <mat-error *ngIf="addEntityFormGroup.get(\'attributes\').get(\'number\').hasError(\'pattern\')">--\x3e\n\x3c!--                        Invalid integer value.--\x3e\n\x3c!--                    </mat-error>--\x3e\n\x3c!--                </mat-form-field>--\x3e\n\x3c!--                <div class="boolean-value-input" fxLayout="column" fxLayoutAlign="center start" fxFlex>--\x3e\n\x3c!--                    <label class="checkbox-label">Boolean Value</label>--\x3e\n\x3c!--                    <mat-checkbox formControlName="booleanValue" style="margin-bottom: 40px;">--\x3e\n\x3c!--                        {{ (addEntityFormGroup.get(\'attributes\').get(\'booleanValue\').value ? "value.true" : "value.false") | translate }}--\x3e\n\x3c!--                    </mat-checkbox>--\x3e\n\x3c!--                </div>--\x3e\n\x3c!--            </div>--\x3e\n\x3c!--        </div>--\x3e\n\x3c!--        <div class="relations-list">--\x3e\n\x3c!--            <div class="mat-body-1" style="padding-bottom: 10px; color: rgba(0,0,0,0.57);">Relations</div>--\x3e\n\x3c!--            <div class="body" [fxShow]="relations().length">--\x3e\n\x3c!--                <div class="row" fxLayout="row" fxLayoutAlign="start center" formArrayName="relations" *ngFor="let relation of relations().controls; let i = index;">--\x3e\n\x3c!--                    <div [formGroupName]="i" class="mat-elevation-z2" fxFlex fxLayout="row" style="padding: 5px 0 5px 5px;">--\x3e\n\x3c!--                        <div fxFlex fxLayout="column">--\x3e\n\x3c!--                            <div fxLayout="row" fxLayoutGap="8px" fxLayout.xs="column"  fxLayoutGap.xs="0">--\x3e\n\x3c!--                                <mat-form-field class="mat-block" style="min-width: 100px;">--\x3e\n\x3c!--                                    <mat-label>Direction</mat-label>--\x3e\n\x3c!--                                    <mat-select formControlName="direction" name="direction">--\x3e\n\x3c!--                                        <mat-option *ngFor="let direction of entitySearchDirection | keyvalue" [value]="direction.value">--\x3e\n\x3c!--                                            {{ ("relation.search-direction." + direction.value) | translate}}--\x3e\n\x3c!--                                        </mat-option>--\x3e\n\x3c!--                                    </mat-select>--\x3e\n\x3c!--                                    <mat-error *ngIf="relation.get(\'direction\').hasError(\'required\')">--\x3e\n\x3c!--                                        Relation direction is required.--\x3e\n\x3c!--                                    </mat-error>--\x3e\n\x3c!--                                </mat-form-field>--\x3e\n\x3c!--                                <tb-relation-type-autocomplete--\x3e\n\x3c!--                                        fxFlex class="mat-block"--\x3e\n\x3c!--                                        formControlName="relationType"--\x3e\n\x3c!--                                        [required]="true">--\x3e\n\x3c!--                                </tb-relation-type-autocomplete>--\x3e\n\x3c!--                            </div>--\x3e\n\x3c!--                            <div fxLayout="row" fxLayout.xs="column">--\x3e\n\x3c!--                                <tb-entity-select--\x3e\n\x3c!--                                        fxFlex class="mat-block"--\x3e\n\x3c!--                                        [required]="true"--\x3e\n\x3c!--                                        formControlName="relatedEntity">--\x3e\n\x3c!--                                </tb-entity-select>--\x3e\n\x3c!--                            </div>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                        <div fxLayout="column" fxLayoutAlign="center center">--\x3e\n\x3c!--                            <button mat-icon-button color="primary"--\x3e\n\x3c!--                                    aria-label="Remove"--\x3e\n\x3c!--                                    type="button"--\x3e\n\x3c!--                                    (click)="removeRelation(i)"--\x3e\n\x3c!--                                    matTooltip="Remove relation"--\x3e\n\x3c!--                                    matTooltipPosition="above">--\x3e\n\x3c!--                                <mat-icon>close</mat-icon>--\x3e\n\x3c!--                            </button>--\x3e\n\x3c!--                        </div>--\x3e\n\x3c!--                    </div>--\x3e\n\x3c!--                </div>--\x3e\n\x3c!--            </div>--\x3e\n\x3c!--            <div>--\x3e\n\x3c!--                <button mat-raised-button color="primary"--\x3e\n\x3c!--                        type="button"--\x3e\n\x3c!--                        (click)="addRelation()"--\x3e\n\x3c!--                        matTooltip="Add Relation"--\x3e\n\x3c!--                        matTooltipPosition="above">--\x3e\n\x3c!--                    Add--\x3e\n\x3c!--                </button>--\x3e\n\x3c!--            </div>--\x3e\n\x3c!--        </div>--\x3e\n\x3c!--    </div>--\x3e\n\x3c!--    <div mat-dialog-actions fxLayout="row" fxLayoutAlign="end center">--\x3e\n\x3c!--        <button mat-button mat-raised-button color="primary"--\x3e\n\x3c!--                type="submit"--\x3e\n\x3c!--                [disabled]="(isLoading$ | async) || addEntityForm.invalid || !addEntityForm.dirty">--\x3e\n\x3c!--            Create--\x3e\n\x3c!--        </button>--\x3e\n\x3c!--        <button mat-button color="primary"--\x3e\n\x3c!--                style="margin-right: 20px;"--\x3e\n\x3c!--                type="button"--\x3e\n\x3c!--                [disabled]="(isLoading$ | async)"--\x3e\n\x3c!--                (click)="cancel()" cdkFocusInitial>--\x3e\n\x3c!--            Cancel--\x3e\n\x3c!--        </button>--\x3e\n\x3c!--    </div>--\x3e\n\x3c!--</form>--\x3e\n',customCss:"/*=======================================================================*/\n/*==========  There are two examples: for edit and add entity  ==========*/\n/*=======================================================================*/\n/*========================  Edit entity example  ========================*/\n/*=======================================================================*/\n/*\n.edit-entity-form .boolean-value-input {\n    padding-left: 5px;\n}\n\n.edit-entity-form .boolean-value-input .checkbox-label {\n    margin-bottom: 8px;\n    color: rgba(0,0,0,0.54);\n    font-size: 12px;\n}\n\n.relations-list .header {\n    padding-right: 5px;\n    padding-bottom: 5px;\n    padding-left: 5px;\n}\n\n.relations-list .header .cell {\n    padding-right: 5px;\n    padding-left: 5px;\n    font-size: 12px;\n    font-weight: 700;\n    color: rgba(0, 0, 0, .54);\n    white-space: nowrap;\n}\n\n.relations-list .mat-form-field-infix {\n    width: auto !important;\n}\n\n.relations-list .body {\n    padding-right: 5px;\n    padding-bottom: 15px;\n    padding-left: 5px;\n}\n\n.relations-list .body .row {\n    padding-top: 5px;\n}\n\n.relations-list .body .cell {\n    padding-right: 5px;\n    padding-left: 5px;\n}\n\n.relations-list .body .md-button {\n    margin: 0;\n}\n*/\n/*========================================================================*/\n/*=========================  Add entity example  =========================*/\n/*========================================================================*/\n/*\n.add-entity-form .boolean-value-input {\n    padding-left: 5px;\n}\n\n.add-entity-form .boolean-value-input .checkbox-label {\n    margin-bottom: 8px;\n    color: rgba(0,0,0,0.54);\n    font-size: 12px;\n}\n\n.relations-list .header {\n    padding-right: 5px;\n    padding-bottom: 5px;\n    padding-left: 5px;\n}\n\n.relations-list .header .cell {\n    padding-right: 5px;\n    padding-left: 5px;\n    font-size: 12px;\n    font-weight: 700;\n    color: rgba(0, 0, 0, .54);\n    white-space: nowrap;\n}\n\n.relations-list .mat-form-field-infix {\n    width: auto !important;\n}\n\n.relations-list .body {\n    padding-right: 5px;\n    padding-bottom: 15px;\n    padding-left: 5px;\n}\n\n.relations-list .body .row {\n    padding-top: 5px;\n}\n\n.relations-list .body .cell {\n    padding-right: 5px;\n    padding-left: 5px;\n}\n\n.relations-list .body .md-button {\n    margin: 0;\n}\n*/\n",customFunction:"/*=======================================================================*/\n/*=====  There are three examples: for delete, edit and add entity  =====*/\n/*=======================================================================*/\n/*=======================  Delete entity example  =======================*/\n/*=======================================================================*/\n//\n//let $injector = widgetContext.$scope.$injector;\n//let dialogs = $injector.get(widgetContext.servicesMap.get('dialogs'));\n//let assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\n//let deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\n//\n//openDeleteEntityDialog();\n//\n//function openDeleteEntityDialog() {\n//    let title = 'Delete ' + entityId.entityType.toLowerCase() + ' ' +\n//                 entityName;\n//    let content = 'Are you sure you want to delete the ' +\n//                  entityId.entityType.toLowerCase() + ' ' + entityName + '?';\n//    dialogs.confirm(title, content, 'Cancel', 'Delete').subscribe(\n//        function(result) {\n//            if (result) {\n//                deleteEntity();\n//            }\n//        }\n//    );\n//}\n//\n//function deleteEntity() {\n//    deleteEntityObservable(entityId).subscribe(\n//        function success() {\n//            widgetContext.updateAliases();\n//        },\n//        function fail() {\n//            showErrorDialog();\n//        }\n//    );\n//}\n//\n//function deleteEntityObservable(entityId) {\n//    if (entityId.entityType == \"ASSET\") {\n//        return assetService.deleteAsset(entityId.id);\n//    } else if (entityId.entityType == \"DEVICE\") {\n//        return deviceService.deleteDevice(entityId.id);\n//    }\n//}\n//\n//function showErrorDialog() {\n//    let title = 'Error';\n//    let content = 'An error occurred while deleting the entity. Please try again.';\n//    dialogs.alert(title, content, 'CLOSE').subscribe(\n//        function(result) {}\n//    );\n//}\n//\n/*=======================================================================*/\n/*========================  Edit entity example  ========================*/\n/*=======================================================================*/\n//\n//let $injector = widgetContext.$scope.$injector;\n//let customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\n//let entityService = $injector.get(widgetContext.servicesMap.get('entityService'));\n//let assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\n//let deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\n//let attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\n//let entityRelationService = $injector.get(widgetContext.servicesMap.get('entityRelationService'));\n//\n//openEditEntityDialog();\n//\n//function openEditEntityDialog() {\n//    customDialog.customDialog(htmlTemplate, EditEntityDialogController).subscribe();\n//}\n//\n//function EditEntityDialogController(instance) {\n//    let vm = instance;\n//\n//    vm.entityName = entityName;\n//    vm.entityType = entityId.entityType;\n//    vm.entitySearchDirection = {\n//        from: \"FROM\",\n//        to: \"TO\"\n//    };\n//    vm.attributes = {};\n//    vm.oldRelationsData = [];\n//    vm.relationsToDelete = [];\n//    vm.entity = {};\n//\n//    vm.editEntityFormGroup = vm.fb.group({\n//        entityName: ['', [vm.validators.required]],\n//        entityType: [null],\n//        entityLabel: [null],\n//        type: ['', [vm.validators.required]],\n//        attributes: vm.fb.group({\n//            latitude: [null],\n//            longitude: [null],\n//            address: [null],\n//            owner: [null],\n//            number: [null, [vm.validators.pattern(/^-?[0-9]+$/)]],\n//            booleanValue: [false]\n//        }),\n//        oldRelations: vm.fb.array([]),\n//        relations: vm.fb.array([])\n//    });\n//\n//    getEntityInfo();\n//\n//    vm.cancel = function() {\n//        vm.dialogRef.close(null);\n//    };\n//\n//    vm.relations = function() {\n//        return vm.editEntityFormGroup.get('relations');\n//    };\n//\n//    vm.oldRelations = function() {\n//        return vm.editEntityFormGroup.get('oldRelations');\n//    };\n//\n//    vm.addRelation = function() {\n//        vm.relations().push(vm.fb.group({\n//            relatedEntity: [null, [vm.validators.required]],\n//            relationType: [null, [vm.validators.required]],\n//            direction: [null, [vm.validators.required]]\n//        }));\n//    };\n//\n//    function addOldRelation() {\n//        vm.oldRelations().push(vm.fb.group({\n//            relatedEntity: [{value: null, disabled: true}, [vm.validators.required]],\n//            relationType: [{value: null, disabled: true}, [vm.validators.required]],\n//            direction: [{value: null, disabled: true}, [vm.validators.required]]\n//        }));\n//    }\n//\n//    vm.removeRelation = function(index) {\n//        vm.relations().removeAt(index);\n//        vm.relations().markAsDirty();\n//    };\n//\n//    vm.removeOldRelation = function(index) {\n//        vm.oldRelations().removeAt(index);\n//        vm.relationsToDelete.push(vm.oldRelationsData[index]);\n//        vm.oldRelations().markAsDirty();\n//    };\n//\n//    vm.save = function() {\n//        vm.editEntityFormGroup.markAsPristine();\n//        widgetContext.rxjs.forkJoin([\n//            saveAttributes(entityId),\n//            saveRelations(entityId),\n//            saveEntity()\n//        ]).subscribe(\n//            function () {\n//                widgetContext.updateAliases();\n//                vm.dialogRef.close(null);\n//            }\n//        );\n//    };\n//\n//    function getEntityAttributes(attributes) {\n//        for (var i = 0; i < attributes.length; i++) {\n//            vm.attributes[attributes[i].key] = attributes[i].value;\n//        }\n//    }\n//\n//    function getEntityRelations(relations) {\n//        let relationsFrom = relations[0];\n//        let relationsTo = relations[1];\n//        for (let i=0; i < relationsFrom.length; i++) {\n//            let relation = {\n//                direction: 'FROM',\n//                relationType: relationsFrom[i].type,\n//                relatedEntity: relationsFrom[i].to\n//            };\n//            vm.oldRelationsData.push(relation);\n//            addOldRelation();\n//        }\n//        for (let i=0; i < relationsTo.length; i++) {\n//            let relation = {\n//                direction: 'TO',\n//                relationType: relationsTo[i].type,\n//                relatedEntity: relationsTo[i].from\n//            };\n//            vm.oldRelationsData.push(relation);\n//            addOldRelation();\n//        }\n//    }\n//\n//    function getEntityInfo() {\n//        entityService.getEntity(entityId.entityType, entityId.id).subscribe(function (entity) {\n//            vm.entity = entity;\n//            widgetContext.rxjs.forkJoin([\n//                entityRelationService.findInfoByFrom(entityId),\n//                entityRelationService.findInfoByTo(entityId),\n//                attributeService.getEntityAttributes(entityId, 'SERVER_SCOPE')\n//            ]).subscribe(\n//                function (data) {\n//                    getEntityRelations(data.slice(0,2));\n//                    getEntityAttributes(data[2]);\n//                    vm.editEntityFormGroup.patchValue({\n//                        entityName: vm.entity.name,\n//                        entityType: vm.entityType,\n//                        entityLabel: vm.entity.label,\n//                        type: vm.entity.type,\n//                        attributes: vm.attributes,\n//                        oldRelations: vm.oldRelationsData\n//                    }, {emitEvent: false});\n//                }\n//            );\n//        });\n//    }\n//\n//    function saveEntity() {\n//        const formValues = vm.editEntityFormGroup.value;\n//        if (vm.entity.label !== formValues.entityLabel){\n//            vm.entity.label = formValues.entityLabel;\n//            if (formValues.entityType == 'ASSET') {\n//                return assetService.saveAsset(vm.entity);\n//            } else if (formValues.entityType == 'DEVICE') {\n//                return deviceService.saveDevice(vm.entity);\n//            }\n//        } else {\n//            return widgetContext.rxjs.of([]);\n//        }\n//    }\n//\n//    function saveAttributes(entityId) {\n//        let attributes = vm.editEntityFormGroup.get('attributes').value;\n//        let attributesArray = [];\n//        for (let key in attributes) {\n//            if (attributes[key] !== vm.attributes[key]) {\n//                attributesArray.push({key: key, value: attributes[key]});\n//            }\n//        }\n//        if (attributesArray.length > 0) {\n//            return attributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", attributesArray);\n//        } else {\n//            return widgetContext.rxjs.of([]);\n//        }\n//    }\n//\n//    function saveRelations(entityId) {\n//        let relations = vm.editEntityFormGroup.get('relations').value;\n//        let tasks = [];\n//        for(let i=0; i < relations.length; i++) {\n//            let relation = {\n//                type: relations[i].relationType,\n//                typeGroup: 'COMMON'\n//            };\n//            if (relations[i].direction == 'FROM') {\n//                relation.to = relations[i].relatedEntity;\n//                relation.from = entityId;\n//            } else {\n//                relation.to = entityId;\n//                relation.from = relations[i].relatedEntity;\n//            }\n//            tasks.push(entityRelationService.saveRelation(relation));\n//        }\n//        for (let i=0; i < vm.relationsToDelete.length; i++) {\n//            let relation = {\n//                type: vm.relationsToDelete[i].relationType\n//            };\n//            if (vm.relationsToDelete[i].direction == 'FROM') {\n//                relation.to = vm.relationsToDelete[i].relatedEntity;\n//                relation.from = entityId;\n//            } else {\n//                relation.to = entityId;\n//                relation.from = vm.relationsToDelete[i].relatedEntity;\n//            }\n//            tasks.push(entityRelationService.deleteRelation(relation.from, relation.type, relation.to));\n//        }\n//        if (tasks.length > 0) {\n//            return widgetContext.rxjs.forkJoin(tasks);\n//        } else {\n//            return widgetContext.rxjs.of([]);\n//        }\n//    }\n//}\n//\n/*========================================================================*/\n/*=========================  Add entity example  =========================*/\n/*========================================================================*/\n//\n//let $injector = widgetContext.$scope.$injector;\n//let customDialog = $injector.get(widgetContext.servicesMap.get('customDialog'));\n//let assetService = $injector.get(widgetContext.servicesMap.get('assetService'));\n//let deviceService = $injector.get(widgetContext.servicesMap.get('deviceService'));\n//let attributeService = $injector.get(widgetContext.servicesMap.get('attributeService'));\n//let entityRelationService = $injector.get(widgetContext.servicesMap.get('entityRelationService'));\n//\n//openAddEntityDialog();\n//\n//function openAddEntityDialog() {\n//    customDialog.customDialog(htmlTemplate, AddEntityDialogController).subscribe();\n//}\n//\n//function AddEntityDialogController(instance) {\n//    let vm = instance;\n//\n//    vm.allowedEntityTypes = ['ASSET', 'DEVICE'];\n//    vm.entitySearchDirection = {\n//        from: \"FROM\",\n//        to: \"TO\"\n//    }\n//\n//    vm.addEntityFormGroup = vm.fb.group({\n//      entityName: ['', [vm.validators.required]],\n//      entityType: ['DEVICE'],\n//      entityLabel: [null],\n//      type: ['', [vm.validators.required]],\n//      attributes: vm.fb.group({\n//          latitude: [null],\n//          longitude: [null],\n//          address: [null],\n//          owner: [null],\n//          number: [null, [vm.validators.pattern(/^-?[0-9]+$/)]],\n//          booleanValue: [null]\n//      }),\n//      relations: vm.fb.array([])\n//    });\n//\n//    vm.cancel = function() {\n//        vm.dialogRef.close(null);\n//    };\n//\n//    vm.relations = function() {\n//        return vm.addEntityFormGroup.get('relations');\n//    };\n//\n//    vm.addRelation = function() {\n//        vm.relations().push(vm.fb.group({\n//          relatedEntity: [null, [vm.validators.required]],\n//          relationType: [null, [vm.validators.required]],\n//          direction: [null, [vm.validators.required]]\n//        }));\n//    };\n//\n//    vm.removeRelation = function(index) {\n//        vm.relations().removeAt(index);\n//        vm.relations().markAsDirty();\n//    };\n//\n//    vm.save = function() {\n//        vm.addEntityFormGroup.markAsPristine();\n//        saveEntityObservable().subscribe(\n//            function (entity) {\n//                widgetContext.rxjs.forkJoin([\n//                    saveAttributes(entity.id),\n//                    saveRelations(entity.id)\n//                ]).subscribe(\n//                    function () {\n//                        widgetContext.updateAliases();\n//                        vm.dialogRef.close(null);\n//                    }\n//                );\n//            }\n//        );\n//    };\n//\n//    function saveEntityObservable() {\n//        const formValues = vm.addEntityFormGroup.value;\n//        let entity = {\n//            name: formValues.entityName,\n//            type: formValues.type,\n//            label: formValues.entityLabel\n//        };\n//        if (formValues.entityType == 'ASSET') {\n//            return assetService.saveAsset(entity);\n//        } else if (formValues.entityType == 'DEVICE') {\n//            return deviceService.saveDevice(entity);\n//        }\n//    }\n//\n//    function saveAttributes(entityId) {\n//        let attributes = vm.addEntityFormGroup.get('attributes').value;\n//        let attributesArray = [];\n//        for (let key in attributes) {\n//            if(attributes[key] !== null) {\n//                attributesArray.push({key: key, value: attributes[key]});\n//            }\n//        }\n//        if (attributesArray.length > 0) {\n//            return attributeService.saveEntityAttributes(entityId, \"SERVER_SCOPE\", attributesArray);\n//        } else {\n//            return widgetContext.rxjs.of([]);\n//        }\n//    }\n//\n//    function saveRelations(entityId) {\n//        let relations = vm.addEntityFormGroup.get('relations').value;\n//        let tasks = [];\n//        for(let i=0; i < relations.length; i++) {\n//            let relation = {\n//                type: relations[i].relationType,\n//                typeGroup: 'COMMON'\n//            };\n//            if (relations[i].direction == 'FROM') {\n//                relation.to = relations[i].relatedEntity;\n//                relation.from = entityId;\n//            } else {\n//                relation.to = entityId;\n//                relation.from = relations[i].relatedEntity;\n//            }\n//            tasks.push(entityRelationService.saveRelation(relation));\n//        }\n//        if (tasks.length > 0) {\n//            return widgetContext.rxjs.forkJoin(tasks);\n//        } else {\n//            return widgetContext.rxjs.of([]);\n//        }\n//    }\n//}\n"}:{customHtml:t.customHtml,customCss:t.customCss,customFunction:t.customFunction}).customResources=t&&Object(b.k)(t.customResources)?Object(b.d)(t.customResources):[],e}(e),[u.Validators.required]))}},e.prototype.setupSelectedDashboardStateIds=function(t){var e=this;this.selectedDashboardStateIds=this.actionTypeFormGroup.get("targetDashboardId").valueChanges.pipe(Object(H.a)((function(){e.targetDashboardStateSearchText=""})),Object(Rt.a)((function(t){return t?e.dashboardService.getDashboard(t):Object(X.a)(null)})),Object(tt.a)((function(t){if(t){var n=(t=e.dashboardUtils.validateAndUpdateDashboard(t)).configuration.states;return Object.keys(n)}return[]})))},e.prototype.setupFilteredDashboardStates=function(){var t=this;this.targetDashboardStateSearchText="",this.filteredDashboardStates=this.actionTypeFormGroup.get("targetDashboardStateId").valueChanges.pipe(Object(Ze.a)(""),Object(tt.a)((function(t){return t||""})),Object(Rt.a)((function(e){return t.fetchDashboardStates(e)})))},e.prototype.fetchDashboardStates=function(t){var e=this;return this.targetDashboardStateSearchText=t,this.widgetActionFormGroup.get("type").value===Ot.d.openDashboard?this.selectedDashboardStateIds.pipe(Object(tt.a)((function(n){var i=t?n.filter(e.createFilterForDashboardState(t)):n;return i&&i.length?i:[t]}))):Object(X.a)(this.data.callbacks.fetchDashboardStates(t))},e.prototype.createFilterForDashboardState=function(t){var e=t.toLowerCase();return function(t){return 0===t.toLowerCase().indexOf(e)}},e.prototype.clearTargetDashboardState=function(t){var e=this;void 0===t&&(t=""),this.dashboardStateInput.nativeElement.value=t,this.actionTypeFormGroup.get("targetDashboardStateId").patchValue(t,{emitEvent:!0}),setTimeout((function(){e.dashboardStateInput.nativeElement.blur(),e.dashboardStateInput.nativeElement.focus()}),0)},e.prototype.validateActionName=function(){var t=this;return function(e){var n=e.value;return t.checkActionName(n,t.widgetActionFormGroup.get("actionSourceId").value)?null:{actionNameNotUnique:!0}}},e.prototype.checkActionName=function(t,e){var n=!0;if(t&&e){var i=this.data.actionsData.actionsMap[e];if(i){var a=i.filter((function(e){return e.name===t}));a&&a.length&&a[0].id!==this.action.id&&(n=!1)}}return n},e.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=!!(t&&t.invalid&&this.submitted);return n||i},e.prototype.actionSourceName=function(t){return t?this.utils.customTranslation(t.name,t.name):""},e.prototype.cancel=function(){this.dialogRef.close(null)},e.prototype.save=function(){var t;this.submitted=!0,(t=this.widgetActionFormGroup.get("type").value===Ot.d.customPretty?Object(i.a)(Object(i.a)({},this.widgetActionFormGroup.value),this.actionTypeFormGroup.get("customAction").value):Object(i.a)(Object(i.a)({},this.widgetActionFormGroup.value),this.actionTypeFormGroup.value)).id=this.action.id,this.dialogRef.close(t)},e.ctorParameters=function(){return[{type:d.Store},{type:k.Router},{type:Lt.a},{type:Dt.a},{type:It.a},{type:void 0,decorators:[{type:a.Inject,args:[O.MAT_DIALOG_DATA]}]},{type:ot.d,decorators:[{type:a.SkipSelf}]},{type:O.MatDialogRef},{type:u.FormBuilder}]},Object(i.c)([Object(a.ViewChild)("dashboardStateInput"),Object(i.g)("design:type",a.ElementRef)],e.prototype,"dashboardStateInput",void 0),e=o=Object(i.c)([Object(a.Component)({selector:"tb-widget-action-dialog",template:Object(i.f)(n("l/KY")).default,providers:[{provide:ot.d,useExisting:o}],styles:[Object(i.f)(n("CRDJ")).default]}),Object(i.h)(5,Object(a.Inject)(O.MAT_DIALOG_DATA)),Object(i.h)(6,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[d.Store,k.Router,Lt.a,Dt.a,It.a,Object,ot.d,O.MatDialogRef,u.FormBuilder])],e)}(A.a),an=function(t){function e(e,n,i,a,o){var r=t.call(this,e)||this;r.store=e,r.translate=n,r.utils=i,r.dialog=a,r.dialogs=o,r.textSearchMode=!1,r.viewsInited=!1,r.dirtyValue=!1,r.propagateChange=function(t){};var s={property:"actionSourceName",direction:_.a.ASC};return r.pageLink=new R.b(10,0,null,s),r.dataSource=new Ye(r.translate,r.utils),r.displayedColumns=["actionSourceName","name","icon","typeName","actions"],r}var o;return Object(i.d)(e,t),o=e,e.prototype.ngOnInit=function(){},e.prototype.ngOnDestroy=function(){},e.prototype.ngAfterViewInit=function(){var t=this;Object(W.a)(this.searchInputField.nativeElement,"keyup").pipe(Object(U.a)(150),Object(G.a)(),Object(H.a)((function(){t.paginator.pageIndex=0,t.updateData()}))).subscribe(),this.sort.sortChange.subscribe((function(){return t.paginator.pageIndex=0})),Object(z.a)(this.sort.sortChange,this.paginator.page).pipe(Object(H.a)((function(){return t.updateData()}))).subscribe(),this.viewsInited=!0,this.dirtyValue&&(this.dirtyValue=!1,this.updateData(!0))},e.prototype.updateData=function(t){void 0===t&&(t=!1),this.pageLink.page=this.paginator.pageIndex,this.pageLink.pageSize=this.paginator.pageSize,this.pageLink.sortOrder.property=this.sort.active,this.pageLink.sortOrder.direction=_.a[this.sort.direction.toUpperCase()],this.dataSource.loadActions(this.pageLink,t)},e.prototype.addAction=function(t){this.openWidgetActionDialog(t)},e.prototype.editAction=function(t,e){this.openWidgetActionDialog(t,e)},e.prototype.openWidgetActionDialog=function(t,e){var n=this;void 0===e&&(e=null),t&&t.stopPropagation();var i=null===e,a=null;i||(a=e.actionSourceId);for(var o={},r=0,s=Object.keys(this.innerValue.actionSources);r<s.length;r++){var l=s[r],c=this.innerValue.actionSources[l];if(c.multiple)o[l]=c;else if(i||e.actionSourceId!==l){var d=this.innerValue.actionsMap[l];d&&d.length||(o[l]=c)}else o[l]=c}var u={actionsMap:this.innerValue.actionsMap,actionSources:o};this.dialog.open(nn,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{isAdd:i,callbacks:this.callbacks,actionsData:u,action:Object(b.d)(e)}}).afterClosed().subscribe((function(t){t&&n.saveAction(t,i,a)}))},e.prototype.saveAction=function(t,e,n){var i,a,o=t.actionSourceId,r=function(t){var e=Object(b.d)(t);return delete e.actionSourceId,delete e.actionSourceName,delete e.typeName,e}(t);e?(i=this.getOrCreateTargetActions(o)).push(r):o!==n?((a=(i=this.getOrCreateTargetActions(n)).findIndex((function(t){return t.id===r.id})))>-1&&i.splice(a,1),(i=this.getOrCreateTargetActions(o)).push(r)):(a=(i=this.getOrCreateTargetActions(o)).findIndex((function(t){return t.id===r.id})))>-1&&(i[a]=r);this.onActionsUpdated()},e.prototype.getOrCreateTargetActions=function(t){var e=this.innerValue.actionsMap,n=e[t];return n||(n=[],e[t]=n),n},e.prototype.deleteAction=function(t,e){var n=this;t&&t.stopPropagation();var i=this.translate.instant("widget-config.delete-action-title"),a=this.translate.instant("widget-config.delete-action-text",{actionName:e.name});this.dialogs.confirm(i,a,this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe((function(t){if(t){var i=n.getOrCreateTargetActions(e.actionSourceId),a=i.findIndex((function(t){return t.id===e.id}));a>-1&&(i.splice(a,1),n.onActionsUpdated())}}))},e.prototype.enterFilterMode=function(){var t=this;this.textSearchMode=!0,this.pageLink.textSearch="",setTimeout((function(){t.searchInputField.nativeElement.focus(),t.searchInputField.nativeElement.setSelectionRange(0,0)}),10)},e.prototype.exitFilterMode=function(){this.textSearchMode=!1,this.pageLink.textSearch=null,this.paginator.pageIndex=0,this.updateData()},e.prototype.resetSortAndFilter=function(t){void 0===t&&(t=!0),this.pageLink.textSearch=null,this.paginator.pageIndex=0;var e=this.sort.sortables.get("actionSourceName");this.sort.active=e.id,this.sort.direction="asc",t&&this.updateData(!0)},e.prototype.registerOnChange=function(t){this.propagateChange=t},e.prototype.registerOnTouched=function(t){},e.prototype.setDisabledState=function(t){this.disabled=t},e.prototype.writeValue=function(t){var e=this;this.innerValue=t,this.innerValue&&setTimeout((function(){e.dataSource.setActions(e.innerValue),e.viewsInited?e.resetSortAndFilter(!0):e.dirtyValue=!0}),0)},e.prototype.onActionsUpdated=function(){this.updateData(!0),this.propagateChange(this.innerValue)},e.ctorParameters=function(){return[{type:d.Store},{type:T.TranslateService},{type:Lt.a},{type:O.MatDialog},{type:F.a}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"disabled",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"callbacks",void 0),Object(i.c)([Object(a.ViewChild)("searchInput"),Object(i.g)("design:type",a.ElementRef)],e.prototype,"searchInputField",void 0),Object(i.c)([Object(a.ViewChild)(N.a),Object(i.g)("design:type",N.a)],e.prototype,"paginator",void 0),Object(i.c)([Object(a.ViewChild)(P.a),Object(i.g)("design:type",P.a)],e.prototype,"sort",void 0),e=o=Object(i.c)([Object(a.Component)({selector:"tb-manage-widget-actions",template:Object(i.f)(n("M1nY")).default,providers:[{provide:u.NG_VALUE_ACCESSOR,useExisting:Object(a.forwardRef)((function(){return o})),multi:!0}],styles:[Object(i.f)(n("MRzK")).default]}),Object(i.g)("design:paramtypes",[d.Store,T.TranslateService,Lt.a,O.MatDialog,F.a])],e)}(c.a),on=n("5VLF"),rn=function(t){function e(e,n,i){var o=t.call(this,e)||this;return o.store=e,o.translate=n,o.raf=i,o.actionUpdated=new a.EventEmitter,o.htmlFullscreen=!1,o.cssFullscreen=!1,o.aceEditors=[],o.editorsResizeCafs={},o.setValuesPending=!1,o.customPrettyActionEditorCompleter=en,o}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){this.initAceEditors(),this.setValuesPending&&(this.setAceEditorValues(),this.setValuesPending=!1)},e.prototype.ngOnDestroy=function(){this.aceResize$.disconnect()},e.prototype.ngOnChanges=function(t){for(var e=0,n=Object.keys(t);e<n.length;e++){var i=n[e];t[i];"action"===i&&(this.aceEditors.length?this.setAceEditorValues():this.setValuesPending=!0)}},e.prototype.notifyActionUpdated=function(){this.actionUpdated.emit(this.validate()?this.action:null)},e.prototype.validate=function(){if(this.action.customResources)for(var t=0,e=this.action.customResources;t<e.length;t++){if(!e[t].url)return!1}return!0},e.prototype.addResource=function(){this.action.customResources||(this.action.customResources=[]),this.action.customResources.push({url:""}),this.notifyActionUpdated()},e.prototype.removeResource=function(t){t>-1&&this.action.customResources.splice(t,1).length>0&&this.notifyActionUpdated()},e.prototype.beautifyCss=function(){var t=Object(on.css_beautify)(this.action.customCss,{indent_size:4});this.action.customCss!==t&&(this.action.customCss=t,this.cssEditor.setValue(this.action.customCss?this.action.customCss:"",-1),this.notifyActionUpdated())},e.prototype.beautifyHtml=function(){var t=Object(on.html_beautify)(this.action.customHtml,{indent_size:4,wrap_line_length:60});this.action.customHtml!==t&&(this.action.customHtml=t,this.htmlEditor.setValue(this.action.customHtml?this.action.customHtml:"",-1),this.notifyActionUpdated())},e.prototype.initAceEditors=function(){var t=this;this.aceResize$=new $t.a((function(e){e.forEach((function(e){var n=t.aceEditors.find((function(t){return t.container===e.target}));t.onAceEditorResize(n)}))})),this.htmlEditor=this.createAceEditor(this.htmlInputElmRef,"html"),this.htmlEditor.on("input",(function(){var e=t.htmlEditor.getValue();t.action.customHtml!==e&&(t.action.customHtml=e,t.notifyActionUpdated())})),this.cssEditor=this.createAceEditor(this.cssInputElmRef,"css"),this.cssEditor.on("input",(function(){var e=t.cssEditor.getValue();t.action.customCss!==e&&(t.action.customCss=e,t.notifyActionUpdated())}))},e.prototype.createAceEditor=function(t,e){var n=t.nativeElement,a={mode:"ace/mode/"+e,showGutter:!0,showPrintMargin:!0};a=Object(i.a)(Object(i.a)({},a),{enableSnippets:!0,enableBasicAutocompletion:!0,enableLiveAutocompletion:!0});var o=I.edit(n,a);return o.session.setUseWrapMode(!0),this.aceEditors.push(o),this.aceResize$.observe(n),o},e.prototype.setAceEditorValues=function(){this.htmlEditor.setValue(this.action.customHtml?this.action.customHtml:"",-1),this.cssEditor.setValue(this.action.customCss?this.action.customCss:"",-1)},e.prototype.onAceEditorResize=function(t){this.editorsResizeCafs[t.id]&&(this.editorsResizeCafs[t.id](),delete this.editorsResizeCafs[t.id]),this.editorsResizeCafs[t.id]=this.raf.raf((function(){t.resize(),t.renderer.updateFull()}))},e.ctorParameters=function(){return[{type:d.Store},{type:T.TranslateService},{type:re.a}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"action",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"hasCustomFunction",void 0),Object(i.c)([Object(a.Output)(),Object(i.g)("design:type",a.EventEmitter)],e.prototype,"actionUpdated",void 0),Object(i.c)([Object(a.ViewChild)("htmlInput",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"htmlInputElmRef",void 0),Object(i.c)([Object(a.ViewChild)("cssInput",{static:!0}),Object(i.g)("design:type",a.ElementRef)],e.prototype,"cssInputElmRef",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-custom-action-pretty-resources-tabs",template:Object(i.f)(n("ZGXP")).default,encapsulation:a.ViewEncapsulation.None,styles:[Object(i.f)(n("FoVK")).default]}),Object(i.g)("design:paramtypes",[d.Store,T.TranslateService,re.a])],e)}(c.a),sn=n("dzgT"),ln=function(t){function e(e){var n=t.call(this,e)||this;return n.store=e,n.fullscreen=!1,n.customPrettyActionEditorCompleter=en,n.propagateChange=function(t){},n}var o;return Object(i.d)(e,t),o=e,e.prototype.ngOnInit=function(){},e.prototype.ngAfterViewInit=function(){var t=this;Object(sn.b)(this.leftPanelElmRef.changes,this.rightPanelElmRef.changes).subscribe((function(){t.leftPanelElmRef.length&&t.rightPanelElmRef.length&&t.initSplitLayout(t.leftPanelElmRef.first.nativeElement,t.rightPanelElmRef.first.nativeElement)}))},e.prototype.initSplitLayout=function(t,e){Split([t,e],{sizes:[50,50],gutterSize:8,cursor:"col-resize"})},e.prototype.ngOnDestroy=function(){},e.prototype.registerOnChange=function(t){this.propagateChange=t},e.prototype.registerOnTouched=function(t){},e.prototype.setDisabledState=function(t){this.disabled=t},e.prototype.writeValue=function(t){this.action=t},e.prototype.onActionUpdated=function(t){void 0===t&&(t=!0),t?this.propagateChange(this.action):this.propagateChange(null)},e.ctorParameters=function(){return[{type:d.Store}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"disabled",void 0),Object(i.c)([Object(a.ViewChildren)("leftPanel"),Object(i.g)("design:type",a.QueryList)],e.prototype,"leftPanelElmRef",void 0),Object(i.c)([Object(a.ViewChildren)("rightPanel"),Object(i.g)("design:type",a.QueryList)],e.prototype,"rightPanelElmRef",void 0),e=o=Object(i.c)([Object(a.Component)({selector:"tb-custom-action-pretty-editor",template:Object(i.f)(n("UePS")).default,providers:[{provide:u.NG_VALUE_ACCESSOR,useExisting:Object(a.forwardRef)((function(){return o})),multi:!0}],encapsulation:a.ViewEncapsulation.None,styles:[Object(i.f)(n("eAUg")).default]}),Object(i.g)("design:paramtypes",[d.Store])],e)}(c.a),cn=n("txsh"),dn=n("9HAa"),un=n("ou6H"),hn=n("XCsc"),pn=n("z3OR"),mn=function(){function t(t,e){this.elementRef=t,this.store=e,this.dataSource=new gn,this.displayedColumns=["order","sampleData","type","key"],this.columnTypes=[],this.columnTypesTranslations=pn.e,this.valid=!0,this.propagateChangePending=!1,this.propagateChange=null}var e;return e=t,t.prototype.ngOnInit=function(){switch(this.columnTypes.push({value:pn.a.name},{value:pn.a.type},{value:pn.a.label},{value:pn.a.description}),this.entityType){case m.b.DEVICE:this.columnTypes.push({value:pn.a.sharedAttribute},{value:pn.a.serverAttribute},{value:pn.a.timeseries},{value:pn.a.accessToken},{value:pn.a.isGateway});break;case m.b.ASSET:this.columnTypes.push({value:pn.a.serverAttribute},{value:pn.a.timeseries})}},t.prototype.registerOnChange=function(t){this.propagateChange=t,this.propagateChangePending&&(this.propagateChange(this.columns),this.propagateChangePending=!1)},t.prototype.registerOnTouched=function(t){},t.prototype.setDisabledState=function(t){this.disabled=t},t.prototype.columnsUpdated=function(){var t=this,e=this.columns.findIndex((function(t){return t.type===pn.a.name}))>-1,n=this.columns.findIndex((function(t){return t.type===pn.a.type}))>-1,i=this.columns.findIndex((function(t){return t.type===pn.a.label}))>-1,a=this.columns.findIndex((function(t){return t.type===pn.a.accessToken}))>-1,o=this.columns.findIndex((function(t){return t.type===pn.a.isGateway}))>-1,r=this.columns.findIndex((function(t){return t.type===pn.a.description}))>-1,s=this.columns.findIndex((function(e){return!t.columnValid(e)}))>-1;this.valid=e&&n&&!s,this.columnTypes.find((function(t){return t.value===pn.a.name})).disabled=e,this.columnTypes.find((function(t){return t.value===pn.a.type})).disabled=n,this.columnTypes.find((function(t){return t.value===pn.a.label})).disabled=i,this.columnTypes.find((function(t){return t.value===pn.a.description})).disabled=r;var l=this.columnTypes.find((function(t){return t.value===pn.a.isGateway}));l&&(l.disabled=o);var c=this.columnTypes.find((function(t){return t.value===pn.a.accessToken}));c&&(c.disabled=a),this.propagateChange?this.propagateChange(this.columns):this.propagateChangePending=!0},t.prototype.isColumnTypeDiffers=function(t){return t===pn.a.clientAttribute||t===pn.a.sharedAttribute||t===pn.a.serverAttribute||t===pn.a.timeseries},t.prototype.columnValid=function(t){return!!pn.f.includes(t.type)||t.key&&t.key.trim().length>0},t.prototype.validate=function(t){return this.valid?null:{columnsInvalid:!0}},t.prototype.writeValue=function(t){this.columns=t,this.dataSource.setColumns(this.columns),this.columnsUpdated()},t.ctorParameters=function(){return[{type:a.ElementRef},{type:d.Store}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",String)],t.prototype,"entityType",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],t.prototype,"disabled",void 0),t=e=Object(i.c)([Object(a.Component)({selector:"tb-table-columns-assignment",template:Object(i.f)(n("zOCL")).default,providers:[{provide:u.NG_VALUE_ACCESSOR,useExisting:Object(a.forwardRef)((function(){return e})),multi:!0},{provide:u.NG_VALIDATORS,useExisting:Object(a.forwardRef)((function(){return e})),multi:!0}],styles:[Object(i.f)(n("gMhB")).default]}),Object(i.g)("design:paramtypes",[a.ElementRef,d.Store])],t)}(),gn=function(){function t(){this.columnsSubject=new Z.a([])}return t.prototype.connect=function(t){return this.columnsSubject.asObservable()},t.prototype.disconnect=function(t){this.columnsSubject.complete()},t.prototype.setColumns=function(t){this.columnsSubject.next(t)},t}(),fn=n("wst2"),bn=function(){function t(){}return t=Object(i.c)([Object(a.NgModule)({declarations:[l.a,s.a,h,y,w.a,v.a,E,C,M,lt,st,Ee,dt,mt,Vt,vt,St,ve,we,Le.a,xe.a,Xt,fe,be,_e,Ae,ke,Re,Be,We,ze,Ge,Ke,an,nn,rn,ln,cn.a,un.a,hn.a,Ft.a,Mt,Pt,mn],imports:[o.CommonModule,r.a,fn.a],exports:[l.a,s.a,h,y,w.a,M,lt,Ee,mt,Vt,we,Le.a,xe.a,Xt,fe,be,_e,Ae,ke,Re,Be,We,ze,Ke,an,nn,rn,ln,cn.a,un.a,hn.a,mn,Ft.a,Mt],providers:[oe.a,de.a,dn.a]})],t)}()},G6Sg:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form [formGroup]="layoutsFormGroup" (ngSubmit)="save()">\n  <mat-toolbar color="primary">\n    <h2 translate>layout.manage</h2>\n    <span fxFlex></span>\n    <button mat-button mat-icon-button\n      (click)="cancel()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div mat-dialog-content>\n    <fieldset [disabled]="isLoading$ | async" fxLayout="column" fxLayoutGap="8px">\n      <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="8px">\n        <mat-checkbox fxFlex formControlName="main">\n          {{ \'layout.main\' | translate }}\n        </mat-checkbox>\n        <mat-checkbox fxFlex formControlName="right">\n          {{ \'layout.right\' | translate }}\n        </mat-checkbox>\n      </div>\n      <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="8px">\n        <button fxFlex\n                type="button" mat-raised-button color="primary"\n                class="tb-layout-button"\n                (click)="openLayoutSettings(\'main\')">\n          <span translate>layout.main</span>\n        </button>\n        <button fxFlex [fxShow]="layoutsFormGroup.get(\'right\').value"\n                type="button" mat-raised-button color="primary"\n                class="tb-layout-button"\n                (click)="openLayoutSettings(\'right\')">\n          <span translate>layout.right</span>\n        </button>\n      </div>\n    </fieldset>\n  </div>\n  <div mat-dialog-actions fxLayoutAlign="end center">\n    <button mat-raised-button color="primary"\n            type="submit"\n            [disabled]="(isLoading$ | async) || layoutsFormGroup.invalid || !layoutsFormGroup.dirty">\n      {{ \'action.save\' | translate }}\n    </button>\n    <button mat-button\n            color="primary"\n            type="button"\n            [disabled]="(isLoading$ | async)"\n            (click)="cancel()" cdkFocusInitial>\n      {{ \'action.cancel\' | translate }}\n    </button>\n  </div>\n</form>\n'},G8Aa:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n("mrSG"),a=n("QJY3"),o=n("RxGS"),r=n("TYT/"),s=n("6onV"),l=function(t){function e(e,n,i,a){var o=t.call(this,e)||this;return o.store=e,o.fb=n,o.entityValue=i,o.entitiesTableConfigValue=a,o.entityAction=new r.EventEmitter,o.entityForm=o.buildForm(o.entityValue),o}return Object(i.d)(e,t),Object.defineProperty(e.prototype,"entitiesTableConfig",{get:function(){return this.entitiesTableConfigValue},set:function(t){this.setEntitiesTableConfig(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isEdit",{get:function(){return this.isEditValue},set:function(t){this.isEditValue=t,this.updateFormState()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAdd",{get:function(){return this.entityValue&&!this.entityValue.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"entity",{get:function(){return this.entityValue},set:function(t){this.entityValue=t,this.entityForm&&(this.entityForm.reset(void 0,{emitEvent:!1}),this.entityForm.markAsPristine(),this.updateForm(t))},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){},e.prototype.onEntityAction=function(t,e){var n={event:t,action:e,entity:this.entity},i=!1;this.entitiesTableConfig&&(i=this.entitiesTableConfig.onEntityAction(n)),i||this.entityAction.emit(n)},e.prototype.updateFormState=function(){this.entityForm&&(this.isEditValue?this.entityForm.enable({emitEvent:!1}):this.entityForm.disable({emitEvent:!1}))},e.prototype.entityFormValue=function(){var t=this.entityForm?Object(i.a)({},this.entityForm.getRawValue()):{};return this.prepareFormValue(t)},e.prototype.prepareFormValue=function(t){return t},e.prototype.setEntitiesTableConfig=function(t){this.entitiesTableConfigValue=t},e.ctorParameters=function(){return[{type:s.Store},{type:a.FormBuilder},{type:void 0},{type:void 0}]},Object(i.c)([Object(r.Input)(),Object(i.g)("design:type",Object),Object(i.g)("design:paramtypes",[Object])],e.prototype,"entitiesTableConfig",null),Object(i.c)([Object(r.Input)(),Object(i.g)("design:type",Boolean),Object(i.g)("design:paramtypes",[Boolean])],e.prototype,"isEdit",null),Object(i.c)([Object(r.Input)(),Object(i.g)("design:type",Object),Object(i.g)("design:paramtypes",[Object])],e.prototype,"entity",null),Object(i.c)([Object(r.Output)(),Object(i.g)("design:type",Object)],e.prototype,"entityAction",void 0),e=Object(i.c)([Object(r.Directive)(),Object(i.g)("design:paramtypes",[s.Store,a.FormBuilder,Object,Object])],e)}(o.a)},GWMJ:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div class="tb-table-widget tb-absolute-fill">\n  <div fxFlex fxLayout="column" class="tb-absolute-fill">\n    <mat-toolbar class="mat-table-toolbar" [fxShow]="textSearchMode">\n      <div class="mat-toolbar-tools">\n        <button mat-button mat-icon-button\n                matTooltip="{{ \'action.search\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>search</mat-icon>\n        </button>\n        <mat-form-field fxFlex>\n          <mat-label>&nbsp;</mat-label>\n          <input #searchInput matInput\n                 [(ngModel)]="textSearch"\n                 placeholder="{{ \'widget.search-data\' | translate }}"/>\n        </mat-form-field>\n        <button mat-button mat-icon-button (click)="exitFilterMode()"\n                matTooltip="{{ \'action.close\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>close</mat-icon>\n        </button>\n      </div>\n    </mat-toolbar>\n    <mat-tab-group [ngClass]="{\'tb-headless\': sources.length === 1}" fxFlex\n                   [(selectedIndex)]="sourceIndex" (selectedIndexChange)="onSourceIndexChanged()">\n      <mat-tab *ngFor="let source of sources" label="{{ source.datasource.name }}">\n        <div fxFlex class="table-container">\n          <table mat-table [dataSource]="source.timeseriesDatasource" [trackBy]="trackByRowIndex"\n                     matSort [matSortActive]="source.pageLink.sortOrder.property" [matSortDirection]="source.pageLink.sortDirection()" matSortDisableClear>\n            <ng-container *ngIf="showTimestamp" [matColumnDef]="\'0\'">\n              <mat-header-cell *matHeaderCellDef mat-sort-header>Timestamp</mat-header-cell>\n              <mat-cell *matCellDef="let row;"\n                        [innerHTML]="cellContent(source, 0, row, row[0])"\n                        [ngStyle]="cellStyle(source, 0, row[0])">\n              </mat-cell>\n            </ng-container>\n            <ng-container [matColumnDef]="h.index + \'\'" *ngFor="let h of source.header; trackBy: trackByColumnIndex;">\n              <mat-header-cell *matHeaderCellDef mat-sort-header> {{ h.dataKey.label }} </mat-header-cell>\n              <mat-cell *matCellDef="let row;"\n                        [innerHTML]="cellContent(source, h.index, row, row[h.index])"\n                        [ngStyle]="cellStyle(source, h.index, row[h.index])">\n              </mat-cell>\n            </ng-container>\n            <ng-container matColumnDef="actions" stickyEnd>\n              <mat-header-cell *matHeaderCellDef [ngStyle.gt-md]="{ minWidth: (actionCellDescriptors.length * 40) + \'px\',\n                                                                    maxWidth: (actionCellDescriptors.length * 40) + \'px\',\n                                                                    width: (actionCellDescriptors.length * 40) + \'px\' }">\n              </mat-header-cell>\n              <mat-cell *matCellDef="let row" [ngStyle.gt-md]="{ minWidth: (actionCellDescriptors.length * 40) + \'px\',\n                                                                maxWidth: (actionCellDescriptors.length * 40) + \'px\',\n                                                                width: (actionCellDescriptors.length * 40) + \'px\' }">\n                <div fxHide fxShow.gt-md fxFlex fxLayout="row" fxLayoutAlign="end">\n                  <button mat-button mat-icon-button [disabled]="isLoading$ | async"\n                          *ngFor="let actionDescriptor of actionCellDescriptors"\n                          matTooltip="{{ actionDescriptor.displayName }}"\n                          matTooltipPosition="above"\n                          (click)="onActionButtonClick($event, row, actionDescriptor)">\n                    <mat-icon>{{actionDescriptor.icon}}</mat-icon>\n                  </button>\n                </div>\n                <div fxHide fxShow.lt-lg *ngIf="actionCellDescriptors.length">\n                  <button mat-button mat-icon-button\n                          (click)="$event.stopPropagation(); ctx.detectChanges();"\n                          [matMenuTriggerFor]="cellActionsMenu">\n                    <mat-icon class="material-icons">more_vert</mat-icon>\n                  </button>\n                  <mat-menu #cellActionsMenu="matMenu" xPosition="before">\n                    <button mat-menu-item *ngFor="let actionDescriptor of actionCellDescriptors"\n                            [disabled]="isLoading$ | async"\n                            (click)="onActionButtonClick($event, row, actionDescriptor)">\n                      <mat-icon>{{actionDescriptor.icon}}</mat-icon>\n                      <span>{{ actionDescriptor.displayName }}</span>\n                    </button>\n                  </mat-menu>\n                </div>\n              </mat-cell>\n            </ng-container>\n            <mat-header-row *matHeaderRowDef="source.displayedColumns; sticky: true"></mat-header-row>\n            <mat-row *matRowDef="let row; columns: source.displayedColumns;"\n                     (click)="onRowClick($event, row)"></mat-row>\n          </table>\n          <span [fxShow]="source.timeseriesDatasource.isEmpty() | async"\n                fxLayoutAlign="center center"\n                class="no-data-found" translate>widget.no-data-found</span>\n        </div>\n        <mat-divider *ngIf="displayPagination"></mat-divider>\n        <mat-paginator *ngIf="displayPagination"\n                       [length]="source.timeseriesDatasource.total() | async"\n                       [pageIndex]="source.pageLink.page"\n                       [pageSize]="source.pageLink.pageSize"\n                       [pageSizeOptions]="pageSizeOptions"></mat-paginator>\n      </mat-tab>\n    </mat-tab-group>\n  </div>\n</div>\n'},H1JJ:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<mat-toolbar color="primary">\n  <h2 translate>audit-log.audit-log-details</h2>\n  <span fxFlex></span>\n  <button mat-button mat-icon-button\n          [mat-dialog-close]="false"\n          type="button">\n    <mat-icon class="material-icons">close</mat-icon>\n  </button>\n</mat-toolbar>\n<div mat-dialog-content fxLayout="column">\n  <label translate class="tb-title no-padding">audit-log.action-data</label>\n  <div #actionDataEditor class="tb-audit-log-action-data">\n  </div>\n  <span style="min-height: 30px;"></span>\n  <label [fxShow]="displayFailureDetails" translate class="tb-title no-padding">audit-log.failure-details</label>\n  <div #failureDetailsEditor [fxShow]="displayFailureDetails" class="tb-audit-log-failure-details">\n  </div>\n</div>\n<div mat-dialog-actions fxLayoutAlign="end center">\n  <button mat-button color="primary"\n          type="button"\n          [disabled]="(isLoading$ | async)"\n          [mat-dialog-close]="false" cdkFocusInitial>\n    {{ \'action.close\' | translate }}\n  </button>\n</div>\n'},HQ2W:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form style="width: 600px;"\n      [formGroup]="dashboardCustomersFormGroup" (ngSubmit)="submit()">\n  <mat-toolbar fxLayout="row" color="primary">\n    <h2>{{ titleText | translate }}</h2>\n    <span fxFlex></span>\n    <button mat-button mat-icon-button\n            (click)="cancel()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div style="height: 4px;" *ngIf="!(isLoading$ | async)"></div>\n  <div mat-dialog-content>\n    <fieldset [disabled]="isLoading$ | async">\n      <span>{{ labelText | translate }}</span>\n      <tb-entity-list\n        formControlName="assignedCustomerIds"\n        [required]="data.actionType !== \'manage\'"\n        [entityType]="entityType.CUSTOMER">\n      </tb-entity-list>\n    </fieldset>\n  </div>\n  <div mat-dialog-actions fxLayout="row">\n    <span fxFlex></span>\n    <button mat-button mat-raised-button color="primary"\n            type="submit"\n            [disabled]="(isLoading$ | async) || dashboardCustomersFormGroup.invalid\n            || !dashboardCustomersFormGroup.dirty">\n      {{ actionName | translate }}\n    </button>\n    <button mat-button color="primary"\n            style="margin-right: 20px;"\n            type="button"\n            [disabled]="(isLoading$ | async)"\n            (click)="cancel()" cdkFocusInitial>\n      {{ \'action.cancel\' | translate }}\n    </button>\n  </div>\n</form>\n'},HUB6:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var i=n("mrSG"),a=n("TYT/"),o=n("MqYC"),r=n("ea4N"),s=n("6onV"),l=n("QJY3"),c=n("U3y+"),d=n("YnEf"),u=n("VNr4"),h=n("gmuX"),p=n("DUip"),m=function(t){function e(e,n,i,a,o,r,s){var l=t.call(this,e,n,r)||this;switch(l.store=e,l.router=n,l.data=i,l.dashboardService=a,l.errorStateMatcher=o,l.dialogRef=r,l.fb=s,l.submitted=!1,l.entityType=c.b,l.assignedCustomersIds=i.assignedCustomersIds||[],i.actionType){case"assign":l.titleText="dashboard.assign-to-customers",l.labelText="dashboard.assign-to-customers-text",l.actionName="action.assign";break;case"manage":l.titleText="dashboard.manage-assigned-customers",l.labelText="dashboard.assigned-customers",l.actionName="action.update";break;case"unassign":l.titleText="dashboard.unassign-from-customers",l.labelText="dashboard.unassign-from-customers-text",l.actionName="action.unassign"}return l}var h;return Object(i.d)(e,t),h=e,e.prototype.ngOnInit=function(){this.dashboardCustomersFormGroup=this.fb.group({assignedCustomerIds:[Object(i.l)(this.assignedCustomersIds)]})},e.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=!!(t&&t.invalid&&this.submitted);return n||i},e.prototype.cancel=function(){this.dialogRef.close(!1)},e.prototype.submit=function(){var t=this;this.submitted=!0;var e=this.dashboardCustomersFormGroup.get("assignedCustomerIds").value,n=[];this.data.dashboardIds.forEach((function(i){n.push(t.getManageDashboardCustomersTask(i,e))})),Object(u.a)(n).subscribe((function(){t.dialogRef.close(!0)}))},e.prototype.getManageDashboardCustomersTask=function(t,e){switch(this.data.actionType){case"assign":return this.dashboardService.addDashboardCustomers(t,e);case"manage":return this.dashboardService.updateDashboardCustomers(t,e);case"unassign":return this.dashboardService.removeDashboardCustomers(t,e)}},e.ctorParameters=function(){return[{type:s.Store},{type:p.Router},{type:void 0,decorators:[{type:a.Inject,args:[r.MAT_DIALOG_DATA]}]},{type:d.a},{type:o.d,decorators:[{type:a.SkipSelf}]},{type:r.MatDialogRef},{type:l.FormBuilder}]},e=h=Object(i.c)([Object(a.Component)({selector:"tb-manage-dashboard-customers-dialog",template:Object(i.f)(n("HQ2W")).default,providers:[{provide:o.d,useExisting:h}]}),Object(i.h)(2,Object(a.Inject)(r.MAT_DIALOG_DATA)),Object(i.h)(4,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[s.Store,p.Router,Object,d.a,o.d,r.MatDialogRef,l.FormBuilder])],e)}(h.a)},Hl1W:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"d",(function(){return k})),n.d(e,"b",(function(){return E})),n.d(e,"c",(function(){return j}));var i,a=n("mrSG"),o=n("4R65"),r=n.n(o),s=(n("5eAj"),n("cxmq"),n("seHC")),l=n("Zss7"),c=n.n(l),d=n("//Q6"),u=function(){function t(t,e,n,i,a){var o=this;this.settings=e,this.setDataSources(n,i),this.leafletMarker=r.a.marker(t,{draggable:e.draggableMarker}),this.markerOffset=[Object(d.k)(e.markerOffsetX)?e.markerOffsetX:.5,Object(d.k)(e.markerOffsetY)?e.markerOffsetY:1],this.createMarkerIcon((function(t){o.leafletMarker.setIcon(t.icon),o.tooltipOffset=[0,-t.size[1]*o.markerOffset[1]+10],o.updateMarkerLabel(e)})),e.showTooltip&&(this.tooltip=Object(s.d)(this.leafletMarker,e,n.$datasource),this.updateMarkerTooltip(n)),this.settings.markerClick&&this.leafletMarker.on("click",(function(t){for(var e in o.settings.markerClick)"function"==typeof o.settings.markerClick[e]&&o.settings.markerClick[e](t.originalEvent,o.data.$datasource)})),a&&this.leafletMarker.on("dragend",(function(t){return a(t,o.data)}))}return t.prototype.setDataSources=function(t,e){this.data=t,this.dataSources=e},t.prototype.updateMarkerTooltip=function(t){var e=this.settings.useTooltipFunction?Object(s.m)(this.settings.tooltipFunction,[this.data,this.dataSources,this.data.dsIndex]):this.settings.tooltipPattern;this.tooltip.setContent(s.l.parseTemplate(e,t,!0)),this.tooltip.isOpen()&&this.tooltip.getElement()&&Object(s.b)(this.tooltip,this.settings,t.$datasource)},t.prototype.updateMarkerPosition=function(t){this.leafletMarker.setLatLng(t)},t.prototype.updateMarkerLabel=function(t){if(this.leafletMarker.unbindTooltip(),t.showLabel){var e=t.useLabelFunction?Object(s.m)(t.labelFunction,[this.data,this.dataSources,this.data.dsIndex]):t.label;t.labelText=s.l.parseTemplate(e,this.data,!0),this.leafletMarker.bindTooltip('<div style="color: '+t.labelColor+';"><b>'+t.labelText+"</b></div>",{className:"tb-marker-label",permanent:!0,direction:"top",offset:this.tooltipOffset})}},t.prototype.updateMarkerColor=function(t){var e=this;this.createDefaultMarkerIcon(t,(function(t){e.leafletMarker.setIcon(t.icon)}))},t.prototype.updateMarkerIcon=function(t){var e=this;this.createMarkerIcon((function(n){e.leafletMarker.setIcon(n.icon),e.tooltipOffset=[0,-n.size[1]*e.markerOffset[1]+10],e.updateMarkerLabel(t)}))},t.prototype.createMarkerIcon=function(t){var e=this;if(this.settings.icon)t({size:[30,30],icon:this.settings.icon});else{var n=this.settings.useMarkerImageFunction?Object(s.m)(this.settings.markerImageFunction,[this.data,this.settings.markerImages,this.dataSources,this.data.dsIndex]):this.settings.currentImage,i=c()(this.settings.useColorFunction?Object(s.m)(this.settings.colorFunction,[this.data,this.dataSources,this.data.dsIndex]):this.settings.color).toHex();n&&n.url?Object(s.a)(n.url).subscribe((function(a){if(a){var o=void 0,s=void 0;a>1?(o=n.size,s=n.size/a):(o=n.size*a,s=n.size);var l=r.a.icon({iconUrl:n.url,iconSize:[o,s],iconAnchor:[o*e.markerOffset[0],s*e.markerOffset[1]],popupAnchor:[0,-s]});t({size:[o,s],icon:l})}else e.createDefaultMarkerIcon(i,t)})):this.createDefaultMarkerIcon(i,t)}},t.prototype.createDefaultMarkerIcon=function(t,e){e({size:[21,34],icon:r.a.icon({iconUrl:"https://chart.apis.google.com/chart?chst=d_map_pin_letter&chld=%E2%80%A2|"+t,iconSize:[21,34],iconAnchor:[21*this.markerOffset[0],34*this.markerOffset[1]],popupAnchor:[0,-34],shadowUrl:"https://chart.apis.google.com/chart?chst=d_map_pin_shadow",shadowSize:[40,37],shadowAnchor:[12,35]})})},t.prototype.removeMarker=function(){},t.prototype.extendBoundsWithMarker=function(t){t.extend(this.leafletMarker.getLatLng())},t.prototype.getMarkerPosition=function(){return this.leafletMarker.getLatLng()},t.prototype.setMarkerPosition=function(t){this.leafletMarker.setLatLng(t)},t}(),h=n("26FU"),p=n("VnD/"),m=(n("owmp"),function(){function t(t,e,n,i,a){this.map=t,this.dataSources=i,this.data=n,this.leafletPoly=r.a.polyline(e,this.getPolyStyle(a)).addTo(this.map),a.usePolylineDecorator&&(this.polylineDecorator=r.a.polylineDecorator(this.leafletPoly,this.getDecoratorSettings(a)).addTo(this.map))}return t.prototype.getDecoratorSettings=function(t){return{patterns:[{offset:t.decoratorOffset,endOffset:t.endDecoratorOffset,repeat:t.decoratorRepeat,symbol:r.a.Symbol[t.decoratorSymbol]({pixelSize:t.decoratorSymbolSize,polygon:!1,pathOptions:{color:t.useDecoratorCustomColor?t.decoratorCustomColor:this.getPolyStyle(t).color,stroke:!0}})}]}},t.prototype.updatePolyline=function(t,e,n,i){this.data=e,this.dataSources=n,this.leafletPoly.setLatLngs(t),this.leafletPoly.setStyle(this.getPolyStyle(i)),this.polylineDecorator&&this.polylineDecorator.setPaths(this.leafletPoly)},t.prototype.getPolyStyle=function(t){return{interactive:!1,color:t.useColorFunction?Object(s.m)(t.colorFunction,[this.data,this.dataSources,this.data.dsIndex]):t.color,opacity:t.useStrokeOpacityFunction?Object(s.m)(t.strokeOpacityFunction,[this.data,this.dataSources,this.data.dsIndex]):t.strokeOpacity,weight:t.useStrokeWeightFunction?Object(s.m)(t.strokeWeightFunction,[this.data,this.dataSources,this.data.dsIndex]):t.strokeWeight}},t.prototype.removePolyline=function(){this.map.removeLayer(this.leafletPoly)},t.prototype.getPolylineLatLngs=function(){return this.leafletPoly.getLatLngs()},t}()),g=function(){function t(t,e,n,i){var a=this;this.map=t,this.settings=i,this.dataSources=n,this.data=e;var o=this.getPolygonColor(i);this.leafletPoly=r.a.polygon(e[this.settings.polygonKeyName],{fill:!0,fillColor:o,color:i.polygonStrokeColor,weight:i.polygonStrokeWeight,fillOpacity:i.polygonOpacity,opacity:i.polygonStrokeOpacity}).addTo(this.map),i.showPolygonTooltip&&(this.tooltip=Object(s.d)(this.leafletPoly,i,e.$datasource),this.updateTooltip(e)),i.polygonClick&&this.leafletPoly.on("click",(function(t){for(var n in a.settings.polygonClick)"function"==typeof a.settings.polygonClick[n]&&a.settings.polygonClick[n](t.originalEvent,e.datasource)}))}return t.prototype.updateTooltip=function(t){var e=this.settings.usePolygonTooltipFunction?Object(s.m)(this.settings.polygonTooltipFunction,[this.data,this.dataSources,this.data.dsIndex]):this.settings.polygonTooltipPattern;this.tooltip.setContent(s.l.parseTemplate(e,t,!0))},t.prototype.updatePolygon=function(t,e,n){this.data=t,this.dataSources=e,this.leafletPoly.setLatLngs(t[this.settings.polygonKeyName]),n.showPolygonTooltip&&this.updateTooltip(this.data),this.updatePolygonColor(n)},t.prototype.removePolygon=function(){this.map.removeLayer(this.leafletPoly)},t.prototype.updatePolygonColor=function(t){var e={fill:!0,fillColor:this.getPolygonColor(t),color:t.polygonStrokeColor,weight:t.polygonStrokeWeight,fillOpacity:t.polygonOpacity,opacity:t.polygonStrokeOpacity};this.leafletPoly.setStyle(e)},t.prototype.getPolygonLatLngs=function(){return this.leafletPoly.getLatLngs()},t.prototype.setPolygonLatLngs=function(t){this.leafletPoly.setLatLngs(t),this.leafletPoly.redraw()},t.prototype.getPolygonColor=function(t){return t.usePolygonColorFunction?Object(s.m)(t.polygonColorFunction,[this.data,this.dataSources,this.data.dsIndex]):t.polygonColor},t}(),f=function(){function t(t,e,n){var i=this;this.ctx=t,this.$container=e,this.markers=new Map,this.polylines=new Map,this.polygons=new Map,this.map$=new h.a(null),this.ready$=this.map$.pipe(Object(p.a)((function(t){return!!t}))),this.markersData=[],this.dragMarker=function(t,e){void 0===e&&(e={}),"dragend"===t.type&&i.saveMarkerLocation(Object(a.a)(Object(a.a)({},e),i.convertToCustomFormat(t.target._latlng)))},this.options=n}return t.prototype.initSettings=function(t){var e=this,n=t.initCallback,i=t.disableScrollZooming,a=t.useClusterMarkers,r=t.zoomOnClick,s=t.showCoverageOnHover,l=t.removeOutsideVisibleBounds,c=t.animate,d=t.chunkedLoading,u=t.maxClusterRadius,h=t.maxZoom;if(i&&this.map.scrollWheelZoom.disable(),n&&setTimeout(t.initCallback,0),a){var p={zoomToBoundsOnClick:r,showCoverageOnHover:s,removeOutsideVisibleBounds:l,animate:c,chunkedLoading:d};u&&u>0&&(p.maxClusterRadius=Math.floor(u)),h&&h>=0&&h<19&&(p.disableClusteringAtZoom=Math.floor(h)),this.markersCluster=Object(o.markerClusterGroup)(p),this.ready$.subscribe((function(t){return t.addLayer(e.markersCluster)}))}},t.prototype.addMarkerControl=function(){var t=this;if(this.options.draggableMarker){var e,n;this.map.on("mousemove",(function(t){e=t.latlng}));var i=function(i){if("dragend"===i.type&&e){var o=new r.a.Icon.Default;o.options.shadowSize=[0,0];var s=r.a.marker(e,{icon:o}).addTo(t.map),l=document.createElement("div"),c=t.convertToCustomFormat(e);t.datasources.forEach((function(e){var n=document.createElement("p");n.appendChild(document.createTextNode(e.entityName)),n.setAttribute("style","font-size: 14px"),n.onclick=function(){var n=Object(a.a)(Object(a.a)({},e),c);t.saveMarkerLocation(n),t.map.removeLayer(s),t.deleteMarker(e.entityName),t.createMarker(e.entityName,n,t.datasources,t.options)},l.append(n)}));var d=document.createElement("a");d.appendChild(document.createTextNode("Delete position")),d.setAttribute("color","red"),d.onclick=function(){t.map.removeLayer(s)},l.append(d);var u=r.a.popup();u.setContent(l),s.bindPopup(u).openPopup()}n.setPosition("topright")};r.a.Control.AddMarker=r.a.Control.extend({onAdd:function(){var t=r.a.DomUtil.create("img");t.src="assets/add_location.svg",t.style.width="32px",t.style.height="32px",t.title="Drag and drop to add marker",t.onclick=this.dragMarker,t.draggable=!0;var e=new r.a.Draggable(t);return e.enable(),e.on("dragend",i),t},onRemove:function(){},dragMarker:this.dragMarker}),r.a.control.addMarker=function(t){return new r.a.Control.AddMarker(t)},n=r.a.control.addMarker({position:"topright"}).addTo(this.map)}},t.prototype.setMap=function(t){this.map=t,this.options.useDefaultCenterPosition?(this.map.panTo(this.options.defaultCenterPosition),this.bounds=t.getBounds()):this.bounds=new r.a.LatLngBounds(null,null),this.options.draggableMarker&&this.addMarkerControl(),this.map$.next(this.map)},t.prototype.setDataSources=function(t){this.datasources=t},t.prototype.saveMarkerLocation=function(t){},t.prototype.createLatLng=function(t,e){return r.a.latLng(t,e)},t.prototype.createBounds=function(){return this.map.getBounds()},t.prototype.extendBounds=function(t,e){e&&e.getLatLngs()&&e.getBounds()&&t.extend(e.getBounds())},t.prototype.invalidateSize=function(){var t;null===(t=this.map)||void 0===t||t.invalidateSize(!0)},t.prototype.onResize=function(){},t.prototype.getCenter=function(){return this.map.getCenter()},t.prototype.fitBounds=function(t,e){var n=this;t.isValid()&&(this.bounds=this.bounds?this.bounds.extend(t):t,!this.options.fitMapBounds&&this.options.defaultZoomLevel?(this.map.setZoom(this.options.defaultZoomLevel,{animate:!1}),this.options.useDefaultCenterPosition?this.map.panTo(this.options.defaultCenterPosition,{animate:!1}):this.map.panTo(this.bounds.getCenter())):(this.map.once("zoomend",(function(){!n.options.defaultZoomLevel&&n.map.getZoom()>n.options.minZoomLevel&&n.map.setZoom(n.options.minZoomLevel,{animate:!1})})),this.options.useDefaultCenterPosition&&(this.bounds=this.bounds.extend(this.options.defaultCenterPosition)),this.map.fitBounds(this.bounds,{padding:e||[50,50],animate:!1}),this.map.invalidateSize()))},t.prototype.convertPosition=function(t){if(!t)return null;var e=t[this.options.latKeyName],n=t[this.options.lngKeyName];return isNaN(e)||isNaN(n)?null:r.a.latLng(e,n)},t.prototype.convertToCustomFormat=function(t){var e;return(e={})[this.options.latKeyName]=t.lat%90,e[this.options.lngKeyName]=t.lng%180,e},t.prototype.updateMarkers=function(t,e){var n=this;t.filter((function(t){return!!n.convertPosition(t)})).forEach((function(i){if(i.rotationAngle||0===i.rotationAngle){var a=n.options.useMarkerImageFunction?Object(s.m)(n.options.markerImageFunction,[i,n.options.markerImages,t,i.dsIndex]):n.options.currentImage,o=a?"background-image: url("+a.url+");":"";n.options.icon=r.a.divIcon({html:'<div class="arrow"\n                     style="transform: translate(-10px, -10px)\n                     rotate('+i.rotationAngle+"deg);\n                     "+o+'"><div>'})}else n.options.icon=null;n.markers.get(i.entityName)?n.updateMarker(i.entityName,i,t,n.options):n.createMarker(i.entityName,i,t,n.options,e)})),this.markersData=t},t.prototype.createMarker=function(t,e,n,i,a){var o=this;this.ready$.subscribe((function(){var r=new u(o.convertPosition(e),i,e,n,o.dragMarker);a&&r.leafletMarker.on("click",(function(){a(e,!0)})),o.bounds&&o.fitBounds(o.bounds.extend(r.leafletMarker.getLatLng())),o.markers.set(t,r),o.options.useClusterMarkers?o.markersCluster.addLayer(r.leafletMarker):o.map.addLayer(r.leafletMarker)}))},t.prototype.updateMarker=function(t,e,n,i){var a=this.markers.get(t),o=this.convertPosition(e);o.equals(a.location)||a.updateMarkerPosition(o),i.showTooltip&&a.updateMarkerTooltip(e),i.useClusterMarkers&&this.markersCluster.refreshClusters(),a.setDataSources(e,n),a.updateMarkerIcon(i)},t.prototype.deleteMarker=function(t){var e,n=null===(e=this.markers.get(t))||void 0===e?void 0:e.leafletMarker;n&&(this.map.removeLayer(n),this.markers.delete(t),n=null)},t.prototype.updatePoints=function(t,e){var n=this;this.map$.subscribe((function(i){n.points&&i.removeLayer(n.points),n.points=new o.FeatureGroup,t.filter((function(t){return!!n.convertPosition(t)})).forEach((function(t){var i=r.a.circleMarker(n.convertPosition(t),{color:n.options.pointColor,radius:n.options.pointSize});n.options.pointTooltipOnRightPanel?Object(s.d)(i,n.options,t.$datasource,e(t,!1)):i.on("click",(function(){return e(t)})),n.points.addLayer(i)})),i.addLayer(n.points)}))},t.prototype.updatePolylines=function(t,e){var n=this;t.forEach((function(t){var i;e=e||t[0],t.length&&e.entityName===t[0].entityName?n.polylines.get(e.entityName)?n.updatePolyline(e,t,n.options):n.createPolyline(e,t,n.options):e&&n.removePolyline(null===(i=t[0])||void 0===i?void 0:i.entityName)}))},t.prototype.createPolyline=function(t,e,n){var i=this;this.ready$.subscribe((function(){var a=new m(i.map,e.map((function(t){return i.convertPosition(t)})).filter((function(t){return!!t})),t,e,n),o=a.leafletPoly.getBounds();i.fitBounds(o),i.polylines.set(t.entityName,a)}))},t.prototype.updatePolyline=function(t,e,n){var i=this;this.ready$.subscribe((function(){var a=i.polylines.get(t.entityName),o=a.leafletPoly.getBounds();a.updatePolyline(e.map((function(t){return i.convertPosition(t)})).filter((function(t){return!!t})),t,e,n);var r=a.leafletPoly.getBounds();o.toBBoxString()!==r.toBBoxString()&&i.fitBounds(r)}))},t.prototype.removePolyline=function(t){var e=this.polylines.get(t);e&&(this.map.removeLayer(e.leafletPoly),e.polylineDecorator&&this.map.removeLayer(e.polylineDecorator),this.polylines.delete(t))},t.prototype.updatePolygons=function(t){var e=this;t.forEach((function(n){n&&n.hasOwnProperty(e.options.polygonKeyName)&&("string"==typeof n[e.options.polygonKeyName]&&(n[e.options.polygonKeyName]=JSON.parse(n[e.options.polygonKeyName])),e.polygons.get(n.$datasource.entityName)?e.updatePolygon(n,t,e.options):e.createPolygon(n,t,e.options))}))},t.prototype.createPolygon=function(t,e,n){var i=this;this.ready$.subscribe((function(){var a=new g(i.map,t,e,n),o=a.leafletPoly.getBounds();i.fitBounds(o),i.polygons.set(t.$datasource.entityName,a)}))},t.prototype.updatePolygon=function(t,e,n){var i=this;this.ready$.subscribe((function(){var a=i.polygons.get(t.entityName),o=a.leafletPoly.getBounds();a.updatePolygon(t,e,n);var r=a.leafletPoly.getBounds();o.toBBoxString()!==r.toBBoxString()&&i.fitBounds(r)}))},t}(),b=function(t){function e(e,n,i){var a,o,s=t.call(this,e,n,i)||this,l=r.a.map(n).setView(null===(a=i)||void 0===a?void 0:a.defaultCenterPosition,null===(o=i)||void 0===o?void 0:o.defaultZoomLevel);return r.a.tileLayer("http://rt{s}.map.gtimg.com/realtimerender?z={z}&x={x}&y={y}&type=vector&style=0",{subdomains:"0123",tms:!0,attribution:"&copy;2020 Tencent - GS(2018)2236\u53f7- Data&copy; NavInfo"}).addTo(l).addTo(l),t.prototype.setMap.call(s,l),t.prototype.initSettings.call(s,i),s}return Object(a.d)(e,t),e}(f),y=(n("Ksvh"),n("OCOE")),v={},w=function(t){function e(e,n,i){var a=t.call(this,e,n,i)||this;return a.resource=e.$injector.get(y.a),a.loadGoogle((function(){var e,o,s,l=r.a.map(n,{attributionControl:!1}).setView(null===(e=i)||void 0===e?void 0:e.defaultCenterPosition,null===(o=i)||void 0===o?void 0:o.defaultZoomLevel);r.a.gridLayer.googleMutant({type:(null===(s=i)||void 0===s?void 0:s.gmDefaultMapType)||"roadmap"}).addTo(l),t.prototype.setMap.call(a,l)}),i.gmApiKey),t.prototype.initSettings.call(a,i),a}return Object(a.d)(e,t),e.prototype.loadGoogle=function(t,e){void 0===e&&(e="AIzaSyDoEx2kaGz3PxwbI9T7ccTSg5xjdw8Nw8Q"),v[e]?t():this.resource.loadResource("https://maps.googleapis.com/maps/api/js?key="+e).subscribe((function(){v[e]=!0,t()}),(function(t){v[e]=!1,console.error("Google map api load failed!",t)}))},e}(f),x=function(t){function e(e,n,i){var a,o,s=t.call(this,e,n,i)||this,l=r.a.map(n).setView(null===(a=i)||void 0===a?void 0:a.defaultCenterPosition,null===(o=i)||void 0===o?void 0:o.defaultZoomLevel);return r.a.tileLayer.provider(i.mapProviderHere||"HERE.normalDay",i.credentials).addTo(l),t.prototype.setMap.call(s,l),t.prototype.initSettings.call(s,i),s}return Object(a.d)(e,t),e}(f),S=n("S5bw"),C=n("67Y/"),T=n("psW0"),O=n("0lYY"),_=n("3Tyt"),L=function(t){function e(e,n,i){var a=t.call(this,e,n,i)||this;return a.aspect=0,a.width=0,a.height=0,a.posFunction=Object(s.k)(i.posFunction,["origXPos","origYPos"]),a.mapImage(i).subscribe((function(e){a.imageUrl=e.imageUrl,a.aspect=e.aspect,e.update?a.onResize(!0):(a.onResize(),t.prototype.setMap.call(a,a.map),t.prototype.initSettings.call(a,i))})),a}return Object(a.d)(e,t),e.prototype.mapImage=function(t){var e=t.imageEntityAlias,n=t.imageUrlAttribute;if(!e||!n)return this.imageFromUrl(t.mapUrl);var i=this.ctx.aliasController.getEntityAliasId(e);if(!i)return this.imageFromUrl(t.mapUrl);var a=[{type:O.a.entity,name:e,aliasName:e,entityAliasId:i,dataKeys:[{type:_.c.attribute,name:n,label:n,settings:{},_hash:Math.random()}]}],o=new S.a,r=!1,s={datasources:a,useDashboardTimewindow:!1,type:O.k.latest,callbacks:{onDataUpdated:function(t){var e;o.next([null===(e=t.data[0])||void 0===e?void 0:e.data,r]),r=!0}}};return this.ctx.subscriptionApi.createSubscription(s,!0).subscribe((function(){})),this.imageFromAlias(o)},e.prototype.imageFromUrl=function(t){return Object(s.a)(t).pipe(Object(C.a)((function(e){return{imageUrl:t,aspect:e,update:!1}})))},e.prototype.imageFromAlias=function(t){return t.pipe(Object(p.a)((function(t){return t[0].length>0})),Object(T.a)((function(t){var e={imageUrl:t[0][0][1],aspect:null,update:t[1]};return Object(s.a)(e.imageUrl).pipe(Object(C.a)((function(t){return e.aspect=t,e})))})))},e.prototype.updateBounds=function(t,e){var n=this,i=this.width,a=this.height,o=this.pointToLatLng(0,a),s=this.pointToLatLng(i,0),l=new r.a.LatLngBounds(o,s);t&&this.imageOverlay&&(this.imageOverlay.remove(),this.imageOverlay=null),this.imageOverlay?this.imageOverlay.setBounds(l):this.imageOverlay=r.a.imageOverlay(this.imageUrl,l).addTo(this.map);o=this.pointToLatLng(-800,a+800),s=this.pointToLatLng(i+800,-800);var c=new r.a.LatLngBounds(o,s);if(this.map.setMaxBounds(c),e){e.x*=i,e.y*=a;var d=this.pointToLatLng(e.x,e.y);setTimeout((function(){n.map.panTo(d,{animate:!1})}),0)}},e.prototype.onResize=function(t){var e=this.$container.clientWidth;if(e>0&&this.aspect){var n=e/this.aspect,i=this.$container.clientHeight;i>0&&n>i&&(e=(n=i)*this.aspect),e*=4;var a=this.width,o=this.height;if(this.width!==e||t)if(this.width=e,this.height=e/this.aspect,this.map){var r=this.latLngToPoint(this.map.getCenter());r.x/=a,r.y/=o,this.updateBounds(t,r),this.map.invalidateSize(!0),this.updateMarkers(this.markersData)}else this.initMap(t)}},e.prototype.fitBounds=function(t,e){},e.prototype.initMap=function(t){if(!this.map&&this.aspect>0){var e=this.pointToLatLng(this.width/2,this.height/2);this.map=r.a.map(this.$container,{minZoom:1,maxZoom:4,scrollWheelZoom:!this.options.disableScrollZooming,center:e,zoom:1,crs:r.a.CRS.Simple,attributionControl:!1}),this.updateBounds(t)}},e.prototype.convertPosition=function(t){return isNaN(t[this.options.xPosKeyName])||isNaN(t[this.options.yPosKeyName])?null:(Object.assign(t,this.posFunction(t[this.options.xPosKeyName],t[this.options.yPosKeyName])),this.pointToLatLng(t.x*this.width,t.y*this.height))},e.prototype.pointToLatLng=function(t,e){return r.a.CRS.Simple.pointToLatLng({x:t,y:e},3)},e.prototype.latLngToPoint=function(t){return r.a.CRS.Simple.latLngToPoint(t,3)},e.prototype.convertToCustomFormat=function(t){var e,n=this.latLngToPoint(t);return(e={})[this.options.xPosKeyName]=Object(s.c)(n.x,this.width),e[this.options.yPosKeyName]=Object(s.c)(n.y,this.height),e},e}(f),I=function(t){function e(e,n,i){var a,o,s=t.call(this,e,n,i)||this,l=r.a.map(n).setView(null===(a=i)||void 0===a?void 0:a.defaultCenterPosition,null===(o=i)||void 0===o?void 0:o.defaultZoomLevel);return(i.useCustomProvider?r.a.tileLayer(i.customProviderTileUrl):r.a.tileLayer.provider(i.mapProvider||"OpenStreetMap.Mapnik")).addTo(l),t.prototype.setMap.call(s,l),t.prototype.initSettings.call(s,i),s}return Object(a.d)(e,t),e}(f),A=n("3QxM");!function(t){t.google="google-map",t.openstreet="openstreet-map",t.here="here",t.image="image-map",t.tencent="tencent-map"}(i||(i={}));var k={"openstreet-map":{MapClass:I,schema:A.i,name:"openstreet-map"},"tencent-map":{MapClass:b,schema:A.m,name:"tencent-map"},"google-map":{MapClass:w,schema:A.b,name:"google-map"},here:{MapClass:x,schema:A.c,name:"here"},"image-map":{MapClass:L,schema:A.d,name:"image-map"}},E={xPosKeyName:"xPos",yPosKeyName:"yPos",markerOffsetX:.5,markerOffsetY:1,latKeyName:"latitude",lngKeyName:"longitude",polygonKeyName:"coordinates",showLabel:!1,label:"${entityName}",showTooltip:!1,useDefaultCenterPosition:!1,showTooltipAction:"click",autocloseTooltip:!1,showPolygon:!1,labelColor:"#000000",color:"#FE7569",polygonColor:"#0000ff",polygonStrokeColor:"#fe0001",polygonOpacity:.5,polygonStrokeOpacity:1,polygonStrokeWeight:1,useLabelFunction:!1,markerImages:[],strokeWeight:2,strokeOpacity:1,initCallback:function(){},defaultZoomLevel:8,disableScrollZooming:!1,minZoomLevel:16,credentials:"",markerClusteringSetting:null,draggableMarker:!1,fitMapBounds:!0},j=["HERE.normalDay","HERE.normalNight","HERE.hybridDay","HERE.terrainDay"]},IktG:function(t,e,n){"use strict";function i(t){return!(!t||!t.assignedCustomers)&&t.assignedCustomers.filter((function(t){return t.public})).length>0}function a(t){return t&&t.assignedCustomers&&t.assignedCustomers.length>0?t.assignedCustomers.filter((function(t){return!t.public})).map((function(t){return t.title})).join(", "):""}function o(t,e){return!!(e&&t&&t.assignedCustomers)&&t.assignedCustomers.filter((function(t){return t.public&&e===t.customerId.id})).length>0}n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return o}))},JIWx:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n.trip-animation-widget {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  font-size: 16px;\n  line-height: 24px;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-direction: column;\n      flex-direction: column;\n}\n.trip-animation-widget .trip-animation-label-container {\n  height: 24px;\n}\n.trip-animation-widget .trip-animation-container {\n  position: relative;\n  z-index: 1;\n  -ms-flex: 1;\n      flex: 1;\n  width: 100%;\n}\n.trip-animation-widget .trip-animation-container .map {\n  width: 100%;\n  height: 100%;\n}\n.trip-animation-widget .trip-animation-container .trip-animation-info-panel {\n  position: absolute;\n  top: 0;\n  right: 0;\n  pointer-events: none;\n}\n.trip-animation-widget .trip-animation-container .trip-animation-info-panel .tooltip-button {\n  top: 0;\n  left: 0;\n  width: 32px;\n  min-width: 32px;\n  height: 32px;\n  min-height: 32px;\n  padding: 0 0 2px;\n  margin: 2px;\n  line-height: 24px;\n  z-index: 999;\n}\n.trip-animation-widget .trip-animation-container .trip-animation-info-panel .tooltip-button::ng-deep .mat-button-wrapper {\n  padding: 0;\n}\n.trip-animation-widget .trip-animation-container .trip-animation-info-panel .tooltip-button mat-icon {\n  width: 24px;\n  height: 24px;\n}\n.trip-animation-widget .trip-animation-container .trip-animation-info-panel .tooltip-button mat-icon svg {\n  width: inherit;\n  height: inherit;\n}\n.trip-animation-widget .trip-animation-container .trip-animation-tooltip {\n  position: absolute;\n  top: 30px;\n  right: 0;\n  z-index: 1000;\n  padding: 5px;\n  background-color: #fff;\n  transition: 0.3s ease-in-out;\n}\n.trip-animation-widget .trip-animation-container .trip-animation-tooltip-hidden {\n  transform: translateX(110%);\n}'},JTB5:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n("mrSG"),a=n("RxGS"),o=n("TYT/"),r=n("6onV"),s=function(t){function e(e){var n=t.call(this,e)||this;return n.store=e,n}return Object(i.d)(e,t),Object.defineProperty(e.prototype,"entitiesTableConfig",{get:function(){return this.entitiesTableConfigValue},set:function(t){this.setEntitiesTableConfig(t)},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){},e.prototype.setEntitiesTableConfig=function(t){this.entitiesTableConfigValue=t},e.ctorParameters=function(){return[{type:r.Store}]},Object(i.c)([Object(o.Input)(),Object(i.g)("design:type",Object),Object(i.g)("design:paramtypes",[Object])],e.prototype,"entitiesTableConfig",null),e=Object(i.c)([Object(o.Directive)(),Object(i.g)("design:paramtypes",[r.Store])],e)}(a.a)},K9Fk:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .tb-aliases-header {\n  min-height: 40px;\n  padding: 0 11px;\n  margin: 5px;\n}\n:host .tb-aliases-header .tb-header-label {\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.570588);\n}\n:host mat-divider {\n  margin: -1px -24px;\n}\n:host .tb-alias {\n  padding: 0 0 0 10px;\n  margin: 5px;\n}\n:host .tb-alias .tb-resolve-multiple-switch {\n  padding-left: 10px;\n}\n:host .tb-alias .tb-resolve-multiple-switch .resolve-multiple-switch {\n  margin: 0;\n}\n:host ::ng-deep .mat-dialog-content {\n  padding-top: 0 !important;\n  padding-bottom: 0 !important;\n}'},KU6p:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host ::ng-deep mat-radio-button {\n  display: block;\n  margin-bottom: 16px;\n}\n:host ::ng-deep mat-radio-button .mat-radio-label {\n  width: 100%;\n  -ms-flex-align: start;\n      align-items: start;\n}\n:host ::ng-deep mat-radio-button .mat-radio-label .mat-radio-label-content {\n  width: 100%;\n}'},Kgme:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var i=n("mrSG"),a=n("TYT/"),o=n("MqYC"),r=n("ea4N"),s=n("6onV"),l=n("QJY3"),c=n("DUip"),d=n("gmuX"),u=n("o8Qb"),h=n("4j5O"),p=function(t){function e(e,n,a,o,r,s,c,d){var u=t.call(this,e,n,r)||this;return u.store=e,u.router=n,u.data=a,u.errorStateMatcher=o,u.dialogRef=r,u.fb=s,u.translate=c,u.dashboardUtils=d,u.submitted=!1,u.states=u.data.states,u.isAdd=u.data.isAdd,u.isAdd?(u.state=Object(i.a)({id:""},u.dashboardUtils.createDefaultState("",!1)),u.prevStateId=""):(u.state=u.data.state,u.prevStateId=u.state.id),u.stateFormGroup=u.fb.group({name:[u.state.name,[l.Validators.required]],id:[u.state.id,[l.Validators.required,u.validateDuplicateStateId()]],root:[u.state.root,[]]}),u.stateFormGroup.get("name").valueChanges.subscribe((function(t){u.checkStateName(t)})),u.stateFormGroup.get("id").valueChanges.subscribe((function(t){u.stateIdTouched=!0})),u}var d;return Object(i.d)(e,t),d=e,e.prototype.checkStateName=function(t){t&&!this.stateIdTouched&&this.isAdd&&this.stateFormGroup.get("id").setValue(t.toLowerCase().replace(/\W/g,"_"),{emitEvent:!1})},e.prototype.validateDuplicateStateId=function(){var t=this;return function(e){var n=e.value;if(n&&(t.states[n]&&n!==t.prevStateId))return{stateExists:!0};return null}},e.prototype.ngOnInit=function(){},e.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=!!(t&&t.invalid&&this.submitted);return n||i},e.prototype.cancel=function(){this.dialogRef.close(null)},e.prototype.save=function(){this.submitted=!0,this.state=Object(i.a)(Object(i.a)({},this.state),this.stateFormGroup.value),this.state.id=this.state.id.trim(),this.dialogRef.close(this.state)},e.ctorParameters=function(){return[{type:s.Store},{type:c.Router},{type:void 0,decorators:[{type:a.Inject,args:[r.MAT_DIALOG_DATA]}]},{type:o.d,decorators:[{type:a.SkipSelf}]},{type:r.MatDialogRef},{type:l.FormBuilder},{type:u.TranslateService},{type:h.a}]},e=d=Object(i.c)([Object(a.Component)({selector:"tb-dashboard-state-dialog",template:Object(i.f)(n("PKp+")).default,providers:[{provide:o.d,useExisting:d}]}),Object(i.h)(2,Object(a.Inject)(r.MAT_DIALOG_DATA)),Object(i.h)(3,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[s.Store,c.Router,Object,o.d,r.MatDialogRef,l.FormBuilder,u.TranslateService,h.a])],e)}(d.a)},Ksvh:function(t,e){L.GridLayer.GoogleMutant=L.GridLayer.extend({options:{minZoom:0,maxZoom:23,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",opacity:1,continuousWorld:!1,noWrap:!1,type:"roadmap",maxNativeZoom:21},initialize:function(t){L.GridLayer.prototype.initialize.call(this,t),this._ready=!!window.google&&!!window.google.maps&&!!window.google.maps.Map,this._GAPIPromise=this._ready?Promise.resolve(window.google):new Promise((function(t,e){var n=0,i=null;i=setInterval((function(){return n>=10?(clearInterval(i),e(new Error("window.google not found after 10 attempts"))):window.google&&window.google.maps&&window.google.maps.Map?(clearInterval(i),t(window.google)):void n++}),500)})),this._tileCallbacks={},this._freshTiles={},this._imagesPerTile="hybrid"===this.options.type?2:1,this._boundOnMutatedImage=this._onMutatedImage.bind(this)},onAdd:function(t){L.GridLayer.prototype.onAdd.call(this,t),this._initMutantContainer(),this._GAPIPromise.then((function(){if(this._ready=!0,this._map=t,this._initMutant(),t.on("viewreset",this._reset,this),this.options.updateWhenIdle?t.on("moveend",this._update,this):t.on("move",this._update,this),t.on("zoomend",this._handleZoomAnim,this),t.on("resize",this._resize,this),google.maps.event.addListenerOnce(this._mutant,"idle",(function(){this._checkZoomLevels(),this._mutantIsReady=!0}).bind(this)),t._controlCorners.bottomright.style.marginBottom="20px",t._controlCorners.bottomleft.style.marginBottom="20px",this._reset(),this._update(),this._subLayers)for(var e in this._subLayers)this._subLayers[e].setMap(this._mutant)}).bind(this))},onRemove:function(t){L.GridLayer.prototype.onRemove.call(this,t),this._observer.disconnect(),t._container.removeChild(this._mutantContainer),google.maps.event.clearListeners(t,"idle"),google.maps.event.clearListeners(this._mutant,"idle"),t.off("viewreset",this._reset,this),t.off("move",this._update,this),t.off("moveend",this._update,this),t.off("zoomend",this._handleZoomAnim,this),t.off("resize",this._resize,this),t._controlCorners&&(t._controlCorners.bottomright.style.marginBottom="0em",t._controlCorners.bottomleft.style.marginBottom="0em")},getAttribution:function(){return this.options.attribution},setElementSize:function(t,e){t.style.width=e.x+"px",t.style.height=e.y+"px"},addGoogleLayer:function(t,e){return this._subLayers||(this._subLayers={}),this._GAPIPromise.then((function(){var n=new(0,google.maps[t])(e);return n.setMap(this._mutant),this._subLayers[t]=n,n}).bind(this))},removeGoogleLayer:function(t){var e=this._subLayers&&this._subLayers[t];e&&(e.setMap(null),delete this._subLayers[t])},_initMutantContainer:function(){this._mutantContainer||(this._mutantContainer=L.DomUtil.create("div","leaflet-google-mutant leaflet-top leaflet-left"),this._mutantContainer.id="_MutantContainer_"+L.Util.stamp(this._mutantContainer),this._mutantContainer.style.zIndex="800",this._mutantContainer.style.pointerEvents="none",L.DomEvent.off(this._mutantContainer)),this._map.getContainer().appendChild(this._mutantContainer),this.setOpacity(this.options.opacity),this.setElementSize(this._mutantContainer,this._map.getSize()),this._attachObserver(this._mutantContainer)},_initMutant:function(){if(this._ready&&this._mutantContainer)if(this._mutant)this._resize();else{this._mutantCenter=new google.maps.LatLng(0,0);var t=new google.maps.Map(this._mutantContainer,{center:this._mutantCenter,zoom:0,tilt:0,mapTypeId:this.options.type,disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!1,streetViewControl:!1,styles:this.options.styles||{},backgroundColor:"transparent"});this._mutant=t,google.maps.event.addListenerOnce(t,"idle",(function(){for(var t=this._mutantContainer.querySelectorAll("a"),e=0;e<t.length;e++)t[e].style.pointerEvents="auto"}).bind(this)),this.fire("spawned",{mapObject:t})}},_attachObserver:function(t){this._observer||(this._observer=new MutationObserver(this._onMutations.bind(this))),this._observer.observe(t,{childList:!0,subtree:!0}),Array.prototype.forEach.call(t.querySelectorAll("img"),this._boundOnMutatedImage)},_onMutations:function(t){for(var e=0;e<t.length;++e)for(var n=t[e],i=0;i<n.addedNodes.length;++i){var a=n.addedNodes[i];a instanceof HTMLImageElement?this._onMutatedImage(a):a instanceof HTMLElement&&(Array.prototype.forEach.call(a.querySelectorAll("img"),this._boundOnMutatedImage),"white"===a.style.backgroundColor&&L.DomUtil.remove(a),0===a.textContent.indexOf("For development purposes only")&&L.DomUtil.remove(a),Array.prototype.forEach.call(a.querySelectorAll('div[draggable=false][style*="text-align: center"]'),L.DomUtil.remove))}},_roadRegexp:/!1i(\d+)!2i(\d+)!3i(\d+)!/,_satRegexp:/x=(\d+)&y=(\d+)&z=(\d+)/,_staticRegExp:/StaticMapService\.GetMapImage/,_onMutatedImage:function(t){var e,n=t.src.match(this._roadRegexp),i=0;if(n?(e={z:n[1],x:n[2],y:n[3]},this._imagesPerTile>1&&(t.style.zIndex=1,i=1)):((n=t.src.match(this._satRegexp))&&(e={x:n[1],y:n[2],z:n[3]}),i=0),e){var a=this._tileCoordsToKey(e);t.style.position="absolute",t.style.visibility="hidden";var o=a+"/"+i;if(this._freshTiles[o]=t,o in this._tileCallbacks&&this._tileCallbacks[o])this._tileCallbacks[o].pop()(t),this._tileCallbacks[o].length||delete this._tileCallbacks[o];else if(this._tiles[a]){var r=this._tiles[a].el,s=0===i?r.firstChild:r.firstChild.nextSibling,l=this._clone(t);r.replaceChild(l,s)}}else t.src.match(this._staticRegExp)&&(t.style.visibility="hidden")},createTile:function(t,e){var n=this._tileCoordsToKey(t),i=L.DomUtil.create("div");i.dataset.pending=this._imagesPerTile,e=e.bind(this,null,i);for(var a=0;a<this._imagesPerTile;a++){var o=n+"/"+a;if(o in this._freshTiles){var r=this._freshTiles[o];i.appendChild(this._clone(r)),i.dataset.pending--}else this._tileCallbacks[o]=this._tileCallbacks[o]||[],this._tileCallbacks[o].push((function(t){return(function(n){t.appendChild(this._clone(n)),t.dataset.pending--,parseInt(t.dataset.pending)||e()}).bind(this)}).bind(this)(i))}return parseInt(i.dataset.pending)||L.Util.requestAnimFrame(e),i},_clone:function(t){var e=t.cloneNode(!0);return e.style.visibility="visible",e},_checkZoomLevels:function(){var t=this._map.getZoom(),e=this._mutant.getZoom();t&&e&&(e!==t||e>this.options.maxNativeZoom)&&this._setMaxNativeZoom(e)},_setMaxNativeZoom:function(t){t!=this.options.maxNativeZoom&&(this.options.maxNativeZoom=t,this._resetView())},_reset:function(){this._initContainer()},_update:function(){if(this._mutant){var t=this._map.getCenter(),e=new google.maps.LatLng(t.lat,t.lng);this._mutant.setCenter(e);var n=this._map.getZoom(),i=n!==Math.round(n),a=this._mutant.getZoom();i||n==a||(this._mutant.setZoom(n),this._mutantIsReady&&this._checkZoomLevels())}L.GridLayer.prototype._update.call(this)},_resize:function(){var t=this._map.getSize();this._mutantContainer.style.width===t.x&&this._mutantContainer.style.height===t.y||(this.setElementSize(this._mutantContainer,t),this._mutant&&google.maps.event.trigger(this._mutant,"resize"))},_handleZoomAnim:function(){if(this._mutant){var t=this._map.getCenter(),e=new google.maps.LatLng(t.lat,t.lng);this._mutant.setCenter(e),this._mutant.setZoom(Math.round(this._map.getZoom()))}},_removeTile:function(t){if(this._mutant)return setTimeout(this._pruneTile.bind(this,t),1e3),L.GridLayer.prototype._removeTile.call(this,t)},_pruneTile:function(t){for(var e=this._mutant.getZoom(),n=t.split(":")[2],i=this._mutant.getBounds(),a=i.getSouthWest(),o=i.getNorthEast(),r=L.latLngBounds([[a.lat(),a.lng()],[o.lat(),o.lng()]]),s=0;s<this._imagesPerTile;s++){var l=t+"/"+s;if(l in this._freshTiles){var c=this._map&&this._keyToBounds(t);this._map&&c.overlaps(r)&&n==e||delete this._freshTiles[l]}}}}),L.gridLayer.googleMutant=function(t){return new L.GridLayer.GoogleMutant(t)}},L8ka:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div class="tb-switch" fxLayout="column" [ngStyle]="{\'pointerEvents\': ctx.isEdit ? \'none\' : \'all\'}">\n  <div #switchErrorContainer class="error-container" [ngStyle]="{\'background\': error?.length ? \'rgba(255,255,255,0.25)\' : \'none\'}"\n       fxLayout="row" fxLayoutAlign="center center">\n    <span #switchError class="switch-error">{{ error }}</span>\n  </div>\n  <div #switchTitleContainer fxFlex="30" class="title-container" fxLayout="row" fxLayoutAlign="center center" [fxShow]="showTitle">\n    <span #switchTitle class="switch-title">{{title}}</span>\n  </div>\n  <div #switchContainer fxFlex="{{showTitle ? 70 : 100}}" id="switch-container" fxLayout="column" fxLayoutAlign="center center">\n    <div #switch class="switch">\n      <mat-slide-toggle #matSlideToggle [(ngModel)]="value" (change)="onValue()">\n      </mat-slide-toggle>\n    </div>\n    <div #onoffContainer class="onoff-container" fxLayout="row" fxLayoutAlign="center start" [fxShow]="showOnOffLabels">\n      <span #offLabel fxFlex class="off-label" [fxShow]="!value" style="text-align: center;">OFF</span>\n      <span fxFlex [fxShow]="value"></span>\n      <span #onLabel fxFlex class="on-label" [fxShow]="value" style="text-align: center;">ON</span>\n      <span fxFlex [fxShow]="!value"></span>\n    </div>\n  </div>\n  <div #textMeasure id="text-measure"></div>\n</div>\n'},Lm6k:function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return m}));var i='<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/id/entity-id.ts#L20">EntityId</a>',a='<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/entity-type.models.ts#L36">EntityType</a>',o='<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/page/page-data.ts#L17">PageData</a>',r='<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/device.models.ts#L33">DeviceInfo</a>',s='<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/device.models.ts#L24">Device</a>',l='<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/device.models.ts#L50">DeviceCredentials</a>',c={name:"pageLink",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/page/page-link.ts#L68">PageLink</a>',description:"Page link object used to perform paginated request."},d={name:"config",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/http/http-utils.ts#L21">RequestConfig</a>',description:"HTTP request configuration.",optional:!0};function u(t){return{type:"Observable&lt;"+t+"&gt;",description:"An <code>Observable</code> of <code>"+t+"</code> object."}}function h(t){return{type:"Observable&lt;Array&lt;"+t+"&gt;&gt;",description:"An <code>Observable</code> of array of <code>"+t+"</code> objects."}}function p(t){return{type:"Observable&lt;"+o+"&lt;"+t+"&gt;&gt;",description:"An <code>Observable</code> of page result as a <code>"+o+"</code> holding array of <code>"+t+"</code> objects."}}var m={deviceService:{description:'Device Service API<br>See <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/http/device.service.ts#L37">DeviceService</a> for API reference.',meta:"service",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/http/device.service.ts#L37">DeviceService</a>',children:{getTenantDeviceInfos:{description:"Get tenant devices",meta:"function",args:[c,{name:"type",type:"string",optional:!0,description:"Device type"},d],return:p(r)},getCustomerDeviceInfos:{description:"Get customer devices",meta:"function",args:[{name:"customerId",type:"string",description:"Id of the customer"},c,{name:"type",type:"string",optional:!0,description:"Device type"},d],return:p(r)},getDevice:{description:"Get device by id",meta:"function",args:[{name:"deviceId",type:"string",description:"Id of the device"},d],return:u(s)},getDevices:{description:"Get devices by ids",meta:"function",args:[{name:"deviceIds",type:"Array<string>",description:"List of device ids"},d],return:h(s)},getDeviceInfo:{description:"Get device info by id",meta:"function",args:[{name:"deviceId",type:"string",description:"Id of the device"},d],return:u(r)},saveDevice:{description:"Save device",meta:"function",args:[{name:"device",type:s,description:"Device object to save"},d],return:u(s)},deleteDevice:{description:"Delete device by id",meta:"function",args:[{name:"deviceId",type:"string",description:"Id of the device"},d],return:{type:"Observable&lt;void&gt;",description:"An <code>Observable</code>."}},getDeviceTypes:{description:"Get all available devices types",meta:"function",args:[d],return:h('<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/entity-type.models.ts#L295">EntitySubtype</a>')},getDeviceCredentials:{description:"Get device credentials by device id",meta:"function",args:[{name:"deviceId",type:"string",description:"Id of the device"},{name:"sync",type:"boolean",description:"Whether to execute HTTP request synchronously (false by default)",optional:!0},d],return:u(l)},saveDeviceCredentials:{description:"Save device credentials",meta:"function",args:[{name:"deviceCredentials",type:l,description:"Device credentials object to save"},d],return:u(l)},makeDevicePublic:{description:"Make device public (available from public dashboard)",meta:"function",args:[{name:"deviceId",type:"string",description:"Id of the device"},d],return:u(s)},assignDeviceToCustomer:{description:"Assign device to specific customer",meta:"function",args:[{name:"customerId",type:"string",description:"Id of the customer"},{name:"deviceId",type:"string",description:"Id of the device"},d],return:u(s)},unassignDeviceFromCustomer:{description:"Unassign device from any customer",meta:"function",args:[{name:"deviceId",type:"string",description:"Id of the device"},d],return:{type:"Observable&lt;void&gt;",description:"An <code>Observable</code>."}},sendOneWayRpcCommand:{description:"Send one way (without response) RPC command to the device.",meta:"function",args:[{name:"deviceId",type:"string",description:"Id of the device"},{name:"requestBody",type:"object",description:"Request body to be sent to device"},d],return:{type:"Observable&lt;any&gt;",description:"A command execution <code>Observable</code>."}},sendTwoWayRpcCommand:{description:"Sends two way (with response) RPC command to the device.",meta:"function",args:[{name:"deviceId",type:"string",description:"Id of the device"},{name:"requestBody",type:"object",description:"Request body to be sent to device"},d],return:{type:"Observable&lt;any&gt;",description:"A command execution <code>Observable</code> of response body."}},findByQuery:{description:"Find devices by search query",meta:"function",args:[{name:"query",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/device.models.ts#L57">DeviceSearchQuery</a>',description:"Device search query object"},d],return:h(s)},findByName:{description:"Find device by name",meta:"function",args:[{name:"deviceName",type:"string",description:"Search device name"},d],return:u(s)},claimDevice:{description:"Send claim device request",meta:"function",args:[{name:"deviceName",type:"string",description:"Claiming device name"},d],return:u('<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/device.models.ts#L71">ClaimResult</a>')},unclaimDevice:{description:"Send un-claim device request",meta:"function",args:[{name:"deviceName",type:"string",description:"Device name to un-claim"},d],return:{type:"Observable&lt;void&gt;",description:"An <code>Observable</code>."}}}},assetService:{description:'Asset Service API<br>See <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/http/asset.service.ts#L29">AssetService</a> for API reference.',meta:"service",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/http/asset.service.ts#L29">AssetService</a>'},entityViewService:{description:'EntityView Service API<br>See <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/http/entity-view.service.ts#L29">EntityViewService</a> for API reference.',meta:"service",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/http/entity-view.service.ts#L29">EntityViewService</a>'},customerService:{description:'Customer Service API<br>See <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/http/customer.service.ts#L28">CustomerService</a> for API reference.',meta:"service",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/http/customer.service.ts#L28">CustomerService</a>'},dashboardService:{description:'Dashboard Service API<br>See <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/http/dashboard.service.ts#L32">DashboardService</a> for API reference.',meta:"service",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/http/dashboard.service.ts#L32">DashboardService</a>'},userService:{description:'User Service API<br>See <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/http/user.service.ts#L29">UserService</a> for API reference.',meta:"service",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/http/user.service.ts#L29">UserService</a>'},attributeService:{description:'Attribute Service API<br>See <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/http/attribute.service.ts#L28">AttributeService</a> for API reference.',meta:"service",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/http/attribute.service.ts#L28">AttributeService</a>'},entityRelationService:{description:'Entity Relation Service API<br>See <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/http/entity-relation.service.ts#L27">EntityRelationService</a> for API reference.',meta:"service",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/http/entity-relation.service.ts#L27">EntityRelationService</a>'},entityService:{description:'Entity Service API<br>See <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/http/entity.service.ts#L64">EntityService</a> for API reference.',meta:"service",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/http/entity.service.ts#L64">EntityService</a>'},dialogs:{description:'Dialogs Service API<br>See <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/services/dialog.service.ts#L39">DialogService</a> for API reference.',meta:"service",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/services/dialog.service.ts#L39">DialogService</a>'},customDialog:{description:'Custom Dialog Service API<br>See <a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/modules/home/components/widget/dialog/custom-dialog.service.ts#L33">CustomDialogService</a> for API reference.',meta:"service",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/modules/home/components/widget/dialog/custom-dialog.service.ts#L33">CustomDialogService</a>'},date:{description:'Date Pipe<br>Formats a date value according to locale rules.<br>See <a href="https://angular.io/api/common/DatePipe">DatePipe</a> for API reference.',meta:"service",type:'<a href="https://angular.io/api/common/DatePipe">DatePipe</a>'},translate:{description:'Translate Service API<br>See <a href="https://github.com/ngx-translate/core#translateservice">TranslateService</a> for API reference.',meta:"service",type:'<a href="https://github.com/ngx-translate/core#translateservice">TranslateService</a>'},http:{description:'HTTP Client Service<br>See <a href="https://angular.io/api/common/http/HttpClient">HttpClient</a> for API reference.',meta:"service",type:'<a href="https://angular.io/api/common/http/HttpClient">HttpClient</a>'}}},LrsY:function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var i=n("mrSG"),a=n("TYT/"),o=n("MqYC"),r=n("ea4N"),s=n("6onV"),l=n("HnHJ"),c=n("gmuX"),d=n("DUip"),u=function(t){function e(e,n,i,a,o,r,s){var l=t.call(this,e,n,a)||this;return l.store=e,l.router=n,l.data=i,l.dialogRef=a,l.componentFactoryResolver=o,l.injector=r,l.errorStateMatcher=s,l.submitted=!1,l}var c;return Object(i.d)(e,t),c=e,e.prototype.ngOnInit=function(){this.entitiesTableConfig=this.data.entitiesTableConfig,this.translations=this.entitiesTableConfig.entityTranslations,this.resources=this.entitiesTableConfig.entityResources,this.entity={};var t=this.componentFactoryResolver.resolveComponentFactory(this.entitiesTableConfig.entityComponent),e=this.entityDetailsFormAnchor.viewContainerRef;e.clear();var n=a.Injector.create({providers:[{provide:"entity",useValue:this.entity},{provide:"entitiesTableConfig",useValue:this.entitiesTableConfig}],parent:this.injector}),i=e.createComponent(t,0,n);this.entityComponent=i.instance,this.entityComponent.isEdit=!0,this.detailsForm=this.entityComponent.entityForm},e.prototype.helpLinkId=function(){return this.resources.helpLinkIdForEntity&&this.entityComponent.entityForm?this.resources.helpLinkIdForEntity(this.entityComponent.entityForm.getRawValue()):this.resources.helpLinkId},e.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=!!(t&&t.invalid&&this.submitted);return n||i},e.prototype.cancel=function(){this.dialogRef.close(null)},e.prototype.add=function(){var t=this;this.submitted=!0,this.detailsForm.valid&&(this.entity=Object(i.a)(Object(i.a)({},this.entity),this.entityComponent.entityFormValue()),this.entitiesTableConfig.saveEntity(this.entity).subscribe((function(e){t.dialogRef.close(e)})))},e.ctorParameters=function(){return[{type:s.Store},{type:d.Router},{type:void 0,decorators:[{type:a.Inject,args:[r.MAT_DIALOG_DATA]}]},{type:r.MatDialogRef},{type:a.ComponentFactoryResolver},{type:a.Injector},{type:o.d,decorators:[{type:a.SkipSelf}]}]},Object(i.c)([Object(a.ViewChild)("entityDetailsForm",{static:!0}),Object(i.g)("design:type",l.a)],e.prototype,"entityDetailsFormAnchor",void 0),e=c=Object(i.c)([Object(a.Component)({selector:"tb-add-entity-dialog",template:Object(i.f)(n("1LDp")).default,providers:[{provide:o.d,useExisting:c}],styles:[Object(i.f)(n("rg+x")).default]}),Object(i.h)(2,Object(a.Inject)(r.MAT_DIALOG_DATA)),Object(i.h)(6,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[s.Store,d.Router,Object,r.MatDialogRef,a.ComponentFactoryResolver,a.Injector,o.d])],e)}(c.a)},M0Qk:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var i=n("mrSG"),a=n("TYT/"),o=n("Valr"),r=n("PCNd"),s=n("uPsX"),l=n("tM37"),c=n("SZX/"),d=function(){function t(){}return t=Object(i.c)([Object(a.NgModule)({declarations:[s.a,l.a],imports:[o.CommonModule,r.a],exports:[s.a,l.a],providers:[c.a]})],t)}()},M1nY:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div class="mat-padding tb-entity-table tb-absolute-fill">\n  <div fxFlex fxLayout="column" class="mat-elevation-z1 tb-entity-table-content">\n    <mat-toolbar class="mat-table-toolbar" [fxShow]="!textSearchMode">\n      <div class="mat-toolbar-tools">\n        <span class="tb-entity-table-title" translate>widget-config.actions</span>\n        <span fxFlex></span>\n        <button mat-icon-button [disabled]="isLoading$ | async"\n                type="button"\n                (click)="addAction($event)"\n                matTooltip="{{ \'widget-config.add-action\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>add</mat-icon>\n        </button>\n        <button mat-icon-button [disabled]="isLoading$ | async" (click)="enterFilterMode()"\n                type="button"\n                matTooltip="{{ \'action.search\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>search</mat-icon>\n        </button>\n      </div>\n    </mat-toolbar>\n    <mat-toolbar class="mat-table-toolbar" [fxShow]="textSearchMode">\n      <div class="mat-toolbar-tools">\n        <button mat-icon-button\n                type="button"\n                matTooltip="{{ \'widget-config.search-actions\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>search</mat-icon>\n        </button>\n        <mat-form-field fxFlex>\n          <mat-label>&nbsp;</mat-label>\n          <input #searchInput matInput\n                 [(ngModel)]="pageLink.textSearch"\n                 placeholder="{{ \'widget-config.search-actions\' | translate }}"/>\n        </mat-form-field>\n        <button mat-icon-button (click)="exitFilterMode()"\n                type="button"\n                matTooltip="{{ \'action.close\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>close</mat-icon>\n        </button>\n      </div>\n    </mat-toolbar>\n    <div fxFlex class="table-container">\n      <table mat-table [dataSource]="dataSource"\n                 matSort [matSortActive]="pageLink.sortOrder.property" [matSortDirection]="pageLink.sortDirection()" matSortDisableClear>\n        <ng-container matColumnDef="actionSourceName">\n          <mat-header-cell *matHeaderCellDef mat-sort-header style="width: 20%"> {{ \'widget-config.action-source\' | translate }} </mat-header-cell>\n          <mat-cell *matCellDef="let action">\n            {{ action.actionSourceName }}\n          </mat-cell>\n        </ng-container>\n        <ng-container matColumnDef="name">\n          <mat-header-cell *matHeaderCellDef mat-sort-header style="width: 30%"> {{ \'widget-config.action-name\' | translate }} </mat-header-cell>\n          <mat-cell *matCellDef="let action">\n            {{ action.name }}\n          </mat-cell>\n        </ng-container>\n        <ng-container matColumnDef="icon">\n          <mat-header-cell *matHeaderCellDef mat-sort-header style="width: 40px"> {{ \'widget-config.action-icon\' | translate }} </mat-header-cell>\n          <mat-cell *matCellDef="let action">\n            <mat-icon>{{ action.icon }}</mat-icon>\n          </mat-cell>\n        </ng-container>\n        <ng-container matColumnDef="typeName">\n          <mat-header-cell *matHeaderCellDef mat-sort-header style="width: 50%"> {{ \'widget-config.action-type\' | translate }} </mat-header-cell>\n          <mat-cell *matCellDef="let action">\n            {{ action.typeName }}\n          </mat-cell>\n        </ng-container>\n        <ng-container matColumnDef="actions" stickyEnd>\n          <mat-header-cell *matHeaderCellDef style="min-width: 80px; max-width: 80px; width: 80px">\n          </mat-header-cell>\n          <mat-cell *matCellDef="let action">\n            <div fxFlex fxLayout="row" fxLayoutAlign="end">\n              <button mat-icon-button [disabled]="isLoading$ | async"\n                      type="button"\n                      matTooltip="{{ \'widget-config.edit-action\' | translate }}"\n                      matTooltipPosition="above"\n                      (click)="editAction($event, action)">\n                <mat-icon>edit</mat-icon>\n              </button>\n              <button mat-icon-button [disabled]="isLoading$ | async"\n                      type="button"\n                      matTooltip="{{ \'widget-config.delete-action\' | translate }}"\n                      matTooltipPosition="above"\n                      (click)="deleteAction($event, action)">\n                <mat-icon>delete</mat-icon>\n              </button>\n            </div>\n          </mat-cell>\n        </ng-container>\n        <mat-header-row [ngClass]="{\'mat-row-select\': true}" *matHeaderRowDef="displayedColumns; sticky: true"></mat-header-row>\n        <mat-row [ngClass]="{\'mat-row-select\': true}"\n                 *matRowDef="let action; columns: displayedColumns;"></mat-row>\n      </table>\n      <span [fxShow]="dataSource.isEmpty() | async"\n            fxLayoutAlign="center center"\n            class="no-data-found" translate>{{ \'widget-config.no-actions-text\' }}</span>\n    </div>\n    <mat-divider></mat-divider>\n    <mat-paginator [length]="dataSource.total() | async"\n                   [pageIndex]="pageLink.page"\n                   [pageSize]="pageLink.pageSize"\n                   [pageSizeOptions]="[10, 20, 30]"></mat-paginator>\n  </div>\n</div>\n'},M8Od:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host {\n  width: 100%;\n  height: 100%;\n}'},MKGz:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .tb-resolve-multiple-switch {\n  padding-left: 10px;\n}\n:host .tb-resolve-multiple-switch .resolve-multiple-switch {\n  margin: 0;\n}\n:host .tb-resolve-multiple-switch .resolve-multiple-label {\n  margin: 5px 0;\n}'},MRzK:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host {\n  width: 100%;\n  height: 100%;\n}\n:host .tb-entity-table .tb-entity-table-content {\n  width: 100%;\n  height: 100%;\n  background: #fff;\n}\n:host .tb-entity-table .tb-entity-table-content .tb-entity-table-title {\n  padding-right: 20px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n:host .tb-entity-table .tb-entity-table-content .table-container {\n  overflow: auto;\n}\n:host ::ng-deep .mat-sort-header-sorted .mat-sort-header-arrow {\n  opacity: 1 !important;\n}'},NTNZ:function(t,e,n){"use strict";n.d(e,"a",(function(){return q}));var i=n("mrSG"),a=n("TYT/"),o=n("Valr"),r=n("PCNd"),s=n("M0Qk"),l=n("p0+G"),c=n("HUB6"),d=n("ekQc"),u=n("p/3Z"),h=n("G4cQ"),p=n("yOwA"),m=n("0aaO"),g=function(){function t(){this.triggerClick=new a.EventEmitter}return t.prototype.ngOnInit=function(){},t.prototype.onTriggerClick=function(){this.triggerClick.emit()},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],t.prototype,"toolbarOpened",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],t.prototype,"forceFullscreen",void 0),Object(i.c)([Object(a.Output)(),Object(i.g)("design:type",Object)],t.prototype,"triggerClick",void 0),t=Object(i.c)([Object(a.Component)({selector:"tb-dashboard-toolbar",template:Object(i.f)(n("4GWK")).default,encapsulation:a.ViewEncapsulation.None,styles:[Object(i.f)(n("vZSk")).default]}),Object(i.g)("design:paramtypes",[])],t)}(),f=n("DkIy"),b=n("DUip"),y=n("F/XL"),v=function(){function t(t,e,n,i){this.router=t,this.route=e,this.ngZone=n,this.statesControllerService=i,this.stateObject=[],this.rxSubscriptions=new Array,this.inited=!1}return Object.defineProperty(t.prototype,"isMobile",{get:function(){return this.isMobileValue},set:function(t){this.isMobileValue!==t&&(this.isMobileValue=t,this.inited&&this.onMobileChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this.stateValue},set:function(t){this.stateValue!==t&&(this.stateValue=t,this.inited&&this.onStateIdChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"dashboardId",{get:function(){return this.dashboardIdValue},set:function(t){this.dashboardIdValue!==t&&(this.dashboardIdValue=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"states",{get:function(){return this.statesValue},set:function(t){this.statesValue!==t&&(this.statesValue=t,this.inited&&this.onStatesChanged())},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){var t=this;this.rxSubscriptions.push(this.route.queryParamMap.subscribe((function(e){var n=t.route.snapshot.params.dashboardId;if(t.dashboardId===n){var i=e.get("state");t.currentState!==i&&(t.currentState=i,t.inited&&t.onStateChanged())}}))),this.init(),this.inited=!0},t.prototype.ngOnDestroy=function(){this.rxSubscriptions.forEach((function(t){t.unsubscribe()})),this.rxSubscriptions.length=0},t.prototype.updateStateParam=function(t){var e=this;this.currentState=t;var n={state:this.currentState};this.ngZone.run((function(){e.router.navigate([],{relativeTo:e.route,queryParams:n,queryParamsHandling:"merge"})}))},t.prototype.openRightLayout=function(){this.dashboardCtrl.openRightLayout()},t.prototype.preserveState=function(){this.statesControllerService.preserveStateControllerState(this.stateControllerId(),this.stateObject)},t.prototype.cleanupPreservedStates=function(){this.statesControllerService.cleanupPreservedStates()},t.prototype.reInit=function(){this.currentState=this.route.snapshot.queryParamMap.get("state"),this.init()},t}(),w=n("OiFK"),x=n("//Q6"),S=n("4j5O"),C=n("21Fy"),T=n("xMyE"),O=n("67Y/"),_=function(t){function e(e,n,i,a,o,r,s){var l=t.call(this,e,n,i,a)||this;return l.router=e,l.route=n,l.ngZone=i,l.statesControllerService=a,l.utils=o,l.entityService=r,l.dashboardUtils=s,l.selectedStateIndex=-1,l}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){t.prototype.ngOnInit.call(this)},e.prototype.ngOnDestroy=function(){t.prototype.ngOnDestroy.call(this)},e.prototype.init=function(){var t=this;if(this.preservedState)this.stateObject=this.preservedState,this.selectedStateIndex=this.stateObject.length-1,setTimeout((function(){t.gotoState(t.stateObject[t.stateObject.length-1].id,!0)}),1);else{var e=this.currentState;this.stateObject=this.parseState(e),this.selectedStateIndex=this.stateObject.length-1,setTimeout((function(){t.gotoState(t.stateObject[t.stateObject.length-1].id,!1)}),1)}},e.prototype.onMobileChanged=function(){},e.prototype.onStateIdChanged=function(){},e.prototype.onStatesChanged=function(){},e.prototype.onStateChanged=function(){this.stateObject=this.parseState(this.currentState),this.selectedStateIndex=this.stateObject.length-1,this.gotoState(this.stateObject[this.stateObject.length-1].id,!1)},e.prototype.stateControllerId=function(){return"entity"},e.prototype.getStateParams=function(){return this.stateObject&&this.stateObject.length?this.stateObject[this.stateObject.length-1].params:{}},e.prototype.openState=function(t,e,n){var i=this;this.states&&this.states[t]&&this.resolveEntity(e).subscribe((function(){var a={id:t,params:e};i.stateObject.push(a),i.selectedStateIndex=i.stateObject.length-1,i.gotoState(i.stateObject[i.stateObject.length-1].id,!0,n)}))},e.prototype.updateState=function(t,e,n){var i=this;t||(t=this.getStateId()),this.states&&this.states[t]&&this.resolveEntity(e).subscribe((function(){i.stateObject[i.stateObject.length-1]={id:t,params:e},i.gotoState(i.stateObject[i.stateObject.length-1].id,!0,n)}))},e.prototype.getEntityId=function(t){var e=this.getStateParams();return t&&t.length?e[t]?e[t].entityId:null:e.entityId},e.prototype.getStateId=function(){return this.stateObject&&this.stateObject.length?this.stateObject[this.stateObject.length-1].id:""},e.prototype.getStateIdAtIndex=function(t){return this.stateObject&&this.stateObject[t]?this.stateObject[t].id:""},e.prototype.getStateIndex=function(){return this.stateObject&&this.stateObject.length?this.stateObject.length-1:-1},e.prototype.getStateParamsByStateId=function(t){var e=this.getStateObjById(t);return e?e.params:null},e.prototype.navigatePrevState=function(t){t<this.stateObject.length-1&&(this.stateObject.splice(t+1,this.stateObject.length-t-1),this.selectedStateIndex=this.stateObject.length-1,this.gotoState(this.stateObject[this.stateObject.length-1].id,!0))},e.prototype.resetState=function(){var t=this.dashboardUtils.getRootStateId(this.states);this.stateObject=[{id:t,params:{}}],this.gotoState(t,!0)},e.prototype.getStateName=function(t){var e="",n=this.stateObject[t];if(n){var i=this.states[n.id];if(i){var a=i.name;a=this.utils.customTranslation(a,a);var o=this.stateObject[t].params,r=o&&o.entityName?o.entityName:"",s=o&&o.entityLabel?o.entityLabel:"";e=Object(x.j)(a,"entityName",r),e=Object(x.j)(e,"entityLabel",s);for(var l=0,c=Object.keys(o);l<c.length;l++){var d=c[l];o[d]&&o[d].entityName&&(e=Object(x.j)(e,d+":entityName",o[d].entityName)),o[d]&&o[d].entityLabel&&(e=Object(x.j)(e,d+":entityLabel",o[d].entityLabel))}}}return e},e.prototype.selectedStateIndexChanged=function(){this.navigatePrevState(this.selectedStateIndex)},e.prototype.parseState=function(t){var e;if(t)try{e=Object(x.b)(t)}catch(a){e=[{id:null,params:{}}]}e||(e=[]),e.length||(e[0]={id:null,params:{}});var n=this.dashboardUtils.getRootStateId(this.states);e[0].id||(e[0].id=n),this.states[e[0].id]||(e[0].id=n);for(var i=e.length;i--;)e[i].id&&this.states[e[i].id]||e.splice(i,1);return e},e.prototype.gotoState=function(t,e,n){this.dashboardCtrl.openDashboardState(t,n),e&&this.updateLocation()},e.prototype.updateLocation=function(){if(this.stateObject[this.stateObject.length-1].id){var t=void 0;t=this.isDefaultState()?null:Object(x.w)(this.stateObject),this.updateStateParam(t)}},e.prototype.isDefaultState=function(){if(1===this.stateObject.length){var t=this.stateObject[0],e=this.dashboardUtils.getRootStateId(this.states);if(t.id===e&&(!t.params||Object(x.m)(t.params)))return!0}return!1},e.prototype.resolveEntity=function(t){return t&&t.targetEntityParamName&&(t=t[t.targetEntityParamName]),t&&t.entityId&&t.entityId.id&&t.entityId.entityType?this.isEntityResolved(t)?Object(y.a)(null):this.entityService.getEntity(t.entityId.entityType,t.entityId.id,{ignoreLoading:!0,ignoreErrors:!0}).pipe(Object(T.a)((function(e){t.entityName=e.name,t.entityLabel=e.label})),Object(O.a)((function(){return null}))):Object(y.a)(null)},e.prototype.isEntityResolved=function(t){return!(!t.entityName||!t.entityName.length)},e.prototype.getStateObjById=function(t){return this.stateObject.find((function(e){return e.id===t}))},e.ctorParameters=function(){return[{type:b.Router},{type:b.ActivatedRoute},{type:a.NgZone},{type:f.a},{type:w.a},{type:C.a},{type:S.a}]},e=Object(i.c)([Object(a.Component)({selector:"tb-entity-state-controller",template:Object(i.f)(n("n7d0")).default,styles:[Object(i.f)(n("0hfc")).default]}),Object(i.g)("design:paramtypes",[b.Router,b.ActivatedRoute,a.NgZone,f.a,w.a,C.a,S.a])],e)}(v),L=function(){function t(t,e){this.viewContainerRef=t,this.statesControllerService=e}return t.prototype.ngOnInit=function(){this.init()},t.prototype.ngOnDestroy=function(){this.destroy()},t.prototype.ngOnChanges=function(t){for(var e=!1,n=0,i=Object.keys(t);n<i.length;n++){var a=i[n],o=t[a];o.firstChange||o.currentValue===o.previousValue||("statesControllerId"===a?this.reInit():"states"===a?this.stateControllerComponent.states=this.states:"dashboardId"===a?(this.stateControllerComponent.dashboardId=this.dashboardId,e=!0):"isMobile"===a?this.stateControllerComponent.isMobile=this.isMobile:"state"===a&&(this.stateControllerComponent.state=this.state))}e&&this.stateControllerComponent.reInit()},t.prototype.reInit=function(){this.destroy(),this.init()},t.prototype.init=function(){this.viewContainerRef.clear();var t=this.statesControllerService.getStateController(this.statesControllerId);t||(t=this.statesControllerService.getStateController("default"));var e=this.statesControllerService.withdrawStateControllerState(this.statesControllerId),n=t.factory;this.stateControllerComponentRef=this.viewContainerRef.createComponent(n),this.stateControllerComponent=this.stateControllerComponentRef.instance,this.dashboardCtrl.dashboardCtx.stateController=this.stateControllerComponent,this.stateControllerComponent.preservedState=e,this.stateControllerComponent.dashboardCtrl=this.dashboardCtrl,this.stateControllerComponent.state=this.state,this.stateControllerComponent.isMobile=this.isMobile,this.stateControllerComponent.states=this.states,this.stateControllerComponent.dashboardId=this.dashboardId},t.prototype.destroy=function(){this.stateControllerComponentRef&&this.stateControllerComponentRef.destroy()},t.ctorParameters=function(){return[{type:a.ViewContainerRef},{type:f.a}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",String)],t.prototype,"statesControllerId",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],t.prototype,"dashboardCtrl",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",String)],t.prototype,"dashboardId",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],t.prototype,"states",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",String)],t.prototype,"state",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],t.prototype,"isMobile",void 0),t=Object(i.c)([Object(a.Directive)({selector:"tb-states-component"}),Object(i.g)("design:paramtypes",[a.ViewContainerRef,f.a])],t)}(),I=function(t){function e(e,n,i,a,o,r,s){var l=t.call(this,e,n,i,a)||this;return l.router=e,l.route=n,l.ngZone=i,l.statesControllerService=a,l.utils=o,l.entityService=r,l.dashboardUtils=s,l}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){t.prototype.ngOnInit.call(this)},e.prototype.ngOnDestroy=function(){t.prototype.ngOnDestroy.call(this)},e.prototype.init=function(){var t=this;if(this.preservedState)this.stateObject=this.preservedState,setTimeout((function(){t.gotoState(t.stateObject[0].id,!0)}),1);else{var e=this.currentState;this.stateObject=this.parseState(e),setTimeout((function(){t.gotoState(t.stateObject[0].id,!1)}),1)}},e.prototype.onMobileChanged=function(){},e.prototype.onStateIdChanged=function(){},e.prototype.onStatesChanged=function(){},e.prototype.onStateChanged=function(){this.stateObject=this.parseState(this.currentState),this.gotoState(this.stateObject[0].id,!1)},e.prototype.stateControllerId=function(){return"default"},e.prototype.getStateParams=function(){return this.stateObject&&this.stateObject.length?this.stateObject[this.stateObject.length-1].params:{}},e.prototype.openState=function(t,e,n){if(this.states&&this.states[t]){e||(e={});var i={id:t,params:e};this.stateObject[0]=i,this.gotoState(this.stateObject[0].id,!0,n)}},e.prototype.updateState=function(t,e,n){if(t||(t=this.getStateId()),this.states&&this.states[t]){e||(e={});var i={id:t,params:e};this.stateObject[0]=i,this.gotoState(this.stateObject[0].id,!0,n)}},e.prototype.getEntityId=function(t){return null},e.prototype.getStateId=function(){return this.stateObject&&this.stateObject.length?this.stateObject[this.stateObject.length-1].id:""},e.prototype.getStateIdAtIndex=function(t){return this.stateObject&&this.stateObject[t]?this.stateObject[t].id:""},e.prototype.getStateIndex=function(){return this.stateObject&&this.stateObject.length?this.stateObject.length-1:-1},e.prototype.getStateParamsByStateId=function(t){var e=this.getStateObjById(t);return e?e.params:null},e.prototype.navigatePrevState=function(t){t<this.stateObject.length-1&&(this.stateObject.splice(t+1,this.stateObject.length-t-1),this.gotoState(this.stateObject[this.stateObject.length-1].id,!0))},e.prototype.resetState=function(){var t=this.dashboardUtils.getRootStateId(this.states);this.stateObject=[{id:t,params:{}}],this.gotoState(t,!0)},e.prototype.getStateName=function(t,e){return this.utils.customTranslation(e.name,t)},e.prototype.displayStateSelection=function(){return this.states&&Object.keys(this.states).length>1},e.prototype.selectedStateIdChanged=function(){this.gotoState(this.stateObject[0].id,!0)},e.prototype.parseState=function(t){var e;if(t)try{e=Object(x.b)(t)}catch(o){e=[{id:null,params:{}}]}if(e||(e=[]),e.length){if(e.length>1){var n=[];n.push(e[e.length-1]),e=n}}else e[0]={id:null,params:{}};var i=this.dashboardUtils.getRootStateId(this.states);e[0].id||(e[0].id=i),this.states[e[0].id]||(e[0].id=i);for(var a=e.length;a--;)e[a].id&&this.states[e[a].id]||e.splice(a,1);return e},e.prototype.gotoState=function(t,e,n){this.dashboardCtrl.dashboardCtx.state!==t&&(this.dashboardCtrl.openDashboardState(t,n),e&&this.updateLocation())},e.prototype.updateLocation=function(){if(this.stateObject[0].id){var t=Object(x.w)(this.stateObject);this.updateStateParam(t)}},e.prototype.getStateObjById=function(t){return this.stateObject.find((function(e){return e.id===t}))},e.ctorParameters=function(){return[{type:b.Router},{type:b.ActivatedRoute},{type:a.NgZone},{type:f.a},{type:w.a},{type:C.a},{type:S.a}]},e=Object(i.c)([Object(a.Component)({selector:"tb-default-state-controller",template:Object(i.f)(n("1llQ")).default,styles:[Object(i.f)(n("+Lap")).default]}),Object(i.g)("design:paramtypes",[b.Router,b.ActivatedRoute,a.NgZone,f.a,w.a,C.a,S.a])],e)}(v),A=function(){function t(t){this.statesControllerService=t,this.statesControllerService.registerStatesController("default",I),this.statesControllerService.registerStatesController("entity",_)}return t.ctorParameters=function(){return[{type:f.a}]},t=Object(i.c)([Object(a.NgModule)({declarations:[L,I,_],imports:[o.CommonModule,r.a,h.a,s.a],exports:[L],providers:[f.a]}),Object(i.g)("design:paramtypes",[f.a])],t)}(),k=n("RxGS"),E=n("6onV"),j=n("n8IB"),D=n("o8Qb"),F=n("FBAY"),M=n("E1rE"),R=n("WEPN"),N=function(t){function e(e,n,i,a){var o=t.call(this,e)||this;return o.store=e,o.translate=n,o.itembuffer=i,o.sanitizer=a,o.dashboardStyle=null,o.hotKeys=[],o.rxSubscriptions=new Array,o.initHotKeys(),o}return Object(i.d)(e,t),Object.defineProperty(e.prototype,"layoutCtx",{get:function(){return this.layoutCtxValue},set:function(t){this.layoutCtxValue=t,this.layoutCtxValue&&(this.layoutCtxValue.ctrl=this,null==this.dashboardStyle&&this.loadDashboardStyle())},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){var t=this;this.rxSubscriptions.push(this.dashboard.dashboardTimewindowChanged.subscribe((function(e){t.dashboardCtx.dashboardTimewindow=e,t.dashboardCtx.runChangeDetection()})))},e.prototype.ngOnDestroy=function(){this.rxSubscriptions.forEach((function(t){t.unsubscribe()})),this.rxSubscriptions.length=0},e.prototype.initHotKeys=function(){var t=this;this.hotKeys.push(new j.a("ctrl+c",(function(e){if(t.isEdit&&!t.isEditingWidget&&!t.widgetEditMode){var n=t.dashboard.getSelectedWidget();n&&(e.preventDefault(),t.copyWidget(e,n))}return!1}),null,this.translate.instant("action.copy"))),this.hotKeys.push(new j.a("ctrl+r",(function(e){if(t.isEdit&&!t.isEditingWidget&&!t.widgetEditMode){var n=t.dashboard.getSelectedWidget();n&&(e.preventDefault(),t.copyWidgetReference(e,n))}return!1}),null,this.translate.instant("action.copy-reference"))),this.hotKeys.push(new j.a("ctrl+v",(function(e){return!t.isEdit||t.isEditingWidget||t.widgetEditMode||t.itembuffer.hasWidget()&&(e.preventDefault(),t.pasteWidget(e)),!1}),null,this.translate.instant("action.paste"))),this.hotKeys.push(new j.a("ctrl+i",(function(e){return!t.isEdit||t.isEditingWidget||t.widgetEditMode||t.itembuffer.canPasteWidgetReference(t.dashboardCtx.getDashboard(),t.dashboardCtx.state,t.layoutCtx.id)&&(e.preventDefault(),t.pasteWidgetReference(e)),!1}),null,this.translate.instant("action.paste-reference"))),this.hotKeys.push(new j.a("ctrl+x",(function(e){if(t.isEdit&&!t.isEditingWidget&&!t.widgetEditMode){var n=t.dashboard.getSelectedWidget();n&&(e.preventDefault(),t.layoutCtx.dashboardCtrl.removeWidget(e,t.layoutCtx,n))}return!1}),null,this.translate.instant("action.delete")))},e.prototype.loadDashboardStyle=function(){this.dashboardStyle={"background-color":this.layoutCtx.gridSettings.backgroundColor,"background-repeat":"no-repeat","background-attachment":"scroll","background-size":this.layoutCtx.gridSettings.backgroundSizeMode||"100%","background-position":"0% 0%"},this.backgroundImage=this.layoutCtx.gridSettings.backgroundImageUrl?this.sanitizer.bypassSecurityTrustStyle("url("+this.layoutCtx.gridSettings.backgroundImageUrl+")"):"none"},e.prototype.reload=function(){var t=this;this.loadDashboardStyle(),this.dashboard.pauseChangeNotifications(),setTimeout((function(){t.dashboard.resumeChangeNotifications(),t.dashboard.notifyLayoutUpdated()}),0)},e.prototype.resetHighlight=function(){this.dashboard.resetHighlight()},e.prototype.highlightWidget=function(t,e){this.dashboard.highlightWidget(t,e)},e.prototype.selectWidget=function(t,e){this.dashboard.selectWidget(t,e)},e.prototype.addWidget=function(t){this.layoutCtx.dashboardCtrl.addWidget(t,this.layoutCtx)},e.prototype.onEditWidget=function(t,e){this.layoutCtx.dashboardCtrl.editWidget(t,this.layoutCtx,e)},e.prototype.onExportWidget=function(t,e){this.layoutCtx.dashboardCtrl.exportWidget(t,this.layoutCtx,e)},e.prototype.onRemoveWidget=function(t,e){return this.layoutCtx.dashboardCtrl.removeWidget(t,this.layoutCtx,e)},e.prototype.onWidgetMouseDown=function(t,e){this.layoutCtx.dashboardCtrl.widgetMouseDown(t,this.layoutCtx,e)},e.prototype.onWidgetClicked=function(t,e){this.layoutCtx.dashboardCtrl.widgetClicked(t,this.layoutCtx,e)},e.prototype.prepareDashboardContextMenu=function(t){return this.layoutCtx.dashboardCtrl.prepareDashboardContextMenu(this.layoutCtx)},e.prototype.prepareWidgetContextMenu=function(t,e){return this.layoutCtx.dashboardCtrl.prepareWidgetContextMenu(this.layoutCtx,e)},e.prototype.copyWidget=function(t,e){this.layoutCtx.dashboardCtrl.copyWidget(t,this.layoutCtx,e)},e.prototype.copyWidgetReference=function(t,e){this.layoutCtx.dashboardCtrl.copyWidgetReference(t,this.layoutCtx,e)},e.prototype.pasteWidget=function(t){var e=this.dashboard.getEventGridPosition(t);this.layoutCtx.dashboardCtrl.pasteWidget(t,this.layoutCtx,e)},e.prototype.pasteWidgetReference=function(t){var e=this.dashboard.getEventGridPosition(t);this.layoutCtx.dashboardCtrl.pasteWidgetReference(t,this.layoutCtx,e)},e.ctorParameters=function(){return[{type:E.Store},{type:D.TranslateService},{type:F.a},{type:M.b}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",R.a)],e.prototype,"dashboardCheatSheet",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object),Object(i.g)("design:paramtypes",[Object])],e.prototype,"layoutCtx",null),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"dashboardCtx",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"isEdit",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"isEditingWidget",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"isMobile",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"widgetEditMode",void 0),Object(i.c)([Object(a.ViewChild)("dashboard",{static:!0}),Object(i.g)("design:type",Object)],e.prototype,"dashboard",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-dashboard-layout",template:Object(i.f)(n("WYFZ")).default,styles:[Object(i.f)(n("ipJt")).default]}),Object(i.g)("design:paramtypes",[E.Store,D.TranslateService,F.a,M.b])],e)}(k.a),P=n("e/A1"),V=n("oKkZ"),W=n("5xOD"),z=n("0lYY"),B=n("0G7Z"),U=function(){function t(t){this.widgetsService=t,this.widgetSelected=new a.EventEmitter,this.timeseriesWidgetTypes=[],this.latestWidgetTypes=[],this.rpcWidgetTypes=[],this.alarmWidgetTypes=[],this.staticWidgetTypes=[],this.callbacks={onWidgetClicked:this.onWidgetClicked.bind(this)}}return t.prototype.ngOnInit=function(){},t.prototype.ngOnChanges=function(t){for(var e=0,n=Object.keys(t);e<n.length;e++){var i=n[e],a=t[i];a.currentValue!==a.previousValue&&a.currentValue&&"widgetsBundle"===i&&this.loadLibrary()}},t.prototype.loadLibrary=function(){var t=this;this.timeseriesWidgetTypes.length=0,this.latestWidgetTypes.length=0,this.rpcWidgetTypes.length=0,this.alarmWidgetTypes.length=0,this.staticWidgetTypes.length=0;var e=this.widgetsBundle.alias,n=this.widgetsBundle.tenantId.id===V.a;this.widgetsService.getBundleWidgetTypes(e,n).subscribe((function(i){i=i.sort((function(t,e){return e.createdTime-t.createdTime}));var a=0;i.forEach((function(i){var o=Object(B.d)(i),r={typeId:i.id,isSystemType:n,bundleAlias:e,typeAlias:o.alias,type:o.type,title:o.widgetName,sizeX:o.sizeX,sizeY:o.sizeY,row:a,col:0,config:JSON.parse(o.defaultConfig)};switch(r.config.title=o.widgetName,o.type){case z.k.timeseries:t.timeseriesWidgetTypes.push(r);break;case z.k.latest:t.latestWidgetTypes.push(r);break;case z.k.rpc:t.rpcWidgetTypes.push(r);break;case z.k.alarm:t.alarmWidgetTypes.push(r);break;case z.k.static:t.staticWidgetTypes.push(r)}a+=r.sizeY}))}))},t.prototype.hasWidgetTypes=function(){return this.timeseriesWidgetTypes.length>0||this.latestWidgetTypes.length>0||this.rpcWidgetTypes.length>0||this.alarmWidgetTypes.length>0||this.staticWidgetTypes.length>0},t.prototype.onWidgetClicked=function(t,e,n){this.widgetSelected.emit(e)},t.ctorParameters=function(){return[{type:W.a}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],t.prototype,"widgetsBundle",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],t.prototype,"aliasController",void 0),Object(i.c)([Object(a.Output)(),Object(i.g)("design:type",a.EventEmitter)],t.prototype,"widgetSelected",void 0),t=Object(i.c)([Object(a.Component)({selector:"tb-dashboard-widget-select",template:Object(i.f)(n("Ozod")).default,styles:[Object(i.f)(n("hVuj")).default]}),Object(i.g)("design:paramtypes",[W.a])],t)}(),G=n("bE8y"),H=n("qFS8"),K=n("mAYL"),Y=n("lHnB"),Z=n("Kgme"),q=function(){function t(){}return t=Object(i.c)([Object(a.NgModule)({declarations:[l.a,p.a,c.a,u.a,g,m.a,N,P.a,U,G.a,H.a,K.a,Y.a,Z.a],imports:[o.CommonModule,r.a,h.a,s.a,A,d.b]})],t)}()},Neop:function(t,e,n){"use strict";var i=function(){this.cssImportStatements=[],this.cssKeyframeStatements=[],this.cssRegex=new RegExp("([\\s\\S]*?){([\\s\\S]*?)}","gi"),this.cssMediaQueryRegex="((@media [\\s\\S]*?){([\\s\\S]*?}\\s*?)})",this.cssKeyframeRegex="((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})",this.combinedCSSRegex="((\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",this.cssCommentsRegex="(\\/\\*[\\s\\S]*?\\*\\/)",this.cssImportStatementRegex=new RegExp("@import .*?;","gi")};i.prototype.stripComments=function(t){var e=new RegExp(this.cssCommentsRegex,"gi");return t.replace(e,"")},i.prototype.parseCSS=function(t){if(void 0===t)return[];for(var e=[];;){var n=this.cssImportStatementRegex.exec(t);if(null===n)break;this.cssImportStatements.push(n[0]),e.push({selector:"@imports",type:"imports",styles:n[0]})}t=t.replace(this.cssImportStatementRegex,"");for(var i,a=new RegExp(this.cssKeyframeRegex,"gi");null!==(i=a.exec(t));)e.push({selector:"@keyframes",type:"keyframes",styles:i[0]});t=t.replace(a,"");for(var o=new RegExp(this.combinedCSSRegex,"gi");null!==(i=o.exec(t));){var r="";r=void 0===i[2]?i[5].split("\r\n").join("\n").trim():i[2].split("\r\n").join("\n").trim();var s=new RegExp(this.cssCommentsRegex,"gi"),l=s.exec(r);if(null!==l&&(r=r.replace(s,"").trim()),-1!==r.indexOf("@media")){var c={selector:r,type:"media",subStyles:this.parseCSS(i[3]+"\n}")};null!==l&&(c.comments=l[0]),e.push(c)}else{var d={selector:r,rules:this.parseRules(i[6])};"@font-face"===r&&(d.type="font-face"),null!==l&&(d.comments=l[0]),e.push(d)}}return e},i.prototype.parseRules=function(t){var e=[];t=(t=t.split("\r\n").join("\n")).split(/;(?![^\(]*\))/);for(var n=0;n<t.length;n++){var i=t[n];if(-1!==(i=i.trim()).indexOf(":")){var a=(i=i.split(":"))[0].trim(),o=i.slice(1).join(":").trim();if(a.length<1||o.length<1)continue;e.push({directive:a,value:o})}else"base64,"==i.trim().substr(0,7)?e[e.length-1].value+=i.trim():i.length>0&&e.push({directive:"",value:i,defective:!0})}return e},i.prototype.findCorrespondingRule=function(t,e,n){void 0===n&&(n=!1);for(var i=!1,a=0;a<t.length&&(t[a].directive!=e||(i=t[a],n!==t[a].value));a++);return i},i.prototype.findBySelector=function(t,e,n){void 0===n&&(n=!1);for(var i=[],a=0;a<t.length;a++)!1===n?t[a].selector===e&&i.push(t[a]):-1!==t[a].selector.indexOf(e)&&i.push(t[a]);if(i.length<2)return i;var o=i[0];for(a=1;a<i.length;a++)this.intelligentCSSPush([o],i[a]);return[o]},i.prototype.deleteBySelector=function(t,e){for(var n=[],i=0;i<t.length;i++)t[i].selector!==e&&n.push(t[i]);return n},i.prototype.compressCSS=function(t){for(var e=[],n={},i=0;i<t.length;i++){var a=t[i];if(!0!==n[a.selector]){var o=this.findBySelector(t,a.selector);0!==o.length&&(e.push(o[0]),n[a.selector]=!0)}}return e},i.prototype.cssDiff=function(t,e){if(t.selector!==e.selector)return!1;if("media"===t.type||"media"===e.type)return!1;for(var n,i,a={selector:t.selector,rules:[]},o=0;o<t.rules.length;o++)n=t.rules[o],(!1===(i=this.findCorrespondingRule(e.rules,n.directive,n.value))||n.value!==i.value)&&a.rules.push(n);for(var r=0;r<e.rules.length;r++)i=e.rules[r],!1===(n=this.findCorrespondingRule(t.rules,i.directive))&&(i.type="DELETED",a.rules.push(i));return 0!==a.rules.length&&a},i.prototype.intelligentMerge=function(t,e,n){void 0===n&&(n=!1);for(var i=0;i<e.length;i++)this.intelligentCSSPush(t,e[i],n);for(i=0;i<t.length;i++){var a=t[i];"media"!==a.type&&"keyframes"!==a.type&&(a.rules=this.compactRules(a.rules))}},i.prototype.intelligentCSSPush=function(t,e,n){e.selector;var i=!1;if(void 0===n&&(n=!1),!1===n){for(var a=0;a<t.length;a++)if(t[a].selector===e.selector){i=t[a];break}}else for(var o=t.length-1;o>-1;o--)if(t[o].selector===e.selector){i=t[o];break}if(!1===i)t.push(e);else if("media"!==e.type)for(var r=0;r<e.rules.length;r++){var s=e.rules[r],l=this.findCorrespondingRule(i.rules,s.directive);!1===l?i.rules.push(s):"DELETED"==s.type?l.type="DELETED":l.value=s.value}else i.subStyles=e.subStyles},i.prototype.compactRules=function(t){for(var e=[],n=0;n<t.length;n++)"DELETED"!==t[n].type&&e.push(t[n]);return e},i.prototype.getCSSForEditor=function(t,e){void 0===e&&(e=0);var n="";void 0===t&&(t=this.css);for(var i=0;i<t.length;i++)"imports"==t[i].type&&(n+=t[i].styles+"\n\n");for(i=0;i<t.length;i++){var a=t[i];if(void 0!==a.selector){var o="";void 0!==a.comments&&(o=a.comments+"\n"),"media"==a.type?(n+=o+a.selector+"{\n",n+=this.getCSSForEditor(a.subStyles,e+1),n+="}\n\n"):"keyframes"!==a.type&&"imports"!==a.type&&(n+=this.getSpaces(e)+o+a.selector+" {\n",n+=this.getCSSOfRules(a.rules,e+1),n+=this.getSpaces(e)+"}\n\n")}}for(i=0;i<t.length;i++)"keyframes"==t[i].type&&(n+=t[i].styles+"\n\n");return n},i.prototype.getImports=function(t){for(var e=[],n=0;n<t.length;n++)"imports"==t[n].type&&e.push(t[n].styles);return e},i.prototype.getCSSOfRules=function(t,e){for(var n="",i=0;i<t.length;i++)void 0!==t[i]&&(void 0===t[i].defective?n+=this.getSpaces(e)+t[i].directive+" : "+t[i].value+";\n":n+=this.getSpaces(e)+t[i].value+";\n");return n||"\n"},i.prototype.getSpaces=function(t){for(var e="",n=0;n<4*t;n++)e+=" ";return e},i.prototype.applyNamespacing=function(t,e){var n=t,i="."+this.cssPreviewNamespace;void 0!==e&&(i=e),"string"==typeof t&&(n=this.parseCSS(t));for(var a=0;a<n.length;a++){var o=n[a];if(!(o.selector.indexOf("@font-face")>-1||o.selector.indexOf("keyframes")>-1||o.selector.indexOf("@import")>-1||o.selector.indexOf(".form-all")>-1||o.selector.indexOf("#stage")>-1))if("media"!==o.type){for(var r=o.selector.split(","),s=[],l=0;l<r.length;l++)-1===r[l].indexOf(".supernova")?s.push(i+" "+r[l]):s.push(r[l]);o.selector=s.join(",")}else o.subStyles=this.applyNamespacing(o.subStyles,e)}return n},i.prototype.clearNamespacing=function(t,e){void 0===e&&(e=!1);var n=t,i="."+this.cssPreviewNamespace;"string"==typeof t&&(n=this.parseCSS(t));for(var a=0;a<n.length;a++){var o=n[a];if("media"!==o.type){for(var r=o.selector.split(","),s=[],l=0;l<r.length;l++)s.push(r[l].split(i+" ").join(""));o.selector=s.join(",")}else o.subStyles=this.clearNamespacing(o.subStyles,!0)}return!1===e?this.getCSSForEditor(n):n},i.prototype.createStyleElement=function(t,e,n){if(void 0===n&&(n=!1),!1===this.testMode&&"nonamespace"!==n&&(e=this.applyNamespacing(e)),"string"!=typeof e&&(e=this.getCSSForEditor(e)),!0===n&&(e=this.getCSSForEditor(this.parseCSS(e))),!1!==this.testMode)return this.testMode("create style #"+t,e);var i=document.getElementById(t);i&&i.parentNode.removeChild(i);var a=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.id=t,o.type="text/css",a.appendChild(o),o.styleSheet&&!o.sheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))},e.a=i},OKrC:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host button.tb-layout-button {\n  width: 100%;\n  height: 100%;\n  padding: 40px 20px;\n}\n:host::ng-deep .mat-button-wrapper {\n  line-height: 18px;\n}\n:host::ng-deep .mat-button-wrapper span {\n  font-size: 18px;\n  font-weight: 400;\n  white-space: normal;\n}'},OMGm:function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var i=function(){function t(t){this.dashboard=t,this.dashboardTimewindowApi={onResetTimewindow:this.dashboard.onResetTimewindow.bind(this.dashboard),onUpdateTimewindow:this.dashboard.onUpdateTimewindow.bind(this.dashboard)}}return Object.defineProperty(t.prototype,"aliasController",{get:function(){return this.dashboard.aliasController},enumerable:!0,configurable:!0}),t}()},Ozic:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host {\n  width: 100%;\n  height: 100%;\n  min-width: 300px;\n  overflow: hidden;\n  background: #fff;\n  border-radius: 4px;\n  box-shadow: 0 7px 8px -4px rgba(0, 0, 0, 0.2), 0 13px 19px 2px rgba(0, 0, 0, 0.14), 0 5px 24px 4px rgba(0, 0, 0, 0.12);\n}\n:host .mat-content {\n  overflow: hidden;\n  background-color: #fff;\n}\n:host .mat-padding {\n  padding: 16px;\n}'},Ozod:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div>\n  <mat-tab-group *ngIf="hasWidgetTypes()" class="tb-absolute-fill" fxFlex>\n    <mat-tab *ngIf="timeseriesWidgetTypes.length" style="height: 100%;" label="{{ \'widget.timeseries\' | translate }}">\n      <tb-dashboard [aliasController]="aliasController"\n                    [widgets]="timeseriesWidgetTypes"\n                    [widgetLayouts]="{}"\n                    [isEdit]="false"\n                    [isMobile]="true"\n                    [isEditActionEnabled]="false"\n                    [isExportActionEnabled]="false"\n                    [isRemoveActionEnabled]="false"\n                    [callbacks]="callbacks"></tb-dashboard>\n    </mat-tab>\n    <mat-tab *ngIf="latestWidgetTypes.length" style="height: 100%;" label="{{ \'widget.latest-values\' | translate }}">\n      <tb-dashboard [aliasController]="aliasController"\n                    [widgets]="latestWidgetTypes"\n                    [widgetLayouts]="{}"\n                    [isEdit]="false"\n                    [isMobile]="true"\n                    [isEditActionEnabled]="false"\n                    [isExportActionEnabled]="false"\n                    [isRemoveActionEnabled]="false"\n                    [callbacks]="callbacks"></tb-dashboard>\n    </mat-tab>\n    <mat-tab *ngIf="rpcWidgetTypes.length" style="height: 100%;" label="{{ \'widget.rpc\' | translate }}">\n      <tb-dashboard [aliasController]="aliasController"\n                    [widgets]="rpcWidgetTypes"\n                    [widgetLayouts]="{}"\n                    [isEdit]="false"\n                    [isMobile]="true"\n                    [isEditActionEnabled]="false"\n                    [isExportActionEnabled]="false"\n                    [isRemoveActionEnabled]="false"\n                    [callbacks]="callbacks"></tb-dashboard>\n    </mat-tab>\n    <mat-tab *ngIf="alarmWidgetTypes.length" style="height: 100%;" label="{{ \'widget.alarm\' | translate }}">\n      <tb-dashboard [aliasController]="aliasController"\n                    [widgets]="alarmWidgetTypes"\n                    [widgetLayouts]="{}"\n                    [isEdit]="false"\n                    [isMobile]="true"\n                    [isEditActionEnabled]="false"\n                    [isExportActionEnabled]="false"\n                    [isRemoveActionEnabled]="false"\n                    [callbacks]="callbacks"></tb-dashboard>\n    </mat-tab>\n    <mat-tab *ngIf="staticWidgetTypes.length" style="height: 100%;" label="{{ \'widget.static\' | translate }}">\n      <tb-dashboard [aliasController]="aliasController"\n                    [widgets]="staticWidgetTypes"\n                    [widgetLayouts]="{}"\n                    [isEdit]="false"\n                    [isMobile]="true"\n                    [isEditActionEnabled]="false"\n                    [isExportActionEnabled]="false"\n                    [isRemoveActionEnabled]="false"\n                    [callbacks]="callbacks"></tb-dashboard>\n    </mat-tab>\n  </mat-tab-group>\n  <span translate *ngIf="widgetsBundle && !hasWidgetTypes()"\n        style="text-transform: uppercase; display: flex;"\n        fxLayoutAlign="center center"\n        class="mat-headline tb-absolute-fill">widgets-bundle.empty</span>\n  <span translate *ngIf="!widgetsBundle"\n        style="text-transform: uppercase; display: flex;"\n        fxLayoutAlign="center center"\n        class="mat-headline tb-absolute-fill">widget.select-widgets-bundle</span>\n</div>\n'},"PKp+":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form [formGroup]="stateFormGroup" (ngSubmit)="save()" style="min-width: 480px;">\n  <mat-toolbar color="primary">\n    <h2 translate>{{ isAdd ? \'dashboard.add-state\' : \'dashboard.edit-state\' }}</h2>\n    <span fxFlex></span>\n    <button mat-button mat-icon-button\n            (click)="cancel()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div mat-dialog-content>\n    <fieldset [disabled]="isLoading$ | async" fxLayout="column">\n      <mat-form-field class="mat-block">\n        <mat-label translate>dashboard.state-name</mat-label>\n        <input required matInput formControlName="name">\n        <mat-error *ngIf="stateFormGroup.get(\'name\').hasError(\'required\')">\n          {{ \'dashboard.state-name-required\' | translate }}\n        </mat-error>\n      </mat-form-field>\n      <mat-form-field class="mat-block">\n        <mat-label translate>dashboard.state-id</mat-label>\n        <input required matInput formControlName="id">\n        <mat-error *ngIf="stateFormGroup.get(\'id\').hasError(\'required\')">\n          {{ \'dashboard.state-id-required\' | translate }}\n        </mat-error>\n        <mat-error *ngIf="stateFormGroup.get(\'id\').hasError(\'stateExists\')">\n          {{ \'dashboard.state-id-exists\' | translate }}\n        </mat-error>\n      </mat-form-field>\n      <mat-checkbox formControlName="root">\n        {{ \'dashboard.is-root-state\' | translate }}\n      </mat-checkbox>\n    </fieldset>\n  </div>\n  <div mat-dialog-actions fxLayoutAlign="end center">\n    <button mat-raised-button color="primary"\n            type="submit"\n            [disabled]="(isLoading$ | async) || stateFormGroup.invalid || !stateFormGroup.dirty">\n      {{ (isAdd ? \'action.add\' : \'action.save\') | translate }}\n    </button>\n    <button mat-button color="primary"\n            type="button"\n            [disabled]="(isLoading$ | async)"\n            (click)="cancel()" cdkFocusInitial>\n      {{ \'action.cancel\' | translate }}\n    </button>\n  </div>\n</form>\n'},PX9o:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<button cdkOverlayOrigin #legendConfigPanelOrigin="cdkOverlayOrigin" [disabled]="disabled"\n        type="button"\n        mat-button mat-raised-button color="primary" (click)="openEditMode()">\n  <mat-icon class="material-icons">toc</mat-icon>\n  <span translate>legend.settings</span>\n</button>\n'},Q2GN:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<section class="tb-aliases-entity-select" fxLayout="row" fxLayoutAlign="start center">\n  <button mat-icon-button\n          cdkOverlayOrigin #aliasEntitySelectPanelOrigin="cdkOverlayOrigin"\n          (click)="openEditMode()"\n          matTooltip="{{ hasSelectableAliasEntities ? (\'entity.select-entities\' | translate) : \'\' }}"\n          [matTooltipPosition]="tooltipPosition">\n    <mat-icon class="material-icons">devices_other</mat-icon>\n  </button>\n  <span fxHide.lt-lg\n        (click)="openEditMode()"\n        matTooltip="{{ hasSelectableAliasEntities ? (\'entity.select-entities\' | translate) : \'\' }}"\n        [matTooltipPosition]="tooltipPosition">\n    {{displayValue}}\n  </span>\n</section>\n'},Q4qZ:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form (ngSubmit)="save()">\n  <mat-toolbar color="primary">\n    <h2 translate>{{settings ? \'dashboard.settings\' : \'layout.settings\'}}</h2>\n    <span fxFlex></span>\n    <button mat-button mat-icon-button\n            (click)="cancel()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div mat-dialog-content>\n    <fieldset [disabled]="isLoading$ | async" fxLayout="column" fxLayoutGap="16px">\n      <div *ngIf="settings" [formGroup]="settingsFormGroup">\n        <mat-form-field class="mat-block">\n          <mat-label translate>dashboard.state-controller</mat-label>\n          <mat-select required formControlName="stateControllerId">\n            <mat-option *ngFor="let stateControllerId of stateControllerIds" [value]="stateControllerId">\n              {{stateControllerId}}\n            </mat-option>\n          </mat-select>\n        </mat-form-field>\n        <div fxLayout="row" fxLayoutAlign="start center" fxLayout.lt-md="column" fxLayoutAlign.lt-md fxLayoutGap="8px">\n          <mat-checkbox fxFlex formControlName="toolbarAlwaysOpen">\n            {{ \'dashboard.toolbar-always-open\' | translate }}\n          </mat-checkbox>\n          <mat-checkbox fxFlex formControlName="showTitle">\n            {{ \'dashboard.display-title\' | translate }}\n          </mat-checkbox>\n          <tb-color-input fxFlex\n                          label="{{\'dashboard.title-color\' | translate}}"\n                          icon="format_color_fill"\n                          openOnInput\n                          formControlName="titleColor">\n          </tb-color-input>\n        </div>\n        <div fxLayout="row" fxLayoutAlign="start center" fxLayout.lt-md="column" fxLayoutAlign.lt-md  fxLayoutGap="8px">\n          <mat-checkbox fxFlex formControlName="showDashboardsSelect">\n            {{ \'dashboard.display-dashboards-selection\' | translate }}\n          </mat-checkbox>\n          <mat-checkbox fxFlex formControlName="showEntitiesSelect">\n            {{ \'dashboard.display-entities-selection\' | translate }}\n          </mat-checkbox>\n          <mat-checkbox fxFlex formControlName="showDashboardTimewindow">\n            {{ \'dashboard.display-dashboard-timewindow\' | translate }}\n          </mat-checkbox>\n          <mat-checkbox fxFlex formControlName="showDashboardExport">\n            {{ \'dashboard.display-dashboard-export\' | translate }}\n          </mat-checkbox>\n        </div>\n      </div>\n      <div *ngIf="gridSettings" [formGroup]="gridSettingsFormGroup">\n        <tb-color-input fxFlex\n                        label="{{\'layout.color\' | translate}}"\n                        icon="format_color_fill"\n                        openOnInput\n                        formControlName="color">\n        </tb-color-input>\n        <mat-form-field class="mat-block">\n          <mat-label translate>dashboard.columns-count</mat-label>\n          <input matInput formControlName="columns" type="number" step="any" min="10"\n                 max="1000" required>\n          <mat-error *ngIf="gridSettingsFormGroup.get(\'columns\').hasError(\'required\')">\n            {{ \'dashboard.columns-count-required\' | translate }}\n          </mat-error>\n          <mat-error *ngIf="gridSettingsFormGroup.get(\'columns\').hasError(\'min\')">\n            {{ \'dashboard.min-columns-count-message\' | translate }}\n          </mat-error>\n          <mat-error *ngIf="gridSettingsFormGroup.get(\'columns\').hasError(\'max\')">\n            {{ \'dashboard.max-columns-count-message\' | translate }}\n          </mat-error>\n        </mat-form-field>\n        <mat-form-field fxFlex class="mat-block">\n          <mat-label translate>dashboard.widgets-margins</mat-label>\n          <input matInput formControlName="margin" type="number" step="any" min="0"\n                 max="50" required>\n          <mat-error *ngIf="gridSettingsFormGroup.get(\'margin\').hasError(\'required\')">\n            {{ \'dashboard.margin-required\' | translate }}\n          </mat-error>\n          <mat-error *ngIf="gridSettingsFormGroup.get(\'margin\').hasError(\'min\')">\n            {{ \'dashboard.min-margin-message\' | translate }}\n          </mat-error>\n          <mat-error *ngIf="gridSettingsFormGroup.get(\'margin\').hasError(\'max\')">\n            {{ \'dashboard.max-margin-message\' | translate }}\n          </mat-error>\n        </mat-form-field>\n        <mat-checkbox fxFlex formControlName="autoFillHeight" style="display: block; padding-bottom: 12px;">\n          {{ \'dashboard.autofill-height\' | translate }}\n        </mat-checkbox>\n        <tb-color-input fxFlex\n                        label="{{\'dashboard.background-color\' | translate}}"\n                        icon="format_color_fill"\n                        openOnInput\n                        formControlName="backgroundColor">\n        </tb-color-input>\n        <tb-image-input fxFlex\n                        label="{{\'dashboard.background-image\' | translate}}"\n                        formControlName="backgroundImageUrl">\n        </tb-image-input>\n        <mat-form-field class="mat-block">\n          <mat-label translate>dashboard.background-size-mode</mat-label>\n          <mat-select formControlName="backgroundSizeMode">\n            <mat-option value="100%">Fit width</mat-option>\n            <mat-option value="auto 100%">Fit height</mat-option>\n            <mat-option value="cover">Cover</mat-option>\n            <mat-option value="contain">Contain</mat-option>\n            <mat-option value="auto">Original size</mat-option>\n          </mat-select>\n        </mat-form-field>\n        <small translate>dashboard.mobile-layout</small>\n        <div fxLayout="row" fxLayoutAlign="start center" fxLayout.xs="column" fxLayoutAlign.xs fxLayoutGap="8px"  style="margin-top: 8px">\n          <mat-checkbox fxFlex formControlName="mobileAutoFillHeight">\n            {{ \'dashboard.autofill-height\' | translate }}\n          </mat-checkbox>\n          <mat-form-field fxFlex class="mat-block">\n            <mat-label translate>dashboard.mobile-row-height</mat-label>\n            <input matInput formControlName="mobileRowHeight" type="number" step="any" min="5"\n                   max="200" required>\n            <mat-error *ngIf="gridSettingsFormGroup.get(\'mobileRowHeight\').hasError(\'required\')">\n              {{ \'dashboard.mobile-row-height-required\' | translate }}\n            </mat-error>\n            <mat-error *ngIf="gridSettingsFormGroup.get(\'mobileRowHeight\').hasError(\'min\')">\n              {{ \'dashboard.min-mobile-row-height-message\' | translate }}\n            </mat-error>\n            <mat-error *ngIf="gridSettingsFormGroup.get(\'mobileRowHeight\').hasError(\'max\')">\n              {{ \'dashboard.max-mobile-row-height-message\' | translate }}\n            </mat-error>\n          </mat-form-field>\n        </div>\n      </div>\n    </fieldset>\n  </div>\n  <div mat-dialog-actions fxLayoutAlign="end center">\n    <button mat-raised-button color="primary"\n            type="submit"\n            [disabled]="(isLoading$ | async) || settingsFormGroup.invalid || gridSettingsFormGroup.invalid\n                         || (!settingsFormGroup.dirty && !gridSettingsFormGroup.dirty)">\n      {{ \'action.save\' | translate }}\n    </button>\n    <button mat-button color="primary"\n            type="button"\n            [disabled]="(isLoading$ | async)"\n            (click)="cancel()" cdkFocusInitial>\n      {{ \'action.cancel\' | translate }}\n    </button>\n  </div>\n</form>\n'},Q7pZ:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n("mrSG"),a=n("TYT/"),o=n("Y8nr"),r=n("cUzu"),s=function(){function t(t){this.http=t}return t.prototype.getAuditLogs=function(t,e){return this.http.get("/api/audit/logs"+t.toQuery(),Object(o.b)(e))},t.prototype.getAuditLogsByCustomerId=function(t,e,n){return this.http.get("/api/audit/logs/customer/"+t+e.toQuery(),Object(o.b)(n))},t.prototype.getAuditLogsByUserId=function(t,e,n){return this.http.get("/api/audit/logs/user/"+t+e.toQuery(),Object(o.b)(n))},t.prototype.getAuditLogsByEntityId=function(t,e,n){return this.http.get("/api/audit/logs/entity/"+t.entityType+"/"+t.id+e.toQuery(),Object(o.b)(n))},t.ctorParameters=function(){return[{type:r.b}]},t=Object(i.c)([Object(a.Injectable)({providedIn:"root"}),Object(i.g)("design:paramtypes",[r.b])],t)}()},QG5L:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div class="tb-table-widget tb-absolute-fill">\n  <div fxFlex fxLayout="column" class="tb-absolute-fill">\n    <mat-toolbar class="mat-table-toolbar" [fxShow]="textSearchMode">\n      <div class="mat-toolbar-tools">\n        <button mat-button mat-icon-button\n                matTooltip="{{ \'action.search\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>search</mat-icon>\n        </button>\n        <mat-form-field fxFlex>\n          <mat-label>&nbsp;</mat-label>\n          <input #searchInput matInput\n                 [(ngModel)]="pageLink.textSearch"\n                 placeholder="{{ \'entity.search\' | translate }}"/>\n        </mat-form-field>\n        <button mat-button mat-icon-button (click)="exitFilterMode()"\n                matTooltip="{{ \'action.close\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>close</mat-icon>\n        </button>\n      </div>\n    </mat-toolbar>\n    <div fxFlex class="table-container">\n      <table mat-table [dataSource]="entityDatasource"\n                 matSort [matSortActive]="sortOrderProperty" [matSortDirection]="pageLink.sortDirection()" matSortDisableClear>\n        <ng-container [matColumnDef]="column.def" *ngFor="let column of columns; trackBy: trackByColumnDef;">\n          <mat-header-cell [ngStyle]="headerStyle(column)" *matHeaderCellDef mat-sort-header> {{ column.title }} </mat-header-cell>\n          <mat-cell *matCellDef="let entity;"\n                    [innerHTML]="cellContent(entity, column)"\n                    [ngStyle]="cellStyle(entity, column)">\n          </mat-cell>\n        </ng-container>\n        <ng-container matColumnDef="actions" stickyEnd>\n          <mat-header-cell *matHeaderCellDef [ngStyle.gt-md]="{ minWidth: (actionCellDescriptors.length * 40) + \'px\',\n                                                                maxWidth: (actionCellDescriptors.length * 40) + \'px\',\n                                                                width: (actionCellDescriptors.length * 40) + \'px\' }">\n          </mat-header-cell>\n          <mat-cell *matCellDef="let entity" [ngStyle.gt-md]="{ minWidth: (actionCellDescriptors.length * 40) + \'px\',\n                                                                maxWidth: (actionCellDescriptors.length * 40) + \'px\',\n                                                                width: (actionCellDescriptors.length * 40) + \'px\' }">\n            <div fxHide fxShow.gt-md fxFlex fxLayout="row" fxLayoutAlign="end">\n              <button mat-button mat-icon-button [disabled]="isLoading$ | async"\n                      *ngFor="let actionDescriptor of actionCellDescriptors"\n                      matTooltip="{{ actionDescriptor.displayName }}"\n                      matTooltipPosition="above"\n                      (click)="onActionButtonClick($event, entity, actionDescriptor)">\n                <mat-icon>{{actionDescriptor.icon}}</mat-icon>\n              </button>\n            </div>\n            <div fxHide fxShow.lt-lg *ngIf="actionCellDescriptors.length">\n              <button mat-button mat-icon-button\n                      (click)="$event.stopPropagation(); ctx.detectChanges();"\n                      [matMenuTriggerFor]="cellActionsMenu">\n                <mat-icon class="material-icons">more_vert</mat-icon>\n              </button>\n              <mat-menu #cellActionsMenu="matMenu" xPosition="before">\n                <button mat-menu-item *ngFor="let actionDescriptor of actionCellDescriptors"\n                        [disabled]="isLoading$ | async"\n                        (click)="onActionButtonClick($event, entity, actionDescriptor)">\n                  <mat-icon>{{actionDescriptor.icon}}</mat-icon>\n                  <span>{{ actionDescriptor.displayName }}</span>\n                </button>\n              </mat-menu>\n            </div>\n          </mat-cell>\n        </ng-container>\n        <mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></mat-header-row>\n        <mat-row [ngClass]="{\'tb-current-entity\': entityDatasource.isCurrentEntity(entity)}"\n                 *matRowDef="let entity; columns: displayedColumns;"\n                 (click)="onRowClick($event, entity)" (dblclick)="onRowClick($event, entity, true)"></mat-row>\n      </table>\n      <span [fxShow]="entityDatasource.isEmpty() | async"\n            fxLayoutAlign="center center"\n            class="no-data-found" translate>entity.no-entities-prompt</span>\n    </div>\n    <mat-divider *ngIf="displayPagination"></mat-divider>\n    <mat-paginator *ngIf="displayPagination"\n                   [length]="entityDatasource.total() | async"\n                   [pageIndex]="pageLink.page"\n                   [pageSize]="pageLink.pageSize"\n                   [pageSizeOptions]="pageSizeOptions"></mat-paginator>\n  </div>\n</div>\n'},QR2c:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var i=n("mrSG"),a=n("rxPF"),o=n("Zss7"),r=n("//Q6"),s=a.GenericOptions,l=a.BaseGauge,c=o,d=Object(i.a)(Object(i.a)({},s),{gaugeType:"arc",gaugeWithScale:.75,dashThickness:0,roundedLineCap:!1,gaugeColor:"#777",levelColors:["blue"],symbol:"",label:"",hideValue:!1,hideMinMax:!1,fontTitle:"Roboto",fontValue:"Roboto",fontMinMaxSize:10,fontMinMaxStyle:"normal",fontMinMaxWeight:"500",colorMinMax:"#eee",fontMinMax:"Roboto",fontLabelSize:8,fontLabelStyle:"normal",fontLabelWeight:"500",colorLabel:"#eee",fontLabel:"Roboto",neonGlowBrightness:0,colorTicks:"gray",tickWidth:4,ticks:[],isMobile:!1});l.initialize("CanvasDigitalGauge",d);var u=function(){function t(){}return t.font=function(t,e,n){return t["font"+e+"Style"]+" "+t["font"+e+"Weight"]+" "+t["font"+e+"Size"]*n+"px "+t["font"+e]},t.normalizedValue=function(t){var e=t.value,n=t.minValue,i=t.maxValue,a=.01*(i-n);return{normal:e<n?n:e>i?i:e,indented:e<n?n-a:e>i?i+a:e}},t.verifyError=function(t){if(!(t instanceof DOMException&&2152923147===t.result))throw t},t}(),h=function(t){function e(n){var a=this;return n=Object(i.a)(Object(i.a)({},d),n||{}),(a=t.call(this,e.configure(n))||this).initValueClone(),a}return Object(i.d)(e,t),e.configure=function(t){t.value>t.maxValue&&(t.value=t.maxValue),t.value<t.minValue&&(t.value=t.minValue),"donut"===t.gaugeType&&(t.donutStartAngle||(t.donutStartAngle=1.5*Math.PI),t.donutEndAngle||(t.donutEndAngle=t.donutStartAngle+2*Math.PI));var n=t.levelColors.length,i=Object(r.t)(t.levelColors[0]),a=n>1?1/(n-1):1;t.colorsRange=[],t.neonGlowBrightness&&(t.neonColorsRange=[]);for(var o=0;o<t.levelColors.length;o++){var s=t.levelColors[o];if(null!==s){var l=void 0;l=i?a*o:e.normalizeValue(s.value,t.minValue,t.maxValue);var d=c(i?s:s.color);t.colorsRange.push({pct:l,color:d.toRgb(),rgbString:d.toRgbString()}),t.neonGlowBrightness&&(d=c(i?s:s.color).brighten(t.neonGlowBrightness),t.neonColorsRange.push({pct:l,color:d.toRgb(),rgbString:d.toRgbString()}))}}t.ticksValue=[];for(var u=0,h=t.ticks;u<h.length;u++){var p=h[u];null!==p&&t.ticksValue.push(e.normalizeValue(p,t.minValue,t.maxValue))}return t.neonGlowBrightness&&(t.neonColorTitle=c(t.colorTitle).brighten(t.neonGlowBrightness).toHexString(),t.neonColorLabel=c(t.colorLabel).brighten(t.neonGlowBrightness).toHexString(),t.neonColorValue=c(t.colorValue).brighten(t.neonGlowBrightness).toHexString(),t.neonColorMinMax=c(t.colorMinMax).brighten(t.neonGlowBrightness).toHexString()),t},e.normalizeValue=function(t,e,n){var i=(t-e)/(n-e);return i<=0?0:i>=1?1:i},e.prototype.initValueClone=function(){var t=this.canvas;this.elementValueClone=t.element.cloneNode(!0),this.contextValueClone=this.elementValueClone.getContext("2d"),this.elementValueClone.initialized=!1,this.contextValueClone.translate(t.drawX,t.drawY),this.contextValueClone.save(),this.elementProgressClone=t.element.cloneNode(!0),this.contextProgressClone=this.elementProgressClone.getContext("2d"),this.elementProgressClone.initialized=!1,this.contextProgressClone.translate(t.drawX,t.drawY),this.contextProgressClone.save()},e.prototype.destroy=function(){this.contextValueClone=null,this.elementValueClone=null,this.contextProgressClone=null,this.elementProgressClone=null,t.prototype.destroy.call(this)},e.prototype.update=function(e){this.canvas.onRedraw=null;var n=t.prototype.update.call(this,e);return this.initValueClone(),this.canvas.onRedraw=this.draw.bind(this),this.draw(),n},Object.defineProperty(e.prototype,"timestamp",{get:function(){return this.options.timestamp},set:function(t){this.options.timestamp=t,this.draw()},enumerable:!0,configurable:!0}),e.prototype.draw=function(){try{var e=this.canvas;if(!e.drawWidth||!e.drawHeight)return this;var n=[-e.drawX,-e.drawY,e.drawWidth,e.drawHeight],i=n[0],a=n[1],o=n[2],s=n[3],l=this.options,c=e.elementClone;if(!c.initialized){(x=e.contextClone).clearRect(i,a,o,s),x.save();var d=e.context;d.barDimensions=function(t,e,n,i,a,o){t.barDimensions={baseX:n,baseY:i,width:a,height:o};var r=t.barDimensions,s=1;"horizontalBar"===e.gaugeType?s=""===e.title?2.5:2:"verticalBar"===e.gaugeType?s=e.hideMinMax?.35:.5:"arc"===e.gaugeType&&(s=1.5);a/o>s?(r.width=o*s,r.height=o):(r.width=a,r.height=a/s);r.origBaseX=r.baseX,r.origBaseY=r.baseY,r.baseX+=(a-r.width)/2,r.baseY+=(o-r.height)/2,"donut"===e.gaugeType?r.fontSizeFactor=Math.max(r.width,r.height)/125:"verticalBar"===e.gaugeType||"arc"===e.gaugeType&&""===e.title?r.fontSizeFactor=Math.max(r.width,r.height)/150:r.fontSizeFactor=Math.max(r.width,r.height)/200;var l=e.gaugeWidthScale;e.neonGlowBrightness&&(e.fontTitleHeight=p(e,"Title",r.fontSizeFactor),e.fontLabelHeight=p(e,"Label",r.fontSizeFactor),e.fontValueHeight=p(e,"Value",r.fontSizeFactor),e.fontMinMaxHeight=p(e,"MinMax",r.fontSizeFactor));if("donut"===e.gaugeType){if(r.Ro=r.width/2-r.width/20,r.Cy=r.baseY+r.height/2,e.title&&"string"==typeof e.title&&e.title.length>0){var c=p(e,"Title",r.fontSizeFactor).height;c+=2*r.fontSizeFactor,r.titleY=r.baseY+c,c+=2*r.fontSizeFactor,r.Cy+=c/2,r.Ro-=c/2}r.Ri=r.Ro-r.width/6.666666666666667*l*1.2,r.Cx=r.baseX+r.width/2}else"arc"===e.gaugeType?(e.title&&"string"==typeof e.title&&e.title.length>0?(r.Ro=r.width/2-r.width/7,r.Ri=r.Ro-r.width/6.666666666666667*l):(r.Ro=r.width/2-4*r.fontSizeFactor,r.Ri=r.Ro-r.width/6.666666666666667*l*1.2),r.Cx=r.baseX+r.width/2,r.Cy=r.baseY+r.height/1.25):"verticalBar"===e.gaugeType?(r.Ro=r.width/2-r.width/10,r.Ri=r.Ro-r.width/6.666666666666667*l*(e.hideMinMax?4:2.5)):(r.Ro=r.width/2-r.width/10,r.Ri=r.Ro-r.width/6.666666666666667*l);if(r.strokeWidth=r.Ro-r.Ri,r.Rm=r.Ri+.5*r.strokeWidth,r.fontValueBaseline="alphabetic",r.fontMinMaxBaseline="alphabetic",r.fontMinMaxAlign="center","donut"===e.gaugeType)if(r.fontValueBaseline="middle",e.label&&e.label.length>0){var d=p(e,"Value",r.fontSizeFactor).height,h=p(e,"Label",r.fontSizeFactor).height,m=d+h;r.labelY=r.Cy+m/2,r.valueY=r.Cy-m/2+d/2}else r.valueY=r.Cy;else if("arc"===e.gaugeType)r.titleY=r.Cy-r.Ro-12*r.fontSizeFactor,r.valueY=r.Cy,r.labelY=r.Cy+(8+e.fontLabelSize)*r.fontSizeFactor,r.minY=r.maxY=r.labelY,e.roundedLineCap&&(r.minY+=r.strokeWidth/2,r.maxY+=r.strokeWidth/2),r.minX=r.Cx-r.Rm,r.maxX=r.Cx+r.Rm;else if("horizontalBar"===e.gaugeType)if(r.titleY=r.baseY+4*r.fontSizeFactor+(""===e.title?0:e.fontTitleSize*r.fontSizeFactor),r.titleBottom=r.titleY+(""===e.title?0:4)*r.fontSizeFactor,r.valueY=r.titleBottom+(e.hideValue?0:e.fontValueSize*r.fontSizeFactor),r.barTop=r.valueY+8*r.fontSizeFactor,r.barBottom=r.barTop+r.strokeWidth,e.hideMinMax&&""===e.label)r.labelY=r.barBottom,r.barLeft=r.origBaseX+e.fontMinMaxSize/3*r.fontSizeFactor,r.barRight=r.origBaseX+a+-e.fontMinMaxSize/3*r.fontSizeFactor;else{t.font=u.font(e,"MinMax",r.fontSizeFactor);var g=t.measureText(e.minValue+"").width,f=t.measureText(e.maxValue+"").width,b=Math.max(g,f);r.minX=r.origBaseX+b/2+e.fontMinMaxSize/3*r.fontSizeFactor,r.maxX=r.origBaseX+a+-b/2-e.fontMinMaxSize/3*r.fontSizeFactor,r.barLeft=r.minX,r.barRight=r.maxX,r.labelY=r.barBottom+(8+e.fontLabelSize)*r.fontSizeFactor,r.minY=r.maxY=r.labelY}else"verticalBar"===e.gaugeType&&(r.titleY=r.baseY+((""===e.title?0:e.fontTitleSize)+8)*r.fontSizeFactor,r.titleBottom=r.titleY+(""===e.title?0:4)*r.fontSizeFactor,r.valueY=r.titleBottom+(e.hideValue?0:e.fontValueSize*r.fontSizeFactor),r.barTop=r.valueY+8*r.fontSizeFactor,r.labelY=r.baseY+r.height-16,""===e.label?r.barBottom=r.labelY:r.barBottom=r.labelY-(8+e.fontLabelSize)*r.fontSizeFactor,r.minX=r.maxX=r.baseX+r.width/2+r.strokeWidth/2+e.fontMinMaxSize/3*r.fontSizeFactor,r.minY=r.barBottom,r.maxY=r.barTop,r.fontMinMaxBaseline="middle",r.fontMinMaxAlign="left");if(e.dashThickness){var y=void 0;"donut"===e.gaugeType?y=Math.PI*r.Rm*2:"arc"===e.gaugeType?y=Math.PI*r.Rm:"horizontalBar"===e.gaugeType?y=r.barRight-r.barLeft:"verticalBar"===e.gaugeType&&(y=r.barBottom-r.barTop);var v=Math.floor(y/(e.dashThickness*r.fontSizeFactor));v="donut"===e.gaugeType?(1|v)-1:v-1|1,r.dashLength=Math.ceil(y/v)}return r}(x,l,i,a,o,s),this.contextValueClone.barDimensions=d.barDimensions,this.contextProgressClone.barDimensions=d.barDimensions,function(t,e){var n=t.barDimensions,i=n.barLeft,a=n.barRight,o=n.barTop,r=n.barBottom,s=n.width,l=n.baseX,c=n.strokeWidth;t.barDimensions.dashLength&&t.setLineDash([t.barDimensions.dashLength]);t.beginPath(),t.strokeStyle=e.gaugeColor,t.lineWidth=c,e.roundedLineCap&&(t.lineCap="round");"donut"===e.gaugeType?(t.arc(t.barDimensions.Cx,t.barDimensions.Cy,t.barDimensions.Rm,e.donutStartAngle,e.donutEndAngle),t.stroke()):"arc"===e.gaugeType?(t.arc(t.barDimensions.Cx,t.barDimensions.Cy,t.barDimensions.Rm,Math.PI,2*Math.PI),t.stroke()):"horizontalBar"===e.gaugeType?(t.moveTo(i,o+c/2),t.lineTo(a,o+c/2),t.stroke()):"verticalBar"===e.gaugeType&&(t.moveTo(l+s/2,r),t.lineTo(l+s/2,o),t.stroke())}(x,l),function(t,e){if(!e.title||"string"!=typeof e.title)return;var n=t.barDimensions,i=n.titleY,a=n.width,o=n.baseX,r=n.fontSizeFactor,s=Math.round(o+a/2),l=i;t.save(),t.textAlign="center",t.font=u.font(e,"Title",r),t.lineWidth=0,m(t,e,"Title",e.title.toUpperCase(),s,l)}(x,l),l.showTimestamp||g(x,l),function(t,e){if(e.hideMinMax||"donut"===e.gaugeType)return;var n=t.barDimensions,i=n.minY,a=n.maxY,o=n.minX,r=n.maxX,s=n.fontSizeFactor,l=n.fontMinMaxAlign,c=n.fontMinMaxBaseline;t.save(),t.textAlign=l,t.textBaseline=c,t.font=u.font(e,"MinMax",s),t.lineWidth=0,m(t,e,"MinMax",e.minValue+"",o,i),m(t,e,"MinMax",e.maxValue+"",r,a)}(x,l),c.initialized=!0}var h=!1;if(!this.elementValueClone.initialized||Object(r.k)(this._value)&&this.elementValueClone.renderedValue!==this._value||l.showTimestamp&&this.elementValueClone.renderedTimestamp!==this.timestamp)Object(r.k)(this._value)&&(this.elementValueClone.renderedValue=this._value),Object(r.u)(this.elementValueClone.renderedValue)&&(this.elementValueClone.renderedValue=this.value),(x=this.contextValueClone).clearRect(i,a,o,s),x.save(),x.drawImage(e.elementClone,i,a,o,s),x.save(),function(t,e,n){if(e.hideValue)return;var i=t.barDimensions,a=i.valueY,o=i.baseX,s=i.width,l=i.fontSizeFactor,c=i.fontValueBaseline,d=Math.round(o+s/2),h=a,p=e.valueText||Object(r.A)(n,e.valueDec);p+=e.symbol,t.save(),t.textAlign="center",t.textBaseline=c,t.font=u.font(e,"Value",l),t.lineWidth=0,m(t,e,"Value",p,d,h)}(x,l,this.elementValueClone.renderedValue),l.showTimestamp&&(g(x,l),this.elementValueClone.renderedTimestamp=this.timestamp),this.elementValueClone.initialized=!0,h=!0;var x,S=(u.normalizedValue(l).normal-l.minValue)/(l.maxValue-l.minValue),C=S.toFixed(3);if(!this.elementProgressClone.initialized||this.elementProgressClone.renderedProgress!==C||h)(x=this.contextProgressClone).clearRect(i,a,o,s),x.save(),x.drawImage(this.elementValueClone,i,a,o,s),x.save(),Number(C)>0&&function(t,e,n){var i;e.neonGlowBrightness?t.currentColor=i=f(n,e.neonColorsRange):t.currentColor=t.strokeStyle=f(n,e.colorsRange);var a=t.barDimensions,o=a.barLeft,r=a.barRight,s=a.barTop,l=a.baseX,c=a.width,d=a.barBottom,u=a.Cx,h=a.Cy,p=a.Rm,m=a.Ro,g=a.Ri,x=a.strokeWidth;t.barDimensions.dashLength&&t.setLineDash([t.barDimensions.dashLength]);t.lineWidth=x,e.roundedLineCap?t.lineCap="round":t.lineCap="butt";"donut"===e.gaugeType?(e.neonGlowBrightness&&(t.strokeStyle=i),t.beginPath(),t.arc(u,h,p,e.donutStartAngle,e.donutStartAngle+(e.donutEndAngle-e.donutStartAngle)*n),t.stroke(),e.neonGlowBrightness&&!e.isMobile&&b(t,u,h,g,p,m,i,n,!0,e.donutStartAngle,e.donutEndAngle),v(t,e.ticksValue,u,h,g,p,m,e.donutStartAngle,e.donutEndAngle-e.donutStartAngle,e.colorTicks,e.tickWidth)):"arc"===e.gaugeType?(e.neonGlowBrightness&&(t.strokeStyle=i),t.beginPath(),t.arc(u,h,p,Math.PI,Math.PI+Math.PI*n),t.stroke(),e.neonGlowBrightness&&!e.isMobile&&b(t,u,h,g,p,m,i,n,!1),v(t,e.ticksValue,u,h,g,p,m,Math.PI,Math.PI,e.colorTicks,e.tickWidth)):"horizontalBar"===e.gaugeType?(e.neonGlowBrightness&&(t.strokeStyle=i),t.beginPath(),t.moveTo(o,s+x/2),t.lineTo(o+(r-o)*n,s+x/2),t.stroke(),e.neonGlowBrightness&&!e.isMobile&&y(t,o,s+x/2,o+(r-o)*n,s+x/2,i,x,!1),w(t,e.ticksValue,o,s,r-o,x,!1,e.colorTicks,e.tickWidth)):"verticalBar"===e.gaugeType&&(e.neonGlowBrightness&&(t.strokeStyle=i),t.beginPath(),t.moveTo(l+c/2,d),t.lineTo(l+c/2,d-(d-s)*n),t.stroke(),e.neonGlowBrightness&&!e.isMobile&&y(t,l+c/2,d,l+c/2,d-(d-s)*n,i,x,!0),w(t,e.ticksValue,l+c/2,s,s-d,x,!0,e.colorTicks,e.tickWidth))}(x,l,S),this.elementProgressClone.initialized=!0,this.elementProgressClone.renderedProgress=C;this.canvas.commit(),e.context.clearRect(i,a,o,s),e.context.save(),e.context.drawImage(this.elementProgressClone,i,a,o,s),e.context.save(),t.prototype.draw.call(this)}catch(T){u.verifyError(T)}return this},e.prototype.getValueColor=function(){if(this.contextProgressClone){var t=this.contextProgressClone.currentColor,e=this.options;if(!t){var n=(u.normalizedValue(e).normal-e.minValue)/(e.maxValue-e.minValue);t=e.neonGlowBrightness?f(n,e.neonColorsRange):f(n,e.colorsRange)}return t}return"#000"},e.heightCache={},e}(l);function p(t,e,n){var i="font-style:"+t["font"+e+"Style"]+";font-weight:"+t["font"+e+"Weight"]+";font-size:"+t["font"+e+"Size"]*n+"px;font-family:"+t["font"+e],a=h.heightCache[i];if(!a){var o={fontFamily:t["font"+e],fontSize:t["font"+e+"Size"]*n+"px",fontWeight:t["font"+e+"Weight"],fontStyle:t["font"+e+"Style"]},r=$("<span>Hg</span>").css(o),s=$('<div style="display: inline-block; width: 1px; height: 0;"></div>'),l=$("<div></div>");l.append(r,s),$("body").append(l);try{a={},s.css({verticalAlign:"baseline"}),a.ascent=s.offset().top-r.offset().top,s.css({verticalAlign:"bottom"}),a.height=s.offset().top-r.offset().top,a.descent=a.height-a.ascent}finally{l.remove()}h.heightCache[i]=a}return a}function m(t,e,n,i,a,o){t.fillStyle=e[(e.neonGlowBrightness?"neonColor":"color")+n],t.fillText(i,a,o)}function g(t,e){if(e.label&&""!==e.label){var n=t.barDimensions,i=n.labelY,a=n.baseX,o=n.width,r=n.fontSizeFactor,s=Math.round(a+o/2),l=i;t.save(),t.textAlign="center",t.font=u.font(e,"Label",r),t.lineWidth=0,m(t,e,"Label",e.label.toUpperCase(),s,l)}}function f(t,e){if(0===t||1===e.length)return e[0].rgbString;for(var n=0;n<e.length;n++)if(t<=e[n].pct){var i=e[n-1],a=e[n],o=a.pct-i.pct,r=(t-i.pct)/o,s=1-r,l=r;return c({r:Math.floor(i.color.r*s+a.color.r*l),g:Math.floor(i.color.g*s+a.color.g*l),b:Math.floor(i.color.b*s+a.color.b*l)}).toRgbString()}}function b(t,e,n,i,a,o,r,s,l,d,u){t.setLineDash([]);var h=o-i,p=.55*h;t.lineWidth=h+p;var m=t.createRadialGradient(e,n,i-p/2,e,n,o+p/2),g=c(r).setAlpha(.5).toRgbString(),f=c(r).setAlpha(0).toRgbString();m.addColorStop(0,f),m.addColorStop(.55/3.1,g),m.addColorStop(1-.55/3.1,g),m.addColorStop(1,f),t.strokeStyle=m,t.beginPath();var b=.01*Math.PI;l?t.arc(e,n,a,d-b,d+(u-d)*s+b):t.arc(e,n,a,Math.PI-b,Math.PI+Math.PI*s+b),t.stroke()}function y(t,e,n,i,a,o,r,s){t.setLineDash([]);var l=.55*r;t.lineWidth=r+l;var d=s?e-t.lineWidth/2:0,u=s?0:n-t.lineWidth/2,h=s?e+t.lineWidth/2:0,p=s?0:n+t.lineWidth/2,m=t.createLinearGradient(d,u,h,p),g=c(o).setAlpha(.5).toRgbString(),f=c(o).setAlpha(0).toRgbString();m.addColorStop(0,f),m.addColorStop(.55/3.1,g),m.addColorStop(1-.55/3.1,g),m.addColorStop(1,f),t.strokeStyle=m;var b=s?0:.05*t.lineWidth,y=s?.05*t.lineWidth:0;t.beginPath(),t.moveTo(e-b,n+y),t.lineTo(i+b,a-y),t.stroke()}function v(t,e,n,i,a,o,r,s,l,c,d){if(e.length){var u=r-a;t.beginPath(),t.lineWidth=d,t.strokeStyle=c;for(var h=0,p=e;h<p.length;h++){var m=s+p[h]*l,g=n+(a+u)*Math.cos(m),f=i+(a+u)*Math.sin(m),b=n+a*Math.cos(m),y=i+a*Math.sin(m);t.moveTo(g,f),t.lineTo(b,y)}t.stroke()}}function w(t,e,n,i,a,o,r,s,l){if(e.length){t.beginPath(),t.lineWidth=l,t.strokeStyle=s;for(var c=0,d=e;c<d.length;c++){var u=d[c]*a;r?(t.moveTo(n-o/2,i+u-a),t.lineTo(n+o/2,i+u-a)):(t.moveTo(n+u,i),t.lineTo(n+u,i+o))}t.stroke()}}},Qhii:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form>\n  <mat-toolbar fxLayout="row" color="primary">\n    <h2 translate>{{ importTitle }}</h2>\n    <span fxFlex></span>\n    <div [tb-help]="\'entitiesImport\'"></div>\n    <button mat-button mat-icon-button\n            (click)="cancel()"\n            [disabled]="isImportData"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div mat-dialog-content>\n    <mat-vertical-stepper [linear]="true" [selectedIndex]="selectedIndex" #importStepper>\n      <mat-step [stepControl]="selectFileFormGroup">\n        <form [formGroup]="selectFileFormGroup">\n          <ng-template matStepLabel>{{ \'import.stepper-text.select-file\' | translate }}</ng-template>\n          <fieldset [disabled]="isLoading$ | async">\n            <tb-file-input formControlName="importData"\n                           required\n                           label="{{importFileLabel | translate}}"\n                           [allowedExtensions]="\'csv\'"\n                           [accept]="\'.csv,application/csv,text/csv\'"\n                           dropLabel="{{\'import.drop-file-csv\' | translate}}">\n            </tb-file-input>\n          </fieldset>\n        </form>\n        <div fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="20px">\n          <button mat-button\n                  [disabled]="(isLoading$ | async)"\n                  (click)="cancel()">{{ \'action.cancel\' | translate }}</button>\n          <button mat-raised-button\n                  [disabled]="(isLoading$ | async) || selectFileFormGroup.invalid || !selectFileFormGroup.dirty"\n                  color="primary"\n                  (click)="nextStep(2)">{{ \'action.continue\' | translate }}</button>\n        </div>\n      </mat-step>\n      <mat-step [stepControl]="importParametersFormGroup">\n        <form [formGroup]="importParametersFormGroup">\n          <ng-template matStepLabel>{{ \'import.stepper-text.configuration\' | translate }}</ng-template>\n          <fieldset [disabled]="isLoading$ | async" fxLayout="column">\n            <mat-form-field class="mat-block">\n              <mat-label translate>import.csv-delimiter</mat-label>\n              <mat-select required formControlName="delim">\n                <mat-option *ngFor="let delimiter of delimiters" [value]="delimiter.key">\n                  {{ delimiter.value }}\n                </mat-option>\n              </mat-select>\n            </mat-form-field>\n            <div fxLayout="column" fxLayoutGap="12px">\n              <mat-checkbox formControlName="isHeader">\n                {{ \'import.csv-first-line-header\' | translate }}\n              </mat-checkbox>\n              <mat-checkbox formControlName="isUpdate">\n                {{ \'import.csv-update-data\' | translate }}\n              </mat-checkbox>\n            </div>\n          </fieldset>\n        </form>\n        <div fxLayout="row wrap" fxLayoutAlign="space-between center">\n          <button mat-button\n                  [disabled]="(isLoading$ | async)"\n                  (click)="previousStep()">{{ \'action.back\' | translate }}</button>\n          <div fxLayout="row wrap" fxLayoutGap="20px">\n            <button mat-button\n                    [disabled]="(isLoading$ | async)"\n                    (click)="cancel()">{{ \'action.cancel\' | translate }}</button>\n            <button mat-raised-button\n                    [disabled]="(isLoading$ | async)"\n                    color="primary"\n                    (click)="nextStep(3)">{{ \'action.continue\' | translate }}</button>\n          </div>\n        </div>\n      </mat-step>\n      <mat-step [stepControl]="columnTypesFormGroup">\n        <form [formGroup]="columnTypesFormGroup">\n          <ng-template matStepLabel>{{ \'import.stepper-text.column-type\' | translate }}</ng-template>\n          <tb-table-columns-assignment formControlName="columnsParam" [entityType]="entityType"></tb-table-columns-assignment>\n        </form>\n        <div fxLayout="row wrap" fxLayoutAlign="space-between center">\n          <button mat-button\n                  [disabled]="(isLoading$ | async)"\n                  (click)="previousStep()">{{ \'action.back\' | translate }}</button>\n          <div fxLayout="row wrap" fxLayoutGap="20px">\n            <button mat-button\n                    [disabled]="(isLoading$ | async)"\n                    (click)="cancel()">{{ \'action.cancel\' | translate }}</button>\n            <button mat-raised-button\n                    [disabled]="(isLoading$ | async) || columnTypesFormGroup.invalid || !columnTypesFormGroup.dirty"\n                    color="primary"\n                    (click)="nextStep(4)">{{ \'action.continue\' | translate }}</button>\n          </div>\n        </div>\n      </mat-step>\n      <mat-step>\n        <ng-template matStepLabel>{{ \'import.stepper-text.creat-entities\' | translate }}</ng-template>\n        <mat-progress-bar color="warn" class="tb-import-progress" mode="determinate" [value]="progressCreate">\n        </mat-progress-bar>\n      </mat-step>\n      <mat-step>\n        <ng-template matStepLabel>{{ \'import.stepper-text.done\' | translate }}</ng-template>\n        <div fxLayout="column">\n          <p class="mat-body-1" *ngIf="this.statistical?.create && this.statistical?.create.entity">\n            {{ translate.instant(\'import.message.create-entities\', {count: this.statistical.create.entity}) }}\n          </p>\n          <p class="mat-body-1" *ngIf="this.statistical?.update && this.statistical?.update.entity">\n            {{ translate.instant(\'import.message.update-entities\', {count: this.statistical.update.entity}) }}\n          </p>\n          <p class="mat-body-1" *ngIf="this.statistical?.error && this.statistical?.error.entity">\n            {{ translate.instant(\'import.message.error-entities\', {count: this.statistical.error.entity}) }}\n          </p>\n        </div>\n        <div fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="20px">\n          <button mat-raised-button\n                  [disabled]="(isLoading$ | async)"\n                  color="primary"\n                  (click)="nextStep(6)">{{ \'action.ok\' | translate }}</button>\n        </div>\n      </mat-step>\n    </mat-vertical-stepper>\n  </div>\n</form>\n'},Qjnd:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<mat-drawer-container hasBackdrop="false" class="tb-absolute-fill">\n  <mat-drawer *ngIf="entitiesTableConfig.detailsPanelEnabled"\n              class="tb-details-drawer mat-elevation-z4"\n              #drawer\n              mode="over"\n              position="end"\n              [opened]="isDetailsOpen">\n    <tb-entity-details-panel\n      [entitiesTableConfig]="entitiesTableConfig"\n      [entityId]="dataSource.currentEntity?.id"\n      (closeEntityDetails)="isDetailsOpen = false; detailsPanelOpened.emit(isDetailsOpen);"\n      (entityUpdated)="onEntityUpdated($event)"\n      (entityAction)="onEntityAction($event)"\n    >\n    </tb-entity-details-panel>\n  </mat-drawer>\n  <mat-drawer-content>\n    <div class="mat-padding tb-entity-table tb-absolute-fill">\n      <div fxLayout="column" class="mat-elevation-z1 tb-entity-table-content">\n        <mat-toolbar class="mat-table-toolbar" [fxShow]="!textSearchMode && dataSource.selection.isEmpty()">\n          <div class="mat-toolbar-tools">\n            <div fxLayout="row" fxLayoutAlign="start center" fxLayout.xs="column" fxLayoutAlign.xs="center start" class="title-container">\n              <span *ngIf="entitiesTableConfig.tableTitle" class="tb-entity-table-title">{{ entitiesTableConfig.tableTitle }}</span>\n              <tb-anchor #entityTableHeader></tb-anchor>\n              <tb-timewindow *ngIf="entitiesTableConfig.useTimePageLink" [(ngModel)]="timewindow"\n                              (ngModelChange)="onTimewindowChange()"\n                              asButton historyOnly></tb-timewindow>\n            </div>\n            <span fxFlex></span>\n            <div [fxShow]="addEnabled()">\n              <button mat-icon-button [disabled]="isLoading$ | async"\n                      *ngIf="!entitiesTableConfig.addActionDescriptors.length; else addActions"\n                      (click)="addEntity($event)"\n                      matTooltip="{{ translations.add | translate }}"\n                      matTooltipPosition="above">\n                <mat-icon>add</mat-icon>\n              </button>\n              <ng-template #addActions>\n                <button mat-icon-button [disabled]="isLoading$ | async"\n                        *ngIf="entitiesTableConfig.addActionDescriptors.length === 1; else addActionsMenu"\n                        [fxShow]="entitiesTableConfig.addActionDescriptors[0].isEnabled()"\n                        (click)="entitiesTableConfig.addActionDescriptors[0].onAction($event)"\n                        matTooltip="{{ entitiesTableConfig.addActionDescriptors[0].name }}"\n                        matTooltipPosition="above">\n                  <mat-icon>{{entitiesTableConfig.addActionDescriptors[0].icon}}</mat-icon>\n                </button>\n                <ng-template #addActionsMenu>\n                  <button mat-icon-button [disabled]="isLoading$ | async"\n                          matTooltip="{{ translations.add | translate }}"\n                          matTooltipPosition="above"\n                          [matMenuTriggerFor]="addActionsMenu">\n                    <mat-icon>add</mat-icon>\n                  </button>\n                  <mat-menu #addActionsMenu="matMenu" xPosition="before">\n                    <button mat-menu-item *ngFor="let actionDescriptor of entitiesTableConfig.addActionDescriptors"\n                            [disabled]="isLoading$ | async"\n                            [fxShow]="actionDescriptor.isEnabled()"\n                            (click)="actionDescriptor.onAction($event)">\n                      <mat-icon>{{actionDescriptor.icon}}</mat-icon>\n                      <span>{{ actionDescriptor.name }}</span>\n                    </button>\n                  </mat-menu>\n                </ng-template>\n              </ng-template>\n            </div>\n            <button mat-icon-button [disabled]="isLoading$ | async"\n                    [fxShow]="actionDescriptor.isEnabled()" *ngFor="let actionDescriptor of headerActionDescriptors"\n                    matTooltip="{{ actionDescriptor.name }}"\n                    matTooltipPosition="above"\n                    (click)="actionDescriptor.onAction($event)">\n              <mat-icon>{{actionDescriptor.icon}}</mat-icon>\n            </button>\n            <button mat-icon-button [disabled]="isLoading$ | async" (click)="updateData()"\n                    matTooltip="{{ \'action.refresh\' | translate }}"\n                    matTooltipPosition="above">\n              <mat-icon>refresh</mat-icon>\n            </button>\n            <button *ngIf="entitiesTableConfig.searchEnabled"\n                    mat-icon-button [disabled]="isLoading$ | async" (click)="enterFilterMode()"\n                    matTooltip="{{ translations.search | translate }}"\n                    matTooltipPosition="above">\n              <mat-icon>search</mat-icon>\n            </button>\n          </div>\n        </mat-toolbar>\n        <mat-toolbar class="mat-table-toolbar" [fxShow]="textSearchMode && dataSource.selection.isEmpty()">\n          <div class="mat-toolbar-tools">\n            <button mat-icon-button\n                    matTooltip="{{ translations.search | translate }}"\n                    matTooltipPosition="above">\n              <mat-icon>search</mat-icon>\n            </button>\n            <mat-form-field fxFlex>\n              <mat-label>&nbsp;</mat-label>\n              <input #searchInput matInput\n                     [(ngModel)]="pageLink.textSearch"\n                     placeholder="{{ translations.search | translate }}"/>\n            </mat-form-field>\n            <button mat-icon-button (click)="exitFilterMode()"\n                    matTooltip="{{ \'action.close\' | translate }}"\n                    matTooltipPosition="above">\n              <mat-icon>close</mat-icon>\n            </button>\n          </div>\n        </mat-toolbar>\n        <mat-toolbar *ngIf="entitiesTableConfig.selectionEnabled" class="mat-table-toolbar" color="primary" [fxShow]="!dataSource.selection.isEmpty()">\n          <div class="mat-toolbar-tools">\n            <span class="tb-entity-table-info">\n              {{ translations.selectedEntities | translate:{count: dataSource.selection.selected.length} }}\n            </span>\n            <span fxFlex></span>\n            <button mat-icon-button [disabled]="isLoading$ | async"\n                    [fxShow]="actionDescriptor.isEnabled" *ngFor="let actionDescriptor of groupActionDescriptors"\n                    matTooltip="{{ actionDescriptor.name }}"\n                    matTooltipPosition="above"\n                    (click)="actionDescriptor.onAction($event, dataSource.selection.selected)">\n              <mat-icon>{{actionDescriptor.icon}}</mat-icon>\n            </button>\n          </div>\n        </mat-toolbar>\n        <div fxFlex class="table-container">\n          <table mat-table [dataSource]="dataSource" [trackBy]="trackByEntityId"\n                     matSort [matSortActive]="pageLink.sortOrder?.property" [matSortDirection]="pageLink.sortDirection()" matSortDisableClear>\n            <ng-container matColumnDef="select" sticky>\n              <mat-header-cell *matHeaderCellDef style="width: 30px;">\n                <mat-checkbox (change)="$event ? dataSource.masterToggle() : null"\n                              [checked]="dataSource.selection.hasValue() && (dataSource.isAllSelected() | async)"\n                              [indeterminate]="dataSource.selection.hasValue() && !(dataSource.isAllSelected() | async)">\n                </mat-checkbox>\n              </mat-header-cell>\n              <mat-cell *matCellDef="let entity">\n                <mat-checkbox (click)="$event.stopPropagation()"\n                              [fxShow]="entitiesTableConfig.entitySelectionEnabled(entity)"\n                              (change)="$event ? dataSource.selection.toggle(entity) : null"\n                              [checked]="dataSource.selection.isSelected(entity)">\n                </mat-checkbox>\n              </mat-cell>\n            </ng-container>\n            <ng-container [matColumnDef]="column.key" *ngFor="let column of entityColumns; trackBy: trackByColumnKey;">\n              <mat-header-cell [ngClass]="{\'mat-number-cell\': column.isNumberColumn}"\n                               [fxHide.lt-lg]="column.mobileHide"\n                               *matHeaderCellDef [ngStyle]="headerCellStyle(column)" mat-sort-header [disabled]="!column.sortable">\n                {{ column.ignoreTranslate ? column.title : (column.title | translate) }} </mat-header-cell>\n              <mat-cell [ngClass]="{\'mat-number-cell\': column.isNumberColumn}"\n                        [fxHide.lt-lg]="column.mobileHide"\n                        *matCellDef="let entity; let row = index"\n                        [matTooltip]="cellTooltip(entity, column, row)"\n                        matTooltipPosition="above"\n                        [innerHTML]="cellContent(entity, column, row)"\n                        [ngStyle]="cellStyle(entity, column, row)">\n              </mat-cell>\n            </ng-container>\n            <ng-container [matColumnDef]="column.key" *ngFor="let column of actionColumns; trackBy: trackByColumnKey;">\n              <mat-header-cell *matHeaderCellDef [ngStyle]="headerCellStyle(column)" mat-sort-header [disabled]="!column.sortable"> {{ column.title | translate }} </mat-header-cell>\n              <mat-cell *matCellDef="let entity; let row = index"\n                        [ngStyle]="cellStyle(entity, column, row)">\n                <button mat-icon-button [disabled]="isLoading$ | async"\n                        [fxShow]="column.actionDescriptor.isEnabled(entity)"\n                        matTooltip="{{ column.actionDescriptor.nameFunction ? column.actionDescriptor.nameFunction(entity) : column.actionDescriptor.name }}"\n                        matTooltipPosition="above"\n                        (click)="column.actionDescriptor.onAction($event, entity)">\n                  <mat-icon [svgIcon]="column.actionDescriptor.mdiIcon" [ngStyle]="column.actionDescriptor.style">\n                    {{column.actionDescriptor.icon}}</mat-icon>\n                </button>\n              </mat-cell>\n            </ng-container>\n            <ng-container matColumnDef="actions" stickyEnd>\n              <mat-header-cell *matHeaderCellDef [ngStyle.gt-md]="{ minWidth: (cellActionDescriptors.length * 40) + \'px\',\n                                                                    maxWidth: (cellActionDescriptors.length * 40) + \'px\',\n                                                                    width: (cellActionDescriptors.length * 40) + \'px\' }">\n                {{ entitiesTableConfig.actionsColumnTitle ? (entitiesTableConfig.actionsColumnTitle | translate) : \'\' }}\n              </mat-header-cell>\n              <mat-cell *matCellDef="let entity" [ngStyle.gt-md]="{ minWidth: (cellActionDescriptors.length * 40) + \'px\',\n                                                                    maxWidth: (cellActionDescriptors.length * 40) + \'px\',\n                                                                    width: (cellActionDescriptors.length * 40) + \'px\' }">\n                <div fxHide fxShow.gt-md fxFlex fxLayout="row" fxLayoutAlign="end">\n                  <button mat-icon-button [disabled]="(isLoading$ | async) || !actionDescriptor.isEnabled(entity)"\n                          *ngFor="let actionDescriptor of cellActionDescriptors"\n                          matTooltip="{{ actionDescriptor.nameFunction ? actionDescriptor.nameFunction(entity) : actionDescriptor.name }}"\n                          matTooltipPosition="above"\n                          (click)="actionDescriptor.onAction($event, entity)">\n                    <mat-icon [svgIcon]="actionDescriptor.mdiIcon" [ngStyle]="actionDescriptor.style">\n                      {{actionDescriptor.icon}}</mat-icon>\n                  </button>\n                </div>\n                <div fxHide fxShow.lt-lg *ngIf="cellActionDescriptors.length">\n                  <button mat-icon-button\n                          (click)="$event.stopPropagation()"\n                          [matMenuTriggerFor]="cellActionsMenu">\n                    <mat-icon class="material-icons">more_vert</mat-icon>\n                  </button>\n                  <mat-menu #cellActionsMenu="matMenu" xPosition="before">\n                    <button mat-menu-item *ngFor="let actionDescriptor of cellActionDescriptors"\n                            [disabled]="isLoading$ | async"\n                            [fxShow]="actionDescriptor.isEnabled(entity)"\n                            (click)="actionDescriptor.onAction($event, entity)">\n                      <mat-icon [svgIcon]="actionDescriptor.mdiIcon" [ngStyle]="actionDescriptor.style">\n                        {{actionDescriptor.icon}}</mat-icon>\n                      <span>{{ actionDescriptor.nameFunction ? actionDescriptor.nameFunction(entity) : actionDescriptor.name }}</span>\n                    </button>\n                  </mat-menu>\n                </div>\n              </mat-cell>\n            </ng-container>\n            <mat-header-row [ngClass]="{\'mat-row-select\': selectionEnabled}" *matHeaderRowDef="displayedColumns; sticky: true"></mat-header-row>\n            <mat-row [ngClass]="{\'mat-row-select\': selectionEnabled,\n                                 \'mat-selected\': dataSource.selection.isSelected(entity),\n                                 \'tb-current-entity\': dataSource.isCurrentEntity(entity)}"\n                     *matRowDef="let entity; columns: displayedColumns;" (click)="onRowClick($event, entity)"></mat-row>\n          </table>\n          <span [fxShow]="!(isLoading$ | async) && (dataSource.isEmpty() | async) && !dataSource.dataLoading"\n                fxLayoutAlign="center center"\n                class="no-data-found">{{ translations.noEntities | translate }}</span>\n          <span [fxShow]="dataSource.dataLoading"\n                fxLayoutAlign="center center"\n                class="no-data-found">{{ \'common.loading\' | translate }}</span>\n        </div>\n        <mat-divider *ngIf="displayPagination"></mat-divider>\n        <mat-paginator *ngIf="displayPagination"\n                       [length]="dataSource.total() | async"\n                       [pageIndex]="pageLink.page"\n                       [pageSize]="pageLink.pageSize"\n                       [pageSizeOptions]="pageSizeOptions"></mat-paginator>\n      </div>\n    </div>\n  </mat-drawer-content>\n</mat-drawer-container>\n'},QtQQ:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div class="date-range-navigator"\n     [ngClass]="{\'short-mode\':ctx.width < 400, \'labels-hidden\': settings.hideLabels, \'long-mode\': ctx.width >= 400}">\n  <mat-form-field class="mat-block" [fxHide]="settings.hidePicker" (click)="openNavigatorPanel($event)">\n    <mat-label *ngIf="!settings.hideLabels" translate>widgets.date-range-navigator.localizationMap.Date picker</mat-label>\n    <mat-select #datePicker [ngModel]="advancedModel.chosenLabel">\n      <mat-option [value]="advancedModel.chosenLabel">\n        {{advancedModel.chosenLabel}}\n      </mat-option>\n    </mat-select>\n  </mat-form-field>\n  <mat-form-field class="mat-block" [fxHide]="settings.hideInterval">\n    <mat-label translate *ngIf="!settings.hideLabels">widgets.date-range-navigator.localizationMap.Interval</mat-label>\n    <mat-select [(ngModel)]="selectedDateInterval" (ngModelChange)="changeInterval()">\n      <mat-option *ngIf="customInterval" [value]="customInterval.ts">\n        {{\'widgets.date-range-navigator.localizationMap.\' + customInterval.label | translate}}\n      </mat-option>\n      <mat-option *ngFor="let date of datesMap | keyvalue: originalOrder" [value]="date.value.ts">\n        {{\'widgets.date-range-navigator.localizationMap.\' + date.value.label | translate}}\n      </mat-option>\n    </mat-select>\n  </mat-form-field>\n\n  <div class="drn__element step" [fxHide]="settings.hideStepSize">\n    <button mat-button mat-icon-button (click)="goBack()">\n      <mat-icon>keyboard_arrow_left</mat-icon>\n    </button>\n    <mat-form-field class="mat-block" fxFlex.gt-sm>\n      <mat-label translate *ngIf="!settings.hideLabels">widgets.date-range-navigator.localizationMap.Step size</mat-label>\n      <mat-select [(ngModel)]="selectedStepSize">\n        <mat-option *ngFor="let date of datesMap | keyvalue: originalOrder" [value]="date.value.ts">\n          {{\'widgets.date-range-navigator.localizationMap.\' + date.value.label | translate}}\n        </mat-option>\n      </mat-select>\n    </mat-form-field>\n    <button mat-button mat-icon-button (click)="goForth()">\n      <mat-icon>keyboard_arrow_right</mat-icon>\n    </button>\n  </div>\n</div>\n'},Qxzm:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host {\n  /*  flex: 1;\n    display: flex;\n    justify-content: flex-start; */\n  padding-right: 8px;\n  min-width: 160px;\n}\n:host ::ng-deep mat-form-field {\n  font-size: 16px;\n  width: 200px;\n}\n:host ::ng-deep mat-form-field .mat-form-field-wrapper {\n  padding-bottom: 0;\n}\n:host ::ng-deep mat-form-field .mat-form-field-underline {\n  bottom: 0;\n}\n@media screen and (max-width: 599px) {\n  :host ::ng-deep mat-form-field {\n    width: 100%;\n  }\n  :host ::ng-deep mat-form-field .mat-form-field-infix {\n    width: auto !important;\n  }\n}'},RLvv:function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n("mrSG"),a=n("Lm6k"),o={ctx:{description:"A reference to widget context that has all necessary API<br>and data used by widget instance.",meta:"object",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/modules/home/models/widget-component.models.ts#L83">WidgetContext</a>',children:Object(i.a)({$container:{description:"Container element of the widget.<br>Can be used to dynamically access or modify widget DOM using jQuery API.",meta:"property",type:"jQuery Object"},$scope:{description:"Reference to the current widget component.<br>Can be used to access/modify component properties when widget is built using Angular approach.",meta:"property",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/modules/home/models/widget-component.models.ts#L274">IDynamicWidgetComponent</a>'},width:{description:"Current width of widget container in pixels.",meta:"property",type:"number"},height:{description:"Current height of widget container in pixels.",meta:"property",type:"number"},isEdit:{description:"Indicates whether the dashboard is in in the view or editing state.",meta:"property",type:"boolean"},isMobile:{description:"Indicates whether the dashboard view is less then 960px width (default mobile breakpoint).",meta:"property",type:"boolean"},widgetConfig:{description:"Common widget configuration containing properties such as <code>color</code> (text color), <code>backgroundColor</code> (widget background color), etc.",meta:"property",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L341">WidgetConfig</a>',children:{title:{description:"Widget title.",meta:"property",type:"string"},titleIcon:{description:"Widget title icon.",meta:"property",type:"string"},showTitle:{description:"Whether to show widget title.",meta:"property",type:"boolean"},showTitleIcon:{description:"Whether to show widget title icon.",meta:"property",type:"boolean"},iconColor:{description:"Widget title icon color.",meta:"property",type:"string"},iconSize:{description:"Widget title icon size.",meta:"property",type:"string"},titleTooltip:{description:"Widget title tooltip content.",meta:"property",type:"string"},dropShadow:{description:"Enable/disable widget card shadow.",meta:"property",type:"boolean"},enableFullscreen:{description:"Whether to enable fullscreen button on widget.",meta:"property",type:"boolean"},useDashboardTimewindow:{description:"Whether to use dashboard timewindow (applicable for timeseries widgets).",meta:"property",type:"boolean"},displayTimewindow:{description:"Whether to display timewindow (applicable for timeseries widgets).",meta:"property",type:"boolean"},showLegend:{description:"Whether to show legend.",meta:"property",type:"boolean"},legendConfig:{description:"Legend configuration.",meta:"property",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L198">LegendConfig</a>',children:{position:{description:"Legend position. Possible values: <code>'top', 'bottom', 'left', 'right'</code>",meta:"property",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L182">LegendPosition</a>'},direction:{description:"Legend direction. Possible values: <code>'column', 'row'</code>",meta:"property",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L170">LegendDirection</a>'},showMin:{description:"Whether to display aggregated min values.",meta:"property",type:"boolean"},showMax:{description:"Whether to display aggregated max values.",meta:"property",type:"boolean"},showAvg:{description:"Whether to display aggregated average values.",meta:"property",type:"boolean"},showTotal:{description:"Whether to display aggregated total values.",meta:"property",type:"boolean"}}},timewindow:{description:"Timewindow configuration object",meta:"property",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/time/time.models.ts#L80">Timewindow</a>',children:{displayValue:{description:"Current timewindow display value.",meta:"property",type:"string"},hideInterval:{description:"Whether to hide interval selection in timewindow panel.",meta:"property",type:"boolean"},hideAggregation:{description:"Whether to hide aggregation selection in timewindow panel.",meta:"property",type:"boolean"},hideAggInterval:{description:"Whether to hide aggregation interval selection in timewindow panel.",meta:"property",type:"boolean"},selectedTab:{description:"Current selected timewindow type (0 - realtime, 1 - history).",meta:"property",type:"number"},realtime:{description:"Realtime timewindow configuration object.",meta:"property",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/time/time.models.ts#L39">IntervalWindow</a>',children:{interval:{description:"Timewindow aggregation interval in milliseconds",meta:"property",type:"number"},timewindowMs:{description:"Timewindow interval in milliseconds",meta:"property",type:"number"}}},history:{description:"History timewindow configuration object.",meta:"property",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/time/time.models.ts#L49">HistoryWindow</a>',children:{historyType:{description:"History timewindow type (0 - last interval, 1 - fixed)",meta:"property",type:"number"},interval:{description:"Timewindow aggregation interval in milliseconds",meta:"property",type:"number"},timewindowMs:{description:"Timewindow interval in milliseconds",meta:"property",type:"number"},fixedTimewindow:{description:"Fixed history timewindow configuration object",meta:"property",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/time/time.models.ts#L44">FixedWindow</a>',children:{startTimeMs:{description:"Timewindow start time in UTC milliseconds",meta:"property",type:"number"},endTimeMs:{description:"Timewindow end time in UTC milliseconds",meta:"property",type:"number"}}}}},aggregation:{description:"Timewindow aggregation configuration object.",meta:"property",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/time/time.models.ts#L74">Aggregation</a>',children:{interval:{description:"Aggregation interval in milliseconds",meta:"property",type:"number"},type:{description:"Aggregation type",meta:"property",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/time/time.models.ts#L54">AggregationType</a>'},limit:{description:"Maximum allowed datapoints when aggregation is disabled (<code>AggregationType == 'NONE'</code>)",meta:"property",type:"number"}}}}},mobileHeight:{description:"Widget height in mobile mode.",meta:"property",type:"number"},mobileOrder:{description:"Widget order in mobile mode.",meta:"property",type:"number"},color:{description:"Widget text color.",meta:"property",type:"string"},backgroundColor:{description:"Widget background color.",meta:"property",type:"string"},padding:{description:"Widget card padding.",meta:"property",type:"string"},margin:{description:"Widget card margin.",meta:"property",type:"string"},widgetStyle:{description:"Widget element style object.",meta:"property",type:"object"},titleStyle:{description:"Widget title element style object.",meta:"property",type:"object"},units:{description:"Optional property defining units text of values displayed by widget. Useful for simple widgets like cards or gauges.",meta:"property",type:"string"},decimals:{description:"Optional property defining how many positions should be used to display decimal part of the value number.",meta:"property",type:"number"},actions:{description:"Map of configured widget actions.",meta:"property",type:"object"},settings:{description:"Object holding widget settings according to widget type.",meta:"property",type:"object"},alarmSource:{description:"Configured alarm source for alarm widget type.",meta:"property",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L250">Datasource</a>'},alarmSearchStatus:{description:"Configured default alarm search status for alarm widget type.",meta:"property",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/alarm.models.ts#L41">AlarmSearchStatus</a>'},alarmsPollingInterval:{description:"Configured alarms polling interval for alarm widget type.",meta:"property",type:"number"},alarmsMaxCountLoad:{description:"Configured maximum alarms to load for alarm widget type.",meta:"property",type:"number"},alarmsFetchSize:{description:"Configured alarms page size used to load alarms.",meta:"property",type:"number"},datasources:{description:"Array of configured widget datasources.",meta:"property",type:'Array&lt;<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L250">Datasource</a>&gt;'}}},settings:{description:'Widget settings containing widget specific properties according to the defined <a href="https://thingsboard.io/docs/user-guide/contribution/widgets-development/#settings-schema-section">settings json schema</a>',meta:"property",type:"object"},datasources:{description:"Array of resolved widget datasources.",meta:"property",type:'Array&lt;<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L250">Datasource</a>&gt;'},data:{description:"Array of latest datasources data.",meta:"property",type:'Array&lt;<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L275">DatasourceData</a>&gt;'},timeWindow:{description:"Current widget timewindow (applicable for timeseries widgets).",meta:"property",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/time/time.models.ts#L104">WidgetTimewindow</a>'},units:{description:"Optional property defining units text of values displayed by widget. Useful for simple widgets like cards or gauges.",meta:"property",type:"string"},decimals:{description:"Optional property defining how many positions should be used to display decimal part of the value number.",meta:"property",type:"number"},hideTitlePanel:{description:"Manages visibility of widget title panel. Useful for widget with custom title panels or different states. <b>updateWidgetParams()</b> function must be called after this property change.",meta:"property",type:"boolean"},widgetTitle:{description:"If set, will override configured widget title text. <b>updateWidgetParams()</b> function must be called after this property change.",meta:"property",type:"string"},detectChanges:{description:"Trigger change detection for current widget. Must be invoked when widget HTML template bindings should be updated due to widget data changes.",meta:"function"},updateWidgetParams:{description:"Updates widget with runtime set properties such as <b>widgetTitle</b>, <b>hideTitlePanel</b>, etc. Must be invoked in order these properties changes take effect.",meta:"function"},defaultSubscription:{description:"Default widget subscription object contains all subscription information,<br>including current data, according to the widget type.",meta:"property",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/api/widget-api.models.ts#L220">IWidgetSubscription</a>'},timewindowFunctions:{description:"Object with timewindow functions used to manage widget data time frame. Can by used by Time-series or Alarm widgets.",meta:"property",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/api/widget-api.models.ts#L45">TimewindowFunctions</a>',children:{onUpdateTimewindow:{description:"This function can be used to update current subscription time frame<br>to historical one identified by <code>startTimeMs</code> and <code>endTimeMs</code> arguments.",meta:"function",args:[{name:"startTimeMs",description:"Timewindow start time in UTC milliseconds",type:"number"},{name:"endTimeMs",description:"Timewindow end time in UTC milliseconds",type:"number"}]},onResetTimewindow:{description:"Resets subscription time frame to default defined by widget timewindow component<br>or dashboard timewindow depending on widget settings.",meta:"function"}}},controlApi:{description:"Object that provides API functions for RPC (Control) widgets.",meta:"property",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/api/widget-api.models.ts#L58">RpcApi</a>',children:{sendOneWayCommand:{description:"Sends one way (without response) RPC command to the device.",meta:"function",args:[{name:"method",description:"RPC method name",type:"string"},{name:"params",description:"RPC method params, custom json object",type:"object",optional:!0},{name:"timeout",description:"Maximum delay in milliseconds to wait until response/acknowledgement is received.",type:"number",optional:!0}],return:{description:"A command execution Observable.",type:"Observable&lt;any&gt;"}},sendTwoWayCommand:{description:"Sends two way (with response) RPC command to the device.",meta:"function",args:[{name:"method",description:"RPC method name",type:"string"},{name:"params",description:"RPC method params, custom json object",type:"object",optional:!0},{name:"timeout",description:"Maximum delay in milliseconds to wait until response/acknowledgement is received.",type:"number",optional:!0}],return:{description:"A command execution Observable of response body.",type:"Observable&lt;any&gt;"}}}},actionsApi:{description:"Set of API functions to work with user defined actions.",meta:"property",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/api/widget-api.models.ts#L67">WidgetActionsApi</a>',children:{getActionDescriptors:{description:"Get list of action descriptors for provided <code>actionSourceId</code>.",meta:"function",args:[{name:"actionSourceId",description:"Id of widget action source",type:"string"}],return:{description:"The list of action descriptors",type:'Array&lt;<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L323">WidgetActionDescriptor</a>&gt;'}},handleWidgetAction:{description:"Handle action produced by particular action source.",meta:"function",args:[{name:"$event",description:"DOM event object associated with action.",type:"Event"},{name:"descriptor",description:"An action descriptor.",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/shared/models/widget.models.ts#L323">WidgetActionDescriptor</a>'},{name:"entityId",description:"Current entity id provided by action source if available.",type:a.a,optional:!0},{name:"entityName",description:"Current entity name provided by action source if available.",type:"string",optional:!0}]}}},stateController:{description:"Reference to Dashboard state controller, providing API to manage current dashboard state.",meta:"property",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/api/widget-api.models.ts#L121">IStateController</a>',children:{openState:{description:"Navigate to new dashboard state.",meta:"function",args:[{name:"id",description:"An id of the target dashboard state.",type:"string"},{name:"params",description:"An object with state parameters to use by the new state.",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/api/widget-api.models.ts#L111">StateParams</a>',optional:!0},{name:"openRightLayout",description:"An optional boolean argument to force open right dashboard layout if present in mobile view mode.",type:"boolean",optional:!0}]},updateState:{description:"Updates current dashboard state.",meta:"function",args:[{name:"id",description:"An optional id of the target dashboard state to replace current state id.",type:"string",optional:!0},{name:"params",description:"An object with state parameters to update current state parameters.",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/api/widget-api.models.ts#L111">StateParams</a>',optional:!0},{name:"openRightLayout",description:"An optional boolean argument to force open right dashboard layout if present in mobile view mode.",type:"boolean",optional:!0}]},getStateId:{description:"Get current dashboard state id.",meta:"function",return:{description:"current dashboard state id.",type:"string"}},getStateParams:{description:"Get current dashboard state parameters.",meta:"function",return:{description:"current dashboard state parameters.",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/api/widget-api.models.ts#L111">StateParams</a>'}},getStateParamsByStateId:{description:"Get state parameters for particular dashboard state identified by <code>id</code>.",meta:"function",args:[{name:"id",description:"An id of the target dashboard state.",type:"string"}],return:{description:"current dashboard state parameters.",type:'<a href="https://github.com/thingsboard/thingsboard/blob/13e6b10b7ab830e64d31b99614a9d95a1a25928a/ui-ngx/src/app/core/api/widget-api.models.ts#L111">StateParams</a>'}}}}},a.c)}}},S3nC:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form [formGroup]="entityAliasFormGroup" (ngSubmit)="save()" style="min-width: 480px;">\n  <mat-toolbar color="primary">\n    <h2>{{ (isAdd ? \'alias.add\' : \'alias.edit\') | translate }}</h2>\n    <span fxFlex></span>\n    <button mat-icon-button\n            (click)="cancel()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div mat-dialog-content>\n    <fieldset [disabled]="isLoading$ | async">\n      <div fxFlex fxLayout="column">\n        <div fxLayout="row">\n          <mat-form-field fxFlex class="mat-block">\n            <mat-label translate>alias.name</mat-label>\n            <input matInput formControlName="alias" required>\n            <mat-error *ngIf="entityAliasFormGroup.get(\'alias\').hasError(\'required\')">\n              {{ \'alias.name-required\' | translate }}\n            </mat-error>\n            <mat-error *ngIf="entityAliasFormGroup.get(\'alias\').hasError(\'duplicateAliasName\')">\n              {{ \'alias.duplicate-alias\' | translate }}\n            </mat-error>\n          </mat-form-field>\n          <section class="tb-resolve-multiple-switch" fxLayout="column" fxLayoutAlign="start center">\n            <label class="tb-small resolve-multiple-label" translate>alias.resolve-multiple</label>\n            <mat-slide-toggle class="resolve-multiple-switch"\n                              formControlName="resolveMultiple">\n            </mat-slide-toggle>\n          </section>\n        </div>\n        <tb-entity-filter formControlName="filter"\n                          [resolveMultiple]="entityAliasFormGroup.get(\'resolveMultiple\').value"\n                          (resolveMultipleChanged)="entityAliasFormGroup.get(\'resolveMultiple\').patchValue($event)"\n                          [allowedEntityTypes]="allowedEntityTypes">\n        </tb-entity-filter>\n        <tb-error [error]="entityAliasFormGroup.hasError(\'noEntityMatched\')\n                  ? translate.instant(\'alias.entity-filter-no-entity-matched\') : \'\'"></tb-error>\n      </div>\n    </fieldset>\n  </div>\n  <div mat-dialog-actions fxLayoutAlign="end center">\n    <button mat-raised-button color="primary"\n            type="submit"\n            [disabled]="(isLoading$ | async) || entityAliasFormGroup.invalid || !entityAliasFormGroup.dirty">\n      {{ (isAdd ? \'action.add\' : \'action.save\') | translate }}\n    </button>\n    <button mat-button color="primary"\n            type="button"\n            [disabled]="(isLoading$ | async)"\n            (click)="cancel()" cdkFocusInitial>\n      {{ \'action.cancel\' | translate }}\n    </button>\n  </div>\n</form>\n'},"SZX/":function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n("mrSG"),a=n("TYT/"),o=n("ea4N"),r=n("U3y+"),s=n("XCsc"),l=function(){function t(t){this.dialog=t}return t.prototype.importEntities=function(t){switch(t){case r.b.DEVICE:return this.openImportDialogCSV(t,"device.import","device.device-file");case r.b.ASSET:return this.openImportDialogCSV(t,"asset.import","asset.asset-file")}},t.prototype.openImportDialogCSV=function(t,e,n){return this.dialog.open(s.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{entityType:t,importTitle:e,importFileLabel:n}}).afterClosed()},t.ctorParameters=function(){return[{type:o.MatDialog}]},t=Object(i.c)([Object(a.Injectable)(),Object(i.g)("design:paramtypes",[o.MatDialog])],t)}()},Soa6:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<tb-entities-table [entitiesTableConfig]="alarmTableConfig"></tb-entities-table>\n'},TLQs:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form [formGroup]="attributeFormGroup" (ngSubmit)="add()" style="min-width: 400px;">\n  <mat-toolbar color="primary">\n    <h2>{{ \'attribute.add\' | translate }}</h2>\n    <span fxFlex></span>\n    <button mat-button mat-icon-button\n            (click)="cancel()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div style="height: 4px;" *ngIf="!(isLoading$ | async)"></div>\n  <div mat-dialog-content>\n    <fieldset [disabled]="isLoading$ | async">\n      <mat-form-field class="mat-block">\n        <mat-label translate>attribute.key</mat-label>\n        <input matInput formControlName="key" required>\n        <mat-error *ngIf="attributeFormGroup.get(\'key\').hasError(\'required\')">\n          {{ \'attribute.key-required\' | translate }}\n        </mat-error>\n      </mat-form-field>\n      <tb-value-input\n        formControlName="value"\n        requiredText="attribute.value-required">\n      </tb-value-input>\n    </fieldset>\n  </div>\n  <div mat-dialog-actions fxLayoutAlign="end center">\n    <button mat-raised-button color="primary"\n            type="submit"\n            [disabled]="(isLoading$ | async) || attributeFormGroup.invalid || !attributeFormGroup.dirty">\n      {{ \'action.add\' | translate }}\n    </button>\n    <button mat-button color="primary"\n            type="button"\n            [disabled]="(isLoading$ | async)"\n            (click)="cancel()" cdkFocusInitial>\n      {{ \'action.cancel\' | translate }}\n    </button>\n  </div>\n</form>\n'},TPjs:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .tb-event-content {\n  width: 100%;\n  min-width: 400px;\n  height: 100%;\n  min-height: 50px;\n}'},TTrM:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .tb-entity-filter-view .entity-filter-empty {\n  font-size: 14px;\n  line-height: 16px;\n  color: rgba(221, 44, 0, 0.87);\n}\n:host .tb-entity-filter-view .entity-filter-type {\n  font-size: 14px;\n  line-height: 16px;\n  color: rgba(0, 0, 0, 0.570588);\n}\n:host .tb-entity-filter-view .entity-filter-value {\n  font-size: 14px;\n  line-height: 16px;\n  color: rgba(0, 0, 0, 0.570588);\n}'},TVBz:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div class="mat-padding tb-entity-table tb-absolute-fill">\n  <div fxFlex fxLayout="column" class="mat-elevation-z1 tb-entity-table-content">\n    <mat-toolbar class="mat-table-toolbar" [fxShow]="!textSearchMode && dataSource.selection.isEmpty()">\n      <div class="mat-toolbar-tools">\n        <div fxLayout="row" fxLayoutAlign="start center" fxLayout.xs="column" fxLayoutAlign.xs="center start" class="title-container">\n          <span class="tb-entity-table-title">\n            {{(direction == directions.FROM ? \'relation.from-relations\' : \'relation.to-relations\') | translate}}\n          </span>\n          <mat-form-field class="mat-block tb-relation-direction">\n            <mat-label translate>relation.direction</mat-label>\n            <mat-select [ngModel]="direction"\n                        (ngModelChange)="directionChanged($event)">\n              <mat-option *ngFor="let type of directionTypes" [value]="type">\n                {{ directionTypeTranslations.get(directions[type]) | translate }}\n              </mat-option>\n            </mat-select>\n          </mat-form-field>\n        </div>\n        <span fxFlex></span>\n        <button mat-icon-button [disabled]="isLoading$ | async"\n                (click)="addRelation($event)"\n                matTooltip="{{ \'action.add\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>add</mat-icon>\n        </button>\n        <button mat-icon-button [disabled]="isLoading$ | async" (click)="reloadRelations()"\n                matTooltip="{{ \'action.refresh\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>refresh</mat-icon>\n        </button>\n        <button mat-icon-button [disabled]="isLoading$ | async" (click)="enterFilterMode()"\n                matTooltip="{{ \'action.search\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>search</mat-icon>\n        </button>\n      </div>\n    </mat-toolbar>\n    <mat-toolbar class="mat-table-toolbar" [fxShow]="textSearchMode && dataSource.selection.isEmpty()">\n      <div class="mat-toolbar-tools">\n        <button mat-icon-button\n                matTooltip="{{ \'action.search\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>search</mat-icon>\n        </button>\n        <mat-form-field fxFlex>\n          <mat-label>&nbsp;</mat-label>\n          <input #searchInput matInput\n                 [(ngModel)]="pageLink.textSearch"\n                 placeholder="{{ \'common.enter-search\' | translate }}"/>\n        </mat-form-field>\n        <button mat-icon-button (click)="exitFilterMode()"\n                matTooltip="{{ \'action.close\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>close</mat-icon>\n        </button>\n      </div>\n    </mat-toolbar>\n    <mat-toolbar class="mat-table-toolbar" color="primary" [fxShow]="!dataSource.selection.isEmpty()">\n      <div class="mat-toolbar-tools" fxLayoutAlign="space-between center">\n        <span class="tb-entity-table-info">\n          {{ \'relation.selected-relations\' | translate:{count: dataSource.selection.selected.length} }}\n        </span>\n        <button mat-icon-button [disabled]="isLoading$ | async"\n                matTooltip="{{ \'action.delete\' | translate }}"\n                matTooltipPosition="above"\n                (click)="deleteRelations($event)">\n          <mat-icon>delete</mat-icon>\n        </button>\n      </div>\n    </mat-toolbar>\n    <div fxFlex class="table-container">\n      <table mat-table [dataSource]="dataSource"\n                 matSort [matSortActive]="pageLink.sortOrder.property" [matSortDirection]="pageLink.sortDirection()" matSortDisableClear>\n        <ng-container matColumnDef="select" sticky>\n          <mat-header-cell *matHeaderCellDef style="width: 30px;">\n            <mat-checkbox (change)="$event ? dataSource.masterToggle() : null"\n                          [checked]="dataSource.selection.hasValue() && (dataSource.isAllSelected() | async)"\n                          [indeterminate]="dataSource.selection.hasValue() && !(dataSource.isAllSelected() | async)">\n            </mat-checkbox>\n          </mat-header-cell>\n          <mat-cell *matCellDef="let relation">\n            <mat-checkbox (click)="$event.stopPropagation()"\n                          (change)="$event ? dataSource.selection.toggle(relation) : null"\n                          [checked]="dataSource.selection.isSelected(relation)">\n            </mat-checkbox>\n          </mat-cell>\n        </ng-container>\n        <ng-container matColumnDef="type">\n          <mat-header-cell *matHeaderCellDef mat-sort-header style="width: 33%"> {{ \'relation.type\' | translate }} </mat-header-cell>\n          <mat-cell *matCellDef="let relation">\n            {{ relation.type }}\n          </mat-cell>\n        </ng-container>\n        <ng-container *ngIf="direction === directions.FROM" matColumnDef="toEntityTypeName">\n          <mat-header-cell *matHeaderCellDef mat-sort-header style="width: 33%"> {{ \'relation.to-entity-type\' | translate }} </mat-header-cell>\n          <mat-cell *matCellDef="let relation">\n            {{ relation.toEntityTypeName }}\n          </mat-cell>\n        </ng-container>\n        <ng-container *ngIf="direction === directions.FROM" matColumnDef="toName">\n          <mat-header-cell *matHeaderCellDef mat-sort-header style="width: 33%"> {{ \'relation.to-entity-name\' | translate }} </mat-header-cell>\n          <mat-cell *matCellDef="let relation">\n            {{ relation.toName }}\n          </mat-cell>\n        </ng-container>\n        <ng-container *ngIf="direction === directions.TO" matColumnDef="fromEntityTypeName">\n          <mat-header-cell *matHeaderCellDef mat-sort-header style="width: 33%"> {{ \'relation.from-entity-type\' | translate }} </mat-header-cell>\n          <mat-cell *matCellDef="let relation">\n            {{ relation.fromEntityTypeName }}\n          </mat-cell>\n        </ng-container>\n        <ng-container *ngIf="direction === directions.TO" matColumnDef="fromName">\n          <mat-header-cell *matHeaderCellDef mat-sort-header style="width: 33%"> {{ \'relation.from-entity-name\' | translate }} </mat-header-cell>\n          <mat-cell *matCellDef="let relation">\n            {{ relation.fromName }}\n          </mat-cell>\n        </ng-container>\n        <ng-container matColumnDef="actions" stickyEnd>\n          <mat-header-cell *matHeaderCellDef style="min-width: 80px; max-width: 80px; width: 80px">\n          </mat-header-cell>\n          <mat-cell *matCellDef="let relation">\n            <div fxFlex fxLayout="row" fxLayoutAlign="end">\n              <button mat-icon-button [disabled]="isLoading$ | async"\n                      matTooltip="{{ \'relation.edit\' | translate }}"\n                      matTooltipPosition="above"\n                      (click)="editRelation($event, relation)">\n                <mat-icon>edit</mat-icon>\n              </button>\n              <button mat-icon-button [disabled]="isLoading$ | async"\n                      matTooltip="{{ \'relation.delete\' | translate }}"\n                      matTooltipPosition="above"\n                      (click)="deleteRelation($event, relation)">\n                <mat-icon>delete</mat-icon>\n              </button>\n            </div>\n          </mat-cell>\n        </ng-container>\n        <mat-header-row [ngClass]="{\'mat-row-select\': true}" *matHeaderRowDef="displayedColumns; sticky: true"></mat-header-row>\n        <mat-row [ngClass]="{\'mat-row-select\': true,\n                             \'mat-selected\': dataSource.selection.isSelected(relation)}"\n                 *matRowDef="let relation; columns: displayedColumns;" (click)="dataSource.selection.toggle(relation)"></mat-row>\n      </table>\n      <span [fxShow]="dataSource.isEmpty() | async"\n            fxLayoutAlign="center center"\n            class="no-data-found" translate>{{ \'relation.no-relations-text\' }}</span>\n    </div>\n    <mat-divider></mat-divider>\n    <mat-paginator [length]="dataSource.total() | async"\n                   [pageIndex]="pageLink.page"\n                   [pageSize]="pageLink.pageSize"\n                   [pageSizeOptions]="[10, 20, 30]"></mat-paginator>\n  </div>\n</div>\n'},UDFY:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form #formContainer class="gateway-form"\n      [formGroup]="gatewayConfigurationGroup"\n      tb-toast toastTarget="{{ toastTargetId }}"\n      (ngSubmit)="save()">\n  <mat-accordion multi="true" class="mat-body-1">\n    <mat-expansion-panel>\n      <mat-expansion-panel-header>\n        <mat-panel-title>\n          <div class="tb-panel-title">{{ \'gateway.thingsboard\' | translate | uppercase }}</div>\n        </mat-panel-title>\n      </mat-expansion-panel-header>\n        <tb-entity-gateway-select\n          formControlName="gateway"\n          [deviceName]="deviceNameForm"\n          [isStateForm]="isStateForm"\n          [newGatewayType]="gatewayType"\n          (gatewayNameExist)="gatewayExist()"\n          required\n        >\n      </tb-entity-gateway-select>\n      <div fxLayout="column">\n        <mat-form-field fxFlex>\n          <mat-label>{{\'gateway.security-type\' | translate }}</mat-label>\n          <mat-select formControlName="securityType" >\n            <mat-option *ngFor="let securityType of securityTypes | keyvalue" [value]="securityType.key">\n              {{ securityType.value.toString() | translate }}\n            </mat-option>\n          </mat-select>\n        </mat-form-field>\n      </div>\n      <div [fxLayout]="alignment" [fxLayoutGap]="layoutGap">\n        <mat-form-field fxFlex>\n          <mat-label>{{ \'gateway.thingsboard-host\' | translate }}</mat-label>\n          <input matInput type="text" formControlName="host">\n          <mat-error *ngIf="gatewayConfigurationGroup.get(\'host\').hasError(\'required\')" translate>\n            gateway.thingsboard-host-required\n          </mat-error>\n        </mat-form-field>\n        <mat-form-field fxFlex>\n          <mat-label>{{ \'gateway.thingsboard-port\' | translate }}</mat-label>\n          <input matInput type="number" formControlName="port">\n          <mat-error *ngIf="gatewayConfigurationGroup.get(\'port\').hasError(\'required\')" translate>\n            gateway.thingsboard-port-required\n          </mat-error>\n          <mat-error *ngIf="gatewayConfigurationGroup.get(\'port\').hasError(\'min\')" translate>\n            gateway.thingsboard-port-min\n          </mat-error>\n          <mat-error *ngIf="gatewayConfigurationGroup.get(\'port\').hasError(\'max\')" translate>\n            gateway.thingsboard-port-max\n          </mat-error>\n          <mat-error *ngIf="gatewayConfigurationGroup.get(\'port\').hasError(\'pattern\')" translate>\n            gateway.thingsboard-port-pattern\n          </mat-error>\n        </mat-form-field>\n      </div>\n\n      <div *ngIf="gatewayConfigurationGroup.get(\'securityType\').value == \'tls\'" fxLayout="column">\n        <mat-form-field fxFlex>\n          <mat-label>{{ \'gateway.tls-path-ca-certificate\' | translate }}</mat-label>\n          <input matInput type="text" formControlName="caCertPath">\n        </mat-form-field>\n        <mat-form-field fxFlex>\n          <mat-label>{{ \'gateway.tls-path-private-key\' | translate }}</mat-label>\n          <input matInput type="text" formControlName="privateKeyPath">\n        </mat-form-field>\n        <mat-form-field fxFlex>\n          <mat-label>{{ \'gateway.tls-path-client-certificate\' | translate }}</mat-label>\n          <input matInput type="text" formControlName="certPath">\n        </mat-form-field>\n      </div>\n\n      <mat-checkbox formControlName="remoteConfiguration">{{ \'gateway.remote\' | translate }}</mat-checkbox>\n\n      <div [fxLayout]="alignment" [fxLayoutGap]="layoutGap">\n        <mat-form-field fxFlex>\n          <mat-label>{{\'gateway.remote-logging-level\' | translate }}</mat-label>\n          <mat-select formControlName="remoteLoggingLevel">\n            <mat-option *ngFor="let logLevel of gatewayLogLevels" [value]="logLevel">\n              {{ logLevel }}\n            </mat-option>\n          </mat-select>\n        </mat-form-field>\n\n        <mat-form-field fxFlex>\n          <mat-label>{{ \'gateway.path-logs\' | translate }}</mat-label>\n          <input matInput type="text" formControlName="remoteLoggingPathToLogs">\n          <mat-error *ngIf="gatewayConfigurationGroup.get(\'remoteLoggingPathToLogs\').hasError(\'required\')" translate>\n            gateway.path-logs-required\n          </mat-error>\n        </mat-form-field>\n      </div>\n\n    </mat-expansion-panel>\n\n    <mat-expansion-panel>\n      <mat-expansion-panel-header>\n        <mat-panel-title>\n          <div class="tb-panel-title">{{ \'gateway.storage\' | translate | uppercase }}</div>\n        </mat-panel-title>\n      </mat-expansion-panel-header>\n\n      <div fxLayout="column">\n        <mat-form-field fxFlex>\n          <mat-label>{{\'gateway.storage-type\' | translate }}</mat-label>\n          <mat-select formControlName="storageType">\n            <mat-option *ngFor="let storageType of storageTypes | keyvalue" [value]="storageType.key">\n              {{ storageType.value.toString() | translate}}\n            </mat-option>\n          </mat-select>\n        </mat-form-field>\n\n        <div [fxLayout]="alignment" [fxLayoutGap]="layoutGap">\n          <mat-form-field fxFlex>\n            <mat-label>{{ \'gateway.storage-pack-size\' | translate }}</mat-label>\n            <input matInput type="number" formControlName="readRecordsCount">\n            <mat-error *ngIf="gatewayConfigurationGroup.get(\'readRecordsCount\').hasError(\'required\')" translate>\n              gateway.storage-pack-size-required\n            </mat-error>\n            <mat-error *ngIf="gatewayConfigurationGroup.get(\'readRecordsCount\').hasError(\'min\')" translate>\n              gateway.storage-pack-size-min\n            </mat-error>\n            <mat-error *ngIf="gatewayConfigurationGroup.get(\'readRecordsCount\').hasError(\'pattern\')" translate>\n              gateway.storage-pack-size-pattern\n            </mat-error>\n          </mat-form-field>\n\n          <mat-form-field fxFlex>\n            <mat-label >\n              {{ (gatewayConfigurationGroup.get(\'storageType\').value !== \'file\' ? \'gateway.storage-max-records\' : \'gateway.storage-max-file-records\') | translate}}\n            </mat-label>\n            <input matInput type="number" formControlName="maxRecordsCount">\n            <mat-error *ngIf="gatewayConfigurationGroup.get(\'maxRecordsCount\').hasError(\'required\')" translate>\n              gateway.storage-max-records-required\n            </mat-error>\n            <mat-error *ngIf="gatewayConfigurationGroup.get(\'maxRecordsCount\').hasError(\'min\')" translate>\n              gateway.storage-max-records-min\n            </mat-error>\n            <mat-error *ngIf="gatewayConfigurationGroup.get(\'maxRecordsCount\').hasError(\'pattern\')" translate>\n              gateway.storage-max-records-pattern\n            </mat-error>\n          </mat-form-field>\n        </div>\n\n        <div [fxLayout]="alignment" [fxLayoutGap]="layoutGap" *ngIf="gatewayConfigurationGroup.get(\'storageType\').value == \'file\'">\n          <mat-form-field fxFlex>\n            <mat-label>{{ \'gateway.storage-max-files\' | translate }}</mat-label>\n            <input matInput type="number" formControlName="maxFilesCount">\n            <mat-error *ngIf="gatewayConfigurationGroup.get(\'maxFilesCount\').hasError(\'required\')" translate>\n              gateway.storage-max-files-required\n            </mat-error>\n            <mat-error *ngIf="gatewayConfigurationGroup.get(\'maxFilesCount\').hasError(\'min\')" translate>\n              gateway.storage-max-files-min\n            </mat-error>\n            <mat-error *ngIf="gatewayConfigurationGroup.get(\'maxFilesCount\').hasError(\'pattern\')" translate>\n              gateway.storage-max-files-pattern\n            </mat-error>\n          </mat-form-field>\n\n          <mat-form-field fxFlex>\n            <mat-label>{{ \'gateway.storage-path\' | translate }}</mat-label>\n            <input matInput type="text" formControlName="dataFolderPath">\n            <mat-error *ngIf="gatewayConfigurationGroup.get(\'dataFolderPath\').hasError(\'required\')" translate>\n              gateway.storage-path-required\n            </mat-error>\n          </mat-form-field>\n        </div>\n      </div>\n    </mat-expansion-panel>\n\n    <mat-expansion-panel>\n      <mat-expansion-panel-header>\n        <mat-panel-title>\n          <div class="tb-panel-title">{{ \'gateway.connectors\' | translate | uppercase }}</div>\n        </mat-panel-title>\n      </mat-expansion-panel-header>\n\n      <div fxLayout="column" class="gateway-config">\n        <section formArrayName="connectors" *ngFor="let connector of connectors.controls; let i = index;">\n          <div [formGroupName]="i" fxLayout="row" fxLayoutAlign="space-between stretch" fxLayoutGap="8px">\n            <div fxLayout="column" fxLayoutAlign="center start">\n              <mat-slide-toggle formControlName="enabled"></mat-slide-toggle>\n            </div>\n            <div [fxLayout]="alignment" [fxLayoutGap]="layoutGap" fxFlex>\n              <mat-form-field fxFlex>\n                <mat-label>{{\'gateway.connector-type\' | translate }}</mat-label>\n                <mat-select formControlName="configType" (selectionChange)="changeConnectorType(connector)">\n                  <mat-option *ngFor="let connectorType of connectorTypes" [value]="connectorType">\n                    {{ connectorType }}\n                  </mat-option>\n                </mat-select>\n                <mat-error *ngIf="connector.get(\'configType\').hasError(\'required\')" translate>\n                  gateway.connector-type-required\n                </mat-error>\n              </mat-form-field>\n\n              <mat-form-field fxFlex>\n                <mat-label>{{ \'gateway.connector-name\' | translate }}</mat-label>\n                <input matInput type="text" formControlName="name" (blur)="changeConnectorName(connector, i)">\n                <mat-error *ngIf="connector.get(\'name\').hasError(\'required\')" translate>\n                  gateway.connector-name-required\n                </mat-error>\n              </mat-form-field>\n            </div>\n            <div [fxLayout]="alignment" [fxLayoutGap]="layoutGap"\n                 fxLayoutAlign="{{alignment == \'row\' ? \'end center\' : \'space-evenly center\'}}" class="action-buttons">\n              <button [disabled]="isReadOnlyForm" mat-icon-button (click)="openConfigDialog($event, i, connector.get(\'config\').value, connector.get(\'name\').value)"\n                         matTooltip="{{ \'gateway.update-config\' | translate }}"\n                         matTooltipPosition="above"\n                         [ngClass]="{\'mat-warn\': connector.get(\'config\').invalid}">\n                <mat-icon>more_horiz</mat-icon>\n              </button>\n              <button [disabled]="isReadOnlyForm"\n                      mat-icon-button (click)="removeConnector(i)"\n                      matTooltip="{{ \'gateway.delete\' | translate }}"\n                      matTooltipPosition="above">\n                <mat-icon>close</mat-icon>\n              </button>\n            </div>\n          </div>\n        </section>\n        <span [fxShow]="!connectors.length" fxLayoutAlign="center center" class="no-data-found">{{\'gateway.no-connectors\' | translate}}</span>\n        <div>\n          <button [fxShow]="!isReadOnlyForm" mat-raised-button type="button" (click)="addNewConnector()"\n                  matTooltip="{{ \'gateway.connector-add\' | translate }}"\n                  matTooltipPosition="above">\n            {{ \'action.add\' | translate }}\n          </button>\n        </div>\n      </div >\n    </mat-expansion-panel>\n  </mat-accordion>\n  <section [fxShow]="!isReadOnlyForm"\n           fxLayout="row" fxLayoutAlign="end center" class="form-action-buttons">\n    <button mat-raised-button color="primary" type="button"\n            (click)="exportConfig()"\n            *ngIf="!gatewayConfigurationGroup.get(\'remoteConfiguration\').value"\n            [disabled]="!gatewayConfigurationGroup.dirty || gatewayConfigurationGroup.invalid"\n            matTooltip="{{\'gateway.download-tip\' | translate }}">\n      {{\'action.download\' | translate }}\n    </button>\n\n    <button mat-raised-button color="primary" type="submit"\n            *ngIf="gatewayConfigurationGroup.get(\'remoteConfiguration\').value"\n            [disabled]="!gatewayConfigurationGroup.dirty || gatewayConfigurationGroup.invalid"\n            matTooltip="{{\'gateway.save-tip\' | translate }}">\n      {{\'action.save\' | translate }}\n    </button>\n  </section>\n</form>\n'},UaJx:function(t,e,n){"use strict";n.d(e,"a",(function(){return L}));var i=n("mrSG"),a=n("TYT/"),o=n("RxGS"),r=n("6onV"),s=n("mbhL"),l=n("ea4N"),c=n("nbAZ"),d=n("Byqp"),u=n("Gi3i"),h=n("ad02"),p=n("xMyE"),m=n("4r/P"),g=n("bne5"),f=n("p0ib"),b=n("VNr4"),y=n("o8Qb"),v=n("DUip"),w=n("qxrw"),x=n("S+vS"),S=n("LrsY"),C=n("aX2P"),T=n("E1rE"),O=n("HnHJ"),_=n("//Q6"),L=function(t){function e(e,n,i,o,r,s,l,c){var d=t.call(this,e)||this;return d.store=e,d.route=n,d.translate=i,d.dialog=o,d.dialogService=r,d.domSanitizer=s,d.cd=l,d.componentFactoryResolver=c,d.headerCellStyleCache=[],d.cellContentCache=[],d.cellTooltipCache=[],d.cellStyleCache=[],d.defaultPageSize=10,d.displayPagination=!0,d.textSearchMode=!1,d.isDetailsOpen=!1,d.detailsPanelOpened=new a.EventEmitter,d.viewInited=!1,d}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){this.entitiesTableConfig?this.init(this.entitiesTableConfig):this.init(this.route.snapshot.data.entitiesTableConfig)},e.prototype.ngOnChanges=function(t){for(var e=0,n=Object.keys(t);e<n.length;e++){var i=n[e],a=t[i];a.firstChange||a.currentValue===a.previousValue||"entitiesTableConfig"===i&&a.currentValue&&this.init(a.currentValue)}},e.prototype.init=function(t){var e=this;if(this.isDetailsOpen=!1,this.entitiesTableConfig=t,this.entitiesTableConfig.headerComponent){var n=this.componentFactoryResolver.resolveComponentFactory(this.entitiesTableConfig.headerComponent),a=this.entityTableHeaderAnchor.viewContainerRef;a.clear(),a.createComponent(n).instance.entitiesTableConfig=this.entitiesTableConfig}this.entitiesTableConfig.table=this,this.translations=this.entitiesTableConfig.entityTranslations,this.headerActionDescriptors=Object(i.l)(this.entitiesTableConfig.headerActionDescriptors),this.groupActionDescriptors=Object(i.l)(this.entitiesTableConfig.groupActionDescriptors),this.cellActionDescriptors=Object(i.l)(this.entitiesTableConfig.cellActionDescriptors),this.entitiesTableConfig.entitiesDeleteEnabled&&(this.cellActionDescriptors.push({name:this.translate.instant("action.delete"),icon:"delete",isEnabled:function(t){return e.entitiesTableConfig.deleteEnabled(t)},onAction:function(t,n){return e.deleteEntity(t,n)}}),this.groupActionDescriptors.push({name:this.translate.instant("action.delete"),icon:"delete",isEnabled:!0,onAction:function(t,n){return e.deleteEntities(t,n)}}));var o=this.groupActionDescriptors.filter((function(t){return t.isEnabled}));this.selectionEnabled=this.entitiesTableConfig.selectionEnabled&&o.length,this.columnsUpdated();var r=null;if(this.entitiesTableConfig.defaultSortOrder&&(r={property:this.entitiesTableConfig.defaultSortOrder.property,direction:this.entitiesTableConfig.defaultSortOrder.direction}),this.displayPagination=this.entitiesTableConfig.displayPagination,this.defaultPageSize=this.entitiesTableConfig.defaultPageSize,this.pageSizeOptions=[this.defaultPageSize,2*this.defaultPageSize,3*this.defaultPageSize],this.entitiesTableConfig.useTimePageLink){this.timewindow=Object(C.p)(C.b);var l=Date.now();this.pageLink=new s.c(10,0,null,r,l-this.timewindow.history.timewindowMs,l)}else this.pageLink=new s.b(10,0,null,r);this.pageLink.pageSize=this.displayPagination?this.defaultPageSize:s.a,this.dataSource=this.entitiesTableConfig.dataSource(this.dataLoaded.bind(this)),this.entitiesTableConfig.onLoadAction&&this.entitiesTableConfig.onLoadAction(this.route),this.entitiesTableConfig.loadDataOnInit&&this.dataSource.loadEntities(this.pageLink),this.viewInited&&setTimeout((function(){e.updatePaginationSubscriptions()}),0)},e.prototype.ngAfterViewInit=function(){var t=this;Object(g.a)(this.searchInputField.nativeElement,"keyup").pipe(Object(u.a)(150),Object(h.a)(),Object(p.a)((function(){t.displayPagination&&(t.paginator.pageIndex=0),t.updateData()}))).subscribe(),this.updatePaginationSubscriptions(),this.viewInited=!0},e.prototype.updatePaginationSubscriptions=function(){var t=this;this.sortSubscription&&(this.sortSubscription.unsubscribe(),this.sortSubscription=null),this.updateDataSubscription&&(this.updateDataSubscription.unsubscribe(),this.updateDataSubscription=null),this.displayPagination&&(this.sortSubscription=this.sort.sortChange.subscribe((function(){return t.paginator.pageIndex=0}))),this.updateDataSubscription=(this.displayPagination?Object(f.a)(this.sort.sortChange,this.paginator.page):this.sort.sortChange).pipe(Object(p.a)((function(){return t.updateData()}))).subscribe()},e.prototype.addEnabled=function(){return this.entitiesTableConfig.addEnabled},e.prototype.clearSelection=function(){this.dataSource.selection.clear(),this.cd.detectChanges()},e.prototype.updateData=function(t){if(void 0===t&&(t=!0),t&&(this.isDetailsOpen=!1),this.displayPagination?(this.pageLink.page=this.paginator.pageIndex,this.pageLink.pageSize=this.paginator.pageSize):this.pageLink.page=0,this.sort.active?this.pageLink.sortOrder={property:this.sort.active,direction:m.a[this.sort.direction.toUpperCase()]}:this.pageLink.sortOrder=null,this.entitiesTableConfig.useTimePageLink){var e=this.pageLink;if(this.timewindow.history.historyType===C.d.LAST_INTERVAL){var n=Date.now();e.startTime=n-this.timewindow.history.timewindowMs,e.endTime=n}else e.startTime=this.timewindow.history.fixedTimewindow.startTimeMs,e.endTime=this.timewindow.history.fixedTimewindow.endTimeMs}this.dataSource.loadEntities(this.pageLink)},e.prototype.dataLoaded=function(t,e){isFinite(t)&&isFinite(e)?this.clearCellCache(t,e):(this.headerCellStyleCache.length=0,this.cellContentCache.length=0,this.cellTooltipCache.length=0,this.cellStyleCache.length=0)},e.prototype.onRowClick=function(t,e){this.entitiesTableConfig.handleRowClick(t,e)||this.toggleEntityDetails(t,e)},e.prototype.toggleEntityDetails=function(t,e){t&&t.stopPropagation(),this.dataSource.toggleCurrentEntity(e)?this.isDetailsOpen=!0:this.isDetailsOpen=!this.isDetailsOpen,this.detailsPanelOpened.emit(this.isDetailsOpen)},e.prototype.addEntity=function(t){var e=this;(this.entitiesTableConfig.addEntity?this.entitiesTableConfig.addEntity():this.dialog.open(S.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{entitiesTableConfig:this.entitiesTableConfig}}).afterClosed()).subscribe((function(t){t&&(e.updateData(),e.entitiesTableConfig.entityAdded(t))}))},e.prototype.onEntityUpdated=function(t){this.updateData(!1),this.entitiesTableConfig.entityUpdated(t)},e.prototype.onEntityAction=function(t){"delete"===t.action&&this.deleteEntity(t.event,t.entity)},e.prototype.deleteEntity=function(t,e){var n=this;t&&t.stopPropagation(),this.dialogService.confirm(this.entitiesTableConfig.deleteEntityTitle(e),this.entitiesTableConfig.deleteEntityContent(e),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe((function(t){t&&n.entitiesTableConfig.deleteEntity(e.id).subscribe((function(){n.updateData(),n.entitiesTableConfig.entitiesDeleted([e.id])}))}))},e.prototype.deleteEntities=function(t,e){var n=this;t&&t.stopPropagation(),this.dialogService.confirm(this.entitiesTableConfig.deleteEntitiesTitle(e.length),this.entitiesTableConfig.deleteEntitiesContent(e.length),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe((function(t){if(t){var i=[];e.forEach((function(t){n.entitiesTableConfig.deleteEnabled(t)&&i.push(n.entitiesTableConfig.deleteEntity(t.id))})),Object(b.a)(i).subscribe((function(){n.updateData(),n.entitiesTableConfig.entitiesDeleted(e.map((function(t){return t.id})))}))}}))},e.prototype.onTimewindowChange=function(){this.updateData()},e.prototype.enterFilterMode=function(){var t=this;this.textSearchMode=!0,this.pageLink.textSearch="",setTimeout((function(){t.searchInputField.nativeElement.focus(),t.searchInputField.nativeElement.setSelectionRange(0,0)}),10)},e.prototype.exitFilterMode=function(){this.textSearchMode=!1,this.pageLink.textSearch=null,this.displayPagination&&(this.paginator.pageIndex=0),this.updateData()},e.prototype.resetSortAndFilter=function(t,e){void 0===t&&(t=!0),void 0===e&&(e=!1),this.pageLink.textSearch=null,this.entitiesTableConfig.useTimePageLink&&!e&&(this.timewindow=Object(C.p)(C.b)),this.displayPagination&&(this.paginator.pageIndex=0);var n=this.sort.sortables.get(this.entitiesTableConfig.defaultSortOrder.property);this.sort.active=n.id,this.sort.direction=this.entitiesTableConfig.defaultSortOrder.direction===m.a.ASC?"asc":"desc",t&&this.updateData()},e.prototype.columnsUpdated=function(t){var e=this;void 0===t&&(t=!1),this.entityColumns=this.entitiesTableConfig.columns.filter((function(t){return t instanceof w.c})).map((function(t){return t})),this.actionColumns=this.entitiesTableConfig.columns.filter((function(t){return t instanceof w.b})).map((function(t){return t})),this.displayedColumns=[],this.selectionEnabled&&this.displayedColumns.push("select"),this.entitiesTableConfig.columns.forEach((function(t){e.displayedColumns.push(t.key)})),this.displayedColumns.push("actions"),this.headerCellStyleCache.length=0,this.cellContentCache.length=0,this.cellTooltipCache.length=0,this.cellStyleCache.length=0,t&&this.dataSource.reset()},e.prototype.headerCellStyle=function(t){var e=this.entitiesTableConfig.columns.indexOf(t),n=this.headerCellStyleCache[e];if(!n){var a={width:t.width};"0px"!==t.width&&(a.minWidth=t.width,a.maxWidth=t.width),n=t instanceof w.c?Object(i.a)(Object(i.a)({},t.headerCellStyleFunction(t.key)),a):a,this.headerCellStyleCache[e]=n}return n},e.prototype.clearCellCache=function(t,e){var n=e*this.entitiesTableConfig.columns.length+t;this.cellContentCache[n]=void 0,this.cellTooltipCache[n]=void 0,this.cellStyleCache[n]=void 0},e.prototype.cellContent=function(t,e,n){if(e instanceof w.c){var i=this.entitiesTableConfig.columns.indexOf(e),a=n*this.entitiesTableConfig.columns.length+i,o=this.cellContentCache[a];return o||(o=this.domSanitizer.bypassSecurityTrustHtml(e.cellContentFunction(t,e.key)),this.cellContentCache[a]=o),o}return""},e.prototype.cellTooltip=function(t,e,n){if(e instanceof w.c){var i=this.entitiesTableConfig.columns.indexOf(e),a=n*this.entitiesTableConfig.columns.length+i,o=this.cellTooltipCache[a];if(!Object(_.u)(o))return null!==o?o:void 0;o=e.cellTooltipFunction(t,e.key),o=Object(_.k)(o)?o:null,this.cellTooltipCache[a]=o}},e.prototype.cellStyle=function(t,e,n){var a=this.entitiesTableConfig.columns.indexOf(e),o=n*this.entitiesTableConfig.columns.length+a,r=this.cellStyleCache[o];if(!r){var s={width:e.width};"0px"!==e.width&&(s.minWidth=e.width,s.maxWidth=e.width),r=e instanceof w.c?Object(i.a)(Object(i.a)({},e.cellStyleFunction(t,e.key)),s):s,this.cellStyleCache[o]=r}return r},e.prototype.trackByColumnKey=function(t,e){return e.key},e.prototype.trackByEntityId=function(t,e){return e.id.id},e.ctorParameters=function(){return[{type:r.Store},{type:v.ActivatedRoute},{type:y.TranslateService},{type:l.MatDialog},{type:x.a},{type:T.b},{type:a.ChangeDetectorRef},{type:a.ComponentFactoryResolver}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",w.d)],e.prototype,"entitiesTableConfig",void 0),Object(i.c)([Object(a.ViewChild)("entityTableHeader",{static:!0}),Object(i.g)("design:type",O.a)],e.prototype,"entityTableHeaderAnchor",void 0),Object(i.c)([Object(a.ViewChild)("searchInput"),Object(i.g)("design:type",a.ElementRef)],e.prototype,"searchInputField",void 0),Object(i.c)([Object(a.ViewChild)(c.a),Object(i.g)("design:type",c.a)],e.prototype,"paginator",void 0),Object(i.c)([Object(a.ViewChild)(d.a),Object(i.g)("design:type",d.a)],e.prototype,"sort",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-entities-table",template:Object(i.f)(n("Qjnd")).default,changeDetection:a.ChangeDetectionStrategy.OnPush,styles:[Object(i.f)(n("+m5s")).default]}),Object(i.g)("design:paramtypes",[r.Store,v.ActivatedRoute,y.TranslateService,l.MatDialog,x.a,T.b,a.ChangeDetectorRef,a.ComponentFactoryResolver])],e)}(o.a)},UePS:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div class="tb-custom-action-pretty mat-elevation-z1" tb-fullscreen [fullscreen]="fullscreen">\n  <div fxLayout="row" fxLayoutAlign="end center" class="tb-action-expand-button" [ngClass]="{\'tb-fullscreen-editor\': fullscreen}">\n    <button mat-button fxHide.lt-md\n            matTooltip="{{ \'widget.toggle-fullscreen\' | translate }}"\n            matTooltipPosition="above"\n            (click)="fullscreen = !fullscreen">\n      <mat-icon>{{ fullscreen ? \'fullscreen_exit\' : \'fullscreen\' }}</mat-icon>\n      <span *ngIf="fullscreen" translate>widget.toggle-fullscreen</span>\n    </button>\n  </div>\n  <div class="tb-custom-action-editor" [ngClass]="{\'tb-fullscreen-editor\': fullscreen}">\n    <div *ngIf="!fullscreen; else fullscreenEditor">\n      <tb-custom-action-pretty-resources-tabs [hasCustomFunction]="true"\n                                              [action]="action" (actionUpdated)="onActionUpdated($event ? true : false)">\n      </tb-custom-action-pretty-resources-tabs>\n    </div>\n    <ng-template #fullscreenEditor>\n      <div class="tb-fullscreen-panel tb-layout-fill" fxLayout="row">\n        <div #leftPanel class="tb-split tb-content">\n          <tb-custom-action-pretty-resources-tabs [hasCustomFunction]="false"\n                                                  [action]="action" (actionUpdated)="onActionUpdated($event ? true : false)">\n          </tb-custom-action-pretty-resources-tabs>\n        </div>\n        <div #rightPanel class="tb-split tb-content right-panel">\n          <tb-js-func\n            [(ngModel)]="action.customFunction"\n            (ngModelChange)="onActionUpdated()"\n            [fillHeight]="true"\n            [functionArgs]="[\'$event\', \'widgetContext\', \'entityId\', \'entityName\', \'htmlTemplate\', \'additionalParams\', \'entityLabel\']"\n            [validationArgs]="[]"\n            [editorCompleter]="customPrettyActionEditorCompleter">\n          </tb-js-func>\n        </div>\n      </div>\n    </ng-template>\n  </div>\n</div>\n'},UrOe:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n("0lYY"),a=n("3Tyt"),o=n("aX2P"),r=n("//Q6"),s=n("9GfO"),l=function(){function t(t,e,n){this.datasourceSubscriptionOptions=t,this.telemetryService=e,this.utils=n,this.listeners=[],this.datasourceType=this.datasourceSubscriptionOptions.datasourceType,this.history=this.datasourceSubscriptionOptions.subscriptionTimewindow&&Object(r.s)(this.datasourceSubscriptionOptions.subscriptionTimewindow.fixedWindow),this.realtime=this.datasourceSubscriptionOptions.subscriptionTimewindow&&Object(r.l)(this.datasourceSubscriptionOptions.subscriptionTimewindow.realtimeWindowMs),this.subscribers=new Array,this.dataKeys={},this.datasourceData={},this.datasourceOrigData={},this.tickScheduledTime=0,this.tickElapsed=0,this.initializeSubscription()}return t.prototype.initializeSubscription=function(){for(var t=0;t<this.datasourceSubscriptionOptions.dataKeys.length;t++){var e=Object(r.d)(this.datasourceSubscriptionOptions.dataKeys[t]);e.index=t,this.datasourceType===i.a.function?e.func||(e.func=new Function("time","prevValue",e.funcBody)):e.postFuncBody&&!e.postFunc&&(e.postFunc=new Function("time","value","prevValue","timePrev","prevOrigValue",e.postFuncBody));var n=void 0;if(this.datasourceType===i.a.entity||this.datasourceSubscriptionOptions.type===i.k.timeseries){n=this.datasourceType===i.a.function?e.name+"_"+e.index+"_"+e.type:e.name+"_"+e.type;var a=this.dataKeys[n];a||(a=[],this.dataKeys[n]=a);var o=a.push(e)-1;this.datasourceData[n+"_"+o]={data:[]}}else n=String(Object(r.x)(e)),this.datasourceData[n]={data:[]},this.dataKeys[n]=e;e.key=n}this.datasourceOrigData=Object(r.d)(this.datasourceData),this.datasourceType===i.a.function&&(this.frequency=1e3,this.datasourceSubscriptionOptions.type===i.k.timeseries&&(this.frequency=Math.min(this.datasourceSubscriptionOptions.subscriptionTimewindow.aggregation.interval,5e3)))},t.prototype.addListener=function(t){this.listeners.push(t),this.history&&this.start()},t.prototype.hasListeners=function(){return this.listeners.length>0},t.prototype.removeListener=function(t){this.listeners.splice(this.listeners.indexOf(t),1)},t.prototype.syncListener=function(t){var e,n;if(this.datasourceType===i.a.entity||this.datasourceSubscriptionOptions.type===i.k.timeseries)for(var a=0,o=Object.keys(this.dataKeys);a<o.length;a++){e=o[a];for(var r=this.dataKeys[e],s=0;s<r.length;s++){n=r[s];var l=e+"_"+s;t.dataUpdated(this.datasourceData[l],t.datasourceIndex,n.index,!1)}}else for(var c=0,d=Object.keys(this.dataKeys);c<d.length;c++)e=d[c],n=this.dataKeys[e],t.dataUpdated(this.datasourceData[e],t.datasourceIndex,n.index,!1)},t.prototype.unsubscribe=function(){this.timer&&(clearTimeout(this.timer),this.timer=null),this.datasourceType===i.a.entity&&(this.subscribers.forEach((function(t){t.unsubscribe()})),this.subscribers.length=0),this.dataAggregator&&(this.dataAggregator.destroy(),this.dataAggregator=null)},t.prototype.start=function(){var t=this;if(!this.history||this.hasListeners()){var e,n=this.datasourceSubscriptionOptions.subscriptionTimewindow,o=[],r=[];if(this.datasourceType===i.a.entity){for(var s,l,c=0,d=Object.keys(this.dataKeys);c<d.length;c++){var u=d[c];(e=this.dataKeys[u][0]).type===a.c.timeseries?o.push(e.name):e.type===a.c.attribute&&r.push(e.name)}if(s=o.join(","),l=r.join(","),s.length>0)if(this.history){var h,p,m,g=new a.d;g.entityType=this.datasourceSubscriptionOptions.entityType,g.entityId=this.datasourceSubscriptionOptions.entityId,g.keys=s,g.startTs=n.fixedWindow.startTimeMs,g.endTs=n.fixedWindow.endTimeMs,g.interval=n.aggregation.interval,g.limit=n.aggregation.limit,g.agg=n.aggregation.type,(x=new a.j(this.telemetryService)).subscriptionCommands.push(g),n.aggregation.stateData&&(h=this.createFirstStateHistoryCommand(n.fixedWindow.startTimeMs,s),x.subscriptionCommands.push(h)),x.data$.subscribe((function(e){if(n.aggregation.stateData&&h&&h.cmdId===e.subscriptionId)p?t.onStateHistoryData(e,p,n.aggregation.limit,n.fixedWindow.startTimeMs,n.fixedWindow.endTimeMs,(function(e){t.onData(e.data,a.c.timeseries,!0)})):m=p;else if(n.aggregation.stateData)m?t.onStateHistoryData(m,e,n.aggregation.limit,n.fixedWindow.startTimeMs,n.fixedWindow.endTimeMs,(function(e){t.onData(e.data,a.c.timeseries,!0)})):p=e;else{for(var i=0,o=Object.keys(e.data);i<o.length;i++){var r=o[i];e.data[r].sort((function(t,e){return t[0]-e[0]}))}t.onData(e.data,a.c.timeseries,!0)}})),x.subscribe(),this.subscribers.push(x)}else{var f,b,y,v,w=new a.k;if(w.entityType=this.datasourceSubscriptionOptions.entityType,w.entityId=this.datasourceSubscriptionOptions.entityId,w.keys=s,(x=new a.j(this.telemetryService)).subscriptionCommands.push(w),this.datasourceSubscriptionOptions.type===i.k.timeseries)this.updateRealtimeSubscriptionCommand(w,n),n.aggregation.stateData&&(f=this.createFirstStateHistoryCommand(n.startTs,s),x.subscriptionCommands.push(f)),this.dataAggregator=this.createRealtimeDataAggregator(n,o,a.c.timeseries),x.data$.subscribe((function(e){n.aggregation.stateData&&f&&f.cmdId===e.subscriptionId?b?(t.onStateHistoryData(e,b,n.aggregation.limit,n.startTs,n.startTs+n.aggregation.timeWindow,(function(e){t.dataAggregator.onData(e,!1,!1,!0)})),v=!0):y=e:n.aggregation.stateData&&!v?y?(t.onStateHistoryData(y,e,n.aggregation.limit,n.startTs,n.startTs+n.aggregation.timeWindow,(function(e){t.dataAggregator.onData(e,!1,!1,!0)})),v=!0):b=e:t.dataAggregator.onData(e,!1,!1,!0)})),x.reconnect$.subscribe((function(){var e=null;t.listeners.forEach((function(t){e?t.setRealtimeSubscription(e):e=t.updateRealtimeSubscription()})),n=e,y=null,b=null,v=!1,t.updateRealtimeSubscriptionCommand(w,n),n.aggregation.stateData&&t.updateFirstStateHistoryCommand(f,n.startTs),t.dataAggregator.reset(e.startTs,e.aggregation.timeWindow,e.aggregation.interval)}));else x.data$.subscribe((function(e){e.data&&t.onData(e.data,a.c.timeseries,!0)}));x.subscribe(),this.subscribers.push(x)}if(l.length){var x,S=new a.b;S.entityType=this.datasourceSubscriptionOptions.entityType,S.entityId=this.datasourceSubscriptionOptions.entityId,S.keys=l,(x=new a.j(this.telemetryService)).subscriptionCommands.push(S),x.data$.subscribe((function(e){e.data&&t.onData(e.data,a.c.attribute,!0)})),x.subscribe(),this.subscribers.push(x)}}else if(this.datasourceType===i.a.function){if(this.datasourceSubscriptionOptions.type===i.k.timeseries){for(var C=0,T=Object.keys(this.dataKeys);C<T.length;C++){u=T[C];this.dataKeys[u].forEach((function(t){o.push(t.name+"_"+t.index)}))}this.dataAggregator=this.createRealtimeDataAggregator(n,o,a.c.function)}this.tickScheduledTime=this.utils.currentPerfTime(),this.history?this.onTick(!0):this.timer=setTimeout(this.onTick.bind(this,!0),0)}}},t.prototype.createFirstStateHistoryCommand=function(t,e){var n=new a.d;return n.entityType=this.datasourceSubscriptionOptions.entityType,n.entityId=this.datasourceSubscriptionOptions.entityId,n.keys=e,n.startTs=t-o.h,n.endTs=t,n.interval=1e3,n.limit=1,n.agg=o.a.NONE,n},t.prototype.updateFirstStateHistoryCommand=function(t,e){t.startTs=e-o.h,t.endTs=e},t.prototype.onStateHistoryData=function(t,e,n,i,a,o){for(var s=0,l=Object.keys(e.data);s<l.length;s++){var c=l[s],d=e.data[c];if(d.sort((function(t,e){return t[0]-e[0]})),d.length<n){var u=t.data[c];if(u.length){var h=u[0];h[0]=i,u=[[i,u[0][1]]],d.unshift(h)}}if(d.length){var p=Object(r.d)(d[d.length-1]);p[0]=a,d.push(p)}}o(e)},t.prototype.createRealtimeDataAggregator=function(t,e,n){var i=this;return new s.a((function(t,e){i.onData(t,n,e)}),e,t.startTs,t.aggregation.limit,t.aggregation.type,t.aggregation.timeWindow,t.aggregation.interval,t.aggregation.stateData,this.utils)},t.prototype.updateRealtimeSubscriptionCommand=function(t,e){t.startTs=e.startTs,t.timeWindow=e.aggregation.timeWindow,t.interval=e.aggregation.interval,t.limit=e.aggregation.limit,t.agg=e.aggregation.type},t.prototype.generateSeries=function(t,e,n,i){var a,o=[],r=t.key+"_"+e,s=this.datasourceData[r].data;a=s.length>0?s[s.length-1]:[0,0];for(var l=n;l<=i&&(this.timer||this.history);l+=this.frequency){var c=[l,t.func(l,a[1])];o.push(c),a=c}return o.length>0&&(t.lastUpdateTime=o[o.length-1][0]),o},t.prototype.generateLatest=function(t,e){var n,i=this,a=this.datasourceData[t.key].data;n=a.length>0?a[a.length-1]:[0,0];var o=Date.now(),r=[o,t.func(o,n[1])];this.datasourceData[t.key].data=[r],this.listeners.forEach((function(n){n.dataUpdated(i.datasourceData[t.key],n.datasourceIndex,t.index,e)}))},t.prototype.onTick=function(t){var e,n=this.utils.currentPerfTime();if(this.tickElapsed+=n-this.tickScheduledTime,this.tickScheduledTime=n,this.timer&&clearTimeout(this.timer),this.datasourceSubscriptionOptions.type===i.k.timeseries){var a=void 0,r=void 0,s=void 0,l={data:{}};this.history||(s=Math.floor(this.tickElapsed/this.frequency));var c=this.history?this.frequency:s*this.frequency;this.tickElapsed=this.tickElapsed-c;for(var d=0,u=Object.keys(this.dataKeys);d<u.length;d++){e=u[d];for(var h=this.dataKeys[e],p=0;p<h.length&&(this.timer||this.history);p++){var m=h[p];if(!a)if(this.realtime){if(m.lastUpdateTime)a=m.lastUpdateTime+this.frequency,r=m.lastUpdateTime+c;else if(r=(a=this.datasourceSubscriptionOptions.subscriptionTimewindow.startTs)+this.datasourceSubscriptionOptions.subscriptionTimewindow.realtimeWindowMs+this.frequency,this.datasourceSubscriptionOptions.subscriptionTimewindow.aggregation.type===o.a.NONE){var g=r-this.frequency*this.datasourceSubscriptionOptions.subscriptionTimewindow.aggregation.limit;a=Math.max(g,a)}}else a=this.datasourceSubscriptionOptions.subscriptionTimewindow.fixedWindow.startTimeMs,r=this.datasourceSubscriptionOptions.subscriptionTimewindow.fixedWindow.endTimeMs;var f=this.generateSeries(m,p,a,r);l.data[m.name+"_"+m.index]=f}}this.dataAggregator&&this.dataAggregator.onData(l,!0,this.history,t)}else if(this.datasourceSubscriptionOptions.type===i.k.latest)for(var b=0,y=Object.keys(this.dataKeys);b<y.length;b++)e=y[b],this.generateLatest(this.dataKeys[e],t);this.history||(this.timer=setTimeout(this.onTick.bind(this,!0),this.frequency))},t.prototype.onData=function(t,e,n){for(var a=this,o=0,r=Object.keys(t);o<r.length;o++)for(var s=r[o],l=t[s],c=s+"_"+e,d=this.dataKeys[c],u=function(t){var e=c+"_"+t;if(h.datasourceData[e].data){var o,r,s=d[t],u=[],p=void 0,m=void 0,g=!1;if(h.realtime?(p=[],m=[]):(p=h.datasourceData[e].data,m=h.datasourceOrigData[e].data),p.length>0?(o=p[p.length-1],r=m[m.length-1]):(o=[0,0],r=[0,0]),h.datasourceOrigData[e].data=[],h.datasourceSubscriptionOptions.type===i.k.timeseries)l.forEach((function(t){var n=t,i=n[0];a.datasourceOrigData[e].data.push(n);var l=a.convertValue(n[1]);s.postFunc&&(l=s.postFunc(i,l,o[1],r[0],r[1])),r=n,n=[i,l],u.push(n),o=n})),g=!0;else if(h.datasourceSubscriptionOptions.type===i.k.latest){if(l.length>0){var f=l[0],b=f[0];h.datasourceOrigData[e].data.push(f);var y=h.convertValue(f[1]);s.postFunc&&(y=s.postFunc(b,y,o[1],r[0],r[1])),f=[b,y],u.push(f)}g=!0}g&&(h.datasourceData[e].data=u,h.listeners.forEach((function(t){t.dataUpdated(a.datasourceData[e],t.datasourceIndex,s.index,n)})))}},h=this,p=0;d&&p<d.length;p++)u(p)},t.prototype.isNumeric=function(t){return t-parseFloat(t)+1>=0},t.prototype.convertValue=function(t){return t&&this.isNumeric(t)?Number(t):t},t}()},VE42:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div fxLayout="column" class="mat-content mat-padding">\n  <label class="tb-title" translate>entity.columns-to-display</label>\n  <mat-checkbox style="padding-bottom: 8px;" [(ngModel)]="column.display" *ngFor="let column of columns"\n                (ngModelChange)="update()">\n    {{ column.title }}\n  </mat-checkbox>\n</div>\n'},Vg08:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div fxFlex fxLayout="column" class="tb-progress-cover" fxLayoutAlign="center center"\n     [ngStyle]="dashboardStyle"\n     [style.backgroundImage]="backgroundImage"\n     [fxShow]="(isLoading$ | async) && !ignoreLoading && !isEdit">\n  <mat-spinner color="warn" mode="indeterminate" diameter="100">\n  </mat-spinner>\n</div>\n<div id="gridster-parent"\n     fxFlex class="tb-dashboard-content layout-wrap" [ngStyle]="{overflowY: isAutofillHeight() ? \'hidden\' : \'auto\'}"\n                (contextmenu)="openDashboardContextMenu($event)">\n  <div #dashboardMenuTrigger="matMenuTrigger" style="visibility: hidden; position: fixed"\n       [style.left]="dashboardMenuPosition.x"\n       [style.top]="dashboardMenuPosition.y"\n       [matMenuTriggerFor]="dashboardMenu">\n  </div>\n  <mat-menu #dashboardMenu="matMenu">\n    <ng-template matMenuContent let-items="items">\n      <div class="tb-dashboard-context-menu-items">\n        <button mat-menu-item *ngFor="let item of items;"\n                [disabled]="!item.enabled"\n                (click)="item.action(dashboardContextMenuEvent)">\n          <span *ngIf="item.shortcut" class="tb-alt-text"> {{ item.shortcut | keyboardShortcut }}</span>\n          <mat-icon *ngIf="item.icon">{{item.icon}}</mat-icon>\n          <span translate>{{item.value}}</span>\n        </button>\n      </div>\n    </ng-template>\n  </mat-menu>\n  <div #widgetMenuTrigger="matMenuTrigger" style="visibility: hidden; position: fixed"\n       [style.left]="widgetMenuPosition.x"\n       [style.top]="widgetMenuPosition.y"\n       [matMenuTriggerFor]="widgetMenu">\n  </div>\n  <mat-menu #widgetMenu="matMenu">\n    <ng-template matMenuContent let-items="items" let-widget="widget">\n      <div class="tb-dashboard-context-menu-items">\n        <button mat-menu-item *ngFor="let item of items;"\n                [disabled]="!item.enabled"\n                (click)="item.action(widgetContextMenuEvent, widget)">\n          <span *ngIf="item.shortcut" class="tb-alt-text"> {{ item.shortcut | keyboardShortcut }}</span>\n          <mat-icon *ngIf="item.icon">{{item.icon}}</mat-icon>\n          <span translate>{{item.value}}</span>\n        </button>\n      </div>\n    </ng-template>\n  </mat-menu>\n  <div [ngClass]="dashboardClass" id="gridster-background" style="height: auto; min-height: 100%; display: inline;">\n    <gridster #gridster id="gridster-child" [options]="gridsterOpts">\n      <gridster-item [item]="widget" class="tb-noselect" *ngFor="let widget of dashboardWidgets">\n        <div tb-fullscreen [fullscreen]="widget.isFullscreen"\n             [fullscreenBackgroundStyle]="dashboardStyle"\n             [fullscreenBackgroundImage]="backgroundImage"\n             (fullscreenChanged)="onWidgetFullscreenChanged($event, widget)"\n             fxLayout="column"\n             class="tb-widget"\n             [ngClass]="{\n                \'tb-highlighted\': isHighlighted(widget),\n                \'tb-not-highlighted\': isNotHighlighted(widget),\n                \'mat-elevation-z4\': widget.dropShadow,\n                \'tb-has-timewindow\': widget.hasTimewindow\n             }"\n             [ngStyle]="widget.style"\n             (mousedown)="widgetMouseDown($event, widget)"\n             (click)="widgetClicked($event, widget)"\n             (contextmenu)="openWidgetContextMenu($event, widget)">\n          <div fxLayout="row" fxLayoutAlign="space-between start">\n            <div class="tb-widget-title" fxLayout="column" fxLayoutAlign="center start" [fxShow]="widget.showWidgetTitlePanel">\n              <span [fxShow]="widget.showTitle"\n                    [ngClass]="{\'single-row\': widget.hasTimewindow}"\n                    [ngStyle]="widget.titleStyle"\n                    [matTooltip]="widget.titleTooltip"\n                    matTooltipClass="tb-tooltip-multiline"\n                    matTooltipPosition="above"\n                    class="mat-subheading-2 title">\n                <mat-icon *ngIf="widget.showTitleIcon" [ngStyle]="widget.titleIconStyle">{{widget.titleIcon}}</mat-icon>\n                {{widget.title}}\n              </span>\n              <tb-timewindow *ngIf="widget.hasTimewindow"\n                             #timewindowComponent\n                             aggregation="{{widget.hasAggregation}}"\n                             [isEdit]="isEdit"\n                             [(ngModel)]="widgetComponent.widget.config.timewindow"\n                             (ngModelChange)="widgetComponent.onTimewindowChanged($event)">\n              </tb-timewindow>\n            </div>\n            <div [fxShow]="widget.showWidgetActions"\n                 class="tb-widget-actions"\n                 [ngClass]="{\'tb-widget-actions-absolute\': !(widget.showWidgetTitlePanel&&(widget.showTitle||widget.hasAggregation))}"\n                 fxLayout="row"\n                 fxLayoutAlign="start center"\n                 (mousedown)="$event.stopPropagation()">\n              <button mat-button mat-icon-button *ngFor="let action of widget.customHeaderActions"\n                    [fxShow]="!isEdit"\n                    (click)="action.onAction($event)"\n                    matTooltip="{{ action.displayName }}"\n                    matTooltipPosition="above">\n                <mat-icon>{{ action.icon }}</mat-icon>\n              </button>\n              <button mat-button mat-icon-button *ngFor="let action of widget.widgetActions"\n                      [fxShow]="!isEdit && action.show"\n                      (click)="action.onAction($event)"\n                      matTooltip="{{ action.name | translate }}"\n                      matTooltipPosition="above">\n                <mat-icon>{{ action.icon }}</mat-icon>\n              </button>\n              <button mat-button mat-icon-button\n                      [fxShow]="!isEdit && widget.enableFullscreen"\n                      (click)="$event.stopPropagation(); widget.isFullscreen = !widget.isFullscreen"\n                      matTooltip="{{(widget.isFullscreen ? \'fullscreen.exit\' : \'fullscreen.expand\') | translate}}"\n                      matTooltipPosition="above">\n                <mat-icon>{{ widget.isFullscreen ? \'fullscreen_exit\' : \'fullscreen\' }}</mat-icon>\n              </button>\n              <button mat-button mat-icon-button\n                      [fxShow]="isEditActionEnabled && !widget.isFullscreen"\n                      (click)="editWidget($event, widget)"\n                      matTooltip="{{ \'widget.edit\' | translate }}"\n                      matTooltipPosition="above">\n                <mat-icon>edit</mat-icon>\n              </button>\n              <button mat-button mat-icon-button\n                      [fxShow]="isExportActionEnabled && !widget.isFullscreen"\n                      (click)="exportWidget($event, widget)"\n                      matTooltip="{{ \'widget.export\' | translate }}"\n                      matTooltipPosition="above">\n                <mat-icon>file_download</mat-icon>\n              </button>\n              <button mat-button mat-icon-button\n                      [fxShow]="isRemoveActionEnabled && !widget.isFullscreen"\n                      (click)="removeWidget($event, widget);"\n                      matTooltip="{{ \'widget.remove\' | translate }}"\n                      matTooltipPosition="above">\n                <mat-icon>close</mat-icon>\n              </button>\n            </div>\n          </div>\n          <div fxFlex fxLayout="column" class="tb-widget-content">\n            <tb-widget fxFlex\n                       #widgetComponent\n                       [dashboardWidget]="widget"\n                       [isEdit]="isEdit"\n                       [isMobile]="isMobileSize">\n            </tb-widget>\n          </div>\n        </div>\n      </gridster-item>\n    </gridster>\n  </div>\n</div>\n'},WAO0:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host {\n  width: 100%;\n  height: 100%;\n}'},WXpk:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\ntb-dashboard-page {\n  display: -ms-flexbox;\n  display: flex;\n  width: 100%;\n  height: 100%;\n}\ndiv.tb-dashboard-page.mat-content {\n  overflow: hidden;\n  background-color: #eee;\n}\ndiv.tb-dashboard-page section.tb-dashboard-title {\n  position: relative;\n  padding-left: 20px;\n  max-height: 60px;\n}\ndiv.tb-dashboard-page section.tb-dashboard-title mat-form-field .mat-form-field-infix {\n  width: 100%;\n}\ndiv.tb-dashboard-page section.tb-dashboard-title input.tb-dashboard-title {\n  height: 38px;\n  font-size: 2rem;\n  font-weight: 500;\n  letter-spacing: 0.005em;\n}\ndiv.tb-dashboard-page section.tb-dashboard-toolbar {\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 13;\n  pointer-events: none;\n}\ndiv.tb-dashboard-page section.tb-dashboard-toolbar.tb-dashboard-toolbar-opened {\n  right: 0;\n}\ndiv.tb-dashboard-page section.tb-dashboard-toolbar.tb-dashboard-toolbar-closed {\n  right: 18px;\n  transition: right 0.3s cubic-bezier(0.55, 0, 0.55, 0.2) 0.2s;\n}\ndiv.tb-dashboard-page .tb-dashboard-container.tb-dashboard-toolbar-opened.is-fullscreen {\n  margin-top: 84px;\n}\n@media screen and (min-width: 960px) {\n  div.tb-dashboard-page .tb-dashboard-container.tb-dashboard-toolbar-opened.is-fullscreen {\n    margin-top: 64px;\n  }\n}\ndiv.tb-dashboard-page .tb-dashboard-container.tb-dashboard-toolbar-opened:not(.is-fullscreen) {\n  margin-top: 84px;\n}\n@media screen and (min-width: 960px) {\n  div.tb-dashboard-page .tb-dashboard-container.tb-dashboard-toolbar-opened:not(.is-fullscreen) {\n    margin-top: 50px;\n  }\n}\ndiv.tb-dashboard-page .tb-dashboard-container.tb-dashboard-toolbar-opened:not(.is-fullscreen).tb-dashboard-toolbar-animated {\n  transition: margin-top 0.3s cubic-bezier(0.55, 0, 0.55, 0.2);\n}\ndiv.tb-dashboard-page .tb-dashboard-container.tb-dashboard-toolbar-closed {\n  margin-top: 0;\n}\ndiv.tb-dashboard-page .tb-dashboard-container.tb-dashboard-toolbar-closed.tb-dashboard-toolbar-animated {\n  transition: margin-top 0.3s cubic-bezier(0.55, 0, 0.55, 0.2) 0.2s;\n}\ndiv.tb-dashboard-page mat-drawer-container.tb-dashboard-drawer-container mat-drawer-container.tb-dashboard-layouts {\n  width: 100%;\n}\ndiv.tb-dashboard-page mat-drawer-container.tb-dashboard-drawer-container mat-drawer-container.tb-dashboard-layouts.tb-shrinked {\n  width: 40%;\n}\n@media screen and (min-width: 960px) {\n  div.tb-dashboard-page mat-drawer-container.tb-dashboard-drawer-container mat-drawer.tb-details-drawer {\n    width: 85% !important;\n  }\n}\n@media screen and (min-width: 1280px) {\n  div.tb-dashboard-page mat-drawer-container.tb-dashboard-drawer-container mat-drawer.tb-details-drawer {\n    width: 75% !important;\n  }\n}\n@media screen and (min-width: 1920px) {\n  div.tb-dashboard-page mat-drawer-container.tb-dashboard-drawer-container mat-drawer.tb-details-drawer {\n    width: 60% !important;\n  }\n}\ndiv.tb-dashboard-page section.tb-powered-by-footer {\n  position: absolute;\n  right: 25px;\n  bottom: 5px;\n  z-index: 30;\n  pointer-events: none;\n}\ndiv.tb-dashboard-page section.tb-powered-by-footer span {\n  font-size: 12px;\n}\ndiv.tb-dashboard-page section.tb-powered-by-footer span a {\n  font-weight: 700;\n  text-decoration: none;\n  pointer-events: all;\n  border: none;\n}'},WYFZ:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div fxLayout="column" class="tb-progress-cover" fxLayoutAlign="center center"\n  *ngIf="layoutCtx.widgets.isLoading()">\n  <mat-spinner color="warn" mode="indeterminate" diameter="100">\n  </mat-spinner>\n</div>\n<div class="mat-content"\n          style="position: relative; width: 100%; height: 100%;" tb-hotkeys [hotkeys]="hotKeys"\n          [cheatSheet]="dashboardCheatSheet"\n          [style.backgroundImage]="backgroundImage"\n          [ngStyle]="dashboardStyle">\n  <section *ngIf="layoutCtx.widgets.isEmpty()" fxLayoutAlign="center center"\n           [ngStyle]="{\'color\': layoutCtx.gridSettings.color}"\n           style="text-transform: uppercase; display: flex; z-index: 1; pointer-events: none;"\n           class="mat-headline tb-absolute-fill">\n    <span *ngIf="!isEdit">\n      {{\'dashboard.no-widgets\' | translate}}\n    </span>\n    <button mat-button *ngIf="isEdit && !widgetEditMode" class="tb-add-new-widget"\n            (click)="addWidget($event)">\n      <mat-icon class="tb-mat-96">add</mat-icon>\n      {{ \'dashboard.add-widget\' | translate }}\n    </button>\n  </section>\n  <tb-dashboard #dashboard [dashboardStyle]="dashboardStyle"\n                [backgroundImage]="backgroundImage"\n                [widgets]="layoutCtx.widgets"\n                [widgetLayouts]="layoutCtx.widgetLayouts"\n                [columns]="layoutCtx.gridSettings.columns"\n                [margin]="layoutCtx.gridSettings.margin"\n                [aliasController]="dashboardCtx.aliasController"\n                [stateController]="dashboardCtx.stateController"\n                [dashboardTimewindow]="dashboardCtx.dashboardTimewindow"\n                [isEdit]="isEdit"\n                [autofillHeight]="layoutCtx.gridSettings.autoFillHeight && !isEdit"\n                [mobileAutofillHeight]="layoutCtx.gridSettings.mobileAutoFillHeight && !isEdit"\n                [mobileRowHeight]="layoutCtx.gridSettings.mobileRowHeight"\n                [isMobile]="isMobile"\n                [isMobileDisabled]="widgetEditMode"\n                [isEditActionEnabled]="isEdit"\n                [isExportActionEnabled]="isEdit && !widgetEditMode"\n                [isRemoveActionEnabled]="isEdit && !widgetEditMode"\n                [callbacks]="this"\n                [ignoreLoading]="layoutCtx.ignoreLoading">\n  </tb-dashboard>\n</div>\n'},XCsc:function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var i=n("mrSG"),a=n("TYT/"),o=n("ea4N"),r=n("6onV"),s=n("QJY3"),l=n("DUip"),c=n("gmuX"),d=n("o8Qb"),u=n("xKAQ"),h=n("CAq0"),p=n("z3OR"),m=n("9HAa"),g=function(t){function e(e,n,i,a,o,r,l){var c=t.call(this,e,n,a)||this;return c.store=e,c.router=n,c.data=i,c.dialogRef=a,c.translate=o,c.importExport=r,c.fb=l,c.delimiters=[{key:",",value:","},{key:";",value:";"},{key:"|",value:"|"},{key:"\t",value:"Tab"}],c.selectedIndex=0,c.isImportData=!1,c.progressCreate=0,c.entityType=i.entityType,c.importTitle=i.importTitle,c.importFileLabel=i.importFileLabel,c.selectFileFormGroup=c.fb.group({importData:[null,[s.Validators.required]]}),c.importParametersFormGroup=c.fb.group({delim:[",",[s.Validators.required]],isHeader:[!0,[]],isUpdate:[!0,[]]}),c.columnTypesFormGroup=c.fb.group({columnsParam:[[],[]]}),c}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){},e.prototype.cancel=function(){this.dialogRef.close(!1)},e.prototype.previousStep=function(){this.importStepper.previous()},e.prototype.nextStep=function(t){switch(t){case 2:this.importStepper.next();break;case 3:var e=this.selectFileFormGroup.get("importData").value,n=this.parseCSV(e);if(-1===n)this.importStepper.previous(),this.importStepper.selected.reset();else{this.parseData=n;var i=this.createColumnsData();this.columnTypesFormGroup.patchValue({columnsParam:i},{emitEvent:!0}),this.importStepper.next()}break;case 4:this.importStepper.next(),this.isImportData=!0,this.addEntities();break;case 6:this.dialogRef.close(!0)}},e.prototype.parseCSV=function(t){var e=this,n={delim:this.importParametersFormGroup.get("delim").value,header:this.importParametersFormGroup.get("isHeader").value};return Object(p.d)(t,n,(function(t,n){e.store.dispatch(new u.b({message:e.translate.instant(t,n),type:"error"}))}))},e.prototype.createColumnsData=function(){for(var t=[],e=this.importParametersFormGroup.get("isHeader").value,n=0;n<this.parseData.headers.length;n++){var i=void 0;i=e&&0===this.parseData.headers[n].search(/^(name|type|label)$/im)?{type:p.a[this.parseData.headers[n].toLowerCase()],key:this.parseData.headers[n].toLowerCase(),sampleData:this.parseData.rows[0][n]}:{type:p.a.serverAttribute,key:e?this.parseData.headers[n]:"",sampleData:this.parseData.rows[0][n]},t.push(i)}return t},e.prototype.addEntities=function(){for(var t=this,e=this.parseData,n=this.columnTypesFormGroup.get("columnsParam").value,i=[],a=0,o=0;o<e.rows.length;o++){for(var r={name:"",type:"",description:"",gateway:null,label:"",accessToken:"",attributes:{server:[],shared:[]},timeseries:[]},s=o,l=0;l<n.length;l++)switch(n[l].type){case p.a.serverAttribute:r.attributes.server.push({key:n[l].key,value:e.rows[s][l]});break;case p.a.timeseries:r.timeseries.push({key:n[l].key,value:e.rows[s][l]});break;case p.a.sharedAttribute:r.attributes.shared.push({key:n[l].key,value:e.rows[s][l]});break;case p.a.accessToken:r.accessToken=e.rows[s][l];break;case p.a.name:r.name=e.rows[s][l];break;case p.a.type:r.type=e.rows[s][l];break;case p.a.label:r.label=e.rows[s][l];break;case p.a.isGateway:r.gateway=e.rows[s][l];break;case p.a.description:r.description=e.rows[s][l]}i.push(r)}var c=this.importParametersFormGroup.get("isUpdate").value;this.importExport.importEntities(i,this.entityType,c,(function(){a++,t.progressCreate=Math.round(a/e.rows.length*100)}),{ignoreErrors:!0,resendRequest:!0}).subscribe((function(e){t.statistical=e,t.isImportData=!1,t.importStepper.next()}))},e.ctorParameters=function(){return[{type:r.Store},{type:l.Router},{type:void 0,decorators:[{type:a.Inject,args:[o.MAT_DIALOG_DATA]}]},{type:o.MatDialogRef},{type:d.TranslateService},{type:m.a},{type:s.FormBuilder}]},Object(i.c)([Object(a.ViewChild)("importStepper",{static:!0}),Object(i.g)("design:type",h.b)],e.prototype,"importStepper",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-import-csv-dialog",template:Object(i.f)(n("Qhii")).default,providers:[],styles:[Object(i.f)(n("uRQ0")).default]}),Object(i.h)(2,Object(a.Inject)(o.MAT_DIALOG_DATA)),Object(i.g)("design:paramtypes",[r.Store,l.Router,Object,o.MatDialogRef,d.TranslateService,m.a,s.FormBuilder])],e)}(c.a)},XHOO:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .tb-knob {\n  width: 100%;\n  height: 100%;\n}\n:host .tb-knob .knob {\n  position: relative;\n}\n:host .tb-knob .knob[draggable] {\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n:host .tb-knob .knob #canvasBar {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  z-index: 2;\n}\n:host .tb-knob .knob .canvas-background {\n  position: absolute;\n  top: 5%;\n  right: 5%;\n  bottom: 5%;\n  left: 5%;\n  z-index: 2;\n  background: #3f4346;\n  border-radius: 50%;\n}\n:host .tb-knob .knob .value-container {\n  position: absolute;\n  top: 35%;\n  right: 35%;\n  bottom: 35%;\n  left: 35%;\n  z-index: 4;\n}\n:host .tb-knob .knob .value-container .knob-value {\n  font-weight: 500;\n  color: #fff;\n  white-space: nowrap;\n}\n:host .tb-knob .knob .error-container {\n  position: absolute;\n  top: 1%;\n  right: 0;\n  left: 0;\n  z-index: 4;\n  height: 5%;\n}\n:host .tb-knob .knob .error-container .knob-error {\n  color: #ff3315;\n  white-space: nowrap;\n}\n:host .tb-knob .knob .title-container {\n  position: absolute;\n  right: 20%;\n  bottom: 5%;\n  left: 20%;\n  z-index: 4;\n  height: 6.6%;\n}\n:host .tb-knob .knob .title-container .knob-title {\n  font-weight: 500;\n  color: #757575;\n  white-space: nowrap;\n}\n:host .tb-knob .knob .minmax-container {\n  position: absolute;\n  right: 18%;\n  bottom: 12%;\n  left: 18%;\n  z-index: 4;\n  height: 4%;\n}\n:host .tb-knob .knob .minmax-container .minmax-label {\n  font-weight: 500;\n  color: #757575;\n  white-space: nowrap;\n}\n:host .tb-knob .knob .top-pointer-container {\n  position: absolute;\n  top: 3.3%;\n  right: 3.3%;\n  bottom: 3.3%;\n  left: 3.3%;\n  z-index: 3;\n  cursor: pointer !important;\n}\n:host .tb-knob .knob .top-pointer-container .top-pointer {\n  position: absolute;\n  top: 50%;\n  left: 22%;\n  width: 5%;\n  height: 5%;\n  margin-top: -2.5%;\n  cursor: pointer !important;\n  content: "";\n  background-color: #b5b5b5;\n  border-radius: 50%;\n  box-shadow: 1px 0 2px #040404;\n}\n:host .tb-knob .knob .top {\n  position: absolute;\n  top: 3.3%;\n  right: 3.3%;\n  bottom: 3.3%;\n  left: 3.3%;\n  z-index: 2;\n  cursor: pointer !important;\n  background: url(\'knob.c529eea069bba2f4223d.svg\') no-repeat;\n  background-size: contain;\n}\n:host .tb-knob .knob #text-measure {\n  position: absolute;\n  width: auto;\n  height: auto;\n  white-space: nowrap;\n  visibility: hidden;\n}'},XOa3:function(t,e,n){"use strict";var i,a,o;n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return o})),n.d(e,"e",(function(){return r})),n.d(e,"d",(function(){return s})),function(t){t[t.TENANT=0]="TENANT",t[t.ENTITY=1]="ENTITY",t[t.USER=2]="USER",t[t.CUSTOMER=3]="CUSTOMER"}(i||(i={})),function(t){t.ADDED="ADDED",t.DELETED="DELETED",t.UPDATED="UPDATED",t.ATTRIBUTES_UPDATED="ATTRIBUTES_UPDATED",t.ATTRIBUTES_DELETED="ATTRIBUTES_DELETED",t.RPC_CALL="RPC_CALL",t.CREDENTIALS_UPDATED="CREDENTIALS_UPDATED",t.ASSIGNED_TO_CUSTOMER="ASSIGNED_TO_CUSTOMER",t.UNASSIGNED_FROM_CUSTOMER="UNASSIGNED_FROM_CUSTOMER",t.ACTIVATED="ACTIVATED",t.SUSPENDED="SUSPENDED",t.CREDENTIALS_READ="CREDENTIALS_READ",t.ATTRIBUTES_READ="ATTRIBUTES_READ",t.RELATION_ADD_OR_UPDATE="RELATION_ADD_OR_UPDATE",t.RELATION_DELETED="RELATION_DELETED",t.RELATIONS_DELETED="RELATIONS_DELETED",t.ALARM_ACK="ALARM_ACK",t.ALARM_CLEAR="ALARM_CLEAR",t.LOGIN="LOGIN",t.LOGOUT="LOGOUT",t.LOCKOUT="LOCKOUT"}(a||(a={})),function(t){t.SUCCESS="SUCCESS",t.FAILURE="FAILURE"}(o||(o={}));var r=new Map([[a.ADDED,"audit-log.type-added"],[a.DELETED,"audit-log.type-deleted"],[a.UPDATED,"audit-log.type-updated"],[a.ATTRIBUTES_UPDATED,"audit-log.type-attributes-updated"],[a.ATTRIBUTES_DELETED,"audit-log.type-attributes-deleted"],[a.RPC_CALL,"audit-log.type-rpc-call"],[a.CREDENTIALS_UPDATED,"audit-log.type-credentials-updated"],[a.ASSIGNED_TO_CUSTOMER,"audit-log.type-assigned-to-customer"],[a.UNASSIGNED_FROM_CUSTOMER,"audit-log.type-unassigned-from-customer"],[a.ACTIVATED,"audit-log.type-activated"],[a.SUSPENDED,"audit-log.type-suspended"],[a.CREDENTIALS_READ,"audit-log.type-credentials-read"],[a.ATTRIBUTES_READ,"audit-log.type-attributes-read"],[a.RELATION_ADD_OR_UPDATE,"audit-log.type-relation-add-or-update"],[a.RELATION_DELETED,"audit-log.type-relation-delete"],[a.RELATIONS_DELETED,"audit-log.type-relations-delete"],[a.ALARM_ACK,"audit-log.type-alarm-ack"],[a.ALARM_CLEAR,"audit-log.type-alarm-clear"],[a.LOGIN,"audit-log.type-login"],[a.LOGOUT,"audit-log.type-logout"],[a.LOCKOUT,"audit-log.type-lockout"]]),s=new Map([[o.SUCCESS,"audit-log.status-success"],[o.FAILURE,"audit-log.status-failure"]])},Xk9D:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var i=n("K9Ia"),a=n("VNr4"),o=n("F/XL"),r=n("S5bw"),s=n("0lYY"),l=n("//Q6"),c=n("67Y/"),d=function(){function t(t,e,n,a){this.utils=t,this.entityService=e,this.stateControllerHolder=n,this.origEntityAliases=a,this.entityAliasesChangedSubject=new i.b,this.entityAliasesChanged=this.entityAliasesChangedSubject.asObservable(),this.entityAliasResolvedSubject=new i.b,this.entityAliasResolved=this.entityAliasResolvedSubject.asObservable(),this.resolvedAliases={},this.resolvedAliasesObservable={},this.resolvedAliasesToStateEntities={},this.entityAliases=Object(l.d)(this.origEntityAliases)}return t.prototype.updateEntityAliases=function(t){for(var e=[],n=0,i=Object.keys(t);n<i.length;n++){var a=t[c=i[n]],o=this.entityAliases[c];Object(l.n)(a,o)||(e.push(c),this.setAliasUnresolved(c))}for(var r=0,s=Object.keys(this.entityAliases);r<s.length;r++){var c;t[c=s[r]]||(e.push(c),this.setAliasUnresolved(c))}this.entityAliases=Object(l.d)(t),e.length&&this.entityAliasesChangedSubject.next(e)},t.prototype.updateAliases=function(t){var e=this;if(!t){t=[];for(var n=0,i=Object.keys(this.resolvedAliases);n<i.length;n++){var o=i[n];t.push(o)}}for(var r=[],s=0,l=t;s<l.length;s++){o=l[s];this.setAliasUnresolved(o),r.push(this.getAliasInfo(o))}Object(a.a)(r).subscribe((function(){e.entityAliasesChangedSubject.next(t)}))},t.prototype.dashboardStateChanged=function(){for(var t=[],e=0,n=Object.keys(this.resolvedAliasesToStateEntities);e<n.length;e++){var i=n[e],a=this.resolvedAliasesToStateEntities[i],o=this.stateControllerHolder().getEntityId(a.entityParamName),r=a.entityId;Object(l.n)(o,r)||(t.push(i),this.setAliasUnresolved(i))}t.length&&this.entityAliasesChangedSubject.next(t)},t.prototype.setAliasUnresolved=function(t){delete this.resolvedAliases[t],delete this.resolvedAliasesObservable[t],delete this.resolvedAliasesToStateEntities[t]},t.prototype.getEntityAliases=function(){return this.entityAliases},t.prototype.getEntityAliasId=function(t){for(var e=0,n=Object.keys(this.entityAliases);e<n.length;e++){var i=n[e];if(this.entityAliases[i].alias===t)return i}return null},t.prototype.getAliasInfo=function(t){var e=this,n=this.resolvedAliases[t];if(n)return Object(o.a)(n);if(this.resolvedAliasesObservable[t])return this.resolvedAliasesObservable[t];var i=new r.a;this.resolvedAliasesObservable[t]=i.asObservable();var a=this.entityAliases[t];if(!a){i.error(null);var s=this.resolvedAliasesObservable[t];return delete this.resolvedAliasesObservable[t],s}return this.entityService.resolveAlias(a,this.stateControllerHolder().getStateParams()).subscribe((function(n){if(e.resolvedAliases[t]=n,delete e.resolvedAliasesObservable[t],n.stateEntity){var a={entityParamName:n.entityParamName,entityId:e.stateControllerHolder().getEntityId(n.entityParamName)};e.resolvedAliasesToStateEntities[t]=a}e.entityAliasResolvedSubject.next(t),i.next(n),i.complete()}),(function(){i.error(null),delete e.resolvedAliasesObservable[t]})),(n=this.resolvedAliases[t])?Object(o.a)(n):this.resolvedAliasesObservable[t]},t.prototype.resolveDatasource=function(t,e){return t.type===s.a.entity?t.entityAliasId?this.getAliasInfo(t.entityAliasId).pipe(Object(c.a)((function(n){if(t.aliasName=n.alias,n.resolveMultiple&&!e){var i=void 0,a=n.resolvedEntities;if(a&&a.length){for(var o=[],r=0;r<a.length;r++){var s=a[r];i=Object(l.d)(t),s.origEntity?i.entity=Object(l.d)(s.origEntity):i.entity={},i.entityId=s.id,i.entityType=s.entityType,i.entityName=s.name,i.entityLabel=s.label,i.entityDescription=s.entityDescription,i.name=s.name,i.generated=r>0,o.push(i)}return o}return n.stateEntity?((i=Object(l.d)(t)).unresolvedStateEntity=!0,[i]):[]}var c=n.currentEntity;return c?(c.origEntity?t.entity=Object(l.d)(c.origEntity):t.entity={},t.entityId=c.id,t.entityType=c.entityType,t.entityName=c.name,t.entityLabel=c.label,t.name=c.name,t.entityDescription=c.entityDescription,[t]):n.stateEntity?(t.unresolvedStateEntity=!0,[t]):[]}))):(t.aliasName=t.entityName,t.name=t.entityName,Object(o.a)([t])):Object(o.a)([t])},t.prototype.resolveAlarmSource=function(t){return this.resolveDatasource(t,!0).pipe(Object(c.a)((function(e){var n,i=e&&e.length?e[0]:Object(l.d)(t);i.type===s.a.function?(n=i.name&&i.name.length?i.name:s.a.function,i.name=n,i.aliasName=n,i.entityName=n):i.unresolvedStateEntity&&(i.name="Unresolved",i.entityName="Unresolved");return i})))},t.prototype.resolveDatasources=function(t){var e=this,n=Object(l.d)(t),i=new Array;return n.forEach((function(t){i.push(e.resolveDatasource(t))})),Object(a.a)(i).pipe(Object(c.a)((function(t){var n=new Array;t.forEach((function(t){n.push.apply(n,t)})),n.sort((function(t,e){return(t.generated?1:0)-(e.generated?1:0)}));var i=0,a=0;return n.forEach((function(t){var n;t.type===s.a.function?(t.name&&t.name.length?n=t.name:(a++,n=s.a.function,a>1&&(n+=" "+a)),t.name=n,t.aliasName=n,t.entityName=n):t.unresolvedStateEntity&&(t.name="Unresolved",t.entityName="Unresolved");t.dataKeys.forEach((function(n){t.generated&&(n._hash=Math.random(),n.color=e.utils.getMaterialColor(i)),i++})),e.updateDatasourceKeyLabels(t)})),n})))},t.prototype.updateDatasourceKeyLabels=function(t){var e=this;t.dataKeys.forEach((function(n){e.updateDataKeyLabel(n,t)}))},t.prototype.updateDataKeyLabel=function(t,e){t.pattern||(t.pattern=Object(l.d)(t.label)),t.label=Object(l.c)(e,t.pattern)},t.prototype.getInstantAliasInfo=function(t){return this.resolvedAliases[t]},t.prototype.updateCurrentAliasEntity=function(t,e){var n=this.resolvedAliases[t];if(n){var i=n.currentEntity;Object(l.n)(e,i)||(n.currentEntity=e,this.entityAliasesChangedSubject.next([t]))}},t}()},YbRx:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host {\n  min-width: 52px;\n}\n:host section.tb-aliases-entity-select {\n  min-height: 32px;\n  padding: 0 6px;\n}\n@media screen and (max-width: 959px) {\n  :host section.tb-aliases-entity-select {\n    padding: 0;\n  }\n}\n:host section.tb-aliases-entity-select span {\n  max-width: 200px;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  pointer-events: all;\n  cursor: pointer;\n}'},YmHn:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div fxLayout="column" class="mat-content mat-padding">\n  <mat-form-field *ngIf="settings.showTemplate" class="mat-block">\n    <input readonly [ngModel]="model.chosenLabel" matInput type="text">\n  </mat-form-field>\n  <ngx-daterangepicker-material [startDate]="model.startDate"\n                                [endDate]="model.endDate"\n                                [locale]="locale"\n                                [singleDatePicker]="settings.onePanel"\n                                [autoApply]="true" (choosedDate)="choosedDate($event)">\n  </ngx-daterangepicker-material>\n  <div class="tb-panel-actions" fxLayout="row" *ngIf="!settings.autoConfirm">\n    <span fxFlex></span>\n    <button mat-button mat-raised-button color="primary"\n            style="margin-right: 20px;"\n            type="button" (click)="apply()">\n      {{ \'action.ok\' | translate }}\n    </button>\n  </div>\n</div>\n'},"Ys3/":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form #formContainer class="tb-multiple-input"\n      [formGroup]="multipleInputFormGroup"\n      tb-toast toastTarget="{{ toastTargetId }}"\n      (ngSubmit)="save()" novalidate autocomplete="off">\n  <div style="padding: 0 8px;" *ngIf="entityDetected && isAllParametersValid">\n    <fieldset *ngFor="let source of sources" [ngClass]="{\'fields-group\': settings.showGroupTitle}">\n      <legend class="group-title" *ngIf="settings.showGroupTitle">{{ getGroupTitle(source.datasource) }}\n      </legend>\n      <div fxLayout="row" class="layout-wrap"\n           [ngClass]="{\'vertical-alignment\': isVerticalAlignment || changeAlignment}">\n        <div *ngFor="let key of visibleKeys(source)"\n             [ngStyle]="{width: (isVerticalAlignment || changeAlignment) ? \'100%\' : inputWidthSettings}">\n          <div class="input-field" *ngIf="key.settings.dataKeyValueType === \'string\'">\n            <mat-form-field class="mat-block">\n              <mat-label>{{key.label}}</mat-label>\n              <input matInput\n                     formControlName="{{key.formId}}"\n                     [required]="key.settings.required"\n                     [readonly]="key.settings.isEditable === \'readonly\'"\n                     type="text"\n                     (focus)="key.isFocused = true; focusInputElement($event)"\n                     (blur)="key.isFocused = false; inputChanged(source, key)">\n              <mat-icon *ngIf="key.settings.icon" matPrefix>{{key.settings.icon}}</mat-icon>\n              <mat-error *ngIf="multipleInputFormGroup.get(key.formId).hasError(\'required\')">\n                {{key.settings.requiredErrorMessage}}\n              </mat-error>\n            </mat-form-field>\n          </div>\n          <div class="input-field" *ngIf="key.settings.dataKeyValueType === \'double\' ||\n                                          key.settings.dataKeyValueType === \'integer\'">\n            <mat-form-field class="mat-block">\n              <mat-label>{{key.label}}</mat-label>\n              <input matInput\n                     formControlName="{{key.formId}}"\n                     [required]="key.settings.required"\n                     [readonly]="key.settings.isEditable === \'readonly\'"\n                     type="number"\n                     step="{{key.settings.step}}"\n                     (focus)="key.isFocused = true; focusInputElement($event)"\n                     (blur)="key.isFocused = false; inputChanged(source, key)">\n              <mat-icon *ngIf="key.settings.icon" matPrefix>{{key.settings.icon}}</mat-icon>\n              <mat-error *ngIf="multipleInputFormGroup.get(key.formId).hasError(\'required\')">\n                {{key.settings.requiredErrorMessage}}\n              </mat-error>\n            </mat-form-field>\n          </div>\n          <div class="input-field mat-block" *ngIf="key.settings.dataKeyValueType === \'booleanCheckbox\'">\n            <mat-checkbox formControlName="{{key.formId}}"\n                          (change)="inputChanged(source, key)">\n              {{key.label}}\n            </mat-checkbox>\n          </div>\n          <div class="input-field mat-block" *ngIf="key.settings.dataKeyValueType === \'booleanSwitch\'">\n            <mat-slide-toggle formControlName="{{key.formId}}"\n                              (change)="inputChanged(source, key)">\n              {{key.label}}\n            </mat-slide-toggle>\n          </div>\n          <div class="input-field mat-block date-time-input" *ngIf="(key.settings.dataKeyValueType === \'dateTime\') ||\n                                                    (key.settings.dataKeyValueType === \'date\') ||\n                                                    (key.settings.dataKeyValueType === \'time\')" fxLayout="column">\n            <div fxLayout="row" [ngClass]="{\'vertically-aligned\': smallWidthContainer}" fxLayoutGap="16px">\n              <mat-form-field>\n                <mat-placeholder>{{key.label}}</mat-placeholder>\n                <mat-datetimepicker-toggle [for]="datePicker" matPrefix></mat-datetimepicker-toggle>\n                <mat-datetimepicker #datePicker type="{{datePickerType(key.settings.dataKeyValueType)}}"\n                                    openOnFocus="true"></mat-datetimepicker>\n                <input matInput formControlName="{{key.formId}}"\n                       [required]="key.settings.required"\n                       [readonly]="key.settings.isEditable === \'readonly\'"\n                       [matDatetimepicker]="datePicker"\n                       (focus)="key.isFocused = true;"\n                       (blur)="key.isFocused = false;"\n                       (dateChange)="inputChanged(source, key)">\n                <mat-error *ngIf="multipleInputFormGroup.get(key.formId).hasError(\'required\')">\n                  {{key.settings.requiredErrorMessage}}\n                </mat-error>\n              </mat-form-field>\n            </div>\n          </div>\n        </div>\n      </div>\n    </fieldset>\n    <div class="mat-padding" fxLayout="row" fxLayoutAlign="end center"\n         *ngIf="entityDetected && settings.showActionButtons">\n      <button mat-button color="primary" type="button"\n              (click)="discardAll()" style="max-height: 50px; margin-right:20px;"\n              [disabled]="!multipleInputFormGroup.dirty">\n        {{ \'action.undo\' | translate }}\n      </button>\n      <button mat-button mat-raised-button color="primary" type="submit"\n                 style="max-height: 50px; margin-right:20px;"\n                 [disabled]="!multipleInputFormGroup.dirty || multipleInputFormGroup.invalid">\n        {{ \'action.save\' | translate }}\n      </button>\n    </div>\n  </div>\n  <div class="tb-multiple-input__errors" fxLayout="column" fxLayoutAlign="center center" style="height: 100%;"\n       *ngIf="!entityDetected || !isAllParametersValid">\n    <div style="text-align: center; font-size: 18px; color: #a0a0a0;" [fxHide]="entityDetected">\n      {{ \'widgets.input-widgets.no-entity-selected\' | translate }}\n    </div>\n    <div style="text-align: center; font-size: 18px; color: #a0a0a0;"\n         [fxShow]="entityDetected && !isAllParametersValid">\n      {{ \'widgets.input-widgets.not-allowed-entity\' | translate }}\n    </div>\n  </div>\n</form>\n'},Z9d0:function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return l}));var i=n("mrSG"),a=n("TYT/"),o=n("S5bw"),r=n("Valr"),s=function(){function t(){}return t.prototype.ngOnDestroy=function(){},t}(),l=function(){function t(t,e){this.compiler=t,this.injector=e,this.dynamicComponentModulesMap=new Map}return t.prototype.createDynamicComponentFactory=function(t,e,n){var l=this,c=new o.a,d=this.createDynamicComponent(t,e),u=[r.CommonModule];n&&(u=Object(i.l)(u,n));var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.d)(e,t),e=Object(i.c)([Object(a.NgModule)({declarations:[d],imports:u})],e)}(s);try{this.compiler.compileModuleAsync(h).then((function(t){var e=t.create(l.injector),n=e.componentFactoryResolver.resolveComponentFactory(d);l.dynamicComponentModulesMap.set(n,{moduleRef:e,moduleType:t.moduleType}),c.next(n),c.complete()})).catch((function(t){c.error(t)}))}catch(p){c.error(p)}return c.asObservable()},t.prototype.destroyDynamicComponentFactory=function(t){var e=this.dynamicComponentModulesMap.get(t);e&&(e.moduleRef.destroy(),this.compiler.clearCacheFor(e.moduleType),this.dynamicComponentModulesMap.delete(t))},t.prototype.createDynamicComponent=function(t,e){return Object(a.Component)({template:e})(t)},t.ctorParameters=function(){return[{type:a.Compiler},{type:a.Injector}]},t=Object(i.c)([Object(a.Injectable)({providedIn:"root"}),Object(i.g)("design:paramtypes",[a.Compiler,a.Injector])],t)}()},ZGXP:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<mat-tab-group selectedIndex="{{hasCustomFunction ? 3 : 2}}" dynamicHeight="true" style="width: 100%; height: 100%;">\n  <mat-tab label="{{ \'widget.resources\' | translate }}" style="width: 100%; height: 100%;">\n    <div class="tb-custom-action-editor-container" style="background-color: #fff;">\n      <div class="mat-padding">\n        <div fxFlex fxLayout="row" style="max-height: 40px;"\n             fxLayoutAlign="start center"\n             *ngFor="let resource of action.customResources; let i = index" >\n          <mat-form-field fxFlex class="mat-block resource-field" floatLabel="never"\n                          style="margin: 10px 0 0; max-height: 40px;">\n            <input required matInput [(ngModel)]="resource.url"\n                   (ngModelChange)="notifyActionUpdated()"\n                   placeholder="{{ \'widget.resource-url\' | translate }}"/>\n          </mat-form-field>\n          <button mat-icon-button color="primary"\n                  [disabled]="isLoading$ | async"\n                  type="button"\n                  (click)="removeResource(i)"\n                  matTooltip="{{\'widget.remove-resource\' | translate}}"\n                  matTooltipPosition="above">\n            <mat-icon>close</mat-icon>\n          </button>\n        </div>\n        <div style="margin-top: 6px;">\n          <button mat-button mat-raised-button color="primary"\n                  [disabled]="isLoading$ | async"\n                  type="button"\n                  (click)="addResource()"\n                  matTooltip="{{\'widget.add-resource\' | translate}}"\n                  matTooltipPosition="above">\n            <span translate>action.add</span>\n          </button>\n        </div>\n      </div>\n    </div>\n  </mat-tab>\n  <mat-tab label="{{ \'widget.css\' | translate }}" style="width: 100%; height: 100%;">\n    <div class="tb-custom-action-editor-container" tb-fullscreen [fullscreen]="cssFullscreen">\n      <div class="tb-editor-area-title-panel">\n        <button mat-button\n                type="button"\n                (click)="beautifyCss()">\n          {{ \'widget.tidy\' | translate }}\n        </button>\n        <button mat-button\n                type="button"\n                mat-icon-button class="tb-mat-32"\n                (click)="cssFullscreen = !cssFullscreen"\n                matTooltip="{{(cssFullscreen ? \'fullscreen.exit\' : \'fullscreen.expand\') | translate}}"\n                matTooltipPosition="above">\n          <mat-icon>{{ cssFullscreen ? \'fullscreen_exit\' : \'fullscreen\' }}</mat-icon>\n        </button>\n      </div>\n      <div #cssInput class="css-panel"></div>\n    </div>\n  </mat-tab>\n  <mat-tab label="{{ \'widget.html\' | translate }}" style="width: 100%; height: 100%;">\n    <div class="tb-custom-action-editor-container" tb-fullscreen [fullscreen]="htmlFullscreen">\n      <div class="tb-editor-area-title-panel">\n        <button mat-button\n                type="button" (click)="beautifyHtml()">\n          {{ \'widget.tidy\' | translate }}\n        </button>\n        <button mat-button\n                type="button"\n                mat-icon-button class="tb-mat-32"\n                (click)="htmlFullscreen = !htmlFullscreen"\n                matTooltip="{{(htmlFullscreen ? \'fullscreen.exit\' : \'fullscreen.expand\') | translate}}"\n                matTooltipPosition="above">\n          <mat-icon>{{ htmlFullscreen ? \'fullscreen_exit\' : \'fullscreen\' }}</mat-icon>\n        </button>\n      </div>\n      <div #htmlInput class="html-panel"></div>\n    </div>\n  </mat-tab>\n  <mat-tab *ngIf="hasCustomFunction" label="{{ \'widget.js\' | translate }}" style="width: 100%; height: 100%;">\n    <tb-js-func\n      [(ngModel)]="action.customFunction"\n      (ngModelChange)="notifyActionUpdated()"\n      [functionArgs]="[\'$event\', \'widgetContext\', \'entityId\', \'entityName\', \'htmlTemplate\', \'additionalParams\', \'entityLabel\']"\n      [validationArgs]="[]"\n      [editorCompleter]="customPrettyActionEditorCompleter">\n    </tb-js-func>\n  </mat-tab>\n</mat-tab-group>\n'},a3eP:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div class="mat-padding tb-entity-table tb-absolute-fill">\n  <div fxFlex fxLayout="column" class="mat-elevation-z1 tb-entity-table-content">\n    <mat-toolbar class="mat-table-toolbar" [fxShow]="mode === \'default\' && !textSearchMode && dataSource.selection.isEmpty()">\n      <div class="mat-toolbar-tools">\n        <div fxLayout="row" fxLayoutAlign="start center" fxLayout.xs="column" fxLayoutAlign.xs="center start" class="title-container">\n          <span class="tb-entity-table-title">{{telemetryTypeTranslationsMap.get(attributeScope) | translate}}</span>\n          <mat-form-field class="mat-block tb-attribute-scope" *ngIf="!disableAttributeScopeSelection">\n            <mat-label translate>attribute.attributes-scope</mat-label>\n            <mat-select [disabled]="(isLoading$ | async) || attributeScopeSelectionReadonly"\n                        [ngModel]="attributeScope"\n                        (ngModelChange)="attributeScopeChanged($event)">\n              <mat-option *ngFor="let scope of attributeScopes" [value]="scope">\n                {{ telemetryTypeTranslationsMap.get(toTelemetryTypeFunc(scope)) | translate }}\n              </mat-option>\n            </mat-select>\n          </mat-form-field>\n        </div>\n        <span fxFlex></span>\n        <button mat-icon-button\n                *ngIf="!isClientSideTelemetryTypeMap.get(attributeScope)"\n                [disabled]="isLoading$ | async"\n                (click)="addAttribute($event)"\n                matTooltip="{{ \'action.add\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>add</mat-icon>\n        </button>\n        <button mat-icon-button\n                *ngIf="!isClientSideTelemetryTypeMap.get(attributeScope)"\n                [disabled]="isLoading$ | async"\n                (click)="reloadAttributes()"\n                matTooltip="{{ \'action.refresh\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>refresh</mat-icon>\n        </button>\n        <button mat-icon-button\n                [disabled]="isLoading$ | async"\n                (click)="enterFilterMode()"\n                matTooltip="{{ \'action.search\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>search</mat-icon>\n        </button>\n      </div>\n    </mat-toolbar>\n    <mat-toolbar class="mat-table-toolbar" [fxShow]="mode === \'default\' && textSearchMode && dataSource.selection.isEmpty()">\n      <div class="mat-toolbar-tools">\n        <button mat-icon-button\n                matTooltip="{{ \'action.search\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>search</mat-icon>\n        </button>\n        <mat-form-field fxFlex>\n          <mat-label>&nbsp;</mat-label>\n          <input #searchInput matInput\n                 [(ngModel)]="pageLink.textSearch"\n                 placeholder="{{ \'common.enter-search\' | translate }}"/>\n        </mat-form-field>\n        <button mat-icon-button (click)="exitFilterMode()"\n                matTooltip="{{ \'action.close\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>close</mat-icon>\n        </button>\n      </div>\n    </mat-toolbar>\n    <mat-toolbar class="mat-table-toolbar" color="primary" [fxShow]="mode === \'default\' && !dataSource.selection.isEmpty()">\n      <div class="mat-toolbar-tools" fxLayout.xs="row wrap">\n        <span class="tb-entity-table-info">\n          {{ (attributeScope === latestTelemetryTypes.LATEST_TELEMETRY ?\n                \'attribute.selected-telemetry\' : \'attribute.selected-attributes\') | translate:{count: dataSource.selection.selected.length} }}\n        </span>\n        <span fxFlex></span>\n        <button [fxShow]="!isClientSideTelemetryTypeMap.get(attributeScope)"\n                class="button-widget-action"\n                mat-icon-button [disabled]="isLoading$ | async"\n                matTooltip="{{ \'action.delete\' | translate }}"\n                matTooltipPosition="above"\n                (click)="deleteAttributes($event)">\n          <mat-icon>delete</mat-icon>\n        </button>\n        <button mat-raised-button color="accent"\n                class="button-widget-action"\n                [disabled]="isLoading$ | async"\n                matTooltip="{{ \'attribute.show-on-widget\' | translate }}"\n                matTooltipPosition="above"\n                (click)="enterWidgetMode()">\n          <mat-icon>now_widgets</mat-icon>\n          <span translate>attribute.show-on-widget</span>\n        </button>\n      </div>\n    </mat-toolbar>\n    <mat-toolbar class="mat-table-toolbar" color="primary" [fxShow]="mode === \'widget\'">\n      <div class="mat-toolbar-tools" fxLayoutGap="8px" fxLayout.xs="row wrap">\n        <div fxFlex fxLayout="row" fxLayoutAlign="start">\n          <span class="tb-details-subtitle">{{ \'widgets-bundle.current\' | translate }}</span>\n          <tb-widgets-bundle-select fxFlexOffset="5"\n                                    fxFlex\n                                    [selectFirstBundle]="false"\n                                    [selectBundleAlias]="selectedWidgetsBundleAlias"\n                                    [(ngModel)]="widgetsBundle"\n                                    (ngModelChange)="onWidgetsBundleChanged()">\n          </tb-widgets-bundle-select>\n        </div>\n        <button mat-raised-button [fxShow]="widgetsList.length > 0"\n                color="accent"\n                class="button-widget-action"\n                [disabled]="isLoading$ | async"\n                matTooltip="{{ \'attribute.add-to-dashboard\' | translate }}"\n                matTooltipPosition="above"\n                (click)="addWidgetToDashboard()">\n          <mat-icon>dashboard</mat-icon>\n          <span translate>attribute.add-to-dashboard</span>\n        </button>\n        <button mat-icon-button\n                [disabled]="isLoading$ | async"\n                matTooltip="{{ \'action.close\' | translate }}"\n                matTooltipPosition="above"\n                (click)="exitWidgetMode()">\n          <mat-icon>close</mat-icon>\n        </button>\n      </div>\n    </mat-toolbar>\n    <div fxFlex class="table-container" [fxShow]="mode !== \'widget\'">\n      <table mat-table [dataSource]="dataSource"\n                 matSort [matSortActive]="pageLink.sortOrder.property" [matSortDirection]="pageLink.sortDirection()" matSortDisableClear>\n        <ng-container matColumnDef="select" sticky>\n          <mat-header-cell *matHeaderCellDef style="width: 30px;">\n            <mat-checkbox (change)="$event ? dataSource.masterToggle() : null"\n                          [checked]="dataSource.selection.hasValue() && (dataSource.isAllSelected() | async)"\n                          [indeterminate]="dataSource.selection.hasValue() && !(dataSource.isAllSelected() | async)">\n            </mat-checkbox>\n          </mat-header-cell>\n          <mat-cell *matCellDef="let attribute">\n            <mat-checkbox (click)="$event.stopPropagation()"\n                          (change)="$event ? dataSource.selection.toggle(attribute) : null"\n                          [checked]="dataSource.selection.isSelected(attribute)">\n            </mat-checkbox>\n          </mat-cell>\n        </ng-container>\n        <ng-container matColumnDef="lastUpdateTs">\n          <mat-header-cell *matHeaderCellDef mat-sort-header style="min-width: 150px; max-width: 150px; width: 150px;"> {{ \'attribute.last-update-time\' | translate }} </mat-header-cell>\n          <mat-cell *matCellDef="let attribute">\n            {{ attribute.lastUpdateTs | date:\'yyyy-MM-dd HH:mm:ss\' }}\n          </mat-cell>\n        </ng-container>\n        <ng-container matColumnDef="key">\n          <mat-header-cell *matHeaderCellDef mat-sort-header style="width: 40%"> {{ \'attribute.key\' | translate }} </mat-header-cell>\n          <mat-cell *matCellDef="let attribute">\n            {{ attribute.key }}\n          </mat-cell>\n        </ng-container>\n        <ng-container matColumnDef="value">\n          <mat-header-cell *matHeaderCellDef style="width: 60%"> {{ \'attribute.value\' | translate }} </mat-header-cell>\n          <mat-cell *matCellDef="let attribute"\n                    class="tb-value-cell"\n                    (click)="editAttribute($event, attribute)">\n            <div fxLayout="row" style="align-items: center">\n              <span fxFlex>{{attribute.value | tbJson}}</span>\n              <span [fxShow]="!isClientSideTelemetryTypeMap.get(attributeScope)">\n                <mat-icon>edit</mat-icon>\n              </span>\n            </div>\n          </mat-cell>\n        </ng-container>\n        <mat-header-row [ngClass]="{\'mat-row-select\': true}" *matHeaderRowDef="displayedColumns; sticky: true"></mat-header-row>\n        <mat-row [ngClass]="{\'mat-row-select\': true,\n                             \'mat-selected\': dataSource.selection.isSelected(attribute)}"\n                 *matRowDef="let attribute; columns: displayedColumns;" (click)="dataSource.selection.toggle(attribute)"></mat-row>\n      </table>\n      <span [fxShow]="dataSource.isEmpty() | async"\n            fxLayoutAlign="center center"\n            class="no-data-found" translate>{{\n          attributeScope === latestTelemetryTypes.LATEST_TELEMETRY\n              ? \'attribute.no-telemetry-text\'\n              : \'attribute.no-attributes-text\'\n        }}</span>\n    </div>\n    <mat-divider [fxShow]="mode !== \'widget\'"></mat-divider>\n    <mat-paginator [fxShow]="mode !== \'widget\'"\n                   [length]="dataSource.total() | async"\n                   [pageIndex]="pageLink.page"\n                   [pageSize]="pageLink.pageSize"\n                   [pageSizeOptions]="[10, 20, 30]"></mat-paginator>\n    <ngx-hm-carousel fxFlex *ngIf="mode === \'widget\' && widgetsList.length > 0"\n                     #carousel\n                     [(ngModel)]="widgetsCarouselIndex"\n                     (ngModelChange)="onWidgetsCarouselIndexChanged()"\n                     [data]="widgetsList"\n                     [infinite]="false"\n                     class="carousel c-accent">\n      <section ngx-hm-carousel-container class="content">\n        <article class="item cursor-pointer"\n                 ngx-hm-carousel-item\n                 *ngFor="let widgets of widgetsList">\n          <tb-dashboard class="tb-absolute-fill"\n            [aliasController]="aliasController"\n            [widgets]="widgets"\n            [columns]="20"\n            [isEdit]="false"\n            [isMobileDisabled]="true"\n            [isEditActionEnabled]="false"\n            [isRemoveActionEnabled]="false">\n          </tb-dashboard>\n        </article>\n      </section>\n\n      <ng-template #carouselPrev>\n        <button mat-icon-button\n                *ngIf="widgetsCarouselIndex > 0"\n                matTooltip="{{ \'attribute.prev-widget\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>keyboard_arrow_left</mat-icon>\n        </button>\n      </ng-template>\n      <ng-template #carouselNext>\n        <button mat-icon-button\n                *ngIf="widgetsCarouselIndex < widgetsList.length - 1"\n                matTooltip="{{ \'attribute.next-widget\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>keyboard_arrow_right</mat-icon>\n        </button>\n      </ng-template>\n\n      <ng-template #carouselDot let-model>\n        <div class="ball"\n             [class.visible]="model.index === model.currentIndex"></div>\n      </ng-template>\n\n    </ngx-hm-carousel>\n    <span translate *ngIf="mode === \'widget\' && widgetsLoaded &&\n                           widgetsList.length === 0 &&\n                           widgetsBundle"\n          fxFlex fxLayoutAlign="center center"\n          style="text-transform: uppercase; display: flex;"\n          class="mat-headline">widgets-bundle.empty</span>\n    <span translate *ngIf="mode === \'widget\' && !widgetsBundle"\n          fxFlex fxLayoutAlign="center center"\n          style="text-transform: uppercase; display: flex;"\n          class="mat-headline">widget.select-widgets-bundle</span>\n  </div>\n</div>\n'},"ab/a":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<table class="tb-legend" [ngClass]="isRowDirection ? \'tb-legend-row\' : \'tb-legend-column\'"\n       [ngStyle]="{ marginRight: isRowDirection && !displayHeader ? \'auto\' : \'20px\' }">\n  <thead>\n  <tr class="tb-legend-header" *ngIf="!isRowDirection">\n    <th colspan="2"></th>\n    <th *ngIf="legendConfig.showMin === true">{{ \'legend.min\' | translate }}</th>\n    <th *ngIf="legendConfig.showMax === true">{{ \'legend.max\' | translate }}</th>\n    <th *ngIf="legendConfig.showAvg === true">{{ \'legend.avg\' | translate }}</th>\n    <th *ngIf="legendConfig.showTotal === true">{{ \'legend.total\' | translate }}</th>\n  </tr>\n  </thead>\n  <tbody>\n    <ng-container *ngIf="!isRowDirection">\n      <tr class="tb-legend-keys" *ngFor="let legendKey of legendKeys()">\n        <td><span class="tb-legend-line" [ngStyle]="{backgroundColor: legendKey.dataKey.color}"></span></td>\n        <td class="tb-legend-label"\n            (click)="toggleHideData(legendKey.dataIndex)"\n            [ngClass]="{ \'tb-hidden-label\': legendData.keys[legendKey.dataIndex].dataKey.hidden, \'tb-horizontal\': isHorizontal }">\n          {{ legendKey.dataKey.label }}\n        </td>\n        <td class="tb-legend-value" *ngIf="legendConfig.showMin === true">{{ legendData.data[legendKey.dataIndex].min }}</td>\n        <td class="tb-legend-value" *ngIf="legendConfig.showMax === true">{{ legendData.data[legendKey.dataIndex].max }}</td>\n        <td class="tb-legend-value" *ngIf="legendConfig.showAvg === true">{{ legendData.data[legendKey.dataIndex].avg }}</td>\n        <td class="tb-legend-value" *ngIf="legendConfig.showTotal === true">{{ legendData.data[legendKey.dataIndex].total }}</td>\n      </tr>\n    </ng-container>\n    <tr *ngIf="isRowDirection" class="tb-legend-keys" [ngClass]="{ \'tb-row-direction\': !displayHeader }">\n      <td></td>\n      <td *ngFor="let legendKey of legendKeys()">\n        <span class="tb-legend-line" [ngStyle]="{backgroundColor: legendKey.dataKey.color}"></span>\n        <span class="tb-legend-label"\n              (click)="toggleHideData(legendKey.dataIndex)"\n              [ngClass]="{ \'tb-hidden-label\': legendData.keys[legendKey.dataIndex].dataKey.hidden}">\n                  {{ legendKey.dataKey.label }}\n        </span>\n      </td>\n    </tr>\n    <tr class="tb-legend-keys" *ngIf="isRowDirection && legendConfig.showMin === true">\n      <td class="tb-legend-type">{{ \'legend.min\' | translate }}</td>\n      <td class="tb-legend-value" *ngFor="let legendKey of legendKeys()">\n        {{ legendData.data[legendKey.dataIndex].min }}\n      </td>\n    </tr>\n    <tr class="tb-legend-keys" *ngIf="isRowDirection && legendConfig.showMax === true">\n      <td class="tb-legend-type">{{ \'legend.max\' | translate }}</td>\n      <td class="tb-legend-value" *ngFor="let legendKey of legendKeys()">\n        {{ legendData.data[legendKey.dataIndex].max }}\n      </td>\n    </tr>\n    <tr class="tb-legend-keys" *ngIf="isRowDirection && legendConfig.showAvg === true">\n      <td class="tb-legend-type">{{ \'legend.avg\' | translate }}</td>\n      <td class="tb-legend-value" *ngFor="let legendKey of legendKeys()">\n        {{ legendData.data[legendKey.dataIndex].avg }}\n      </td>\n    </tr>\n    <tr class="tb-legend-keys" *ngIf="isRowDirection && legendConfig.showTotal === true">\n      <td class="tb-legend-type">{{ \'legend.total\' | translate }}</td>\n      <td class="tb-legend-value" *ngFor="let legendKey of legendKeys()">\n        {{ legendData.data[legendKey.dataIndex].total }}\n      </td>\n    </tr>\n  </tbody>\n</table>\n'},abO1:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .tb-round-switch {\n  width: 100%;\n  height: 100%;\n}\n:host .tb-round-switch .title-container .switch-title {\n  font-weight: 500;\n  color: #757575;\n  white-space: nowrap;\n}\n:host .tb-round-switch .error-container {\n  position: absolute;\n  top: 1%;\n  right: 0;\n  left: 0;\n  z-index: 4;\n  height: 14px;\n}\n:host .tb-round-switch .error-container .switch-error {\n  color: #ff3315;\n  white-space: nowrap;\n}\n:host .tb-round-switch #text-measure {\n  position: absolute;\n  width: auto;\n  height: auto;\n  white-space: nowrap;\n  visibility: hidden;\n}\n:host .tb-round-switch #switch-container {\n  padding: 10px;\n}\n:host .tb-round-switch #switch-container .switch {\n  position: relative;\n  box-sizing: border-box;\n  width: 260px;\n  min-width: 260px;\n  height: 260px;\n  min-height: 260px;\n  padding: 25px;\n  font-family: sans-serif;\n  font-size: 48px;\n  color: #424242;\n  cursor: pointer;\n  background: #ddd;\n  background: linear-gradient(180deg, #bbb, #ddd);\n  border-radius: 130px;\n  box-shadow: 0 0 0 8px rgba(0, 0, 0, 0.1), 0 0 3px 1px rgba(0, 0, 0, 0.1), inset 0 8px 3px -8px rgba(255, 255, 255, 0.4);\n}\n:host .tb-round-switch #switch-container .switch input {\n  display: none;\n}\n:host .tb-round-switch #switch-container .switch .on,\n:host .tb-round-switch #switch-container .switch .off {\n  position: absolute;\n  width: 100%;\n  text-align: center;\n  text-shadow: 1px 1px 4px #4a4a4a;\n}\n:host .tb-round-switch #switch-container .switch .on {\n  top: 10px;\n  font-family: sans-serif;\n  color: #444;\n  transition: all 0.1s;\n}\n:host .tb-round-switch #switch-container .switch .off {\n  bottom: 5px;\n  transition: all 0.1s;\n  transform: scaleY(0.85);\n}\n:host .tb-round-switch #switch-container .switch .but {\n  position: relative;\n  display: block;\n  width: 200px;\n  height: 178px;\n  font-size: 48px;\n  cursor: pointer;\n  background-color: #d8d8d8;\n  border-bottom-width: 0;\n  border-radius: 400px 400px 400px 400px/400px 400px 300px 300px;\n  box-shadow: inset 8px 6px 5px -7px #a2a2a2, inset -8px 6px 5px -7px #a2a2a2, inset 0 -3px 2px -2px rgba(200, 200, 200, 0.5), 0 3px 3px -2px #fff, inset 0 -230px 60px -200px rgba(255, 255, 255, 0.2), inset 0 220px 40px -200px rgba(0, 0, 0, 0.3);\n  transition: all 0.2s;\n}\n:host .tb-round-switch #switch-container .switch .back {\n  box-sizing: border-box;\n  width: 210px;\n  height: 210px;\n  padding: 4px 4px;\n  cursor: pointer;\n  background-color: #888787;\n  background-image: linear-gradient(-90deg, transparent 30%, transparent 70%), linear-gradient(0deg, rgba(150, 150, 150, 0) 30%, rgba(150, 150, 150, 0.2) 50%, rgba(150, 150, 150, 0) 70%);\n  border-radius: 105px;\n  box-shadow: 30px 30px 30px -20px rgba(58, 58, 58, 0.3), -30px 30px 30px -20px rgba(58, 58, 58, 0.3), 0 30px 30px 0 rgba(16, 16, 16, 0.3), inset 0 -1px 0 0 #484848;\n  transition: all 0.2s;\n}\n:host .tb-round-switch #switch-container .switch input:checked + .back .on,\n:host .tb-round-switch #switch-container .switch input:checked + .back .off {\n  text-shadow: 1px 1px 4px #4a4a4a;\n}\n:host .tb-round-switch #switch-container .switch input:checked + .back .on {\n  top: 10px;\n  color: #4c4c4c;\n  transform: scaleY(0.85);\n}\n:host .tb-round-switch #switch-container .switch input:checked + .back .off {\n  bottom: 5px;\n  color: #444;\n  transform: scaleY(1);\n}\n:host .tb-round-switch #switch-container .switch input:checked + .back .but {\n  margin-top: 20px;\n  background: #dcdcdc radial-gradient(circle closest-corner at 50% 15%, rgba(0, 0, 0, 0.3), transparent);\n  border-radius: 400px 400px 400px 400px/300px 300px 400px 400px;\n  box-shadow: inset 8px -4px 5px -7px #a9a9a9, inset -8px -4px 5px -7px #808080, 0 -3px 8px -4px rgba(50, 50, 50, 0.4), inset 0 3px 4px -2px #9c9c9c, inset 0 280px 40px -200px rgba(0, 0, 0, 0.2), inset 0 -200px 40px -200px rgba(180, 180, 180, 0.2);\n}\n:host .tb-round-switch #switch-container .switch input:checked + .back {\n  padding: 2px 4px;\n  background-image: linear-gradient(0deg, #868686 30%, transparent 70%), linear-gradient(90deg, rgba(115, 115, 115, 0) 0%, rgba(255, 255, 255, 0.74) 50%, rgba(105, 105, 105, 0) 100%);\n  box-shadow: 30px 30px 30px -20px rgba(49, 49, 49, 0.1), -30px 30px 30px -20px rgba(111, 111, 111, 0.1), 0 30px 30px 0 rgba(0, 0, 0, 0.2), inset 0 1px 2px 0 rgba(167, 167, 167, 0.6);\n}'},bAp8:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .tb-table-widget .mat-table, :host .tb-table-widget .mat-paginator, :host .tb-table-widget mat-toolbar.mat-table-toolbar:not([color=primary]) {\n  background: transparent;\n}\n:host .tb-table-widget mat-toolbar {\n  height: 39px;\n  max-height: 39px;\n}\n:host .tb-table-widget mat-toolbar .mat-toolbar-tools {\n  height: 39px;\n  max-height: 39px;\n}\n:host .tb-table-widget .table-container {\n  overflow: auto;\n}\n:host .tb-table-widget .mat-row:not(.mat-row-select) mat-cell:nth-child(n+2):nth-last-child(n+2), :host .tb-table-widget .mat-row:not(.mat-row-select) mat-footer-cell:nth-child(n+2):nth-last-child(n+2), :host .tb-table-widget .mat-row:not(.mat-row-select) mat-header-cell:nth-child(n+2):nth-last-child(n+2), :host .tb-table-widget .mat-header-row:not(.mat-row-select) mat-cell:nth-child(n+2):nth-last-child(n+2), :host .tb-table-widget .mat-header-row:not(.mat-row-select) mat-footer-cell:nth-child(n+2):nth-last-child(n+2), :host .tb-table-widget .mat-header-row:not(.mat-row-select) mat-header-cell:nth-child(n+2):nth-last-child(n+2) {\n  padding: 0 5px;\n}\n:host .tb-table-widget .mat-row.mat-row-select mat-cell:nth-child(2), :host .tb-table-widget .mat-row.mat-row-select mat-footer-cell:nth-child(2), :host .tb-table-widget .mat-row.mat-row-select mat-header-cell:nth-child(2), :host .tb-table-widget .mat-header-row.mat-row-select mat-cell:nth-child(2), :host .tb-table-widget .mat-header-row.mat-row-select mat-footer-cell:nth-child(2), :host .tb-table-widget .mat-header-row.mat-row-select mat-header-cell:nth-child(2) {\n  padding: 0 5px;\n}\n:host .tb-table-widget .mat-row.mat-row-select mat-cell:nth-child(n+3):nth-last-child(n+2), :host .tb-table-widget .mat-row.mat-row-select mat-footer-cell:nth-child(n+3):nth-last-child(n+2), :host .tb-table-widget .mat-row.mat-row-select mat-header-cell:nth-child(n+3):nth-last-child(n+2), :host .tb-table-widget .mat-header-row.mat-row-select mat-cell:nth-child(n+3):nth-last-child(n+2), :host .tb-table-widget .mat-header-row.mat-row-select mat-footer-cell:nth-child(n+3):nth-last-child(n+2), :host .tb-table-widget .mat-header-row.mat-row-select mat-header-cell:nth-child(n+3):nth-last-child(n+2) {\n  padding: 0 5px;\n}\n:host-context(.tb-has-timewindow) .tb-table-widget mat-toolbar {\n  height: 65px;\n  max-height: 65px;\n}\n:host-context(.tb-has-timewindow) .tb-table-widget mat-toolbar .mat-toolbar-tools {\n  height: 65px;\n  max-height: 65px;\n}'},bE8y:function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var i=n("mrSG"),a=n("TYT/"),o=n("MqYC"),r=n("ea4N"),s=n("6onV"),l=n("QJY3"),c=n("DUip"),d=n("gmuX"),u=n("0lYY"),h=n("//Q6"),p=function(t){function e(e,n,i,a,o,r){var s=t.call(this,e,n,o)||this;s.store=e,s.router=n,s.data=i,s.errorStateMatcher=a,s.dialogRef=o,s.fb=r,s.submitted=!1,s.dashboard=s.data.dashboard,s.aliasController=s.data.aliasController,s.widget=s.data.widget;var l,c,d=s.data.widgetInfo,u=d.typeSettingsSchema||d.settingsSchema,p=d.typeDataKeySettingsSchema||d.dataKeySettingsSchema,m=d.typeParameters,g=d.actionSources,f=!Object(h.k)(d.typeParameters)||!d.typeParameters.useCustomDatasources;l=u&&""!==u?Object(h.t)(u)?JSON.parse(u):u:{},c=p&&""!==p?Object(h.t)(p)?JSON.parse(p):p:{};var b={config:s.widget.config,layout:{},widgetType:s.widget.type,typeParameters:m,actionSources:g,isDataEnabled:f,settingsSchema:l,dataKeySettingsSchema:c};return s.widgetFormGroup=s.fb.group({widgetConfig:[b,[]]}),s}var d;return Object(i.d)(e,t),d=e,e.prototype.ngOnInit=function(){},e.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=!!(t&&t.invalid&&this.submitted);return n||i},e.prototype.helpLinkIdForWidgetType=function(){var t="widgetsConfig";return this.widget&&this.widget.type&&(t=u.l.get(this.widget.type).configHelpLinkId),t},e.prototype.cancel=function(){this.dialogRef.close(null)},e.prototype.add=function(){this.submitted=!0;var t=this.widgetFormGroup.get("widgetConfig").value;this.widget.config=t.config,this.widget.config.mobileOrder=t.layout.mobileOrder,this.widget.config.mobileHeight=t.layout.mobileHeight,this.dialogRef.close(this.widget)},e.ctorParameters=function(){return[{type:s.Store},{type:c.Router},{type:void 0,decorators:[{type:a.Inject,args:[r.MAT_DIALOG_DATA]}]},{type:o.d,decorators:[{type:a.SkipSelf}]},{type:r.MatDialogRef},{type:l.FormBuilder}]},e=d=Object(i.c)([Object(a.Component)({selector:"tb-add-widget-dialog",template:Object(i.f)(n("lKcD")).default,providers:[{provide:o.d,useExisting:d}]}),Object(i.h)(2,Object(a.Inject)(r.MAT_DIALOG_DATA)),Object(i.h)(3,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[s.Store,c.Router,Object,o.d,r.MatDialogRef,l.FormBuilder])],e)}(d.a)},bHFI:function(t,e,n){"use strict";n.d(e,"d",(function(){return a})),n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return r})),n.d(e,"e",(function(){return s})),n.d(e,"a",(function(){return l}));var i=n("mrSG");function a(){return{schema:{type:"object",properties:{},required:[]},form:[],groupInfoes:[]}}function o(t,e){var n;t.groupInfoes.push({formIndex:(null===(n=t.groupInfoes)||void 0===n?void 0:n.length)||0,GroupTitle:e})}function r(t,e){Object.assign(t.schema.properties,e.schema.properties),t.schema.required=t.schema.required.concat(e.schema.required),t.form.push(e.form)}function s(t){return t.reduce((function(t,e){return{schema:{properties:Object(i.a)(Object(i.a)({},t.schema.properties),e.schema.properties),required:Object(i.l)(t.schema.required,e.schema.required)},form:Object(i.l)(t.form,e.form)}}),{schema:{type:"object",properties:{},required:[]},form:[],groupInfoes:[]})}function l(t,e,n){return void 0===n&&(n=[]),t.form=t.form.map((function(t){if(!n.includes(t)&&!n.includes(t.key)){if("string"==typeof t)return{key:t,condition:e};"object"==typeof t&&(t.condition?t.condition+=" && "+e:t.condition=e)}return t})),t}},c69d:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host ::ng-deep tb-entities-table .mat-drawer-container {\n  background-color: white;\n}'},c6cM:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var i=n("0lYY"),a=n("aX2P"),o=n("S5bw"),r=n("XlPw"),s=n("U3y+"),l=n("UZbx"),c=n("//Q6"),d=n("3Tyt"),u=n("6OOC"),h=n("wd/R"),p=h,m=function(){function t(t,e){var n=this;this.options=e,this.cafs={},this.hasResolvedData=!1;var a=new o.a;this.init$=a.asObservable(),this.ctx=t,this.type=e.type,this.id=this.ctx.utils.guid(),this.callbacks=e.callbacks,this.type===i.k.rpc?(this.callbacks.rpcStateChanged=this.callbacks.rpcStateChanged||function(){},this.callbacks.onRpcSuccess=this.callbacks.onRpcSuccess||function(){},this.callbacks.onRpcFailed=this.callbacks.onRpcFailed||function(){},this.callbacks.onRpcErrorCleared=this.callbacks.onRpcErrorCleared||function(){},this.targetDeviceAliasIds=e.targetDeviceAliasIds,this.targetDeviceIds=e.targetDeviceIds,this.targetDeviceAliasId=null,this.targetDeviceId=null,this.rpcRejection=null,this.rpcErrorText=null,this.rpcEnabled=!1,this.executingRpcRequest=!1,this.executingSubjects=[],this.initRpc().subscribe((function(){a.next(n),a.complete()}))):this.type===i.k.alarm?(this.callbacks.onDataUpdated=this.callbacks.onDataUpdated||function(){},this.callbacks.onDataUpdateError=this.callbacks.onDataUpdateError||function(){},this.callbacks.dataLoading=this.callbacks.dataLoading||function(){},this.callbacks.timeWindowUpdated=this.callbacks.timeWindowUpdated||function(){},this.alarmSource=e.alarmSource,this.alarmSearchStatusValue=Object(c.k)(e.alarmSearchStatus)?e.alarmSearchStatus:l.b.ANY,this.alarmsPollingInterval=Object(c.k)(e.alarmsPollingInterval)?e.alarmsPollingInterval:5e3,this.alarmsMaxCountLoad=Object(c.k)(e.alarmsMaxCountLoad)?e.alarmsMaxCountLoad:0,this.alarmsFetchSize=Object(c.k)(e.alarmsFetchSize)?e.alarmsFetchSize:100,this.alarmSourceListener=null,this.alarms=[],this.originalTimewindow=null,this.timeWindow={},this.useDashboardTimewindow=e.useDashboardTimewindow,this.useDashboardTimewindow?this.timeWindowConfig=Object(c.d)(e.dashboardTimewindow):this.timeWindowConfig=Object(c.d)(e.timeWindowConfig),this.subscriptionTimewindow=null,this.loadingData=!1,this.displayLegend=!1,this.initAlarmSubscription().subscribe((function(){a.next(n),a.complete()}),(function(){a.error(null)}))):(this.callbacks.onDataUpdated=this.callbacks.onDataUpdated||function(){},this.callbacks.onDataUpdateError=this.callbacks.onDataUpdateError||function(){},this.callbacks.dataLoading=this.callbacks.dataLoading||function(){},this.callbacks.legendDataUpdated=this.callbacks.legendDataUpdated||function(){},this.callbacks.timeWindowUpdated=this.callbacks.timeWindowUpdated||function(){},this.datasources=this.ctx.utils.validateDatasources(e.datasources),this.datasourceListeners=[],this.data=[],this.hiddenData=[],this.originalTimewindow=null,this.timeWindow={},this.useDashboardTimewindow=e.useDashboardTimewindow,this.stateData=e.stateData,this.useDashboardTimewindow?this.timeWindowConfig=Object(c.d)(e.dashboardTimewindow):this.timeWindowConfig=Object(c.d)(e.timeWindowConfig),this.subscriptionTimewindow=null,this.comparisonEnabled=e.comparisonEnabled,this.comparisonEnabled&&(this.timeForComparison=e.timeForComparison,this.comparisonTimeWindow={},this.timewindowForComparison=null),this.units=e.units||"",this.decimals=Object(c.k)(e.decimals)?e.decimals:2,this.loadingData=!1,e.legendConfig?(this.legendConfig=e.legendConfig,this.legendData={keys:[],data:[]},this.displayLegend=!0):this.displayLegend=!1,this.caulculateLegendData=this.displayLegend&&this.type===i.k.timeseries&&(!0===this.legendConfig.showMin||!0===this.legendConfig.showMax||!0===this.legendConfig.showAvg||!0===this.legendConfig.showTotal),this.initDataSubscription().subscribe((function(){a.next(n),a.complete()}),(function(t){a.error(t)})))}return Object.defineProperty(t.prototype,"alarmSearchStatus",{get:function(){return this.alarmSearchStatusValue},set:function(t){this.alarmSearchStatusValue!==t&&(this.alarmSearchStatusValue=t,this.onAlarmSearchStatusChanged())},enumerable:!0,configurable:!0}),t.prototype.initRpc=function(){var t=this,e=new o.a;return this.targetDeviceAliasIds&&this.targetDeviceAliasIds.length>0?(this.targetDeviceAliasId=this.targetDeviceAliasIds[0],this.ctx.aliasController.getAliasInfo(this.targetDeviceAliasId).subscribe((function(n){n.currentEntity&&n.currentEntity.entityType===s.b.DEVICE?(t.targetDeviceId=n.currentEntity.id,t.targetDeviceName=n.currentEntity.name,t.targetDeviceId?t.rpcEnabled=!0:t.rpcEnabled=!!t.ctx.utils.widgetEditMode,t.hasResolvedData=t.rpcEnabled,t.callbacks.rpcStateChanged(t),e.next(),e.complete()):(t.rpcEnabled=!1,t.callbacks.rpcStateChanged(t),e.next(),e.complete())}),(function(){t.rpcEnabled=!1,t.callbacks.rpcStateChanged(t),e.next(),e.complete()}))):(this.targetDeviceIds&&this.targetDeviceIds.length>0&&(this.targetDeviceId=this.targetDeviceIds[0]),this.targetDeviceId?this.rpcEnabled=!0:this.rpcEnabled=!!this.ctx.utils.widgetEditMode,this.hasResolvedData=!0,this.callbacks.rpcStateChanged(this),e.next(),e.complete()),e.asObservable()},t.prototype.initAlarmSubscription=function(){var t=this,e=new o.a(1);return this.loadStDiff().subscribe((function(){t.ctx.aliasController?t.ctx.aliasController.resolveAlarmSource(t.alarmSource).subscribe((function(n){t.alarmSource=n,n&&(t.hasResolvedData=!0),t.configureAlarmsData(),e.next(),e.complete()}),(function(t){e.error(t)})):(t.hasResolvedData=!0,t.configureAlarmsData(),e.next(),e.complete())})),e.asObservable()},t.prototype.configureAlarmsData=function(){},t.prototype.initDataSubscription=function(){var t=this,e=new o.a(1);return this.loadStDiff().subscribe((function(){t.ctx.aliasController?t.ctx.aliasController.resolveDatasources(t.datasources).subscribe((function(n){t.datasources=n,n&&n.length&&(t.hasResolvedData=!0),t.configureData(),e.next(),e.complete()}),(function(n){t.notifyDataLoaded(),e.error(n)})):(t.hasResolvedData=!0,t.configureData(),e.next(),e.complete())})),e.asObservable()},t.prototype.configureData=function(){var t=this,e=[],n=0,i=0;this.datasources.forEach((function(a){var o=[],r=0;if(a.dataKeys.forEach((function(e){if(e.hidden=!!e.settings.hideDataByDefault,e.inLegend=!e.settings.removeFromLegend,e.pattern=e.label,t.comparisonEnabled&&e.settings.comparisonSettings&&e.settings.comparisonSettings.showValuesForComparison){r++,i++;var s=t.ctx.utils.createAdditionalDataKey(e,a,t.timeForComparison,t.datasources,i);e.settings.comparisonSettings.color=s.color,o.push(s)}var l={datasource:a,dataKey:e,data:[]};if(e.type===d.c.entityField&&a.entity){var c=u.a[e.name]?u.a[e.name].value:e.name;a.entity[c]&&l.data.push([Date.now(),a.entity[c]])}if(t.data.push(l),t.hiddenData.push({data:[]}),t.displayLegend){var h={dataKey:e,dataIndex:n++};t.legendData.keys.push(h);t.legendData.data.push({min:null,max:null,avg:null,total:null,hidden:!1})}})),r>0){var s=Object(c.d)(a);s.dataKeys=o,s.isAdditional=!0,e.push(s)}})),e.forEach((function(e){e.dataKeys.forEach((function(i){var a={datasource:e,dataKey:i,data:[]};if(t.data.push(a),t.hiddenData.push({data:[]}),t.displayLegend){var o={dataKey:i,dataIndex:n++};t.legendData.keys.push(o);t.legendData.data.push({min:null,max:null,avg:null,total:null,hidden:!1})}}))})),this.datasources=this.datasources.concat(e),this.displayLegend&&(this.legendData.keys=this.legendData.keys.sort((function(t,e){return t.dataKey.label.localeCompare(e.dataKey.label)})))},t.prototype.resetData=function(){for(var t=0;t<this.data.length;t++)this.data[t].data=[],this.hiddenData[t].data=[],this.displayLegend&&(this.legendData.data[t].min=null,this.legendData.data[t].max=null,this.legendData.data[t].avg=null,this.legendData.data[t].total=null,this.legendData.data[t].hidden=!1);this.onDataUpdated()},t.prototype.getFirstEntityInfo=function(){var t,e,n;if(this.type===i.k.rpc)this.targetDeviceId&&(t={entityType:s.b.DEVICE,id:this.targetDeviceId},e=this.targetDeviceName);else if(this.type===i.k.alarm)this.alarmSource&&this.alarmSource.entityType&&this.alarmSource.entityId&&(t={entityType:this.alarmSource.entityType,id:this.alarmSource.entityId},e=this.alarmSource.entityName,n=this.alarmSource.entityLabel);else for(var a=0,o=this.datasources;a<o.length;a++){var r=o[a];if(r&&r.entityType&&r.entityId){t={entityType:r.entityType,id:r.entityId},e=r.entityName,n=r.entityLabel;break}}return t?{entityId:t,entityName:e,entityLabel:n}:null},t.prototype.onAliasesChanged=function(t){return this.type===i.k.rpc?this.checkRpcTarget(t):this.type===i.k.alarm?this.checkAlarmSource(t):this.checkSubscriptions(t)},t.prototype.onDataUpdated=function(t){var e=this;this.cafs.dataUpdated&&(this.cafs.dataUpdated(),this.cafs.dataUpdated=null),this.cafs.dataUpdated=this.ctx.raf.raf((function(){try{e.callbacks.onDataUpdated(e,t)}catch(n){e.callbacks.onDataUpdateError(e,n)}}))},t.prototype.onDashboardTimewindowChanged=function(t){this.type!==i.k.timeseries&&this.type!==i.k.alarm||this.useDashboardTimewindow&&!Object(c.n)(this.timeWindowConfig,t)&&t&&(this.timeWindowConfig=Object(c.d)(t),this.update())},t.prototype.onAlarmSearchStatusChanged=function(){this.type===i.k.alarm&&this.update()},t.prototype.updateDataVisibility=function(t){this.displayLegend&&(this.legendData.keys[t].dataKey.hidden?(this.hiddenData[t].data=this.data[t].data,this.data[t].data=[]):(this.data[t].data=this.hiddenData[t].data,this.hiddenData[t].data=[]),this.onDataUpdated())},t.prototype.updateTimewindowConfig=function(t){this.useDashboardTimewindow||(this.timeWindowConfig=t,this.update())},t.prototype.onResetTimewindow=function(){this.useDashboardTimewindow?this.ctx.dashboardTimewindowApi.onResetTimewindow():this.originalTimewindow&&(this.timeWindowConfig=Object(c.d)(this.originalTimewindow),this.originalTimewindow=null,this.callbacks.timeWindowUpdated(this,this.timeWindowConfig),this.update())},t.prototype.onUpdateTimewindow=function(t,e,n){this.useDashboardTimewindow?this.ctx.dashboardTimewindowApi.onUpdateTimewindow(t,e):(this.originalTimewindow||(this.originalTimewindow=Object(c.d)(this.timeWindowConfig)),this.timeWindowConfig=Object(a.r)(this.timeWindowConfig,t,e,n,this.ctx.timeService),this.callbacks.timeWindowUpdated(this,this.timeWindowConfig),this.update())},t.prototype.sendOneWayCommand=function(t,e,n){return this.sendCommand(!0,t,e,n)},t.prototype.sendTwoWayCommand=function(t,e,n){return this.sendCommand(!1,t,e,n)},t.prototype.clearRpcError=function(){this.rpcRejection=null,this.rpcErrorText=null,this.callbacks.onRpcErrorCleared(this)},t.prototype.sendCommand=function(t,e,n,i){var a=this;if(this.rpcEnabled){this.rpcRejection&&408!==this.rpcRejection.status&&(this.rpcRejection=null,this.rpcErrorText=null,this.callbacks.onRpcErrorCleared(this));var s={method:e,params:n};i&&i>0&&(s.timeout=i);var l=new o.a;return this.executingRpcRequest=!0,this.callbacks.rpcStateChanged(this),this.ctx.utils.widgetEditMode?setTimeout((function(){a.executingRpcRequest=!1,a.callbacks.rpcStateChanged(a),t?(l.next(),l.complete()):(l.next(s),l.complete())}),500):(this.executingSubjects.push(l),(t?this.ctx.deviceService.sendOneWayRpcCommand(this.targetDeviceId,s):this.ctx.deviceService.sendTwoWayRpcCommand(this.targetDeviceId,s)).subscribe((function(t){a.rpcRejection=null,a.rpcErrorText=null;var e=a.executingSubjects.indexOf(l);e>=0&&a.executingSubjects.splice(e,1),a.executingRpcRequest=a.executingSubjects.length>0,a.callbacks.onRpcSuccess(a),l.next(t),l.complete()}),(function(t){var e=a.executingSubjects.indexOf(l);if(e>=0&&a.executingSubjects.splice(e,1),a.executingRpcRequest=a.executingSubjects.length>0,a.callbacks.rpcStateChanged(a),!a.executingRpcRequest||408===t.status){if(a.rpcRejection=t,408===t.status)a.rpcErrorText="Request Timeout.";else if(409===t.status)a.rpcErrorText="Device is offline.";else{a.rpcErrorText="Error : "+t.status+" - "+t.statusText;var n=a.extractRejectionErrorText(t);n&&(a.rpcErrorText+="</br>",a.rpcErrorText+=n)}a.callbacks.onRpcFailed(a)}l.error(t)}))),l.asObservable()}return Object(r.a)(new Error("Rpc disabled!"))},t.prototype.extractRejectionErrorText=function(t){var e=null;if(t.error){e=t.error;try{e=t.error?JSON.parse(t.error):null}catch(n){}}return e&&!e.message?e=this.prepareMessageFromData(e):e&&e.message&&(e=e.message),e},t.prototype.prepareMessageFromData=function(t){if("object"!=typeof t||t.constructor!==ArrayBuffer)return t;var e=String.fromCharCode.apply(null,new Uint8Array(t));try{var n=JSON.parse(e);return n.message?n.message:e}catch(i){return e}},t.prototype.update=function(){this.unsubscribe(),this.subscribe()},t.prototype.subscribe=function(){var t=this;this.cafs.subscribe&&(this.cafs.subscribe(),this.cafs.subscribe=null),this.cafs.subscribe=this.ctx.raf.raf((function(){t.doSubscribe()}))},t.prototype.doSubscribe=function(){var t=this;if(this.type!==i.k.rpc)if(this.type===i.k.alarm)this.alarmsSubscribe();else{this.notifyDataLoading(),this.type===i.k.timeseries&&this.timeWindowConfig&&(this.updateRealtimeSubscription(),this.comparisonEnabled&&this.updateSubscriptionForComparison(),this.subscriptionTimewindow.fixedWindow&&this.onDataUpdated());var e=0,n=!this.datasources.length;this.datasources.forEach((function(a){var o={subscriptionType:t.type,subscriptionTimewindow:t.subscriptionTimewindow,datasource:a,entityType:a.entityType,entityId:a.entityId,dataUpdated:t.dataUpdated.bind(t),updateRealtimeSubscription:function(){return t.subscriptionTimewindow=t.updateRealtimeSubscription(),t.subscriptionTimewindow},setRealtimeSubscription:function(e){t.updateRealtimeSubscription(Object(c.d)(e))},datasourceIndex:e};t.comparisonEnabled&&a.isAdditional&&(o.subscriptionTimewindow=t.timewindowForComparison,o.updateRealtimeSubscription=function(){return t.subscriptionTimewindow=t.updateSubscriptionForComparison(),t.subscriptionTimewindow},o.setRealtimeSubscription=function(){t.updateSubscriptionForComparison()});for(var r=!1,s=0;s<a.dataKeys.length;s++)a.dataKeys[s].type!==d.c.entityField?t.data[e+s].data=[]:r=!0;e+=a.dataKeys.length,t.datasourceListeners.push(o),a.dataKeys.length&&t.ctx.datasourceService.subscribeToDatasource(o),(a.unresolvedStateEntity||r||!a.dataKeys.length||a.type===i.a.entity&&!a.entityId)&&(n=!0)})),n&&(this.notifyDataLoaded(),this.onDataUpdated())}},t.prototype.alarmsSubscribe=function(){var t=this;this.notifyDataLoading(),this.timeWindowConfig&&(this.updateRealtimeSubscription(),this.subscriptionTimewindow.fixedWindow&&this.onDataUpdated()),this.alarmSourceListener={subscriptionTimewindow:this.subscriptionTimewindow,alarmSource:this.alarmSource,alarmSearchStatus:this.alarmSearchStatus,alarmsPollingInterval:this.alarmsPollingInterval,alarmsMaxCountLoad:this.alarmsMaxCountLoad,alarmsFetchSize:this.alarmsFetchSize,alarmsUpdated:function(e){return t.alarmsUpdated(e)}},this.alarms=null,this.ctx.alarmService.subscribeForAlarms(this.alarmSourceListener);var e=!1;(this.alarmSource.unresolvedStateEntity||this.alarmSource.type===i.a.entity&&!this.alarmSource.entityId)&&(e=!0),e&&(this.notifyDataLoaded(),this.onDataUpdated())},t.prototype.unsubscribe=function(){var t=this;this.type!==i.k.rpc&&(this.type===i.k.alarm?this.alarmsUnsubscribe():(this.datasourceListeners.forEach((function(e){t.ctx.datasourceService.unsubscribeFromDatasource(e)})),this.datasourceListeners.length=0,this.resetData()))},t.prototype.alarmsUnsubscribe=function(){this.alarmSourceListener&&(this.ctx.alarmService.unsubscribeFromAlarms(this.alarmSourceListener),this.alarmSourceListener=null)},t.prototype.checkRpcTarget=function(t){return t.indexOf(this.targetDeviceAliasId)>-1},t.prototype.checkAlarmSource=function(t){return!(!this.options.alarmSource||!this.options.alarmSource.entityAliasId)&&t.indexOf(this.options.alarmSource.entityAliasId)>-1},t.prototype.checkSubscriptions=function(t){var e=!1,n=this.options.datasources;if(n)for(var i=0,a=n;i<a.length;i++){var o=a[i];if(o.entityAliasId&&t.indexOf(o.entityAliasId)>-1){e=!0;break}}return e},t.prototype.isDataResolved=function(){return this.hasResolvedData},t.prototype.destroy=function(){this.unsubscribe();for(var t=0,e=Object.keys(this.cafs);t<e.length;t++){var n=e[t];this.cafs[n]&&(this.cafs[n](),this.cafs[n]=null)}},t.prototype.notifyDataLoading=function(){this.loadingData=!0,this.callbacks.dataLoading(this)},t.prototype.notifyDataLoaded=function(){this.loadingData=!1,this.callbacks.dataLoading(this)},t.prototype.updateTimewindow=function(){this.timeWindow.interval=this.subscriptionTimewindow.aggregation.interval||1e3,this.subscriptionTimewindow.realtimeWindowMs?(this.timeWindow.maxTime=p().valueOf()+this.timeWindow.stDiff,this.timeWindow.minTime=this.timeWindow.maxTime-this.subscriptionTimewindow.realtimeWindowMs):this.subscriptionTimewindow.fixedWindow&&(this.timeWindow.maxTime=this.subscriptionTimewindow.fixedWindow.endTimeMs,this.timeWindow.minTime=this.subscriptionTimewindow.fixedWindow.startTimeMs)},t.prototype.updateRealtimeSubscription=function(t){return this.subscriptionTimewindow=t||Object(a.l)(this.timeWindowConfig,this.timeWindow.stDiff,this.stateData,this.ctx.timeService),this.updateTimewindow(),this.subscriptionTimewindow},t.prototype.updateComparisonTimewindow=function(){this.comparisonTimeWindow.interval=this.timewindowForComparison.aggregation.interval||1e3,this.timewindowForComparison.realtimeWindowMs?(this.comparisonTimeWindow.maxTime=p(this.timeWindow.maxTime).subtract(1,this.timeForComparison).valueOf(),this.comparisonTimeWindow.minTime=this.comparisonTimeWindow.maxTime-this.timewindowForComparison.realtimeWindowMs):this.timewindowForComparison.fixedWindow&&(this.comparisonTimeWindow.maxTime=this.timewindowForComparison.fixedWindow.endTimeMs,this.comparisonTimeWindow.minTime=this.timewindowForComparison.fixedWindow.startTimeMs)},t.prototype.updateSubscriptionForComparison=function(){return this.subscriptionTimewindow||(this.subscriptionTimewindow=this.updateRealtimeSubscription()),this.timewindowForComparison=Object(a.m)(this.subscriptionTimewindow,this.timeForComparison),this.updateComparisonTimewindow(),this.timewindowForComparison},t.prototype.dataUpdated=function(t,e,n,a){for(var o=0;o<this.datasourceListeners.length;o++)this.datasources[o].dataReceived=!0===this.datasources[o].dataReceived,this.datasourceListeners[o].datasourceIndex===e&&t.data.length>0&&(this.datasources[o].dataReceived=!0);this.notifyDataLoaded();var r,s=!0;if(r=this.displayLegend&&this.legendData.keys[e+n].dataKey.hidden?this.hiddenData[e+n]:this.data[e+n],this.type===i.k.latest){var l=r.data;if(t.data.length){if(l&&l[0]&&l[0].length>1&&t.data.length>0){var c=l[0][0],d=l[0][1];c===t.data[0][0]&&d===t.data[0][1]&&(s=!1)}}else s=!1}s&&(this.subscriptionTimewindow&&this.subscriptionTimewindow.realtimeWindowMs&&(this.updateTimewindow(),this.timewindowForComparison&&this.timewindowForComparison.realtimeWindowMs&&this.updateComparisonTimewindow()),r.data=t.data,this.caulculateLegendData&&this.updateLegend(e+n,t.data,a),this.onDataUpdated(a))},t.prototype.alarmsUpdated=function(t){this.notifyDataLoaded();var e=!this.alarms||!Object(c.n)(this.alarms,t);this.alarms=t,this.subscriptionTimewindow&&this.subscriptionTimewindow.realtimeWindowMs&&this.updateTimewindow(),e&&this.onDataUpdated()},t.prototype.updateLegend=function(t,e,n){var i=this.legendData.keys[t].dataKey,a=Object(c.k)(i.decimals)?i.decimals:this.decimals,o=i.units&&i.units.length?i.units:this.units,r=this.legendData.data[t];this.legendConfig.showMin&&(r.min=this.ctx.widgetUtils.formatValue(function(t){if(t.length>0){for(var e=Number(t[0][1]),n=1;n<t.length;n++)e=Math.min(e,Number(t[n][1]));return e}return null}(e),a,o)),this.legendConfig.showMax&&(r.max=this.ctx.widgetUtils.formatValue(function(t){if(t.length>0){for(var e=Number(t[0][1]),n=1;n<t.length;n++)e=Math.max(e,Number(t[n][1]));return e}return null}(e),a,o)),this.legendConfig.showAvg&&(r.avg=this.ctx.widgetUtils.formatValue(function(t){return t.length>0?g(t)/t.length:null}(e),a,o)),this.legendConfig.showTotal&&(r.total=this.ctx.widgetUtils.formatValue(g(e),a,o)),this.callbacks.legendDataUpdated(this,!1!==n)},t.prototype.loadStDiff=function(){var t=this,e=new o.a(1);return this.ctx.getServerTimeDiff&&this.timeWindow?this.ctx.getServerTimeDiff().subscribe((function(n){t.timeWindow.stDiff=n,e.next(),e.complete()}),(function(){t.timeWindow.stDiff=0,e.next(),e.complete()})):(this.timeWindow&&(this.timeWindow.stDiff=0),e.next(),e.complete()),e.asObservable()},t}();function g(t){if(t.length>0){var e=0;return t.forEach((function(t){e+=Number(t[1])})),e}return null}},cRoh:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<mat-form-field appearance="standard" [formGroup]="keysListFormGroup" class="mat-block">\n  <mat-chip-list #chipList formControlName="keys" tb-chip-draggable (chipDrop)="onChipDrop($event)">\n    <mat-chip\n      *ngFor="let key of keys; let $index = index"\n      [selectable]="!disabled"\n      [removable]="!disabled"\n      (removed)="remove(key)">\n      <div fxLayout="row" fxLayoutAlign="start center" class="tb-attribute-chip">\n        <div *ngIf="!disabled" class="tb-chip-drag-handle" style="margin-right: 5px;">\n          <mat-icon class="tb-mat-20">drag_handle</mat-icon>\n        </div>\n        <div class="tb-color-preview" (click)="showColorPicker(key)" style="margin-right: 5px;">\n          <div class="tb-color-result" [ngStyle]="{background: key.color}"></div>\n        </div>\n        <div class="tb-chip-labels">\n          <div class="tb-chip-label">\n            <span *ngIf="datasourceType !== datasourceTypes.function && widgetType !== widgetTypes.alarm">\n              <span *ngIf="key.type === dataKeyTypes.attribute"\n                    matTooltip="{{\'datakey.attributes\' | translate }}"\n                    matTooltipPosition="above">\n                  <mat-icon class="tb-mat-20"\n                            svgIcon="alpha-a-circle-outline"></mat-icon>\n              </span>\n              <span *ngIf="key.type === dataKeyTypes.entityField"\n                    matTooltip="{{\'datakey.entity-field\' | translate }}"\n                    matTooltipPosition="above">\n                  <mat-icon class="tb-mat-20"\n                            svgIcon="alpha-e-circle-outline"></mat-icon>\n              </span>\n              <span *ngIf="key.type === dataKeyTypes.timeseries"\n                    matTooltip="{{\'datakey.timeseries\' | translate }}"\n                    matTooltipPosition="above">\n                  <mat-icon class="tb-mat-20">timeline</mat-icon>\n              </span>\n            </span>\n            {{key.label}}\n          </div>\n          <div class="tb-chip-separator">: </div>\n          <div class="tb-chip-label">\n            <strong *ngIf="datasourceType !== datasourceTypes.function && key.postFuncBody; else simpleChipLabel">f({{key.name}})</strong>\n            <ng-template #simpleChipLabel>\n              <strong>{{key.name}}</strong>\n            </ng-template>\n          </div>\n        </div>\n        <button *ngIf="!disabled"\n                type="button"\n                (click)="editDataKey(key, $index)" mat-button mat-icon-button class="tb-mat-32">\n          <mat-icon class="tb-mat-20">edit</mat-icon>\n        </button>\n        <mat-icon matChipRemove *ngIf="!disabled">close</mat-icon>\n      </div>\n    </mat-chip>\n    <input matInput type="text" placeholder="{{ !disabled ? placeholder : \'\' }}"\n           style="max-width: 200px;"\n           #keyInput\n           formControlName="key"\n           matAutocompleteOrigin\n           #origin="matAutocompleteOrigin"\n           [matAutocompleteConnectedTo]="origin"\n           (focusin)="onFocus()"\n           [matAutocomplete]="keyAutocomplete"\n           [matChipInputFor]="chipList"\n           [matChipInputSeparatorKeyCodes]="separatorKeysCodes"\n           (matChipInputTokenEnd)="add($event)">\n  </mat-chip-list>\n  <mat-autocomplete #keyAutocomplete="matAutocomplete"\n                    class="tb-autocomplete"\n                    [displayWith]="displayKeyFn">\n    <mat-option *ngFor="let key of filteredKeys | async" [value]="key">\n      <span style="white-space: nowrap;">\n        <span *ngIf="datasourceType !== datasourceTypes.function && widgetType !== widgetTypes.alarm">\n          <span *ngIf="key.type === dataKeyTypes.attribute"\n                matTooltip="{{\'datakey.attributes\' | translate }}"\n                matTooltipPosition="above">\n              <mat-icon class="tb-mat-16"\n                        svgIcon="alpha-a-circle-outline"></mat-icon>\n          </span>\n          <span *ngIf="key.type === dataKeyTypes.entityField"\n                matTooltip="{{\'datakey.entity-field\' | translate }}"\n                matTooltipPosition="above">\n              <mat-icon class="tb-mat-16"\n                        svgIcon="alpha-e-circle-outline"></mat-icon>\n          </span>\n          <span *ngIf="key.type === dataKeyTypes.timeseries"\n                matTooltip="{{\'datakey.timeseries\' | translate }}"\n                matTooltipPosition="above">\n              <mat-icon class="tb-mat-16">timeline</mat-icon>\n          </span>\n        </span>\n        <span [innerHTML]="key.name | highlight:searchText"></span>\n      </span>\n    </mat-option>\n    <mat-option *ngIf="!(filteredKeys | async)?.length" [value]="null" class="tb-not-found">\n      <div class="tb-not-found-content" (click)="$event.stopPropagation()">\n        <div *ngIf="!textIsNotEmpty(searchText); else searchNotEmpty">\n          <span translate>entity.no-keys-found</span>\n        </div>\n        <ng-template #searchNotEmpty>\n          <span>\n            {{ translate.get(\'entity.no-key-matching\',\n              {key: truncate.transform(searchText, true, 6, &apos;...&apos;)}) | async }}\n          </span>\n          <span *ngIf="datasourceType === datasourceTypes.function || widgetType === widgetTypes.alarm; else createEntityKey">\n            <a translate (click)="createKey(searchText)">entity.create-new-key</a>\n          </span>\n          <ng-template #createEntityKey>\n            <span>{{\'entity.create-new-key\' | translate }}  </span>\n            <span *ngIf="widgetType == widgetTypes.latest"\n                  matTooltip="{{\'datakey.attributes\' | translate }}"\n                  matTooltipPosition="above">\n              <mat-icon (click)="createKey(searchText, dataKeyTypes.attribute)"\n                      class="tb-mat-16"\n                      svgIcon="alpha-a-circle-outline"></mat-icon>\n            </span>\n            <span *ngIf="widgetType == widgetTypes.latest"\n                  matTooltip="{{\'datakey.entity-field\' | translate }}"\n                  matTooltipPosition="above">\n              <mat-icon (click)="createKey(searchText, dataKeyTypes.entityField)"\n                        class="tb-mat-16"\n                        svgIcon="alpha-e-circle-outline"></mat-icon>\n            </span>\n            <span matTooltip="{{\'datakey.timeseries\' | translate }}"\n                  matTooltipPosition="above">\n              <mat-icon (click)="createKey(searchText, dataKeyTypes.timeseries)"\n                      class="tb-mat-16">timeline</mat-icon>\n            </span>\n          </ng-template>\n        </ng-template>\n      </div>\n    </mat-option>\n  </mat-autocomplete>\n  <mat-error *ngIf="keysListFormGroup.get(\'keys\').hasError(\'required\')">\n    {{ requiredText }}\n  </mat-error>\n</mat-form-field>\n<div class="mat-caption" style="color: rgba(0,0,0,0.57);" *ngIf="maxDataKeys !== null && maxDataKeys > -1">\n  {{ maxDataKeysText() }}\n</div>\n'},cX0b:function(t,e,n){"use strict";n.d(e,"a",(function(){return k}));var i=n("mrSG"),a=n("TYT/"),o=n("DUip"),r=n("qxrw"),s=n("o8Qb"),l=n("Valr"),c=n("U3y+"),d=n("F/XL"),u=n("VNr4"),h=n("6onV"),p=n("C/rb"),m=n("t9fZ"),g=n("xMyE"),f=n("psW0"),b=n("67Y/"),y=n("zp9Z"),v=n("ktVl"),w=n("ea4N"),x=n("S+vS"),S=n("tM37"),C=n("IktG"),T=n("YnEf"),O=n("p0+G"),_=n("HUB6"),L=n("p/3Z"),I=n("yOwA"),A=n("9HAa"),k=function(){function t(t,e,n,i,a,o,s,l,d){var u=this;this.store=t,this.dashboardService=e,this.customerService=n,this.dialogService=i,this.importExport=a,this.translate=o,this.datePipe=s,this.router=l,this.dialog=d,this.config=new r.d,this.config.entityType=c.b.DASHBOARD,this.config.entityComponent=O.a,this.config.entityTabsComponent=I.a,this.config.entityTranslations=c.d.get(c.b.DASHBOARD),this.config.entityResources=c.c.get(c.b.DASHBOARD),this.config.deleteEntityTitle=function(t){return u.translate.instant("dashboard.delete-dashboard-title",{dashboardTitle:t.title})},this.config.deleteEntityContent=function(){return u.translate.instant("dashboard.delete-dashboard-text")},this.config.deleteEntitiesTitle=function(t){return u.translate.instant("dashboard.delete-dashboards-title",{count:t})},this.config.deleteEntitiesContent=function(){return u.translate.instant("dashboard.delete-dashboards-text")},this.config.loadEntity=function(t){return u.dashboardService.getDashboard(t.id)},this.config.saveEntity=function(t){return u.dashboardService.saveDashboard(t)},this.config.onEntityAction=function(t){return u.onDashboardAction(t)},this.config.detailsReadonly=function(){return"customer_user"===u.config.componentsData.dashboardScope}}return t.prototype.resolve=function(t){var e=this,n=t.params;return this.config.componentsData={dashboardScope:t.data.dashboardsType,customerId:n.customerId},this.store.pipe(Object(h.select)(p.d),Object(m.a)(1)).pipe(Object(g.a)((function(t){t.authority===y.a.CUSTOMER_USER&&(e.config.componentsData.dashboardScope="customer_user",e.config.componentsData.customerId=t.customerId)})),Object(f.a)((function(){return e.config.componentsData.customerId?e.customerService.getCustomer(e.config.componentsData.customerId):Object(d.a)(null)})),Object(b.a)((function(t){return t?t.additionalInfo&&t.additionalInfo.isPublic?e.config.tableTitle=e.translate.instant("customer.public-dashboards"):e.config.tableTitle=t.title+": "+e.translate.instant("dashboard.dashboards"):e.config.tableTitle=e.translate.instant("dashboard.dashboards"),e.config.columns=e.configureColumns(e.config.componentsData.dashboardScope),e.configureEntityFunctions(e.config.componentsData.dashboardScope),e.config.cellActionDescriptors=e.configureCellActions(e.config.componentsData.dashboardScope),e.config.groupActionDescriptors=e.configureGroupActions(e.config.componentsData.dashboardScope),e.config.addActionDescriptors=e.configureAddActions(e.config.componentsData.dashboardScope),e.config.addEnabled="customer_user"!==e.config.componentsData.dashboardScope,e.config.entitiesDeleteEnabled="tenant"===e.config.componentsData.dashboardScope,e.config.deleteEnabled=function(){return"tenant"===e.config.componentsData.dashboardScope},e.config})))},t.prototype.configureColumns=function(t){var e=[new r.a("createdTime","common.created-time",this.datePipe,"150px"),new r.c("title","dashboard.title","50%")];return"tenant"===t&&e.push(new r.c("customersTitle","dashboard.assignedToCustomers","50%",(function(t){return Object(C.a)(t)}),(function(){return{}}),!1),new r.c("dashboardIsPublic","dashboard.public","60px",(function(t){return Object(r.e)(Object(C.c)(t))}),(function(){return{}}),!1)),e},t.prototype.configureEntityFunctions=function(t){var e=this;"tenant"===t?(this.config.entitiesFetchFunction=function(t){return e.dashboardService.getTenantDashboards(t)},this.config.deleteEntity=function(t){return e.dashboardService.deleteDashboard(t.id)}):(this.config.entitiesFetchFunction=function(t){return e.dashboardService.getCustomerDashboards(e.config.componentsData.customerId,t)},this.config.deleteEntity=function(t){return e.dashboardService.unassignDashboardFromCustomer(e.config.componentsData.customerId,t.id)})},t.prototype.configureCellActions=function(t){var e=this,n=[];return n.push({name:this.translate.instant("dashboard.open-dashboard"),icon:"dashboard",isEnabled:function(){return!0},onAction:function(t,n){return e.openDashboard(t,n)}}),"tenant"===t&&n.push({name:this.translate.instant("dashboard.export"),icon:"file_download",isEnabled:function(){return!0},onAction:function(t,n){return e.exportDashboard(t,n)}},{name:this.translate.instant("dashboard.make-public"),icon:"share",isEnabled:function(t){return!Object(C.c)(t)},onAction:function(t,n){return e.makePublic(t,n)}},{name:this.translate.instant("dashboard.make-private"),icon:"reply",isEnabled:function(t){return Object(C.c)(t)},onAction:function(t,n){return e.makePrivate(t,n)}},{name:this.translate.instant("dashboard.manage-assigned-customers"),icon:"assignment_ind",isEnabled:function(){return!0},onAction:function(t,n){return e.manageAssignedCustomers(t,n)}}),"customer"===t&&n.push({name:this.translate.instant("dashboard.export"),icon:"file_download",isEnabled:function(){return!0},onAction:function(t,n){return e.exportDashboard(t,n)}},{name:this.translate.instant("dashboard.make-private"),icon:"reply",isEnabled:function(t){return Object(C.b)(t,e.config.componentsData.customerId)},onAction:function(t,n){return e.makePrivate(t,n)}},{name:this.translate.instant("dashboard.unassign-from-customer"),icon:"assignment_return",isEnabled:function(t){return!Object(C.b)(t,e.config.componentsData.customerId)},onAction:function(t,n){return e.unassignFromCustomer(t,n,e.config.componentsData.customerId)}}),n},t.prototype.configureGroupActions=function(t){var e=this,n=[];return"tenant"===t&&(n.push({name:this.translate.instant("dashboard.assign-dashboards"),icon:"assignment_ind",isEnabled:!0,onAction:function(t,n){return e.assignDashboardsToCustomers(t,n.map((function(t){return t.id.id})))}}),n.push({name:this.translate.instant("dashboard.unassign-dashboards"),icon:"assignment_return",isEnabled:!0,onAction:function(t,n){return e.unassignDashboardsFromCustomers(t,n.map((function(t){return t.id.id})))}})),"customer"===t&&n.push({name:this.translate.instant("dashboard.unassign-dashboards"),icon:"assignment_return",isEnabled:!0,onAction:function(t,n){return e.unassignDashboardsFromCustomer(t,n.map((function(t){return t.id.id})),e.config.componentsData.customerId)}}),n},t.prototype.configureAddActions=function(t){var e=this,n=[];return"tenant"===t&&n.push({name:this.translate.instant("dashboard.create-new-dashboard"),icon:"insert_drive_file",isEnabled:function(){return!0},onAction:function(t){return e.config.table.addEntity(t)}},{name:this.translate.instant("dashboard.import"),icon:"file_upload",isEnabled:function(){return!0},onAction:function(t){return e.importDashboard(t)}}),"customer"===t&&n.push({name:this.translate.instant("dashboard.assign-new-dashboard"),icon:"add",isEnabled:function(){return!0},onAction:function(t){return e.addDashboardsToCustomer(t)}}),n},t.prototype.openDashboard=function(t,e){t&&t.stopPropagation(),"customer"===this.config.componentsData.dashboardScope?this.router.navigateByUrl("customers/"+this.config.componentsData.customerId+"/dashboards/"+e.id.id):this.router.navigateByUrl("dashboards/"+e.id.id)},t.prototype.importDashboard=function(t){var e=this;this.importExport.importDashboard().subscribe((function(t){t&&e.config.table.updateData()}))},t.prototype.exportDashboard=function(t,e){t&&t.stopPropagation(),this.importExport.exportDashboard(e.id.id)},t.prototype.addDashboardsToCustomer=function(t){var e=this;t&&t.stopPropagation(),this.dialog.open(S.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{customerId:this.config.componentsData.customerId,entityType:c.b.DASHBOARD}}).afterClosed().subscribe((function(t){t&&e.config.table.updateData()}))},t.prototype.makePublic=function(t,e){var n=this;t&&t.stopPropagation(),this.dashboardService.makeDashboardPublic(e.id.id).subscribe((function(t){n.dialog.open(L.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{dashboard:t}}).afterClosed().subscribe((function(){n.config.table.updateData()}))}))},t.prototype.makePrivate=function(t,e){var n=this;t&&t.stopPropagation(),this.dialogService.confirm(this.translate.instant("dashboard.make-private-dashboard-title",{dashboardTitle:e.title}),this.translate.instant("dashboard.make-private-dashboard-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe((function(t){t&&n.dashboardService.makeDashboardPrivate(e.id.id).subscribe((function(){n.config.table.updateData()}))}))},t.prototype.manageAssignedCustomers=function(t,e){var n=e.assignedCustomers?e.assignedCustomers.map((function(t){return t.customerId.id})):[];this.showManageAssignedCustomersDialog(t,[e.id.id],"manage",n)},t.prototype.assignDashboardsToCustomers=function(t,e){this.showManageAssignedCustomersDialog(t,e,"assign")},t.prototype.unassignDashboardsFromCustomers=function(t,e){this.showManageAssignedCustomersDialog(t,e,"unassign")},t.prototype.showManageAssignedCustomersDialog=function(t,e,n,i){var a=this;t&&t.stopPropagation(),this.dialog.open(_.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{dashboardIds:e,actionType:n,assignedCustomersIds:i}}).afterClosed().subscribe((function(t){t&&a.config.table.updateData()}))},t.prototype.unassignFromCustomer=function(t,e,n){var i=this;t&&t.stopPropagation(),this.dialogService.confirm(this.translate.instant("dashboard.unassign-dashboard-title",{dashboardTitle:e.title}),this.translate.instant("dashboard.unassign-dashboard-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe((function(t){t&&i.dashboardService.unassignDashboardFromCustomer(n,e.id.id).subscribe((function(){i.config.table.updateData()}))}))},t.prototype.unassignDashboardsFromCustomer=function(t,e,n){var i=this;t&&t.stopPropagation(),this.dialogService.confirm(this.translate.instant("dashboard.unassign-dashboards-title",{count:e.length}),this.translate.instant("dashboard.unassign-dashboards-text"),this.translate.instant("action.no"),this.translate.instant("action.yes"),!0).subscribe((function(t){if(t){var a=[];e.forEach((function(t){a.push(i.dashboardService.unassignDashboardFromCustomer(n,t))})),Object(u.a)(a).subscribe((function(){i.config.table.updateData()}))}}))},t.prototype.onDashboardAction=function(t){switch(t.action){case"open":return this.openDashboard(t.event,t.entity),!0;case"export":return this.exportDashboard(t.event,t.entity),!0;case"makePublic":return this.makePublic(t.event,t.entity),!0;case"makePrivate":return this.makePrivate(t.event,t.entity),!0;case"manageAssignedCustomers":return this.manageAssignedCustomers(t.event,t.entity),!0;case"unassignFromCustomer":return this.unassignFromCustomer(t.event,t.entity,this.config.componentsData.customerId),!0}return!1},t.ctorParameters=function(){return[{type:h.Store},{type:T.a},{type:v.a},{type:x.a},{type:A.a},{type:s.TranslateService},{type:l.DatePipe},{type:o.Router},{type:w.MatDialog}]},t=Object(i.c)([Object(a.Injectable)(),Object(i.g)("design:paramtypes",[h.Store,T.a,v.a,x.a,A.a,s.TranslateService,l.DatePipe,o.Router,w.MatDialog])],t)}()},cxmq:function(t,e,n){!function(t){"use strict";var e=L.MarkerClusterGroup=L.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,clusterPane:L.Marker.prototype.options.pane,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(t){L.Util.setOptions(this,t),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this._featureGroup=L.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=L.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var e=L.DomUtil.TRANSITION&&this.options.animate;L.extend(this,e?this._withAnimation:this._noAnimation),this._markerCluster=e?L.MarkerCluster:L.MarkerClusterNonAnimated},addLayer:function(t){if(t instanceof L.LayerGroup)return this.addLayers([t]);if(!t.getLatLng)return this._nonPointGroup.addLayer(t),this.fire("layeradd",{layer:t}),this;if(!this._map)return this._needsClustering.push(t),this.fire("layeradd",{layer:t}),this;if(this.hasLayer(t))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(t,this._maxZoom),this.fire("layeradd",{layer:t}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var e=t,n=this._zoom;if(t.__parent)for(;e.__parent._zoom>=n;)e=e.__parent;return this._currentShownBounds.contains(e.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(t,e):this._animationAddLayerNonAnimated(t,e)),this},removeLayer:function(t){return t instanceof L.LayerGroup?this.removeLayers([t]):t.getLatLng?this._map?t.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(t)),this._removeLayer(t,!0),this.fire("layerremove",{layer:t}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),t.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(t)&&(this._featureGroup.removeLayer(t),t.clusterShow&&t.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,t)&&this.hasLayer(t)&&this._needsRemoving.push({layer:t,latlng:t._latlng}),this.fire("layerremove",{layer:t}),this):(this._nonPointGroup.removeLayer(t),this.fire("layerremove",{layer:t}),this)},addLayers:function(t,e){if(!L.Util.isArray(t))return this.addLayer(t);var n,i=this._featureGroup,a=this._nonPointGroup,o=this.options.chunkedLoading,r=this.options.chunkInterval,s=this.options.chunkProgress,l=t.length,c=0,d=!0;if(this._map){var u=(new Date).getTime(),h=L.bind((function(){for(var p=(new Date).getTime();l>c&&!(o&&0==c%200&&(new Date).getTime()-p>r);c++)if((n=t[c])instanceof L.LayerGroup)d&&(t=t.slice(),d=!1),this._extractNonGroupLayers(n,t),l=t.length;else if(n.getLatLng){if(!this.hasLayer(n)&&(this._addLayer(n,this._maxZoom),e||this.fire("layeradd",{layer:n}),n.__parent&&2===n.__parent.getChildCount())){var m=n.__parent.getAllChildMarkers(),g=m[0]===n?m[1]:m[0];i.removeLayer(g)}}else a.addLayer(n),e||this.fire("layeradd",{layer:n});s&&s(c,l,(new Date).getTime()-u),c===l?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(h,this.options.chunkDelay)}),this);h()}else for(var p=this._needsClustering;l>c;c++)(n=t[c])instanceof L.LayerGroup?(d&&(t=t.slice(),d=!1),this._extractNonGroupLayers(n,t),l=t.length):n.getLatLng?this.hasLayer(n)||p.push(n):a.addLayer(n);return this},removeLayers:function(t){var e,n,i=t.length,a=this._featureGroup,o=this._nonPointGroup,r=!0;if(!this._map){for(e=0;i>e;e++)(n=t[e])instanceof L.LayerGroup?(r&&(t=t.slice(),r=!1),this._extractNonGroupLayers(n,t),i=t.length):(this._arraySplice(this._needsClustering,n),o.removeLayer(n),this.hasLayer(n)&&this._needsRemoving.push({layer:n,latlng:n._latlng}),this.fire("layerremove",{layer:n}));return this}if(this._unspiderfy){this._unspiderfy();var s=t.slice(),l=i;for(e=0;l>e;e++)(n=s[e])instanceof L.LayerGroup?(this._extractNonGroupLayers(n,s),l=s.length):this._unspiderfyLayer(n)}for(e=0;i>e;e++)(n=t[e])instanceof L.LayerGroup?(r&&(t=t.slice(),r=!1),this._extractNonGroupLayers(n,t),i=t.length):n.__parent?(this._removeLayer(n,!0,!0),this.fire("layerremove",{layer:n}),a.hasLayer(n)&&(a.removeLayer(n),n.clusterShow&&n.clusterShow())):(o.removeLayer(n),this.fire("layerremove",{layer:n}));return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],this._needsRemoving=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer((function(t){t.off(this._childMarkerEventHandlers,this),delete t.__parent}),this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var t=new L.LatLngBounds;this._topClusterLevel&&t.extend(this._topClusterLevel._bounds);for(var e=this._needsClustering.length-1;e>=0;e--)t.extend(this._needsClustering[e].getLatLng());return t.extend(this._nonPointGroup.getBounds()),t},eachLayer:function(t,e){var n,i,a,o=this._needsClustering.slice(),r=this._needsRemoving;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(o),i=o.length-1;i>=0;i--){for(n=!0,a=r.length-1;a>=0;a--)if(r[a].layer===o[i]){n=!1;break}n&&t.call(e,o[i])}this._nonPointGroup.eachLayer(t,e)},getLayers:function(){var t=[];return this.eachLayer((function(e){t.push(e)})),t},getLayer:function(t){var e=null;return t=parseInt(t,10),this.eachLayer((function(n){L.stamp(n)===t&&(e=n)})),e},hasLayer:function(t){if(!t)return!1;var e,n=this._needsClustering;for(e=n.length-1;e>=0;e--)if(n[e]===t)return!0;for(e=(n=this._needsRemoving).length-1;e>=0;e--)if(n[e].layer===t)return!1;return!(!t.__parent||t.__parent._group!==this)||this._nonPointGroup.hasLayer(t)},zoomToShowLayer:function(t,e){"function"!=typeof e&&(e=function(){});var n=function(){!t._icon&&!t.__parent._icon||this._inZoomAnimation||(this._map.off("moveend",n,this),this.off("animationend",n,this),t._icon?e():t.__parent._icon&&(this.once("spiderfied",e,this),t.__parent.spiderfy()))};t._icon&&this._map.getBounds().contains(t.getLatLng())?e():t.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",n,this),this._map.panTo(t.getLatLng())):(this._map.on("moveend",n,this),this.on("animationend",n,this),t.__parent.zoomToBounds())},onAdd:function(t){var e,n,i;if(this._map=t,!isFinite(this._map.getMaxZoom()))throw"Map has no maxZoom specified";for(this._featureGroup.addTo(t),this._nonPointGroup.addTo(t),this._gridClusters||this._generateInitialClusters(),this._maxLat=t.options.crs.projection.MAX_LATITUDE,e=0,n=this._needsRemoving.length;n>e;e++)(i=this._needsRemoving[e]).newlatlng=i.layer._latlng,i.layer._latlng=i.latlng;for(e=0,n=this._needsRemoving.length;n>e;e++)i=this._needsRemoving[e],this._removeLayer(i.layer,!0),i.layer._latlng=i.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),n=this._needsClustering,this._needsClustering=[],this.addLayers(n,!0)},onRemove:function(t){t.off("zoomend",this._zoomEnd,this),t.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(t){for(var e=t;e&&!e._icon;)e=e.__parent;return e||null},_arraySplice:function(t,e){for(var n=t.length-1;n>=0;n--)if(t[n]===e)return t.splice(n,1),!0},_removeFromGridUnclustered:function(t,e){for(var n=this._map,i=this._gridUnclustered,a=Math.floor(this._map.getMinZoom());e>=a&&i[e].removeObject(t,n.project(t.getLatLng(),e));e--);},_childMarkerDragStart:function(t){t.target.__dragStart=t.target._latlng},_childMarkerMoved:function(t){if(!this._ignoreMove&&!t.target.__dragStart){var e=t.target._popup&&t.target._popup.isOpen();this._moveChild(t.target,t.oldLatLng,t.latlng),e&&t.target.openPopup()}},_moveChild:function(t,e,n){t._latlng=e,this.removeLayer(t),t._latlng=n,this.addLayer(t)},_childMarkerDragEnd:function(t){var e=t.target.__dragStart;delete t.target.__dragStart,e&&this._moveChild(t.target,e,t.target._latlng)},_removeLayer:function(t,e,n){var i=this._gridClusters,a=this._gridUnclustered,o=this._featureGroup,r=this._map,s=Math.floor(this._map.getMinZoom());e&&this._removeFromGridUnclustered(t,this._maxZoom);var l,c=t.__parent,d=c._markers;for(this._arraySplice(d,t);c&&(c._childCount--,c._boundsNeedUpdate=!0,!(c._zoom<s));)e&&c._childCount<=1?(l=c._markers[0]===t?c._markers[1]:c._markers[0],i[c._zoom].removeObject(c,r.project(c._cLatLng,c._zoom)),a[c._zoom].addObject(l,r.project(l.getLatLng(),c._zoom)),this._arraySplice(c.__parent._childClusters,c),c.__parent._markers.push(l),l.__parent=c.__parent,c._icon&&(o.removeLayer(c),n||o.addLayer(l))):c._iconNeedsUpdate=!0,c=c.__parent;delete t.__parent},_isOrIsParent:function(t,e){for(;e;){if(t===e)return!0;e=e.parentNode}return!1},fire:function(t,e,n){if(e&&e.layer instanceof L.MarkerCluster){if(e.originalEvent&&this._isOrIsParent(e.layer._icon,e.originalEvent.relatedTarget))return;t="cluster"+t}L.FeatureGroup.prototype.fire.call(this,t,e,n)},listens:function(t,e){return L.FeatureGroup.prototype.listens.call(this,t,e)||L.FeatureGroup.prototype.listens.call(this,"cluster"+t,e)},_defaultIconCreateFunction:function(t){var e=t.getChildCount(),n=" marker-cluster-";return n+=10>e?"small":100>e?"medium":"large",new L.DivIcon({html:"<div><span>"+e+"</span></div>",className:"marker-cluster"+n,iconSize:new L.Point(40,40)})},_bindEvents:function(){var t=this._map,e=this.options.spiderfyOnMaxZoom,n=this.options.showCoverageOnHover,i=this.options.zoomToBoundsOnClick;(e||i)&&this.on("clusterclick",this._zoomOrSpiderfy,this),n&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),t.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(t){for(var e=t.layer,n=e;1===n._childClusters.length;)n=n._childClusters[0];n._zoom===this._maxZoom&&n._childCount===e._childCount&&this.options.spiderfyOnMaxZoom?e.spiderfy():this.options.zoomToBoundsOnClick&&e.zoomToBounds(),t.originalEvent&&13===t.originalEvent.keyCode&&this._map._container.focus()},_showCoverage:function(t){var e=this._map;this._inZoomAnimation||(this._shownPolygon&&e.removeLayer(this._shownPolygon),t.layer.getChildCount()>2&&t.layer!==this._spiderfied&&(this._shownPolygon=new L.Polygon(t.layer.getConvexHull(),this.options.polygonOptions),e.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var t=this.options.spiderfyOnMaxZoom,e=this.options.showCoverageOnHover,n=this.options.zoomToBoundsOnClick,i=this._map;(t||n)&&this.off("clusterclick",this._zoomOrSpiderfy,this),e&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),i.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var t=this._getExpandedVisibleBounds();this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,t),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),t),this._currentShownBounds=t}},_generateInitialClusters:function(){var t=Math.ceil(this._map.getMaxZoom()),e=Math.floor(this._map.getMinZoom()),n=this.options.maxClusterRadius,i=n;"function"!=typeof n&&(i=function(){return n}),null!==this.options.disableClusteringAtZoom&&(t=this.options.disableClusteringAtZoom-1),this._maxZoom=t,this._gridClusters={},this._gridUnclustered={};for(var a=t;a>=e;a--)this._gridClusters[a]=new L.DistanceGrid(i(a)),this._gridUnclustered[a]=new L.DistanceGrid(i(a));this._topClusterLevel=new this._markerCluster(this,e-1)},_addLayer:function(t,e){var n,i,a=this._gridClusters,o=this._gridUnclustered,r=Math.floor(this._map.getMinZoom());for(this.options.singleMarkerMode&&this._overrideMarkerIcon(t),t.on(this._childMarkerEventHandlers,this);e>=r;e--){n=this._map.project(t.getLatLng(),e);var s=a[e].getNearObject(n);if(s)return s._addChild(t),void(t.__parent=s);if(s=o[e].getNearObject(n)){var l=s.__parent;l&&this._removeLayer(s,!1);var c=new this._markerCluster(this,e,s,t);a[e].addObject(c,this._map.project(c._cLatLng,e)),s.__parent=c,t.__parent=c;var d=c;for(i=e-1;i>l._zoom;i--)d=new this._markerCluster(this,i,d),a[i].addObject(d,this._map.project(s.getLatLng(),i));return l._addChild(d),void this._removeFromGridUnclustered(s,e)}o[e].addObject(t,n)}this._topClusterLevel._addChild(t),t.__parent=this._topClusterLevel},_refreshClustersIcons:function(){this._featureGroup.eachLayer((function(t){t instanceof L.MarkerCluster&&t._iconNeedsUpdate&&t._updateIcon()}))},_enqueue:function(t){this._queue.push(t),this._queueTimeout||(this._queueTimeout=setTimeout(L.bind(this._processQueue,this),300))},_processQueue:function(){for(var t=0;t<this._queue.length;t++)this._queue[t].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var t=Math.round(this._map._zoom);this._processQueue(),this._zoom<t&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,t)):this._zoom>t?(this._animationStart(),this._animationZoomOut(this._zoom,t)):this._moveEnd()},_getExpandedVisibleBounds:function(){return this.options.removeOutsideVisibleBounds?L.Browser.mobile?this._checkBoundsMaxLat(this._map.getBounds()):this._checkBoundsMaxLat(this._map.getBounds().pad(1)):this._mapBoundsInfinite},_checkBoundsMaxLat:function(t){var e=this._maxLat;return void 0!==e&&(t.getNorth()>=e&&(t._northEast.lat=1/0),t.getSouth()<=-e&&(t._southWest.lat=-1/0)),t},_animationAddLayerNonAnimated:function(t,e){if(e===t)this._featureGroup.addLayer(t);else if(2===e._childCount){e._addToMap();var n=e.getAllChildMarkers();this._featureGroup.removeLayer(n[0]),this._featureGroup.removeLayer(n[1])}else e._updateIcon()},_extractNonGroupLayers:function(t,e){var n,i=t.getLayers(),a=0;for(e=e||[];a<i.length;a++)(n=i[a])instanceof L.LayerGroup?this._extractNonGroupLayers(n,e):e.push(n);return e},_overrideMarkerIcon:function(t){return t.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[t]}})}});L.MarkerClusterGroup.include({_mapBoundsInfinite:new L.LatLngBounds(new L.LatLng(-1/0,-1/0),new L.LatLng(1/0,1/0))}),L.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(t,e){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(t,e){this._animationAddLayerNonAnimated(t,e)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(t,e){var n,i=this._getExpandedVisibleBounds(),a=this._featureGroup,o=Math.floor(this._map.getMinZoom());this._ignoreMove=!0,this._topClusterLevel._recursively(i,t,o,(function(o){var r,s=o._latlng,l=o._markers;for(i.contains(s)||(s=null),o._isSingleParent()&&t+1===e?(a.removeLayer(o),o._recursivelyAddChildrenToMap(null,e,i)):(o.clusterHide(),o._recursivelyAddChildrenToMap(s,e,i)),n=l.length-1;n>=0;n--)r=l[n],i.contains(r._latlng)||a.removeLayer(r)})),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(i,e),a.eachLayer((function(t){t instanceof L.MarkerCluster||!t._icon||t.clusterShow()})),this._topClusterLevel._recursively(i,t,e,(function(t){t._recursivelyRestoreChildPositions(e)})),this._ignoreMove=!1,this._enqueue((function(){this._topClusterLevel._recursively(i,t,o,(function(t){a.removeLayer(t),t.clusterShow()})),this._animationEnd()}))},_animationZoomOut:function(t,e){this._animationZoomOutSingle(this._topClusterLevel,t-1,e),this._topClusterLevel._recursivelyAddChildrenToMap(null,e,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),t,this._getExpandedVisibleBounds())},_animationAddLayer:function(t,e){var n=this,i=this._featureGroup;i.addLayer(t),e!==t&&(e._childCount>2?(e._updateIcon(),this._forceLayout(),this._animationStart(),t._setPos(this._map.latLngToLayerPoint(e.getLatLng())),t.clusterHide(),this._enqueue((function(){i.removeLayer(t),t.clusterShow(),n._animationEnd()}))):(this._forceLayout(),n._animationStart(),n._animationZoomOutSingle(e,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(t,e,n){var i=this._getExpandedVisibleBounds(),a=Math.floor(this._map.getMinZoom());t._recursivelyAnimateChildrenInAndAddSelfToMap(i,a,e+1,n);var o=this;this._forceLayout(),t._recursivelyBecomeVisible(i,n),this._enqueue((function(){if(1===t._childCount){var r=t._markers[0];this._ignoreMove=!0,r.setLatLng(r.getLatLng()),this._ignoreMove=!1,r.clusterShow&&r.clusterShow()}else t._recursively(i,n,a,(function(t){t._recursivelyRemoveChildrenFromMap(i,a,e+1)}));o._animationEnd()}))},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){L.Util.falseFn(document.body.offsetWidth)}}),L.markerClusterGroup=function(t){return new L.MarkerClusterGroup(t)};var n=L.MarkerCluster=L.Marker.extend({options:L.Icon.prototype.options,initialize:function(t,e,n,i){L.Marker.prototype.initialize.call(this,n?n._cLatLng||n.getLatLng():new L.LatLng(0,0),{icon:this,pane:t.options.clusterPane}),this._group=t,this._zoom=e,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new L.LatLngBounds,n&&this._addChild(n),i&&this._addChild(i)},getAllChildMarkers:function(t,e){t=t||[];for(var n=this._childClusters.length-1;n>=0;n--)this._childClusters[n].getAllChildMarkers(t);for(var i=this._markers.length-1;i>=0;i--)e&&this._markers[i].__dragStart||t.push(this._markers[i]);return t},getChildCount:function(){return this._childCount},zoomToBounds:function(t){for(var e,n=this._childClusters.slice(),i=this._group._map,a=i.getBoundsZoom(this._bounds),o=this._zoom+1,r=i.getZoom();n.length>0&&a>o;){o++;var s=[];for(e=0;e<n.length;e++)s=s.concat(n[e]._childClusters);n=s}a>o?this._group._map.setView(this._latlng,o):r>=a?this._group._map.setView(this._latlng,r+1):this._group._map.fitBounds(this._bounds,t)},getBounds:function(){var t=new L.LatLngBounds;return t.extend(this._bounds),t},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(t,e){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(t),t instanceof L.MarkerCluster?(e||(this._childClusters.push(t),t.__parent=this),this._childCount+=t._childCount):(e||this._markers.push(t),this._childCount++),this.__parent&&this.__parent._addChild(t,!0)},_setClusterCenter:function(t){this._cLatLng||(this._cLatLng=t._cLatLng||t._latlng)},_resetBounds:function(){var t=this._bounds;t._southWest&&(t._southWest.lat=1/0,t._southWest.lng=1/0),t._northEast&&(t._northEast.lat=-1/0,t._northEast.lng=-1/0)},_recalculateBounds:function(){var t,e,n,i,a=this._markers,o=this._childClusters,r=0,s=0,l=this._childCount;if(0!==l){for(this._resetBounds(),t=0;t<a.length;t++)n=a[t]._latlng,this._bounds.extend(n),r+=n.lat,s+=n.lng;for(t=0;t<o.length;t++)(e=o[t])._boundsNeedUpdate&&e._recalculateBounds(),this._bounds.extend(e._bounds),n=e._wLatLng,i=e._childCount,r+=n.lat*i,s+=n.lng*i;this._latlng=this._wLatLng=new L.LatLng(r/l,s/l),this._boundsNeedUpdate=!1}},_addToMap:function(t){t&&(this._backupLatlng=this._latlng,this.setLatLng(t)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(t,e,n){this._recursively(t,this._group._map.getMinZoom(),n-1,(function(t){var n,i,a=t._markers;for(n=a.length-1;n>=0;n--)(i=a[n])._icon&&(i._setPos(e),i.clusterHide())}),(function(t){var n,i,a=t._childClusters;for(n=a.length-1;n>=0;n--)(i=a[n])._icon&&(i._setPos(e),i.clusterHide())}))},_recursivelyAnimateChildrenInAndAddSelfToMap:function(t,e,n,i){this._recursively(t,i,e,(function(a){a._recursivelyAnimateChildrenIn(t,a._group._map.latLngToLayerPoint(a.getLatLng()).round(),n),a._isSingleParent()&&n-1===i?(a.clusterShow(),a._recursivelyRemoveChildrenFromMap(t,e,n)):a.clusterHide(),a._addToMap()}))},_recursivelyBecomeVisible:function(t,e){this._recursively(t,this._group._map.getMinZoom(),e,null,(function(t){t.clusterShow()}))},_recursivelyAddChildrenToMap:function(t,e,n){this._recursively(n,this._group._map.getMinZoom()-1,e,(function(i){if(e!==i._zoom)for(var a=i._markers.length-1;a>=0;a--){var o=i._markers[a];n.contains(o._latlng)&&(t&&(o._backupLatlng=o.getLatLng(),o.setLatLng(t),o.clusterHide&&o.clusterHide()),i._group._featureGroup.addLayer(o))}}),(function(e){e._addToMap(t)}))},_recursivelyRestoreChildPositions:function(t){for(var e=this._markers.length-1;e>=0;e--){var n=this._markers[e];n._backupLatlng&&(n.setLatLng(n._backupLatlng),delete n._backupLatlng)}if(t-1===this._zoom)for(var i=this._childClusters.length-1;i>=0;i--)this._childClusters[i]._restorePosition();else for(var a=this._childClusters.length-1;a>=0;a--)this._childClusters[a]._recursivelyRestoreChildPositions(t)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(t,e,n,i){var a,o;this._recursively(t,e-1,n-1,(function(t){for(o=t._markers.length-1;o>=0;o--)a=t._markers[o],i&&i.contains(a._latlng)||(t._group._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow())}),(function(t){for(o=t._childClusters.length-1;o>=0;o--)a=t._childClusters[o],i&&i.contains(a._latlng)||(t._group._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow())}))},_recursively:function(t,e,n,i,a){var o,r,s=this._childClusters,l=this._zoom;if(l>=e&&(i&&i(this),a&&l===n&&a(this)),e>l||n>l)for(o=s.length-1;o>=0;o--)(r=s[o])._boundsNeedUpdate&&r._recalculateBounds(),t.intersects(r._bounds)&&r._recursively(t,e,n,i,a)},_isSingleParent:function(){return this._childClusters.length>0&&this._childClusters[0]._childCount===this._childCount}});L.Marker.include({clusterHide:function(){var t=this.options.opacity;return this.setOpacity(0),this.options.opacity=t,this},clusterShow:function(){return this.setOpacity(this.options.opacity)}}),L.DistanceGrid=function(t){this._cellSize=t,this._sqCellSize=t*t,this._grid={},this._objectPoint={}},L.DistanceGrid.prototype={addObject:function(t,e){var n=this._getCoord(e.x),i=this._getCoord(e.y),a=this._grid,o=a[i]=a[i]||{},r=o[n]=o[n]||[],s=L.Util.stamp(t);this._objectPoint[s]=e,r.push(t)},updateObject:function(t,e){this.removeObject(t),this.addObject(t,e)},removeObject:function(t,e){var n,i,a=this._getCoord(e.x),o=this._getCoord(e.y),r=this._grid,s=r[o]=r[o]||{},l=s[a]=s[a]||[];for(delete this._objectPoint[L.Util.stamp(t)],n=0,i=l.length;i>n;n++)if(l[n]===t)return l.splice(n,1),1===i&&delete s[a],!0},eachObject:function(t,e){var n,i,a,o,r,s,l=this._grid;for(n in l)for(i in r=l[n])for(a=0,o=(s=r[i]).length;o>a;a++)t.call(e,s[a])&&(a--,o--)},getNearObject:function(t){var e,n,i,a,o,r,s,l,c=this._getCoord(t.x),d=this._getCoord(t.y),u=this._objectPoint,h=this._sqCellSize,p=null;for(e=d-1;d+1>=e;e++)if(a=this._grid[e])for(n=c-1;c+1>=n;n++)if(o=a[n])for(i=0,r=o.length;r>i;i++)s=o[i],(h>(l=this._sqDist(u[L.Util.stamp(s)],t))||h>=l&&null===p)&&(h=l,p=s);return p},_getCoord:function(t){var e=Math.floor(t/this._cellSize);return isFinite(e)?e:t},_sqDist:function(t,e){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i}},L.QuickHull={getDistant:function(t,e){var n=e[1].lat-e[0].lat;return(e[0].lng-e[1].lng)*(t.lat-e[0].lat)+n*(t.lng-e[0].lng)},findMostDistantPointFromBaseLine:function(t,e){var n,i,a,o=0,r=null,s=[];for(n=e.length-1;n>=0;n--)i=e[n],(a=this.getDistant(i,t))>0&&(s.push(i),a>o&&(o=a,r=i));return{maxPoint:r,newPoints:s}},buildConvexHull:function(t,e){var n=[],i=this.findMostDistantPointFromBaseLine(t,e);return i.maxPoint?n=(n=n.concat(this.buildConvexHull([t[0],i.maxPoint],i.newPoints))).concat(this.buildConvexHull([i.maxPoint,t[1]],i.newPoints)):[t[0]]},getConvexHull:function(t){var e,n=!1,i=!1,a=!1,o=!1,r=null,s=null,l=null,c=null,d=null,u=null;for(e=t.length-1;e>=0;e--){var h=t[e];(!1===n||h.lat>n)&&(r=h,n=h.lat),(!1===i||h.lat<i)&&(s=h,i=h.lat),(!1===a||h.lng>a)&&(l=h,a=h.lng),(!1===o||h.lng<o)&&(c=h,o=h.lng)}return i!==n?(u=s,d=r):(u=c,d=l),[].concat(this.buildConvexHull([u,d],t),this.buildConvexHull([d,u],t))}},L.MarkerCluster.include({getConvexHull:function(){var t,e,n=this.getAllChildMarkers(),i=[];for(e=n.length-1;e>=0;e--)t=n[e].getLatLng(),i.push(t);return L.QuickHull.getConvexHull(i)}}),L.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:0,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(this._group._spiderfied!==this&&!this._group._inZoomAnimation){var t,e=this.getAllChildMarkers(null,!0),n=this._group._map.latLngToLayerPoint(this._latlng);this._group._unspiderfy(),this._group._spiderfied=this,e.length>=this._circleSpiralSwitchover?t=this._generatePointsSpiral(e.length,n):(n.y+=10,t=this._generatePointsCircle(e.length,n)),this._animationSpiderfy(e,t)}},unspiderfy:function(t){this._group._inZoomAnimation||(this._animationUnspiderfy(t),this._group._spiderfied=null)},_generatePointsCircle:function(t,e){var n,i,a=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+t)/this._2PI,o=this._2PI/t,r=[];for(a=Math.max(a,35),r.length=t,n=0;t>n;n++)i=this._circleStartAngle+n*o,r[n]=new L.Point(e.x+a*Math.cos(i),e.y+a*Math.sin(i))._round();return r},_generatePointsSpiral:function(t,e){var n,i=this._group.options.spiderfyDistanceMultiplier,a=i*this._spiralLengthStart,o=i*this._spiralFootSeparation,r=i*this._spiralLengthFactor*this._2PI,s=0,l=[];for(l.length=t,n=t;n>=0;n--)t>n&&(l[n]=new L.Point(e.x+a*Math.cos(s),e.y+a*Math.sin(s))._round()),a+=r/(s+=o/a+5e-4*n);return l},_noanimationUnspiderfy:function(){var t,e,n=this._group,i=n._map,a=n._featureGroup,o=this.getAllChildMarkers(null,!0);for(n._ignoreMove=!0,this.setOpacity(1),e=o.length-1;e>=0;e--)t=o[e],a.removeLayer(t),t._preSpiderfyLatlng&&(t.setLatLng(t._preSpiderfyLatlng),delete t._preSpiderfyLatlng),t.setZIndexOffset&&t.setZIndexOffset(0),t._spiderLeg&&(i.removeLayer(t._spiderLeg),delete t._spiderLeg);n.fire("unspiderfied",{cluster:this,markers:o}),n._ignoreMove=!1,n._spiderfied=null}}),L.MarkerClusterNonAnimated=L.MarkerCluster.extend({_animationSpiderfy:function(t,e){var n,i,a,o,r=this._group,s=r._map,l=r._featureGroup,c=this._group.options.spiderLegPolylineOptions;for(r._ignoreMove=!0,n=0;n<t.length;n++)o=s.layerPointToLatLng(e[n]),i=t[n],a=new L.Polyline([this._latlng,o],c),s.addLayer(a),i._spiderLeg=a,i._preSpiderfyLatlng=i._latlng,i.setLatLng(o),i.setZIndexOffset&&i.setZIndexOffset(1e6),l.addLayer(i);this.setOpacity(.3),r._ignoreMove=!1,r.fire("spiderfied",{cluster:this,markers:t})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),L.MarkerCluster.include({_animationSpiderfy:function(t,e){var n,i,a,o,r,s,l=this,c=this._group,d=c._map,u=c._featureGroup,h=this._latlng,p=d.latLngToLayerPoint(h),m=L.Path.SVG,g=L.extend({},this._group.options.spiderLegPolylineOptions),f=g.opacity;for(void 0===f&&(f=L.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),m?(g.opacity=0,g.className=(g.className||"")+" leaflet-cluster-spider-leg"):g.opacity=f,c._ignoreMove=!0,n=0;n<t.length;n++)i=t[n],s=d.layerPointToLatLng(e[n]),a=new L.Polyline([h,s],g),d.addLayer(a),i._spiderLeg=a,m&&(r=(o=a._path).getTotalLength()+.1,o.style.strokeDasharray=r,o.style.strokeDashoffset=r),i.setZIndexOffset&&i.setZIndexOffset(1e6),i.clusterHide&&i.clusterHide(),u.addLayer(i),i._setPos&&i._setPos(p);for(c._forceLayout(),c._animationStart(),n=t.length-1;n>=0;n--)s=d.layerPointToLatLng(e[n]),(i=t[n])._preSpiderfyLatlng=i._latlng,i.setLatLng(s),i.clusterShow&&i.clusterShow(),m&&((o=(a=i._spiderLeg)._path).style.strokeDashoffset=0,a.setStyle({opacity:f}));this.setOpacity(.3),c._ignoreMove=!1,setTimeout((function(){c._animationEnd(),c.fire("spiderfied",{cluster:l,markers:t})}),200)},_animationUnspiderfy:function(t){var e,n,i,a,o,r,s=this,l=this._group,c=l._map,d=l._featureGroup,u=t?c._latLngToNewLayerPoint(this._latlng,t.zoom,t.center):c.latLngToLayerPoint(this._latlng),h=this.getAllChildMarkers(null,!0),p=L.Path.SVG;for(l._ignoreMove=!0,l._animationStart(),this.setOpacity(1),n=h.length-1;n>=0;n--)(e=h[n])._preSpiderfyLatlng&&(e.closePopup(),e.setLatLng(e._preSpiderfyLatlng),delete e._preSpiderfyLatlng,r=!0,e._setPos&&(e._setPos(u),r=!1),e.clusterHide&&(e.clusterHide(),r=!1),r&&d.removeLayer(e),p&&(o=(a=(i=e._spiderLeg)._path).getTotalLength()+.1,a.style.strokeDashoffset=o,i.setStyle({opacity:0})));l._ignoreMove=!1,setTimeout((function(){var t=0;for(n=h.length-1;n>=0;n--)(e=h[n])._spiderLeg&&t++;for(n=h.length-1;n>=0;n--)(e=h[n])._spiderLeg&&(e.clusterShow&&e.clusterShow(),e.setZIndexOffset&&e.setZIndexOffset(0),t>1&&d.removeLayer(e),c.removeLayer(e._spiderLeg),delete e._spiderLeg);l._animationEnd(),l.fire("unspiderfied",{cluster:s,markers:h})}),200)}}),L.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),L.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(t){L.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(t))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(t){this._spiderfied&&this._spiderfied.unspiderfy(t)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(t){t._spiderLeg&&(this._featureGroup.removeLayer(t),t.clusterShow&&t.clusterShow(),t.setZIndexOffset&&t.setZIndexOffset(0),this._map.removeLayer(t._spiderLeg),delete t._spiderLeg)}}),L.MarkerClusterGroup.include({refreshClusters:function(t){return t?t instanceof L.MarkerClusterGroup?t=t._topClusterLevel.getAllChildMarkers():t instanceof L.LayerGroup?t=t._layers:t instanceof L.MarkerCluster?t=t.getAllChildMarkers():t instanceof L.Marker&&(t=[t]):t=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(t),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(t),this},_flagParentsIconsNeedUpdate:function(t){var e,n;for(e in t)for(n=t[e].__parent;n;)n._iconNeedsUpdate=!0,n=n.__parent},_refreshSingleMarkerModeMarkers:function(t){var e,n;for(e in t)n=t[e],this.hasLayer(n)&&n.setIcon(this._overrideMarkerIcon(n))}}),L.Marker.include({refreshIconOptions:function(t,e){var n=this.options.icon;return L.setOptions(n,t),this.setIcon(n),e&&this.__parent&&this.__parent._group.refreshClusters(this),this}}),t.MarkerClusterGroup=e,t.MarkerCluster=n}(e)},dSgL:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form [formGroup]="importFormGroup" (ngSubmit)="importFromJson()">\n  <mat-toolbar color="primary">\n    <h2 translate>{{ importTitle }}</h2>\n    <span fxFlex></span>\n    <button mat-button mat-icon-button\n            (click)="cancel()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div mat-dialog-content>\n    <fieldset [disabled]="isLoading$ | async">\n      <div fxFlex fxLayout="column">\n        <tb-file-input\n          [contentConvertFunction]="loadDataFromJsonContent"\n          formControlName="jsonContent"\n          required\n          label="{{importFileLabel | translate}}"\n          dropLabel="{{ \'import.drop-file\' | translate }}"\n          accept=".json,application/json"\n          allowedExtensions="json">\n        </tb-file-input>\n      </div>\n    </fieldset>\n  </div>\n  <div mat-dialog-actions fxLayoutAlign="end center">\n    <button mat-raised-button color="primary"\n            type="submit"\n            [disabled]="(isLoading$ | async) || importFormGroup.invalid || !importFormGroup.dirty">\n      {{ \'action.import\' | translate }}\n    </button>\n    <button mat-button color="primary"\n            type="button"\n            [disabled]="(isLoading$ | async)"\n            (click)="cancel()" cdkFocusInitial>\n      {{ \'action.cancel\' | translate }}\n    </button>\n  </div>\n</form>\n'},"do/i":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n("U3y+"),a=function(t){this.entityType=i.b.WIDGET_TYPE,this.id=t}},"e/A1":function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var i=n("mrSG"),a=n("TYT/"),o=n("RxGS"),r=n("6onV"),s=n("ea4N"),l=n("BOYq"),c=n("//Q6"),d=n("QJY3"),u=function(t){function e(e,n,i,a){var o=t.call(this,e)||this;return o.store=e,o.dialog=n,o.fb=i,o.widgetComponentService=a,o.widgetFormGroup=o.fb.group({widgetConfig:[null]}),o}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){this.loadWidgetConfig()},e.prototype.ngOnChanges=function(t){for(var e=!1,n=0,i=Object.keys(t);n<i.length;n++){var a=i[n],o=t[a];o.firstChange||o.currentValue===o.previousValue||["widget","widgetLayout"].includes(a)&&(e=!0)}e&&this.loadWidgetConfig()},e.prototype.loadWidgetConfig=function(){if(this.widget){var t,e,n=this.widgetComponentService.getInstantWidgetInfo(this.widget),i=n.typeSettingsSchema||n.settingsSchema,a=n.typeDataKeySettingsSchema||n.dataKeySettingsSchema,o=n.typeParameters,r=n.actionSources,s=!Object(c.k)(n.typeParameters)||!n.typeParameters.useCustomDatasources;t=i&&""!==i?Object(c.t)(i)?JSON.parse(i):i:{},e=a&&""!==a?Object(c.t)(a)?JSON.parse(a):a:{},this.widgetConfig={config:this.widget.config,layout:this.widgetLayout,widgetType:this.widget.type,typeParameters:o,actionSources:r,isDataEnabled:s,settingsSchema:t,dataKeySettingsSchema:e},this.widgetFormGroup.reset({widgetConfig:this.widgetConfig})}},e.ctorParameters=function(){return[{type:r.Store},{type:s.MatDialog},{type:d.FormBuilder},{type:l.a}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"dashboard",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"aliasController",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],e.prototype,"widgetEditMode",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"widget",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object)],e.prototype,"widgetLayout",void 0),e=Object(i.c)([Object(a.Component)({selector:"tb-edit-widget",template:Object(i.f)(n("FjzW")).default}),Object(i.g)("design:paramtypes",[r.Store,s.MatDialog,d.FormBuilder,l.a])],e)}(o.a)},eAUg:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n.tb-custom-action-pretty {\n  box-sizing: border-box;\n  position: relative;\n  padding: 8px;\n  background-color: #fff;\n}\n.tb-custom-action-pretty .tb-fullscreen-panel .tb-custom-action-editor-container {\n  height: calc(100% - 40px);\n}\n.tb-custom-action-pretty .tb-fullscreen-panel .right-panel {\n  padding-top: 8px;\n  padding-left: 3px;\n}\n.tb-custom-action-pretty .tb-fullscreen-panel tb-js-func .tb-js-func-panel {\n  box-sizing: border-box;\n}\n.tb-custom-action-pretty .tb-fullscreen-panel mat-tab-group .mat-tab-body-wrapper {\n  height: 100%;\n}\n.tb-custom-action-pretty .tb-fullscreen-panel mat-tab-group .mat-tab-body-wrapper mat-tab-body {\n  height: 100%;\n}\n.tb-custom-action-pretty .tb-fullscreen-panel mat-tab-group .mat-tab-body-wrapper mat-tab-body > div {\n  height: 100%;\n}\n.tb-custom-action-pretty .tb-split {\n  box-sizing: border-box;\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n.tb-custom-action-pretty .tb-content {\n  border: 1px solid #c0c0c0;\n}\n.tb-custom-action-pretty .gutter {\n  background-color: #eee;\n  background-repeat: no-repeat;\n  background-position: 50%;\n}\n.tb-custom-action-pretty .gutter.gutter-horizontal {\n  cursor: col-resize;\n  background-image: url(\'vertical.5e6d1df402c3bc10ecc6.png\');\n}\n.tb-custom-action-pretty .tb-split.tb-split-horizontal,\n.tb-custom-action-pretty .gutter.gutter-horizontal {\n  float: left;\n  height: 100%;\n}\n.tb-custom-action-pretty .tb-action-expand-button {\n  position: absolute;\n  right: 14px;\n  z-index: 2;\n}\n.tb-custom-action-pretty .tb-action-expand-button.tb-fullscreen-editor {\n  position: relative;\n  right: 0;\n}\n.tb-custom-action-pretty .tb-action-expand-button.tb-fullscreen-editor .mat-button .mat-icon {\n  margin-right: 5px;\n}\n.tb-custom-action-pretty .tb-action-expand-button .mat-button {\n  min-width: 36px;\n  padding: 0;\n}\n.tb-custom-action-pretty .tb-action-expand-button .mat-button .mat-icon {\n  margin-right: 0;\n}\n.tb-custom-action-pretty .tb-custom-action-editor.tb-fullscreen-editor {\n  height: 100%;\n}'},ekQc:function(t,e,n){"use strict";n.d(e,"a",(function(){return p})),n.d(e,"c",(function(){return m})),n.d(e,"b",(function(){return f}));var i=n("mrSG"),a=n("TYT/"),o=n("DUip"),r=n("UaJx"),s=n("zp9Z"),l=n("cX0b"),c=n("0aaO"),d=n("YnEf"),u=n("4j5O"),h=n("67Y/"),p=function(){function t(t,e){this.dashboardService=t,this.dashboardUtils=e}return t.prototype.resolve=function(t){var e=this,n=t.params.dashboardId;return this.dashboardService.getDashboard(n).pipe(Object(h.a)((function(t){return e.dashboardUtils.validateAndUpdateDashboard(t)})))},t.ctorParameters=function(){return[{type:d.a},{type:u.a}]},t=Object(i.c)([Object(a.Injectable)(),Object(i.g)("design:paramtypes",[d.a,u.a])],t)}(),m=function(t,e,n){return n.dashboard.title},g=[{path:"dashboards",data:{breadcrumb:{label:"dashboard.dashboards",icon:"dashboard"}},children:[{path:"",component:r.a,data:{auth:[s.a.TENANT_ADMIN,s.a.CUSTOMER_USER],title:"dashboard.dashboards",dashboardsType:"tenant"},resolve:{entitiesTableConfig:l.a}},{path:":dashboardId",component:c.a,data:{breadcrumb:{labelFunction:m,icon:"dashboard"},auth:[s.a.TENANT_ADMIN,s.a.CUSTOMER_USER],title:"dashboard.dashboard",widgetEditMode:!1},resolve:{dashboard:p}}]}],f=function(){function t(){}return t=Object(i.c)([Object(a.NgModule)({imports:[o.RouterModule.forChild(g)],exports:[o.RouterModule],providers:[l.a,p]})],t)}()},fPs1:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div style="min-width: 400px;">\n  <mat-toolbar fxLayout="row" color="primary">\n    <h2>{{ \'dashboard.public-dashboard-title\' | translate }}</h2>\n    <span fxFlex></span>\n    <button mat-button mat-icon-button\n            (click)="close()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div style="height: 4px;" *ngIf="!(isLoading$ | async)"></div>\n  <div mat-dialog-content tb-toast toastTarget="makeDashboardPublicDialogContent">\n    <span\n       innerHTML="{{ translate.get(\'dashboard.public-dashboard-text\', {dashboardTitle: dashboard.title, publicLink: publicLink}) | async }}">\n    </span>\n    <div fxLayout="row" fxLayoutAlign="start center">\n      <pre class="tb-highlight" fxFlex><code>{{ publicLink }}</code></pre>\n      <button mat-button mat-icon-button\n              ngxClipboard\n              (cbOnSuccess)="onPublicLinkCopied($event)"\n              cbContent="{{publicLink}}"\n              matTooltipPosition="above"\n              matTooltip="{{ \'dashboard.copy-public-link\' | translate }}">\n        <mat-icon svgIcon="mdi:clipboard-arrow-left"></mat-icon>\n      </button>\n    </div>\n    <div class="tb-notice" innerHTML="{{\'dashboard.public-dashboard-notice\' | translate}}"></div>\n    <tb-social-share-panel style="padding-top: 15px;"\n                           shareTitle="{{ \'dashboard.socialshare-title\' | translate:{dashboardTitle: dashboard.title} }}"\n                           shareText="{{ \'dashboard.socialshare-text\' | translate:{dashboardTitle: dashboard.title} }}"\n                           shareLink="{{ publicLink }}"\n                           shareHashTags="thingsboard, iot">\n    </tb-social-share-panel>\n  </div>\n  <div mat-dialog-actions fxLayout="row">\n    <span fxFlex></span>\n    <button mat-button color="primary"\n            style="margin-right: 20px;"\n            type="button"\n            [disabled]="(isLoading$ | async)"\n            (click)="close()" cdkFocusInitial>\n      {{ \'action.ok\' | translate }}\n    </button>\n  </div>\n</div>\n'},fxBt:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div fxLayout="column" [formGroup]="entityFilterFormGroup" class="tb-entity-filter">\n  <mat-form-field class="mat-block">\n    <mat-label translate>alias.filter-type</mat-label>\n    <mat-select required formControlName="type">\n      <mat-option *ngFor="let type of aliasFilterTypes" [value]="type">\n        {{aliasFilterTypeTranslations.get(type) | translate}}\n      </mat-option>\n    </mat-select>\n    <mat-error *ngIf="entityFilterFormGroup.get(\'type\').hasError(\'required\')">\n      {{ \'alias.filter-type-required\' | translate }}\n    </mat-error>\n  </mat-form-field>\n  <section fxLayout="column" [formGroup]="filterFormGroup" [ngSwitch]="entityFilterFormGroup.get(\'type\').value">\n    <ng-template [ngSwitchCase]="aliasFilterType.singleEntity">\n      <tb-entity-select required\n                        useAliasEntityTypes="true"\n                        formControlName="singleEntity">\n      </tb-entity-select>\n    </ng-template>\n    <ng-template [ngSwitchCase]="aliasFilterType.entityList">\n      <tb-entity-type-select required\n                             showLabel\n                             [allowedEntityTypes]="allowedEntityTypes"\n                             formControlName="entityType">\n      </tb-entity-type-select>\n      <tb-entity-list required\n                      [entityType]="filterFormGroup.get(\'entityType\').value"\n                      formControlName="entityList">\n      </tb-entity-list>\n    </ng-template>\n    <ng-template [ngSwitchCase]="aliasFilterType.entityName">\n      <tb-entity-type-select required\n                             showLabel\n                             [allowedEntityTypes]="allowedEntityTypes"\n                             formControlName="entityType">\n      </tb-entity-type-select>\n      <mat-form-field class="mat-block">\n        <mat-label translate>entity.name-starts-with</mat-label>\n        <input matInput formControlName="entityNameFilter" required>\n        <mat-error *ngIf="filterFormGroup.get(\'entityNameFilter\').hasError(\'required\')">\n          {{ \'entity.entity-name-filter-required\' | translate }}\n        </mat-error>\n      </mat-form-field>\n    </ng-template>\n    <ng-template [ngSwitchCase]="aliasFilterType.stateEntity">\n      <mat-form-field floatLabel="always" class="mat-block">\n        <mat-label translate>alias.state-entity-parameter-name</mat-label>\n        <input matInput formControlName="stateEntityParamName"\n               placeholder="{{ \'alias.default-entity-parameter-name\' | translate }}">\n      </mat-form-field>\n      <div fxLayout="column">\n        <label class="tb-small">{{ \'alias.default-state-entity\' | translate }}</label>\n        <tb-entity-select fxFlex\n                          useAliasEntityTypes="true"\n                          formControlName="defaultStateEntity">\n        </tb-entity-select>\n      </div>\n    </ng-template>\n    <ng-template [ngSwitchCase]="aliasFilterType.assetType">\n      <tb-entity-subtype-autocomplete required\n                                      formControlName="assetType"\n                                      [entityType]="entityType.ASSET">\n      </tb-entity-subtype-autocomplete>\n      <mat-form-field class="mat-block">\n        <mat-label translate>asset.name-starts-with</mat-label>\n        <input matInput formControlName="assetNameFilter">\n      </mat-form-field>\n    </ng-template>\n    <ng-template [ngSwitchCase]="aliasFilterType.deviceType">\n      <tb-entity-subtype-autocomplete required\n                                      formControlName="deviceType"\n                                      [entityType]="entityType.DEVICE">\n      </tb-entity-subtype-autocomplete>\n      <mat-form-field class="mat-block">\n        <mat-label translate>device.name-starts-with</mat-label>\n        <input matInput formControlName="deviceNameFilter">\n      </mat-form-field>\n    </ng-template>\n    <ng-template [ngSwitchCase]="aliasFilterType.entityViewType">\n      <tb-entity-subtype-autocomplete required\n                                      formControlName="entityViewType"\n                                      [entityType]="entityType.ENTITY_VIEW">\n      </tb-entity-subtype-autocomplete>\n      <mat-form-field class="mat-block">\n        <mat-label translate>entity-view.name-starts-with</mat-label>\n        <input matInput formControlName="entityViewNameFilter">\n      </mat-form-field>\n    </ng-template>\n    <ng-template [ngSwitchCase]="aliasFilterType.relationsQuery">\n      <section fxLayout="column" id="relationsQueryFilter">\n        <label class="tb-small">{{ \'alias.root-entity\' | translate }}</label>\n        <section class="tb-root-state-entity-switch" fxLayout="row" fxLayoutAlign="start center" style="padding-left: 0;">\n          <mat-slide-toggle class="root-state-entity-switch"\n                            formControlName="rootStateEntity">\n          </mat-slide-toggle>\n          <label class="tb-small root-state-entity-label" translate>alias.root-state-entity</label>\n        </section>\n        <div fxFlex fxLayout="row" *ngIf="!filterFormGroup.get(\'rootStateEntity\').value">\n          <tb-entity-select fxFlex\n                            required\n                            useAliasEntityTypes="true"\n                            formControlName="rootEntity">\n          </tb-entity-select>\n        </div>\n        <div fxFlex fxLayout="row" *ngIf="filterFormGroup.get(\'rootStateEntity\').value">\n          <mat-form-field floatLabel="always" class="mat-block" style="margin-top: 14px; padding-right: 8px;">\n            <mat-label translate>alias.state-entity-parameter-name</mat-label>\n            <input matInput formControlName="stateEntityParamName"\n                   placeholder="{{ \'alias.default-entity-parameter-name\' | translate }}">\n          </mat-form-field>\n          <div fxFlex fxLayout="column">\n            <label class="tb-small">{{ \'alias.default-state-entity\' | translate }}</label>\n            <tb-entity-select fxFlex\n                              useAliasEntityTypes="true"\n                              formControlName="defaultStateEntity">\n            </tb-entity-select>\n          </div>\n        </div>\n        <div fxFlex fxLayout="row">\n          <section class="tb-root-state-entity-switch" fxLayout="row" fxLayoutAlign="start center" style="padding-left: 0;">\n            <mat-slide-toggle class="root-state-entity-switch"\n                              formControlName="fetchLastLevelOnly">\n            </mat-slide-toggle>\n            <label class="tb-small root-state-entity-label" translate>alias.last-level-relation</label>\n          </section>\n        </div>\n        <div fxFlex fxLayoutGap="8px" fxLayout="row" fxLayout.xs="column">\n          <mat-form-field class="mat-block" style="min-width: 100px;">\n            <mat-label translate>relation.direction</mat-label>\n            <mat-select required formControlName="direction">\n              <mat-option *ngFor="let type of directionTypes" [value]="type">\n                {{ directionTypeTranslations.get(directionTypeEnum[type]) | translate }}\n              </mat-option>\n            </mat-select>\n          </mat-form-field>\n          <mat-form-field fxFlex floatLabel="always" class="mat-block">\n            <mat-label translate>alias.max-relation-level</mat-label>\n            <input matInput\n                   type="number"\n                   min="1"\n                   step="1"\n                   placeholder="{{ \'alias.unlimited-level\' | translate }}"\n                   formControlName="maxLevel">\n          </mat-form-field>\n        </div>\n        <div class="mat-caption" style="padding-bottom: 10px; color: rgba(0,0,0,0.57);" translate>relation.relation-filters</div>\n        <tb-relation-filters\n          [allowedEntityTypes]="allowedEntityTypes"\n          formControlName="filters">\n        </tb-relation-filters>\n      </section>\n    </ng-template>\n    <ng-template [ngSwitchCase]="entityFilterFormGroup.get(\'type\').value === aliasFilterType.assetSearchQuery ||\n                                 entityFilterFormGroup.get(\'type\').value === aliasFilterType.deviceSearchQuery ||\n                                 entityFilterFormGroup.get(\'type\').value === aliasFilterType.entityViewSearchQuery ?\n                                 entityFilterFormGroup.get(\'type\').value : \'\'">\n      <label class="tb-small">{{ \'alias.root-entity\' | translate }}</label>\n      <section class="tb-root-state-entity-switch" fxLayout="row" fxLayoutAlign="start center" style="padding-left: 0;">\n        <mat-slide-toggle class="root-state-entity-switch"\n                          formControlName="rootStateEntity">\n        </mat-slide-toggle>\n        <label class="tb-small root-state-entity-label" translate>alias.root-state-entity</label>\n      </section>\n      <div fxFlex fxLayout="row" *ngIf="!filterFormGroup.get(\'rootStateEntity\').value">\n        <tb-entity-select fxFlex\n                          required\n                          useAliasEntityTypes="true"\n                          formControlName="rootEntity">\n        </tb-entity-select>\n      </div>\n      <div fxFlex fxLayout="row" *ngIf="filterFormGroup.get(\'rootStateEntity\').value">\n        <mat-form-field floatLabel="always" class="mat-block" style="margin-top: 14px; padding-right: 8px;">\n          <mat-label translate>alias.state-entity-parameter-name</mat-label>\n          <input matInput formControlName="stateEntityParamName"\n                 placeholder="{{ \'alias.default-entity-parameter-name\' | translate }}">\n        </mat-form-field>\n        <div fxFlex fxLayout="column">\n          <label class="tb-small">{{ \'alias.default-state-entity\' | translate }}</label>\n          <tb-entity-select fxFlex\n                            useAliasEntityTypes="true"\n                            formControlName="defaultStateEntity">\n          </tb-entity-select>\n        </div>\n      </div>\n      <div fxFlex fxLayout="row">\n        <section class="tb-root-state-entity-switch" fxLayout="row" fxLayoutAlign="start center" style="padding-left: 0;">\n          <mat-slide-toggle class="root-state-entity-switch"\n                            formControlName="fetchLastLevelOnly">\n          </mat-slide-toggle>\n          <label class="tb-small root-state-entity-label" translate>alias.last-level-relation</label>\n        </section>\n      </div>\n      <div fxFlex fxLayoutGap="8px" fxLayout="row" fxLayout.xs="column">\n        <mat-form-field class="mat-block" style="min-width: 100px;">\n          <mat-label translate>relation.direction</mat-label>\n          <mat-select required formControlName="direction">\n            <mat-option *ngFor="let type of directionTypes" [value]="type">\n              {{ directionTypeTranslations.get(directionTypeEnum[type]) | translate }}\n            </mat-option>\n          </mat-select>\n        </mat-form-field>\n        <mat-form-field fxFlex floatLabel="always" class="mat-block">\n          <mat-label translate>alias.max-relation-level</mat-label>\n          <input matInput\n                 type="number"\n                 min="1"\n                 step="1"\n                 placeholder="{{ \'alias.unlimited-level\' | translate }}"\n                 formControlName="maxLevel">\n        </mat-form-field>\n      </div>\n      <div class="mat-caption" style="color: rgba(0,0,0,0.57);" translate>relation.relation-type</div>\n      <tb-relation-type-autocomplete\n        fxFlex\n        formControlName="relationType">\n      </tb-relation-type-autocomplete>\n    </ng-template>\n    <ng-template [ngSwitchCase]="aliasFilterType.assetSearchQuery">\n      <div class="mat-caption tb-required" style="color: rgba(0,0,0,0.57);" translate>asset.asset-types</div>\n      <tb-entity-subtype-list\n        required\n        [entityType]="entityType.ASSET"\n        formControlName="assetTypes">\n      </tb-entity-subtype-list>\n    </ng-template>\n    <ng-template [ngSwitchCase]="aliasFilterType.deviceSearchQuery">\n      <div class="mat-caption tb-required" style="color: rgba(0,0,0,0.57);" translate>device.device-types</div>\n      <tb-entity-subtype-list\n        required\n        [entityType]="entityType.DEVICE"\n        formControlName="deviceTypes">\n      </tb-entity-subtype-list>\n    </ng-template>\n    <ng-template [ngSwitchCase]="aliasFilterType.entityViewSearchQuery">\n      <div class="mat-caption tb-required" style="color: rgba(0,0,0,0.57);" translate>entity-view.entity-view-types</div>\n      <tb-entity-subtype-list\n        required\n        [entityType]="entityType.ENTITY_VIEW"\n        formControlName="entityViewTypes">\n      </tb-entity-subtype-list>\n    </ng-template>\n  </section>\n</div>\n'},g8Nv:function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var i=n("mrSG"),a=n("TYT/"),o=n("ea4N"),r=n("o8Qb"),s=n("Vurf"),l=n("Z9d0"),c=n("Valr"),d=n("PCNd"),u=n("psW0"),h=n("xMyE"),p=n("llUh"),m=n("txsh"),g=function(){function t(t,e,n,i){this.translate=t,this.authService=e,this.dynamicComponentFactoryService=n,this.dialog=i}return t.prototype.customDialog=function(t,e,n){var a=this;return this.dynamicComponentFactoryService.createDynamicComponentFactory(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.d)(e,t),e}(p.b),t,[d.a,f]).pipe(Object(u.a)((function(t){var i={controller:e,customComponentFactory:t,data:n};return a.dialog.open(m.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:i}).afterClosed().pipe(Object(h.a)((function(){a.dynamicComponentFactoryService.destroyDynamicComponentFactory(t)})))})))},t.ctorParameters=function(){return[{type:r.TranslateService},{type:s.a},{type:l.a},{type:o.MatDialog}]},t=Object(i.c)([Object(a.Injectable)(),Object(i.g)("design:paramtypes",[r.TranslateService,s.a,l.a,o.MatDialog])],t)}(),f=function(){function t(){}return t=Object(i.c)([Object(a.NgModule)({declarations:[],imports:[c.CommonModule,d.a],exports:[]})],t)}()},gMhB:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .mat-column-order {\n  -ms-flex: 0 0 40px;\n      flex: 0 0 40px;\n}\n:host .mat-column-sampleData {\n  -ms-flex: 0 0 120px;\n      flex: 0 0 120px;\n}\n:host .mat-column-type {\n  -ms-flex: 0 0 120px;\n      flex: 0 0 120px;\n}'},hVuj:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host ::ng-deep .mat-tab-group .mat-tab-body-wrapper {\n  height: 100%;\n}'},hqxT:function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var i=n("mrSG"),a=n("TYT/"),o=n("MqYC"),r=n("ea4N"),s=n("6onV"),l=n("QJY3"),c=n("DUip"),d=n("gmuX"),u=n("OiFK"),h=n("o8Qb"),p=n("21Fy"),m=function(t){function e(e,n,i,a,o,r,s,c,d){var u=t.call(this,e,n,o)||this;if(u.store=e,u.router=n,u.data=i,u.errorStateMatcher=a,u.dialogRef=o,u.fb=r,u.utils=s,u.translate=c,u.entityService=d,u.submitted=!1,u.isAdd=i.isAdd,u.allowedEntityTypes=i.allowedEntityTypes,Array.isArray(i.entityAliases))u.entityAliases=i.entityAliases;else{u.entityAliases=[];for(var h=0,p=Object.keys(i.entityAliases);h<p.length;h++){var m=p[h];u.entityAliases.push(i.entityAliases[m])}}return u.isAdd&&!u.data.alias?u.alias={id:null,alias:"",filter:{resolveMultiple:!1}}:u.alias=i.alias,u.entityAliasFormGroup=u.fb.group({alias:[u.alias.alias,[u.validateDuplicateAliasName(),l.Validators.required]],resolveMultiple:[u.alias.filter.resolveMultiple],filter:[u.alias.filter,l.Validators.required]}),u}var d;return Object(i.d)(e,t),d=e,e.prototype.validateDuplicateAliasName=function(){var t=this;return function(e){var n=e.value,i=t.entityAliases.find((function(t){return t.alias===n}));return i&&(t.isAdd||t.alias.id!==i.id)?{duplicateAliasName:{valid:!1}}:null}},e.prototype.ngOnInit=function(){},e.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=!!(t&&t.invalid&&this.submitted);return n||i},e.prototype.cancel=function(){this.dialogRef.close(null)},e.prototype.validate=function(){return this.entityService.resolveAliasFilter(this.alias.filter,null,1,!0)},e.prototype.save=function(){var t=this;this.submitted=!0,this.alias.alias=this.entityAliasFormGroup.get("alias").value,this.alias.filter=this.entityAliasFormGroup.get("filter").value,this.alias.filter.resolveMultiple=this.entityAliasFormGroup.get("resolveMultiple").value,this.validate().subscribe((function(){t.isAdd&&(t.alias.id=t.utils.guid()),t.dialogRef.close(t.alias)}),(function(){t.entityAliasFormGroup.setErrors({noEntityMatched:!0});var e=t.entityAliasFormGroup.valueChanges.subscribe((function(){t.entityAliasFormGroup.setErrors(null),e.unsubscribe()}))}))},e.ctorParameters=function(){return[{type:s.Store},{type:c.Router},{type:void 0,decorators:[{type:a.Inject,args:[r.MAT_DIALOG_DATA]}]},{type:o.d,decorators:[{type:a.SkipSelf}]},{type:r.MatDialogRef},{type:l.FormBuilder},{type:u.a},{type:h.TranslateService},{type:p.a}]},e=d=Object(i.c)([Object(a.Component)({selector:"tb-entity-alias-dialog",template:Object(i.f)(n("S3nC")).default,providers:[{provide:o.d,useExisting:d}],styles:[Object(i.f)(n("MKGz")).default]}),Object(i.h)(2,Object(a.Inject)(r.MAT_DIALOG_DATA)),Object(i.h)(3,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[s.Store,c.Router,Object,o.d,r.MatDialogRef,l.FormBuilder,u.a,h.TranslateService,p.a])],e)}(d.a)},iG9X:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form [formGroup]="alarmFormGroup" style="min-width: 600px;">\n  <mat-toolbar color="primary">\n    <h2>{{ \'alarm.alarm-details\' | translate }}</h2>\n    <span fxFlex></span>\n    <button mat-icon-button\n            (click)="close()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div style="height: 4px;" *ngIf="!(isLoading$ | async)"></div>\n  <div mat-dialog-content>\n    <fieldset [disabled]="isLoading$ | async">\n      <div fxLayout="row" fxLayoutGap="6px">\n        <mat-form-field class="mat-block">\n          <mat-label translate>alarm.created-time</mat-label>\n          <input matInput formControlName="createdTime" readonly>\n        </mat-form-field>\n        <mat-form-field fxFlex class="mat-block">\n          <mat-label translate>alarm.originator</mat-label>\n          <input matInput formControlName="originatorName" readonly>\n        </mat-form-field>\n      </div>\n      <div fxLayout="row" fxLayoutGap="6px" *ngIf="alarmFormGroup.get(\'startTime\').value ||\n                                 alarmFormGroup.get(\'endTime\').value">\n        <mat-form-field *ngIf="alarmFormGroup.get(\'startTime\').value" fxFlex class="mat-block">\n          <mat-label translate>alarm.start-time</mat-label>\n          <input matInput formControlName="startTime" readonly>\n        </mat-form-field>\n        <mat-form-field *ngIf="alarmFormGroup.get(\'endTime\').value" fxFlex class="mat-block">\n          <mat-label translate>alarm.end-time</mat-label>\n          <input matInput formControlName="endTime" readonly>\n        </mat-form-field>\n        <span fxFlex *ngIf="!alarmFormGroup.get(\'startTime\').value || !alarmFormGroup.get(\'endTime\').value"></span>\n      </div>\n      <div fxLayout="row" fxLayoutGap="6px" *ngIf="alarmFormGroup.get(\'ackTime\').value ||\n                                 alarmFormGroup.get(\'clearTime\').value">\n        <mat-form-field *ngIf="alarmFormGroup.get(\'ackTime\').value" fxFlex class="mat-block">\n          <mat-label translate>alarm.ack-time</mat-label>\n          <input matInput formControlName="ackTime" readonly>\n        </mat-form-field>\n        <mat-form-field *ngIf="alarmFormGroup.get(\'clearTime\').value" fxFlex class="mat-block">\n          <mat-label translate>alarm.clear-time</mat-label>\n          <input matInput formControlName="clearTime" readonly>\n        </mat-form-field>\n        <span fxFlex *ngIf="!alarmFormGroup.get(\'ackTime\').value || !alarmFormGroup.get(\'clearTime\').value"></span>\n      </div>\n      <div fxLayout="row" fxLayoutGap="6px">\n        <mat-form-field fxFlex class="mat-block">\n          <mat-label translate>alarm.type</mat-label>\n          <input matInput formControlName="type" readonly>\n        </mat-form-field>\n        <mat-form-field fxFlex class="mat-block">\n          <mat-label translate>alarm.severity</mat-label>\n          <input matInput formControlName="alarmSeverity" readonly\n                 [ngStyle]="{fontWeight: \'bold\', color: alarmSeverityColorsMap.get((alarm$ | async)?.severity)}">\n        </mat-form-field>\n        <mat-form-field fxFlex class="mat-block">\n          <mat-label translate>alarm.status</mat-label>\n          <input matInput formControlName="alarmStatus" readonly>\n        </mat-form-field>\n      </div>\n      <tb-json-object-edit\n          *ngIf="displayDetails"\n          formControlName="alarmDetails"\n          readonly\n          label="{{ \'alarm.details\' | translate }}">\n      </tb-json-object-edit>\n    </fieldset>\n  </div>\n  <div mat-dialog-actions fxLayout="row">\n    <div fxLayout="row" *ngIf="alarm$ | async; let alarm;">\n      <button *ngIf="allowAcknowledgment && (alarm.status === alarmStatuses.ACTIVE_UNACK ||\n                                             alarm.status === alarmStatuses.CLEARED_UNACK)"\n              mat-raised-button\n              color="primary"\n              type="button"\n              (click)="acknowledge()"\n              style="margin-right: 20px;"\n              [disabled]="(isLoading$ | async)">\n        {{ \'alarm.acknowledge\' | translate }}\n      </button>\n      <button *ngIf="allowClear && (alarm.status === alarmStatuses.ACTIVE_ACK ||\n                                    alarm.status === alarmStatuses.ACTIVE_UNACK)"\n              mat-raised-button\n              color="primary"\n              type="button"\n              (click)="clear()"\n              [disabled]="(isLoading$ | async)">\n        {{ \'alarm.clear\' | translate }}\n      </button>\n    </div>\n    <span fxFlex></span>\n    <button mat-button color="primary"\n            type="button"\n            [disabled]="(isLoading$ | async)"\n            (click)="close()" cdkFocusInitial>\n      {{ \'action.close\' | translate }}\n    </button>\n  </div>\n</form>\n'},igfJ:function(t,e,n){"use strict";n.d(e,"a",(function(){return x}));var i=n("mrSG"),a=n("TYT/"),o=n("Q7pZ"),r=n("o8Qb"),s=n("Valr"),l=n("ea4N"),c=n("XOa3"),d=n("/Bgp"),u=n("8Mhd"),h=n("qxrw"),p=n("U3y+"),m=n("4r/P"),g=n("5pw5"),f=function(t){function e(e,n,i,a,o,r,s,l,d){void 0===o&&(o=c.c.TENANT),void 0===r&&(r=null),void 0===s&&(s=null),void 0===l&&(l=null),void 0===d&&(d=!0);var u=t.call(this)||this;return u.auditLogService=e,u.translate=n,u.datePipe=i,u.dialog=a,u.auditLogMode=o,u.entityId=r,u.userId=s,u.customerId=l,u.loadDataOnInit=d,u.tableTitle="",u.useTimePageLink=!0,u.detailsPanelEnabled=!1,u.selectionEnabled=!1,u.searchEnabled=!0,u.addEnabled=!1,u.entitiesDeleteEnabled=!1,u.actionsColumnTitle="audit-log.details",u.entityTranslations={noEntities:"audit-log.no-audit-logs-prompt",search:"audit-log.search"},u.entityResources={},u.entitiesFetchFunction=function(t){return u.fetchAuditLogs(t)},u.defaultSortOrder={property:"createdTime",direction:m.a.DESC},u.columns.push(new h.a("createdTime","audit-log.timestamp",u.datePipe,"150px")),u.auditLogMode!==c.c.ENTITY&&u.columns.push(new h.c("entityType","audit-log.entity-type","20%",(function(t){return n.instant(p.d.get(t.entityId.entityType).type)})),new h.c("entityName","audit-log.entity-name","20%")),u.auditLogMode!==c.c.USER&&u.columns.push(new h.c("userName","audit-log.user","33%")),u.columns.push(new h.c("actionType","audit-log.type","33%",(function(t){return n.instant(c.e.get(t.actionType))})),new h.c("actionStatus","audit-log.status","33%",(function(t){return n.instant(c.d.get(t.actionStatus))}))),u.cellActionDescriptors.push({name:u.translate.instant("audit-log.details"),icon:"more_horiz",isEnabled:function(){return!0},onAction:function(t,e){return u.showAuditLogDetails(e)}}),u}return Object(i.d)(e,t),e.prototype.fetchAuditLogs=function(t){switch(this.auditLogMode){case c.c.TENANT:return this.auditLogService.getAuditLogs(t);case c.c.ENTITY:return this.auditLogService.getAuditLogsByEntityId(this.entityId,t);case c.c.USER:return this.auditLogService.getAuditLogsByUserId(this.userId.id,t);case c.c.CUSTOMER:return this.auditLogService.getAuditLogsByCustomerId(this.customerId.id,t)}},e.prototype.showAuditLogDetails=function(t){this.dialog.open(g.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{auditLog:t}})},e}(h.d),b=n("UaJx"),y=n("6onV"),v=n("zp9Z"),w=n("C/rb"),x=function(){function t(t,e,n,i,a){this.auditLogService=t,this.translate=e,this.datePipe=n,this.dialog=i,this.store=a,this.activeValue=!1,this.dirtyValue=!1}return Object.defineProperty(t.prototype,"active",{set:function(t){this.activeValue!==t&&(this.activeValue=t,this.activeValue&&this.dirtyValue&&(this.dirtyValue=!1,this.entitiesTable.updateData()))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"entityId",{set:function(t){this.entityIdValue=t,this.auditLogTableConfig&&this.auditLogTableConfig.entityId!==t&&(this.auditLogTableConfig.entityId=t,this.entitiesTable.resetSortAndFilter(this.activeValue),this.activeValue||(this.dirtyValue=!0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"userId",{set:function(t){this.userIdValue=t,this.auditLogTableConfig&&this.auditLogTableConfig.userId!==t&&(this.auditLogTableConfig.userId=t,this.entitiesTable.resetSortAndFilter(this.activeValue),this.activeValue||(this.dirtyValue=!0))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"customerId",{set:function(t){this.customerIdValue=t,this.auditLogTableConfig&&this.auditLogTableConfig.customerId!==t&&(this.auditLogTableConfig.customerId=t,this.entitiesTable.resetSortAndFilter(this.activeValue),this.activeValue||(this.dirtyValue=!0))},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){var t=this.activeValue;(this.dirtyValue=!this.activeValue,this.auditLogMode)||(Object(w.b)(this.store).authority===v.a.TENANT_ADMIN&&(this.auditLogMode=c.c.TENANT),t=!0);this.auditLogTableConfig=new f(this.auditLogService,this.translate,this.datePipe,this.dialog,this.auditLogMode,this.entityIdValue,this.userIdValue,this.customerIdValue,t)},t.ctorParameters=function(){return[{type:o.a},{type:r.TranslateService},{type:s.DatePipe},{type:l.MatDialog},{type:y.Store}]},Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Number)],t.prototype,"auditLogMode",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean)],t.prototype,"detailsMode",void 0),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Boolean),Object(i.g)("design:paramtypes",[Boolean])],t.prototype,"active",null),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",Object),Object(i.g)("design:paramtypes",[Object])],t.prototype,"entityId",null),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",d.a),Object(i.g)("design:paramtypes",[d.a])],t.prototype,"userId",null),Object(i.c)([Object(a.Input)(),Object(i.g)("design:type",u.a),Object(i.g)("design:paramtypes",[u.a])],t.prototype,"customerId",null),Object(i.c)([Object(a.ViewChild)(b.a,{static:!0}),Object(i.g)("design:type",b.a)],t.prototype,"entitiesTable",void 0),t=Object(i.c)([Object(a.Component)({selector:"tb-audit-log-table",template:Object(i.f)(n("rVoF")).default,styles:[Object(i.f)(n("qS8Y")).default]}),Object(i.g)("design:paramtypes",[o.a,r.TranslateService,s.DatePipe,l.MatDialog,y.Store])],t)}()},ipJt:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host button.tb-add-new-widget {\n  padding-right: 12px;\n  font-size: 24px;\n  border-style: dashed;\n  border-width: 2px;\n}'},"l/KY":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form [formGroup]="widgetActionFormGroup" (ngSubmit)="save()" style="min-width: 480px;">\n  <mat-toolbar color="primary">\n    <h2>{{ (isAdd ? \'widget-config.add-action\' : \'widget-config.edit-action\' ) | translate }}</h2>\n    <span fxFlex></span>\n    <button mat-button mat-icon-button\n            (click)="cancel()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div style="height: 4px;" *ngIf="!(isLoading$ | async)"></div>\n  <div mat-dialog-content>\n    <fieldset [disabled]="isLoading$ | async">\n      <mat-form-field class="mat-block">\n        <mat-label translate>widget-config.action-source</mat-label>\n        <mat-select required formControlName="actionSourceId">\n          <mat-option *ngFor="let actionSourceItem of data.actionsData.actionSources | keyvalue" [value]="actionSourceItem.key">\n            {{ actionSourceName(actionSourceItem.value) }}\n          </mat-option>\n        </mat-select>\n        <mat-error *ngIf="widgetActionFormGroup.get(\'actionSourceId\').hasError(\'required\')">\n          {{ \'widget-config.action-source-required\' | translate }}\n        </mat-error>\n      </mat-form-field>\n      <mat-form-field class="mat-block">\n        <mat-label translate>widget-config.action-name</mat-label>\n        <input required matInput formControlName="name">\n        <mat-error *ngIf="widgetActionFormGroup.get(\'name\').hasError(\'required\')">\n          {{ \'widget-config.action-name-required\' | translate }}\n        </mat-error>\n        <mat-error *ngIf="widgetActionFormGroup.get(\'name\').hasError(\'actionNameNotUnique\')"\n          [innerHTML]="\'widget-config.action-name-not-unique\' | translate">\n        </mat-error>\n      </mat-form-field>\n      <tb-material-icon-select\n        formControlName="icon">\n      </tb-material-icon-select>\n      <mat-form-field class="mat-block">\n        <mat-label translate>widget-config.action-type</mat-label>\n        <mat-select required formControlName="type">\n          <mat-option *ngFor="let actionType of widgetActionTypes" [value]="actionType">\n            {{ widgetActionTypeTranslations.get(widgetActionType[actionType]) | translate }}\n          </mat-option>\n        </mat-select>\n        <mat-error *ngIf="widgetActionFormGroup.get(\'type\').hasError(\'required\')">\n          {{ \'widget-config.action-type-required\' | translate }}\n        </mat-error>\n      </mat-form-field>\n      <section fxLayout="column" [formGroup]="actionTypeFormGroup" [ngSwitch]="widgetActionFormGroup.get(\'type\').value">\n        <ng-template [ngSwitchCase]="widgetActionType.openDashboard">\n          <div fxLayout="column">\n            <div class="mat-caption tb-required"\n                 style="padding-left: 3px; padding-bottom: 10px; color: rgba(0,0,0,0.57);" translate>widget-action.target-dashboard</div>\n            <tb-dashboard-autocomplete\n              formControlName="targetDashboardId"\n              required\n              [selectFirstDashboard]="true"\n            ></tb-dashboard-autocomplete>\n          </div>\n        </ng-template>\n        <ng-template [ngSwitchCase]="widgetActionFormGroup.get(\'type\').value === widgetActionType.openDashboardState ||\n                                     widgetActionFormGroup.get(\'type\').value === widgetActionType.updateDashboardState ||\n                                     widgetActionFormGroup.get(\'type\').value === widgetActionType.openDashboard ?\n                                     widgetActionFormGroup.get(\'type\').value : \'\'">\n          <mat-form-field class="mat-block">\n            <input matInput type="text" placeholder="{{ \'widget-action.target-dashboard-state\' | translate }}"\n                   #dashboardStateInput\n                   formControlName="targetDashboardStateId"\n                   [required]="widgetActionFormGroup.get(\'type\').value === widgetActionType.openDashboardState"\n                   [matAutocomplete]="targetDashboardStateAutocomplete">\n            <button *ngIf="actionTypeFormGroup.get(\'targetDashboardStateId\').value"\n                    type="button"\n                    matSuffix mat-icon-button aria-label="Clear"\n                    (click)="clearTargetDashboardState()">\n              <mat-icon class="material-icons">close</mat-icon>\n            </button>\n            <mat-autocomplete\n              class="tb-autocomplete"\n              #targetDashboardStateAutocomplete="matAutocomplete">\n              <mat-option *ngFor="let state of filteredDashboardStates | async" [value]="state">\n                <span [innerHTML]="state | highlight:targetDashboardStateSearchText"></span>\n              </mat-option>\n            </mat-autocomplete>\n            <mat-error *ngIf="actionTypeFormGroup.get(\'targetDashboardStateId\').hasError(\'required\')">\n              {{ \'widget-action.target-dashboard-state-required\' | translate }}\n            </mat-error>\n          </mat-form-field>\n        </ng-template>\n        <ng-template [ngSwitchCase]="widgetActionFormGroup.get(\'type\').value === widgetActionType.openDashboardState ||\n                                     widgetActionFormGroup.get(\'type\').value === widgetActionType.updateDashboardState ?\n                                     widgetActionFormGroup.get(\'type\').value : \'\'">\n          <mat-checkbox formControlName="openRightLayout">\n            {{ \'widget-action.open-right-layout\' | translate }}\n          </mat-checkbox>\n        </ng-template>\n        <ng-template [ngSwitchCase]="widgetActionFormGroup.get(\'type\').value === widgetActionType.openDashboardState ||\n                                     widgetActionFormGroup.get(\'type\').value === widgetActionType.updateDashboardState ||\n                                     widgetActionFormGroup.get(\'type\').value === widgetActionType.openDashboard ?\n                                     widgetActionFormGroup.get(\'type\').value : \'\'">\n          <div fxFlex fxLayout="column">\n            <mat-checkbox formControlName="setEntityId">\n              {{ \'widget-action.set-entity-from-widget\' | translate }}\n            </mat-checkbox>\n            <mat-form-field *ngIf="actionTypeFormGroup.get(\'setEntityId\').value"\n                            floatLabel="always"\n                            class="mat-block">\n              <mat-label translate>alias.state-entity-parameter-name</mat-label>\n              <input matInput\n                     placeholder="{{ \'alias.default-entity-parameter-name\' | translate }}"\n                     formControlName="stateEntityParamName">\n            </mat-form-field>\n          </div>\n        </ng-template>\n        <ng-template [ngSwitchCase]="widgetActionType.custom">\n          <tb-js-func\n            formControlName="customFunction"\n            [functionArgs]="[\'$event\', \'widgetContext\', \'entityId\', \'entityName\', \'additionalParams\', \'entityLabel\']"\n            [validationArgs]="[]"\n            [editorCompleter]="customActionEditorCompleter"\n          ></tb-js-func>\n        </ng-template>\n        <ng-template [ngSwitchCase]="widgetActionType.customPretty">\n          <tb-custom-action-pretty-editor\n            formControlName="customAction">\n          </tb-custom-action-pretty-editor>\n        </ng-template>\n      </section>\n    </fieldset>\n  </div>\n  <div mat-dialog-actions fxLayoutAlign="end center">\n    <button mat-raised-button color="primary"\n            type="submit"\n            [disabled]="(isLoading$ | async) || widgetActionFormGroup.invalid || actionTypeFormGroup.invalid || (!widgetActionFormGroup.dirty && !actionTypeFormGroup.dirty)">\n      {{ (isAdd  ? \'action.add\' : \'action.save\') | translate }}\n    </button>\n    <button mat-button color="primary"\n            type="button"\n            [disabled]="(isLoading$ | async)"\n            (click)="cancel()" cdkFocusInitial>\n      {{ \'action.cancel\' | translate }}\n    </button>\n  </div>\n</form>\n'},lGaB:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<tb-details-panel fxFlex\n                   [headerTitle]="entitiesTableConfig.entityTitle(entity)"\n                   headerSubtitle="{{ translations.details | translate }}"\n                   [isReadOnly]="entitiesTableConfig.detailsReadonly(entity)"\n                   [isEdit]="isEditValue"\n                   (closeDetails)="onCloseEntityDetails()"\n                   (toggleDetailsEditMode)="onToggleEditMode($event)"\n                   (applyDetails)="saveEntity()"\n                   [theForm]="detailsForm">\n  <div class="details-buttons">\n    <div [tb-help]="helpLinkId()"></div>\n  </div>\n  <mat-tab-group class="tb-absolute-fill" [ngClass]="{\'tb-headless\': hideDetailsTabs()}" fxFlex [(selectedIndex)]="selectedTab">\n    <mat-tab label="{{ \'details.details\' | translate }}">\n      <tb-anchor #entityDetailsForm></tb-anchor>\n    </mat-tab>\n    <tb-anchor #entityTabs></tb-anchor>\n  </mat-tab-group>\n</tb-details-panel>\n'},lHnB:function(t,e,n){"use strict";n.d(e,"a",(function(){return D}));var i=n("mrSG"),a=n("TYT/"),o=n("MqYC"),r=n("ea4N"),s=n("6onV"),l=n("QJY3"),c=n("DUip"),d=n("gmuX"),u=n("mbhL"),h=n("26FU"),p=n("S5bw"),m=n("F/XL"),g=n("Duvn"),f=n("9Z1F"),b=n("67Y/"),y=n("s4kO"),v=n("yGWI"),w=function(){function t(t){this.states=t,this.statesSubject=new h.a([]),this.pageDataSubject=new h.a(Object(g.a)()),this.pageData$=this.pageDataSubject.asObservable()}return t.prototype.connect=function(t){return this.statesSubject.asObservable()},t.prototype.disconnect=function(t){this.statesSubject.complete(),this.pageDataSubject.complete()},t.prototype.loadStates=function(t,e){var n=this;void 0===e&&(e=!1),e&&(this.allStates=null);var i=new p.a;return this.fetchStates(t).pipe(Object(f.a)((function(){return Object(m.a)(Object(g.a)())}))).subscribe((function(t){n.statesSubject.next(t.data),n.pageDataSubject.next(t),i.next(t)})),i},t.prototype.fetchStates=function(t){return this.getAllStates().pipe(Object(b.a)((function(e){return t.filterData(e)})))},t.prototype.getAllStates=function(){if(!this.allStates){for(var t=[],e=0,n=Object.keys(this.states);e<n.length;e++){var a=n[e],o=this.states[a];t.push(Object(i.a)({id:a},o))}this.allStates=Object(m.a)(t).pipe(Object(y.a)(1),Object(v.a)())}return this.allStates},t.prototype.isEmpty=function(){return this.statesSubject.pipe(Object(b.a)((function(t){return!t.length})))},t.prototype.total=function(){return this.pageDataSubject.pipe(Object(b.a)((function(t){return t.totalElements})))},t}(),x=n("4r/P"),S=n("nbAZ"),C=n("Byqp"),T=n("bne5"),O=n("p0ib"),_=n("Gi3i"),L=n("ad02"),I=n("xMyE"),A=n("o8Qb"),k=n("S+vS"),E=n("//Q6"),j=n("Kgme"),D=function(t){function e(e,n,i,a,o,r,s,l,c){var d=t.call(this,e,n,o)||this;d.store=e,d.router=n,d.data=i,d.errorStateMatcher=a,d.dialogRef=o,d.fb=r,d.translate=s,d.dialogs=l,d.dialog=c,d.textSearchMode=!1,d.submitted=!1,d.states=d.data.states,d.statesFormGroup=d.fb.group({});var h={property:"name",direction:x.a.ASC};return d.pageLink=new u.b(5,0,null,h),d.displayedColumns=["name","id","root","actions"],d.dataSource=new w(d.states),d}var d;return Object(i.d)(e,t),d=e,e.prototype.ngOnInit=function(){this.dataSource.loadStates(this.pageLink)},e.prototype.ngAfterViewInit=function(){var t=this;Object(T.a)(this.searchInputField.nativeElement,"keyup").pipe(Object(_.a)(150),Object(L.a)(),Object(I.a)((function(){t.paginator.pageIndex=0,t.updateData()}))).subscribe(),this.sort.sortChange.subscribe((function(){return t.paginator.pageIndex=0})),Object(O.a)(this.sort.sortChange,this.paginator.page).pipe(Object(I.a)((function(){return t.updateData()}))).subscribe()},e.prototype.updateData=function(t){void 0===t&&(t=!1),this.pageLink.page=this.paginator.pageIndex,this.pageLink.pageSize=this.paginator.pageSize,this.pageLink.sortOrder.property=this.sort.active,this.pageLink.sortOrder.direction=x.a[this.sort.direction.toUpperCase()],this.dataSource.loadStates(this.pageLink,t)},e.prototype.addState=function(t){this.openStateDialog(t)},e.prototype.editState=function(t,e){this.openStateDialog(t,e)},e.prototype.deleteState=function(t,e){var n=this;t&&t.stopPropagation();var i=this.translate.instant("dashboard.delete-state-title"),a=this.translate.instant("dashboard.delete-state-text",{stateName:e.name});this.dialogs.confirm(i,a,this.translate.instant("action.no"),this.translate.instant("action.yes")).subscribe((function(t){t&&(delete n.states[e.id],n.onStatesUpdated())}))},e.prototype.enterFilterMode=function(){var t=this;this.textSearchMode=!0,this.pageLink.textSearch="",setTimeout((function(){t.searchInputField.nativeElement.focus(),t.searchInputField.nativeElement.setSelectionRange(0,0)}),10)},e.prototype.exitFilterMode=function(){this.textSearchMode=!1,this.pageLink.textSearch=null,this.paginator.pageIndex=0,this.updateData()},e.prototype.openStateDialog=function(t,e){var n=this;void 0===e&&(e=null),t&&t.stopPropagation();var i=null===e,a=null;i||(a=e.id),this.dialog.open(j.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{isAdd:i,states:this.states,state:Object(E.d)(e)}}).afterClosed().subscribe((function(t){t&&n.saveState(t,a)}))},e.prototype.saveState=function(t,e){var n={name:t.name,root:t.root,layouts:t.layouts};if(e?this.states[e]=n:this.states[t.id]=n,t.root)for(var i=0,a=Object.keys(this.states);i<a.length;i++){var o=a[i],r=this.states[o];o!==t.id&&(r.root=!1)}this.onStatesUpdated()},e.prototype.onStatesUpdated=function(){this.statesFormGroup.markAsDirty(),this.updateData(!0)},e.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=!!(t&&t.invalid&&this.submitted);return n||i},e.prototype.cancel=function(){this.dialogRef.close(null)},e.prototype.save=function(){this.submitted=!0,this.dialogRef.close(this.states)},e.ctorParameters=function(){return[{type:s.Store},{type:c.Router},{type:void 0,decorators:[{type:a.Inject,args:[r.MAT_DIALOG_DATA]}]},{type:o.d,decorators:[{type:a.SkipSelf}]},{type:r.MatDialogRef},{type:l.FormBuilder},{type:A.TranslateService},{type:k.a},{type:r.MatDialog}]},Object(i.c)([Object(a.ViewChild)("searchInput"),Object(i.g)("design:type",a.ElementRef)],e.prototype,"searchInputField",void 0),Object(i.c)([Object(a.ViewChild)(S.a),Object(i.g)("design:type",S.a)],e.prototype,"paginator",void 0),Object(i.c)([Object(a.ViewChild)(C.a),Object(i.g)("design:type",C.a)],e.prototype,"sort",void 0),e=d=Object(i.c)([Object(a.Component)({selector:"tb-manage-dashboard-states-dialog",template:Object(i.f)(n("C/AO")).default,providers:[{provide:o.d,useExisting:d}],styles:[Object(i.f)(n("qpl/")).default]}),Object(i.h)(2,Object(a.Inject)(r.MAT_DIALOG_DATA)),Object(i.h)(3,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[s.Store,c.Router,Object,o.d,r.MatDialogRef,l.FormBuilder,A.TranslateService,k.a,r.MatDialog])],e)}(d.a)},lKcD:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form [formGroup]="widgetFormGroup" (ngSubmit)="add()" style="width: 900px;">\n  <mat-toolbar color="primary">\n    <h2 translate>widget.add</h2>\n    <span fxFlex></span>\n    <div [tb-help]="helpLinkIdForWidgetType()"></div>\n    <button mat-icon-button\n            (click)="cancel()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div mat-dialog-content>\n    <fieldset [disabled]="isLoading$ | async" style="position: relative; height: 600px;">\n      <tb-widget-config\n        [aliasController]="aliasController"\n        [functionsOnly]="false"\n        [entityAliases]="dashboard.configuration.entityAliases"\n        [dashboardStates]="dashboard.configuration.states"\n        formControlName="widgetConfig">\n      </tb-widget-config>\n    </fieldset>\n  </div>\n  <div mat-dialog-actions fxLayoutAlign="end center">\n    <button mat-raised-button color="primary"\n            type="submit"\n            [disabled]="(isLoading$ | async) || widgetFormGroup.invalid">\n      {{ \'action.add\' | translate }}\n    </button>\n    <button mat-button color="primary"\n            type="button"\n            [disabled]="(isLoading$ | async)"\n            (click)="cancel()"\n            cdkFocusInitial>\n      {{ \'action.cancel\' | translate }}\n    </button>\n  </div>\n</form>\n'},lfP9:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host {\n  width: 100%;\n  height: 100%;\n}\n:host .tb-entity-table .tb-entity-table-content {\n  width: 100%;\n  height: 100%;\n  background: #fff;\n}\n:host .tb-entity-table .tb-entity-table-content .mat-toolbar-tools {\n  min-height: auto;\n}\n:host .tb-entity-table .tb-entity-table-content .title-container {\n  overflow: hidden;\n}\n:host .tb-entity-table .tb-entity-table-content .tb-entity-table-title {\n  padding-right: 20px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n:host .tb-entity-table .tb-entity-table-content .table-container {\n  overflow: auto;\n}\n:host .tb-entity-table .tb-entity-table-content .tb-entity-table-info {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n:host .tb-entity-table .tb-entity-table-content .button-widget-action {\n  margin-left: auto;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n@media screen and (max-width: 599px) {\n  :host .mat-toolbar {\n    height: auto;\n    min-height: 100px;\n  }\n  :host .mat-toolbar .tb-entity-table-title {\n    padding-bottom: 5px;\n    width: 100%;\n  }\n}\n:host ::ng-deep .mat-sort-header-sorted .mat-sort-header-arrow {\n  opacity: 1 !important;\n}\n:host ::ng-deep mat-form-field.tb-attribute-scope {\n  font-size: 16px;\n  width: 200px;\n}\n:host ::ng-deep mat-form-field.tb-attribute-scope .mat-form-field-wrapper {\n  padding-bottom: 0;\n}\n:host ::ng-deep mat-form-field.tb-attribute-scope .mat-form-field-underline {\n  bottom: 0;\n}\n@media screen and (max-width: 599px) {\n  :host ::ng-deep mat-form-field.tb-attribute-scope {\n    width: 100%;\n  }\n  :host ::ng-deep mat-form-field.tb-attribute-scope .mat-form-field-infix {\n    width: auto !important;\n  }\n}\n:host ::ng-deep mat-cell.tb-value-cell {\n  cursor: pointer;\n}\n:host ::ng-deep mat-cell.tb-value-cell mat-icon {\n  height: 24px;\n  width: 24px;\n  font-size: 24px;\n  color: #757575;\n}\n:host ::ng-deep .carousel .aniT {\n  transition: all 1s linear;\n}\n:host ::ng-deep .carousel .transition {\n  transition: all 0.3s ease-in-out !important;\n}\n:host ::ng-deep .carousel .content {\n  display: -ms-flexbox;\n  display: flex;\n  height: 100%;\n}\n:host ::ng-deep .carousel .content .item {\n  position: relative;\n}\n:host ::ng-deep .carousel .direction {\n  width: 60px;\n}\n:host ::ng-deep .carousel .ball {\n  width: 10px;\n  height: 10px;\n  border-radius: 50%;\n  background: black;\n  border: 2px solid;\n  opacity: 0.5;\n}\n:host ::ng-deep .carousel .ball.visible {\n  opacity: 1;\n}\n:host ::ng-deep .carousel ul.indicators {\n  pointer-events: none;\n}\n:host ::ng-deep .carousel ul.indicators li {\n  pointer-events: all;\n}'},llUh:function(t,e,n){"use strict";n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return u}));var i=n("mrSG"),a=n("ea4N"),o=n("TYT/"),r=n("6onV"),s=n("DUip"),l=n("RxGS"),c=n("QJY3"),d=new o.InjectionToken("ConfigDialogData"),u=function(t){function e(e,n,i,a,o){var r=t.call(this,e)||this;return r.store=e,r.router=n,r.dialogRef=i,r.fb=a,r.data=o,r.validators=c.Validators,r.data.controller(r),r}return Object(i.d)(e,t),e=Object(i.c)([Object(i.h)(4,Object(o.Inject)(d)),Object(i.g)("design:paramtypes",[r.Store,s.Router,a.MatDialogRef,c.FormBuilder,Object])],e)}(l.a)},mAYL:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var i=n("mrSG"),a=n("TYT/"),o=n("MqYC"),r=n("ea4N"),s=n("6onV"),l=n("QJY3"),c=n("DUip"),d=n("gmuX"),u=n("OiFK"),h=n("o8Qb"),p=n("//Q6"),m=n("4j5O"),g=n("DkIy"),f=function(t){function e(e,n,i,a,o,r,s,c,d,u){var h=t.call(this,e,n,o)||this;return h.store=e,h.router=n,h.data=i,h.errorStateMatcher=a,h.dialogRef=o,h.fb=r,h.utils=s,h.dashboardUtils=c,h.translate=d,h.statesControllerService=u,h.submitted=!1,h.stateControllerIds=Object.keys(h.statesControllerService.getStateControllers()),h.settings=h.data.settings,h.gridSettings=h.data.gridSettings,h.settings?(h.settingsFormGroup=h.fb.group({stateControllerId:[Object(p.u)(h.settings.stateControllerId)?"entity":h.settings.stateControllerId,[]],toolbarAlwaysOpen:[!!Object(p.u)(h.settings.toolbarAlwaysOpen)||h.settings.toolbarAlwaysOpen,[]],showTitle:[!!Object(p.u)(h.settings.showTitle)||h.settings.showTitle,[]],titleColor:[Object(p.u)(h.settings.titleColor)?"rgba(0,0,0,0.870588)":h.settings.titleColor,[]],showDashboardsSelect:[!!Object(p.u)(h.settings.showDashboardsSelect)||h.settings.showDashboardsSelect,[]],showEntitiesSelect:[!!Object(p.u)(h.settings.showEntitiesSelect)||h.settings.showEntitiesSelect,[]],showDashboardTimewindow:[!!Object(p.u)(h.settings.showDashboardTimewindow)||h.settings.showDashboardTimewindow,[]],showDashboardExport:[!!Object(p.u)(h.settings.showDashboardExport)||h.settings.showDashboardExport,[]]}),h.settingsFormGroup.get("stateControllerId").valueChanges.subscribe((function(t){"default"!==t&&h.settingsFormGroup.get("toolbarAlwaysOpen").setValue(!0)}))):h.settingsFormGroup=h.fb.group({}),h.gridSettings?h.gridSettingsFormGroup=h.fb.group({color:[h.gridSettings.color||"rgba(0,0,0,0.870588)",[]],columns:[h.gridSettings.columns||24,[l.Validators.required,l.Validators.min(10),l.Validators.max(1e3)]],margin:[Object(p.k)(h.gridSettings.margin)?h.gridSettings.margin:10,[l.Validators.required,l.Validators.min(0),l.Validators.max(50)]],autoFillHeight:[!Object(p.u)(h.gridSettings.autoFillHeight)&&h.gridSettings.autoFillHeight,[]],backgroundColor:[h.gridSettings.backgroundColor||"rgba(0,0,0,0)",[]],backgroundImageUrl:[h.gridSettings.backgroundImageUrl,[]],backgroundSizeMode:[h.gridSettings.backgroundSizeMode||"100%",[]],mobileAutoFillHeight:[!Object(p.u)(h.gridSettings.mobileAutoFillHeight)&&h.gridSettings.mobileAutoFillHeight,[]],mobileRowHeight:[Object(p.u)(h.gridSettings.mobileRowHeight)?70:h.gridSettings.mobileRowHeight,[l.Validators.required,l.Validators.min(5),l.Validators.max(200)]]}):h.gridSettingsFormGroup=h.fb.group({}),h}var d;return Object(i.d)(e,t),d=e,e.prototype.ngOnInit=function(){},e.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=!!(t&&t.invalid&&this.submitted);return n||i},e.prototype.cancel=function(){this.dialogRef.close(null)},e.prototype.save=function(){this.submitted=!0;var t=null,e=null;this.settings&&(t=Object(i.a)(Object(i.a)({},this.settings),this.settingsFormGroup.value)),this.gridSettings&&(e=Object(i.a)(Object(i.a)({},this.gridSettings),this.gridSettingsFormGroup.value)),this.dialogRef.close({settings:t,gridSettings:e})},e.ctorParameters=function(){return[{type:s.Store},{type:c.Router},{type:void 0,decorators:[{type:a.Inject,args:[r.MAT_DIALOG_DATA]}]},{type:o.d,decorators:[{type:a.SkipSelf}]},{type:r.MatDialogRef},{type:l.FormBuilder},{type:u.a},{type:m.a},{type:h.TranslateService},{type:g.a}]},e=d=Object(i.c)([Object(a.Component)({selector:"tb-dashboard-settings-dialog",template:Object(i.f)(n("Q4qZ")).default,providers:[{provide:o.d,useExisting:d}],styles:[Object(i.f)(n("60Fo")).default]}),Object(i.h)(2,Object(a.Inject)(r.MAT_DIALOG_DATA)),Object(i.h)(3,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[s.Store,c.Router,Object,o.d,r.MatDialogRef,l.FormBuilder,u.a,m.a,h.TranslateService,g.a])],e)}(d.a)},mopS:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n("mrSG"),a=n("TYT/"),o=n("Y8nr"),r=n("cUzu"),s=function(){function t(t){this.http=t}return t.prototype.getEvents=function(t,e,n,i,a){return this.http.get("/api/events/"+t.entityType+"/"+t.id+"/"+e+i.toQuery()+"&tenantId="+n,Object(o.b)(a))},t.ctorParameters=function(){return[{type:r.b}]},t=Object(i.c)([Object(a.Injectable)({providedIn:"root"}),Object(i.g)("design:paramtypes",[r.b])],t)}()},n3Zx:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div fxLayout="column" class="tb-entity-filter-view">\n  <div *ngIf="!filter || !filter.type; else filterView" class="entity-filter-empty" translate>alias.no-entity-filter-specified</div>\n  <ng-template #filterView>\n    <div fxLayout="column">\n      <div class="entity-filter-value">{{ filterDisplayValue }}</div>\n    </div>\n  </ng-template>\n</div>\n'},n4i3:function(t,e,n){"use strict";n.d(e,"a",(function(){return m})),n.d(e,"b",(function(){return g}));var i=n("mrSG"),a=n("Hl1W"),o=n("3QxM"),r=n("bHFI"),s=n("seHC"),l=n("3Tyt"),c=n("BsGH"),d=n("o8Qb"),u=n("OiFK"),h=n("LvDl"),p=n.n(h),m=function(){function t(t,e,n,i,o){var r,h=this;this.mapProvider=t,this.drawRoutes=e,this.ctx=n,this.translate=function(t,e){return t?h.ctx.$injector.get(u.a).customTranslation(t,e||t)||h.ctx.$injector.get(d.TranslateService).instant(t):""},this.setMarkerLocation=function(t){var e=h.ctx.$injector.get(c.a),n={entityType:t.$datasource.entityType,id:t.$datasource.entityId},i=[],a=[],o=[h.settings.latKeyName,h.settings.lngKeyName,h.settings.xPosKeyName,h.settings.yPosKeyName];t.$datasource.dataKeys.forEach((function(e){if(o.includes(e.name)){var n={key:e.name,value:t[e.name]};e.type===l.c.attribute&&i.push(n),e.type===l.c.timeseries&&a.push(n)}})),a.length&&e.saveEntityTimeseries(n,l.e.LATEST_TELEMETRY,a).subscribe((function(){})),i.length&&e.saveEntityAttributes(n,l.a.SERVER_SCOPE,i).subscribe((function(){}))},this.map&&(this.map.map.remove(),delete this.map),this.data=n.data,i||(i=n.$container[0]),this.settings=this.initSettings(n.settings),o&&(this.settings.draggableMarker=!0),this.settings.tooltipAction=this.getDescriptors("tooltipAction"),this.settings.markerClick=this.getDescriptors("markerClick"),this.settings.polygonClick=this.getDescriptors("polygonClick");var p=null===(r=a.d[this.provider])||void 0===r?void 0:r.MapClass;p&&(s.l.setTranslate(this.translate),this.map=new p(this.ctx,i,this.settings),this.map.saveMarkerLocation=this.setMarkerLocation,this.settings.draggableMarker&&this.map.setDataSources(Object(s.j)(this.data)))}return t.dataKeySettingsSchema=function(){return{}},t.getProvidersSchema=function(t,e){var n,s;void 0===e&&(e=!1);var l=p.a.cloneDeep(o.f);return t&&(l.schema.properties.provider.default=t),e&&(l.form[0].items=null===(n=l.form[0])||void 0===n?void 0:n.items.filter((function(t){return"image-map"!==t.value}))),Object(r.e)(Object(i.l)([l],null===(s=Object.keys(a.d))||void 0===s?void 0:s.map((function(t){var e,n=a.d[t];return Object(r.a)(null===(e=n)||void 0===e?void 0:e.schema,"model.provider === '"+n.name+"'")}))))},t.settingsSchema=function(t,e){var n=Object(r.d)();if(Object(r.c)(n,this.getProvidersSchema(t)),Object(r.b)(n,"Map Provider Settings"),Object(r.c)(n,o.a),Object(r.b)(n,"Common Map Settings"),Object(r.c)(n,Object(r.a)(o.e,"model.showPolygon === true",["showPolygon"])),Object(r.b)(n,"Polygon Settings"),e)Object(r.c)(n,o.l),Object(r.b)(n,"Route Map Settings");else{var i=Object(r.e)([o.g,Object(r.a)(o.h,'model.useClusterMarkers === true && model.provider !== "image-map"')]);Object(r.c)(n,i),Object(r.b)(n,"Markers Clustering Settings")}return n},t.actionSources=function(){return{markerClick:{name:"widget-action.marker-click",multiple:!1},polygonClick:{name:"widget-action.polygon-click",multiple:!1},tooltipAction:{name:"widget-action.tooltip-tag-action",multiple:!0}}},t.prototype.getDescriptors=function(t){var e=this,n=this.ctx.actionsApi.getActionDescriptors(t),i={};return n.forEach((function(t){i[t.name]=function(n,i){return e.onCustomAction(t,n,i)}}),i),i},t.prototype.onInit=function(){},t.prototype.onCustomAction=function(t,e,n){e&&(e.preventDefault(),e.stopPropagation());var i=n.entityId,a=n.entityName,o=n.entityLabel,r=n.entityType;this.ctx.actionsApi.handleWidgetAction(e,t,{entityType:r,id:i},a,null,o)},t.prototype.initSettings=function(t){var e,n,o,r=["data","dsData","dsIndex"];this.provider=t.provider||this.mapProvider,this.provider!==a.a.here||t.mapProviderHere||(t.mapProvider&&a.c.includes(t.mapProvider)?t.mapProviderHere=t.mapProvider:t.mapProviderHere=a.c[0]);var l={provider:this.provider,mapUrl:null===(e=t)||void 0===e?void 0:e.mapImageUrl,labelFunction:Object(s.k)(t.labelFunction,r),tooltipFunction:Object(s.k)(t.tooltipFunction,r),colorFunction:Object(s.k)(t.colorFunction,r),polygonColorFunction:Object(s.k)(t.polygonColorFunction,r),polygonTooltipFunction:Object(s.k)(t.polygonTooltipFunction,r),markerImageFunction:Object(s.k)(t.markerImageFunction,["data","images","dsData","dsIndex"]),labelColor:this.ctx.widgetConfig.color,polygonKeyName:t.polKeyName?t.polKeyName:t.polygonKeyName,tooltipPattern:t.tooltipPattern||"<b>${entityName}</b><br/><br/><b>Latitude:</b> ${"+t.latKeyName+":7}<br/><b>Longitude:</b> ${"+t.lngKeyName+":7}",defaultCenterPosition:Object(s.f)(null===(n=t)||void 0===n?void 0:n.defaultCenterPosition),currentImage:(null===(o=t.markerImage)||void 0===o?void 0:o.length)?{url:t.markerImage,size:t.markerImageSize||34}:null};return Object(i.a)(Object(i.a)(Object(i.a)({},a.b),t),l)},t.prototype.update=function(){this.drawRoutes&&this.map.updatePolylines(Object(s.i)(this.data)),this.settings.showPolygon&&this.map.updatePolygons(Object(s.j)(this.data)),this.map.updateMarkers(Object(s.j)(this.data))},t.prototype.resize=function(){var t;null===(t=this.map)||void 0===t||t.invalidateSize(),this.map.onResize()},t.prototype.onDestroy=function(){},t}(),g=m},n7d0:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div class="entity-state-controller">\n  <div *ngIf="!isMobile || stateObject.length === 1" fxLayout="row" fxLayoutAlign="start center">\n        <span *ngFor="let state of stateObject; index as i; last as isLast" class="state-entry" [ngStyle]="{fontWeight: isLast ? \'bold\' : \'normal\',\n                         cursor: isLast ? \'default\' : \'pointer\'}" (click)="navigatePrevState(i)">\n            {{getStateName(i)}}\n          <span class=\'state-divider\' [fxHide]="isLast"> > </span>\n        </span>\n  </div>\n  <mat-select *ngIf="isMobile && stateObject.length > 1"\n              [(ngModel)]="selectedStateIndex" (ngModelChange)="selectedStateIndexChanged()">\n    <mat-option *ngFor="let state of stateObject; index as i" [value]="i">\n      {{getStateName(i)}}\n    </mat-option>\n  </mat-select>\n</div>\n\n\n\n'},nFIZ:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div fxLayout="column" class="mat-content mat-padding">\n  <label class="tb-title" translate>alarm.alarm-status-filter</label>\n  <mat-radio-group [(ngModel)]="subscription.alarmSearchStatus" fxLayout="column" fxLayoutGap="16px">\n    <mat-radio-button *ngFor="let searchStatus of alarmSearchStatuses" [value]="searchStatus" color="primary">\n      {{ alarmSearchStatusTranslationMap.get(alarmSearchStatusEnum[searchStatus]) | translate }}\n    </mat-radio-button>\n  </mat-radio-group>\n</div>\n'},nFN6:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .tb-progress-cover {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  z-index: 6;\n  opacity: 1;\n}\n:host .tb-dashboard-content {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  background: none;\n  outline: none;\n}\n:host .tb-dashboard-content gridster-item {\n  transition: none;\n  overflow: visible;\n  background: none;\n}\n:host #gridster-child {\n  background: none;\n}\ntb-widget.tb-widget {\n  position: relative;\n  height: 100%;\n  margin: 0;\n  overflow: hidden;\n  outline: none;\n  transition: all 0.2s ease-in-out;\n}\ndiv.tb-widget {\n  position: relative;\n  height: 100%;\n  margin: 0;\n  overflow: hidden;\n  outline: none;\n  transition: all 0.2s ease-in-out;\n}\ndiv.tb-widget .tb-widget-title {\n  max-height: 65px;\n  padding-top: 5px;\n  padding-left: 5px;\n  overflow: hidden;\n}\ndiv.tb-widget .tb-widget-title tb-timewindow {\n  font-size: 14px;\n  opacity: 0.85;\n  margin: 0;\n}\ndiv.tb-widget .tb-widget-title .title {\n  width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  line-height: 24px;\n  letter-spacing: 0.01em;\n  margin: 0;\n  display: -webkit-box;\n  -webkit-box-orient: vertical;\n  -webkit-line-clamp: 2;\n}\ndiv.tb-widget .tb-widget-title .title.single-row {\n  -webkit-line-clamp: 1;\n}\ndiv.tb-widget .tb-widget-actions {\n  z-index: 19;\n  margin: 5px 0 0;\n}\ndiv.tb-widget .tb-widget-actions-absolute {\n  position: absolute;\n  top: 3px;\n  right: 8px;\n}\ndiv.tb-widget .tb-widget-actions button.mat-icon-button {\n  width: 32px;\n  min-width: 32px;\n  height: 32px;\n  min-height: 32px;\n  padding: 0 !important;\n  margin: 0 !important;\n  line-height: 20px;\n}\ndiv.tb-widget .tb-widget-actions button.mat-icon-button mat-icon {\n  width: 20px;\n  min-width: 20px;\n  height: 20px;\n  min-height: 20px;\n  font-size: 20px;\n  line-height: 20px;\n}\ndiv.tb-widget .tb-widget-content tb-widget {\n  position: relative;\n  width: 100%;\n}\ndiv.tb-widget.tb-highlighted {\n  border: 1px solid #039be5;\n  box-shadow: 0 0 20px #039be5;\n}\ndiv.tb-widget.tb-not-highlighted {\n  opacity: 0.5;\n}\n.tb-dashboard-context-menu-items {\n  min-width: 256px;\n}'},nPkc:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n.tb-web-camera {\n  height: 100%;\n}\n.tb-web-camera__last-photo {\n  width: 100%;\n  margin: 5px 0;\n  text-align: center;\n  border: solid 1px;\n}\n.tb-web-camera__last-photo_text {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  margin-top: -0.625em;\n  transform: translate(-50%, -50%);\n}\n.tb-web-camera__last-photo_img {\n  width: 100%;\n  height: 100%;\n  -o-object-fit: contain;\n     object-fit: contain;\n}\n.tb-web-camera .camera-container {\n  height: 100%;\n}\n.tb-web-camera .camera {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n}\n.tb-web-camera .camera .camera-stream {\n  display: block;\n  width: 100%;\n  height: 100%;\n  -o-object-fit: contain;\n     object-fit: contain;\n}\n.tb-web-camera .camera .camera-controls {\n  position: absolute;\n  bottom: 0;\n  width: 100%;\n  padding: 0 5px 5px;\n}\n.tb-web-camera .camera .camera-controls .mat-button-base {\n  margin: 6px 8px;\n}\n.tb-web-camera .message-text {\n  font-size: 18px;\n  color: #a0a0a0;\n  text-align: center;\n}'},nYlx:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<mat-toolbar fxLayout="row" color="primary">\n  <h2 translate>{{ title }}</h2>\n  <span fxFlex></span>\n  <button mat-button mat-icon-button\n          [mat-dialog-close]="false"\n          type="button">\n    <mat-icon class="material-icons">close</mat-icon>\n  </button>\n</mat-toolbar>\n<div mat-dialog-content fxLayout="column">\n  <div #eventContentEditor class="tb-event-content">\n  </div>\n</div>\n<div mat-dialog-actions fxLayout="row">\n  <span fxFlex></span>\n  <button mat-button color="primary"\n          style="margin-right: 20px;"\n          type="button"\n          [disabled]="(isLoading$ | async)"\n          [mat-dialog-close]="false" cdkFocusInitial>\n    {{ \'action.close\' | translate }}\n  </button>\n</div>\n'},ncsw:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var i=n("mrSG"),a=n("TYT/"),o=n("2lgB"),r=n("OiFK"),s=n("0lYY"),l=n("UrOe"),c=n("//Q6"),d=function(){function t(t,e){this.telemetryService=t,this.utils=e,this.subscriptions={}}return t.prototype.subscribeToDatasource=function(t){var e=t.datasource;if(e.type!==s.a.entity||t.entityId&&t.entityType){var n=[];e.dataKeys.forEach((function(t){var e={name:t.name,type:t.type,funcBody:t.funcBody,postFuncBody:t.postFuncBody};n.push(e)}));var i,a={datasourceType:e.type,dataKeys:n,type:t.subscriptionType};t.subscriptionType===s.k.timeseries&&(a.subscriptionTimewindow=Object(c.d)(t.subscriptionTimewindow)),a.datasourceType===s.a.entity&&(a.entityType=t.entityType,a.entityId=t.entityId),t.datasourceSubscriptionKey=Object(c.x)(a),this.subscriptions[t.datasourceSubscriptionKey]?(i=this.subscriptions[t.datasourceSubscriptionKey]).syncListener(t):(i=new l.a(a,this.telemetryService,this.utils),this.subscriptions[t.datasourceSubscriptionKey]=i,i.start()),i.addListener(t)}},t.prototype.unsubscribeFromDatasource=function(t){if(t.datasourceSubscriptionKey){var e=this.subscriptions[t.datasourceSubscriptionKey];e&&(e.removeListener(t),e.hasListeners()||(e.unsubscribe(),delete this.subscriptions[t.datasourceSubscriptionKey])),t.datasourceSubscriptionKey=null}},t.ctorParameters=function(){return[{type:o.a},{type:r.a}]},t=Object(i.c)([Object(a.Injectable)({providedIn:"root"}),Object(i.g)("design:paramtypes",[o.a,r.a])],t)}()},oEEf:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div class="tb-absolute-fill" [fxLayout]="legendContainerLayoutType">\n  <tb-legend *ngIf="displayLegend && isLegendFirst"\n             [ngStyle]="legendStyle"\n             [legendConfig]="legendConfig"\n             [legendData]="legendData"\n             (legendKeyHiddenChange)="onLegendKeyHiddenChange($event)">\n  </tb-legend>\n  <div fxFlex id="widget-container">\n    <ng-container #widgetContent></ng-container>\n  </div>\n  <tb-legend *ngIf="displayLegend && !isLegendFirst"\n             [ngStyle]="legendStyle"\n             [legendConfig]="legendConfig"\n             [legendData]="legendData"\n             (legendKeyHiddenChange)="onLegendKeyHiddenChange($event)">\n  </tb-legend>\n</div>\n<div class="tb-absolute-fill tb-widget-error" *ngIf="widgetErrorData">\n  <span>Widget Error: {{ widgetErrorData.name + ": " + widgetErrorData.message}}</span>\n</div>\n<div class="tb-absolute-fill tb-widget-loading" [fxShow]="loadingData" fxLayout="column" fxLayoutAlign="center center">\n  <mat-spinner color="accent" md-mode="indeterminate" diameter="40"></mat-spinner>\n</div>\n'},oTDE:function(t,e,n){"use strict";n.d(e,"b",(function(){return w})),n.d(e,"a",(function(){return x}));var i=n("mrSG"),a=n("LvDl"),o=n.n(a),r=n("Zss7"),s=n.n(r),l=n("TYT/"),c=n("n4i3"),d=n("Hl1W"),u=n("bHFI"),h=n("3QxM"),p=n("E1rE"),m=n("0G7Z"),g=n("seHC"),f=n("wd/R"),b=n.n(f),y=n("//Q6"),v=n("HR/i"),w=function(){function t(t,e){var n=this;this.cd=t,this.sanitizer=e,this.interpolatedTimeData=[],this.mainTooltip="",this.visibleTooltip=!1,this.anchors=[],this.calcTooltip=function(t){var e=t||n.activeTrip,i=n.settings.useTooltipFunction?Object(g.m)(n.settings.tooltipFunction,[e,n.historicalData,t.dsIndex]):n.settings.tooltipPattern,a=g.l.parseTemplate(i,e,!0);return n.mainTooltip=n.sanitizer.sanitize(l.SecurityContext.HTML,a),n.cd.detectChanges(),n.activeTrip=t,a}}return t.getSettingsSchema=function(){var t=Object(u.d)();return Object(u.c)(t,c.b.getProvidersSchema(null,!0)),Object(u.b)(t,"Map Provider Settings"),Object(u.c)(t,h.n),Object(u.b)(t,"Trip Animation Settings"),Object(u.c)(t,h.j),Object(u.b)(t,"Path Settings"),Object(u.c)(t,Object(u.a)(h.k,"model.showPoints === true",["showPoints"])),Object(u.b)(t,"Path Points Settings"),Object(u.c)(t,Object(u.a)(h.e,"model.showPolygon === true",["showPolygon"])),Object(u.b)(t,"Polygon Settings"),t},t.prototype.ngOnInit=function(){var t=this;this.widgetConfig=this.ctx.widgetConfig;var e={normalizationStep:1e3,showLabel:!1,buttonColor:s()(this.widgetConfig.color).setAlpha(.54).toRgbString(),disabledButtonColor:s()(this.widgetConfig.color).setAlpha(.3).toRgbString(),rotationAngle:0};this.settings=Object(i.a)(Object(i.a)({},e),this.ctx.settings),this.useAnchors=this.settings.showPoints&&this.settings.usePointAsAnchor,this.settings.pointAsAnchorFunction=Object(g.k)(this.settings.pointAsAnchorFunction,["data","dsData","dsIndex"]),this.settings.tooltipFunction=Object(g.k)(this.settings.tooltipFunction,["data","dsData","dsIndex"]),this.settings.labelFunction=Object(g.k)(this.settings.labelFunction,["data","dsData","dsIndex"]),this.normalizationStep=this.settings.normalizationStep;var n=this.ctx.subscriptions[Object.keys(this.ctx.subscriptions)[0]];n&&(n.callbacks.onDataUpdated=function(){var e;t.historicalData=Object(g.i)(t.ctx.data).filter((function(t){return t.length})),t.historicalData.length&&(t.calculateIntervals(),t.timeUpdated(t.currentTime&&t.currentTime>t.minTime?t.currentTime:t.minTime)),null===(e=t.mapWidget.map.map)||void 0===e||e.invalidateSize(),t.cd.detectChanges()})},t.prototype.ngAfterViewInit=function(){var t=this,e=o.a.cloneDeep(this.ctx);this.mapWidget=new c.a(d.a.openstreet,!1,e,this.mapContainer.nativeElement),this.mapResize$=new v.a((function(){t.mapWidget.resize()})),this.mapResize$.observe(this.mapContainer.nativeElement)},t.prototype.ngOnDestroy=function(){this.mapResize$&&this.mapResize$.disconnect()},t.prototype.timeUpdated=function(t){var e=this;this.currentTime=t;var n=this.interpolatedTimeData.map((function(e){return e[t]})).filter((function(t){return t}));if(Object(y.u)(n[0]))for(var a=Object.keys(this.interpolatedTimeData[0]).map((function(t){return parseInt(t,10)})),r=1;r<a.length;r++)if(a[r-1]<t&&a[r]>t){var s=this.interpolatedTimeData[0][a[r-1]],l=this.interpolatedTimeData[0][a[r]],c=Object(g.g)(a[r-1],a[r],t);n[0]=Object(i.a)(Object(i.a)(Object(i.a)({},s),{time:t}),Object(g.h)(s,l,this.settings.latKeyName,this.settings.lngKeyName,c));break}this.calcLabel(),this.calcTooltip(n.find((function(t){return t.entityName===e.activeTrip.entityName}))),this.mapWidget&&(this.mapWidget.map.updatePolylines(this.interpolatedTimeData.map((function(t){return o.a.values(t)})),this.activeTrip),this.settings.showPolygon&&this.mapWidget.map.updatePolygons(this.interpolatedTimeData),this.settings.showPoints&&this.mapWidget.map.updatePoints(o.a.values(o.a.union(this.interpolatedTimeData)[0]),this.calcTooltip),this.mapWidget.map.updateMarkers(n,(function(t){e.activeTrip=t,e.timeUpdated(e.currentTime)})))},t.prototype.setActiveTrip=function(){},t.prototype.calculateIntervals=function(){var t=this;if(this.historicalData.forEach((function(e,n){var i,a;t.minTime=(null===(i=e[0])||void 0===i?void 0:i.time)||1/0,t.maxTime=(null===(a=e[e.length-1])||void 0===a?void 0:a.time)||-1/0,t.interpolatedTimeData[n]=t.interpolateArray(e)})),this.activeTrip||(this.activeTrip=this.interpolatedTimeData.map((function(e){return e[t.minTime]})).filter((function(t){return t}))[0]),this.useAnchors){var e=Object.entries(o.a.union(this.interpolatedTimeData)[0]);this.anchors=e.filter((function(n){return Object(g.m)(t.settings.pointAsAnchorFunction,[n[1],e,n[1].dsIndex])})).map((function(t){return parseInt(t[0],10)}))}},t.prototype.calcLabel=function(){var t=this.activeTrip,e=this.settings.useLabelFunction?Object(g.m)(this.settings.labelFunction,[t,this.historicalData,t.dsIndex]):this.settings.label;this.label=g.l.parseTemplate(e,t,!0)},t.prototype.interpolateArray=function(t){for(var e={},n=this.settings.latKeyName,a=this.settings.lngKeyName,o=0,r=t;o<r.length;o++){var s=r[o],l=s.time;e[this.minTime+Math.ceil((l-this.minTime)/this.normalizationStep)*this.normalizationStep]=Object(i.a)(Object(i.a)({},s),{minTime:this.minTime!==1/0?b()(this.minTime).format("YYYY-MM-DD HH:mm:ss"):"",maxTime:this.maxTime!==-1/0?b()(this.maxTime).format("YYYY-MM-DD HH:mm:ss"):"",rotationAngle:this.settings.rotationAngle})}for(var c=Object.keys(e),d=0;d<c.length-1;d++)e[c[d]].rotationAngle+=Object(g.e)(e[c[d]],e[c[d+1]],n,a);return e},t.ctorParameters=function(){return[{type:l.ChangeDetectorRef},{type:p.b}]},Object(i.c)([Object(l.Input)(),Object(i.g)("design:type",m.c)],t.prototype,"ctx",void 0),Object(i.c)([Object(l.ViewChild)("map"),Object(i.g)("design:type",Object)],t.prototype,"mapContainer",void 0),t=Object(i.c)([Object(l.Component)({selector:"trip-animation",template:Object(i.f)(n("tdBX")).default,styles:[Object(i.f)(n("JIWx")).default]}),Object(i.g)("design:paramtypes",[l.ChangeDetectorRef,p.b])],t)}(),x=w},ou6H:function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var i=n("mrSG"),a=n("TYT/"),o=n("MqYC"),r=n("ea4N"),s=n("6onV"),l=n("QJY3"),c=n("DUip"),d=n("gmuX"),u=n("xKAQ"),h=function(t){function e(e,n,i,a,o,r){var s=t.call(this,e,n,o)||this;return s.store=e,s.router=n,s.data=i,s.errorStateMatcher=a,s.dialogRef=o,s.fb=r,s.submitted=!1,s.importTitle=i.importTitle,s.importFileLabel=i.importFileLabel,s.importFormGroup=s.fb.group({jsonContent:[null,[l.Validators.required]]}),s}var d;return Object(i.d)(e,t),d=e,e.prototype.ngOnInit=function(){},e.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=!!(t&&t.invalid&&this.submitted);return n||i},e.prototype.loadDataFromJsonContent=function(t){try{return JSON.parse(t)}catch(e){return this.store.dispatch(new u.b({message:e.message,type:"error"})),null}},e.prototype.cancel=function(){this.dialogRef.close(null)},e.prototype.importFromJson=function(){this.submitted=!0;var t=this.importFormGroup.get("jsonContent").value;this.dialogRef.close(t)},e.ctorParameters=function(){return[{type:s.Store},{type:c.Router},{type:void 0,decorators:[{type:a.Inject,args:[r.MAT_DIALOG_DATA]}]},{type:o.d,decorators:[{type:a.SkipSelf}]},{type:r.MatDialogRef},{type:l.FormBuilder}]},e=d=Object(i.c)([Object(a.Component)({selector:"tb-import-dialog",template:Object(i.f)(n("dSgL")).default,providers:[{provide:o.d,useExisting:d}]}),Object(i.h)(2,Object(a.Inject)(r.MAT_DIALOG_DATA)),Object(i.h)(3,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[s.Store,c.Router,Object,o.d,r.MatDialogRef,l.FormBuilder])],e)}(d.a)},ou9H:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n("mrSG"),a=n("MGBS"),o=n("zotm");function r(t,e){return function(n){return n.lift(new s(t,e))}}var s=function(){function t(t,e){this.keySelector=t,this.flushes=e}return t.prototype.call=function(t,e){return e.subscribe(new l(t,this.keySelector,this.flushes))},t}(),l=function(t){function e(e,n,i){var a=t.call(this,e)||this;return a.keySelector=n,a.values=new Set,i&&a.add(Object(o.a)(a,i)),a}return i.d(e,t),e.prototype.notifyNext=function(t,e,n,i,a){this.values.clear()},e.prototype.notifyError=function(t,e){this._error(t)},e.prototype._next=function(t){this.keySelector?this._useKeySelector(t):this._finalizeNext(t,t)},e.prototype._useKeySelector=function(t){var e,n=this.destination;try{e=this.keySelector(t)}catch(i){return void n.error(i)}this._finalizeNext(e,t)},e.prototype._finalizeNext=function(t,e){var n=this.values;n.has(t)||(n.add(t),this.destination.next(e))},e}(a.a)},owmp:function(t,e,n){!function(t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var e,n,i,a=function(t,e){return(180*Math.atan2(e.y-t.y,e.x-t.x)/Math.PI+90+360)%360},o=function(t,e){var n=t.value;return t.isInPixels?n/e:n};function r(t){if("string"==typeof t&&-1!==t.indexOf("%"))return{value:parseFloat(t)/100,isInPixels:!1};var e=t?parseFloat(t):0;return{value:e,isInPixels:e>0}}function s(t){return t.reduce((function(t,e,n,i){if(n>0&&!function(t,e){return t.x===e.x&&t.y===e.y}(e,i[n-1])){var o=i[n-1],r=t.length>0?t[t.length-1].distB:0,s=(l=o,d=(c=e).x-l.x,u=c.y-l.y,Math.sqrt(d*d+u*u));t.push({a:o,b:e,distA:r,distB:r+s,heading:a(o,e)})}var l,c,d,u;return t}),[])}e=L.Marker.prototype._initIcon,n=L.Marker.prototype._setPos,i="msTransform"===L.DomUtil.TRANSFORM,L.Marker.addInitHook((function(){var t=this.options.icon&&this.options.icon.options&&this.options.icon.options.iconAnchor;t&&(t=t[0]+"px "+t[1]+"px"),this.options.rotationOrigin=this.options.rotationOrigin||t||"center bottom",this.options.rotationAngle=this.options.rotationAngle||0,this.on("drag",(function(t){t.target._applyRotation()}))})),L.Marker.include({_initIcon:function(){e.call(this)},_setPos:function(t){n.call(this,t),this._applyRotation()},_applyRotation:function(){this.options.rotationAngle&&(this._icon.style[L.DomUtil.TRANSFORM+"Origin"]=this.options.rotationOrigin,i?this._icon.style[L.DomUtil.TRANSFORM]="rotate("+this.options.rotationAngle+"deg)":this._icon.style[L.DomUtil.TRANSFORM]+=" rotateZ("+this.options.rotationAngle+"deg)")},setRotationAngle:function(t){return this.options.rotationAngle=t,this.update(),this},setRotationOrigin:function(t){return this.options.rotationOrigin=t,this.update(),this}}),t.Symbol=t.Symbol||{},t.Symbol.Dash=t.Class.extend({options:{pixelSize:10,pathOptions:{}},initialize:function(e){t.Util.setOptions(this,e),this.options.pathOptions.clickable=!1},buildSymbol:function(e,n,i,a,o){var r=this.options,s=Math.PI/180;if(r.pixelSize<=1)return t.polyline([e.latLng,e.latLng],r.pathOptions);var l=i.project(e.latLng),c=-(e.heading-90)*s,d=t.point(l.x+r.pixelSize*Math.cos(c+Math.PI)/2,l.y+r.pixelSize*Math.sin(c)/2),u=l.add(l.subtract(d));return t.polyline([i.unproject(d),i.unproject(u)],r.pathOptions)}}),t.Symbol.dash=function(e){return new t.Symbol.Dash(e)},t.Symbol.ArrowHead=t.Class.extend({options:{polygon:!0,pixelSize:10,headAngle:60,pathOptions:{stroke:!1,weight:2}},initialize:function(e){t.Util.setOptions(this,e),this.options.pathOptions.clickable=!1},buildSymbol:function(e,n,i,a,o){return this.options.polygon?t.polygon(this._buildArrowPath(e,i),this.options.pathOptions):t.polyline(this._buildArrowPath(e,i),this.options.pathOptions)},_buildArrowPath:function(e,n){var i=Math.PI/180,a=n.project(e.latLng),o=-(e.heading-90)*i,r=this.options.headAngle/2*i,s=o+r,l=o-r,c=t.point(a.x-this.options.pixelSize*Math.cos(s),a.y+this.options.pixelSize*Math.sin(s)),d=t.point(a.x-this.options.pixelSize*Math.cos(l),a.y+this.options.pixelSize*Math.sin(l));return[n.unproject(c),e.latLng,n.unproject(d)]}}),t.Symbol.arrowHead=function(e){return new t.Symbol.ArrowHead(e)},t.Symbol.Marker=t.Class.extend({options:{markerOptions:{},rotate:!1},initialize:function(e){t.Util.setOptions(this,e),this.options.markerOptions.clickable=!1,this.options.markerOptions.draggable=!1},buildSymbol:function(e,n,i,a,o){return this.options.rotate&&(this.options.markerOptions.rotationAngle=e.heading+(this.options.angleCorrection||0)),t.marker(e.latLng,this.options.markerOptions)}}),t.Symbol.marker=function(e){return new t.Symbol.Marker(e)};var l=function(e){return Array.isArray(e)&&((n=e[0])instanceof t.LatLng||Array.isArray(n)&&2===n.length&&"number"==typeof n[0]);var n};t.PolylineDecorator=t.FeatureGroup.extend({options:{patterns:[]},initialize:function(e,n){t.FeatureGroup.prototype.initialize.call(this),t.Util.setOptions(this,n),this._map=null,this._paths=this._initPaths(e),this._bounds=this._initBounds(),this._patterns=this._initPatterns(this.options.patterns)},_initPaths:function(e,n){var i=this;return l(e)?[n?e.concat([e[0]]):e]:e instanceof t.Polyline?this._initPaths(e.getLatLngs(),e instanceof t.Polygon):Array.isArray(e)?e.reduce((function(t,e){return t.concat(i._initPaths(e,n))}),[]):[]},_initPatterns:function(t){return t.map(this._parsePatternDef)},setPatterns:function(t){this.options.patterns=t,this._patterns=this._initPatterns(this.options.patterns),this.redraw()},setPaths:function(t){this._paths=this._initPaths(t),this._bounds=this._initBounds(),this.redraw()},_parsePatternDef:function(t,e){return{symbolFactory:t.symbol,offset:r(t.offset),endOffset:r(t.endOffset),repeat:r(t.repeat)}},onAdd:function(t){this._map=t,this._draw(),this._map.on("moveend",this.redraw,this)},onRemove:function(e){this._map.off("moveend",this.redraw,this),this._map=null,t.FeatureGroup.prototype.onRemove.call(this,e)},_initBounds:function(){var e=this._paths.reduce((function(t,e){return t.concat(e)}),[]);return t.latLngBounds(e)},getBounds:function(){return this._bounds},_buildSymbols:function(t,e,n){var i=this;return n.map((function(a,o){return e.buildSymbol(a,t,i._map,o,n.length)}))},_getDirectionPoints:function(e,n){var i=this;return e.length<2?[]:function(t,e){var n=s(t),i=n.length;if(0===i)return[];var a=n[i-1].distB,r=o(e.offset,a),l=o(e.endOffset,a),c=a*o(e.repeat,a),d=l>0?a*l:0,u=[],h=r>0?a*r:0;do{u.push(h),h+=c}while(c>0&&h<a-d);var p=0,m=n[0];return u.map((function(t){for(;t>m.distB&&p<i-1;)p++,m=n[p];var e,a,o,r=(t-m.distA)/(m.distB-m.distA);return{pt:(e=m.a,a=m.b,o=r,a.x!==e.x?{x:e.x+o*(a.x-e.x),y:e.y+o*(a.y-e.y)}:{x:e.x,y:e.y+(a.y-e.y)*o}),heading:m.heading}}))}(e.map((function(t){return i._map.project(t)})),n).map((function(e){return{latLng:i._map.unproject(t.point(e.pt)),heading:e.heading}}))},redraw:function(){this._map&&(this.clearLayers(),this._draw())},_getPatternLayers:function(e){var n=this,i=this._map.getBounds().pad(.1);return this._paths.map((function(a){var o=n._getDirectionPoints(a,e).filter((function(t){return i.contains(t.latLng)}));return t.featureGroup(n._buildSymbols(a,e.symbolFactory,o))}))},_draw:function(){var e=this;this._patterns.map((function(t){return e._getPatternLayers(t)})).forEach((function(n){e.addLayer(t.featureGroup(n))}))}}),t.polylineDecorator=function(e,n){return new t.PolylineDecorator(e,n)}}(n("4R65"))},"p/3Z":function(t,e,n){"use strict";n.d(e,"a",(function(){return p}));var i=n("mrSG"),a=n("TYT/"),o=n("ea4N"),r=n("6onV"),s=n("QJY3"),l=n("YnEf"),c=n("xKAQ"),d=n("o8Qb"),u=n("gmuX"),h=n("DUip"),p=function(t){function e(e,n,i,a,o,r,s){var l=t.call(this,e,n,r)||this;return l.store=e,l.router=n,l.data=i,l.translate=a,l.dashboardService=o,l.dialogRef=r,l.fb=s,l.dashboard=i.dashboard,l.publicLink=o.getPublicDashboardLink(l.dashboard),l}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){},e.prototype.close=function(){this.dialogRef.close()},e.prototype.onPublicLinkCopied=function(t){this.store.dispatch(new c.b({message:this.translate.instant("dashboard.public-link-copied-message"),type:"success",target:"makeDashboardPublicDialogContent",duration:750,verticalPosition:"bottom",horizontalPosition:"left"}))},e.ctorParameters=function(){return[{type:r.Store},{type:h.Router},{type:void 0,decorators:[{type:a.Inject,args:[o.MAT_DIALOG_DATA]}]},{type:d.TranslateService},{type:l.a},{type:o.MatDialogRef},{type:s.FormBuilder}]},e=Object(i.c)([Object(a.Component)({selector:"tb-make-dashboard-public-dialog",template:Object(i.f)(n("fPs1")).default}),Object(i.h)(2,Object(a.Inject)(o.MAT_DIALOG_DATA)),Object(i.g)("design:paramtypes",[r.Store,h.Router,Object,d.TranslateService,l.a,o.MatDialogRef,s.FormBuilder])],e)}(u.a)},"p0+G":function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var i=n("mrSG"),a=n("TYT/"),o=n("6onV"),r=n("G8Aa"),s=n("QJY3"),l=n("xKAQ"),c=n("o8Qb"),d=n("IktG"),u=n("YnEf"),h=n("qxrw"),p=n("//Q6"),m=function(t){function e(e,n,i,a,o,r){var s=t.call(this,e,r,a,o)||this;return s.store=e,s.translate=n,s.dashboardService=i,s.entityValue=a,s.entitiesTableConfigValue=o,s.fb=r,s}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){this.dashboardScope=this.entitiesTableConfig.componentsData.dashboardScope,this.customerId=this.entitiesTableConfig.componentsData.customerId,t.prototype.ngOnInit.call(this)},e.prototype.isPublic=function(t){return Object(d.c)(t)},e.prototype.isCurrentPublicCustomer=function(t){return Object(d.b)(t,this.customerId)},e.prototype.hideDelete=function(){return!!this.entitiesTableConfig&&!this.entitiesTableConfig.deleteEnabled(this.entity)},e.prototype.buildForm=function(t){return this.updateFields(t),this.fb.group({title:[t?t.title:"",[s.Validators.required]],configuration:this.fb.group({description:[t&&t.configuration?t.configuration.description:""]})})},e.prototype.updateForm=function(t){this.updateFields(t),this.entityForm.patchValue({title:t.title}),this.entityForm.patchValue({configuration:{description:t.configuration?t.configuration.description:""}})},e.prototype.prepareFormValue=function(t){return t.configuration=Object(i.a)(Object(i.a)({},this.entity.configuration||{}),t.configuration||{}),t},e.prototype.onPublicLinkCopied=function(t){this.store.dispatch(new l.b({message:this.translate.instant("dashboard.public-link-copied-message"),type:"success",duration:750,verticalPosition:"bottom",horizontalPosition:"right"}))},e.prototype.updateFields=function(t){t&&!Object(p.n)(t,{})&&(this.assignedCustomersText=Object(d.a)(t),this.publicLink=this.dashboardService.getPublicDashboardLink(t))},e.ctorParameters=function(){return[{type:o.Store},{type:c.TranslateService},{type:u.a},{type:void 0,decorators:[{type:a.Inject,args:["entity"]}]},{type:h.d,decorators:[{type:a.Inject,args:["entitiesTableConfig"]}]},{type:s.FormBuilder}]},e=Object(i.c)([Object(a.Component)({selector:"tb-dashboard-form",template:Object(i.f)(n("EUjX")).default,styles:[Object(i.f)(n("Di+U")).default]}),Object(i.h)(3,Object(a.Inject)("entity")),Object(i.h)(4,Object(a.Inject)("entitiesTableConfig")),Object(i.g)("design:paramtypes",[o.Store,c.TranslateService,u.a,Object,h.d,s.FormBuilder])],e)}(r.a)},q1F0:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<mat-form-field class="mat-block">\n  <mat-label translate>event.event-type</mat-label>\n  <mat-select [ngModel]="eventTableConfig.eventType"\n              (ngModelChange)="eventTypeChanged($event)">\n    <mat-option *ngFor="let type of eventTableConfig.eventTypes" [value]="type">\n      {{ eventTypeTranslationsMap.get(type) | translate }}\n    </mat-option>\n  </mat-select>\n</mat-form-field>\n'},q2GY:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .tb-relation-filters {\n  max-width: calc(100vw - 48px);\n  overflow: hidden;\n}\n:host .tb-relation-filters .container {\n  width: 100%;\n  overflow: auto;\n}\n:host .tb-relation-filters .header {\n  width: -webkit-max-content;\n  width: -moz-max-content;\n  width: max-content;\n  padding: 0 5px 5px;\n}\n:host .tb-relation-filters .header .cell {\n  padding-right: 5px;\n  padding-left: 5px;\n  font-size: 12px;\n  font-weight: 700;\n  color: rgba(0, 0, 0, 0.54);\n  white-space: nowrap;\n}\n:host .tb-relation-filters .body {\n  width: -webkit-max-content;\n  width: -moz-max-content;\n  width: max-content;\n  padding: 0 5px 20px;\n}\n:host .tb-relation-filters .body .row {\n  padding-top: 5px;\n}\n:host .tb-relation-filters .body .cell {\n  padding-right: 5px;\n  padding-left: 5px;\n}\n:host .tb-relation-filters .any-filter {\n  margin: 10px 0 20px;\n}\n:host ::ng-deep .tb-relation-filters .cell .mat-form-field .mat-form-field-infix {\n  border-top: none;\n}\n:host ::ng-deep .tb-relation-filters .cell .mat-form-field.mat-form-field-appearance-standard .mat-form-field-flex {\n  padding-top: 0;\n}'},qDwk:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form>\n  <mat-toolbar color="primary">\n    <h2 translate>layout.select</h2>\n    <span fxFlex></span>\n    <button mat-icon-button\n      (click)="cancel()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div mat-dialog-content>\n    <fieldset [disabled]="isLoading$ | async" fxLayout="column" fxLayoutGap="8px">\n      <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="8px">\n        <button fxFlex\n                mat-raised-button color="primary"\n                type="button"\n                class="tb-layout-button"\n                (click)="selectLayout(\'main\')">\n          <span translate>layout.main</span>\n        </button>\n        <button fxFlex\n                mat-raised-button color="primary"\n                type="button"\n                class="tb-layout-button"\n                (click)="selectLayout(\'right\')">\n          <span translate>layout.right</span>\n        </button>\n      </div>\n    </fieldset>\n  </div>\n</form>\n'},qFS8:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var i=n("mrSG"),a=n("TYT/"),o=n("MqYC"),r=n("ea4N"),s=n("6onV"),l=n("QJY3"),c=n("DUip"),d=n("gmuX"),u=n("OiFK"),h=n("o8Qb"),p=n("//Q6"),m=n("4j5O"),g=n("mAYL"),f=function(t){function e(e,n,i,a,o,r,s,l,c,d){var u=t.call(this,e,n,o)||this;u.store=e,u.router=n,u.data=i,u.errorStateMatcher=a,u.dialogRef=o,u.fb=r,u.utils=s,u.dashboardUtils=l,u.translate=c,u.dialog=d,u.submitted=!1,u.layouts=u.data.layouts,u.layoutsFormGroup=u.fb.group({main:[{value:Object(p.k)(u.layouts.main),disabled:!0},[]],right:[Object(p.k)(u.layouts.right),[]]});for(var h=0,m=Object.keys(u.layoutsFormGroup.controls);h<m.length;h++){var g=m[h];u.layoutsFormGroup.controls[g];u.layouts[g]||(u.layouts[g]=u.dashboardUtils.createDefaultLayoutData())}return u}var d;return Object(i.d)(e,t),d=e,e.prototype.ngOnInit=function(){},e.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=!!(t&&t.invalid&&this.submitted);return n||i},e.prototype.openLayoutSettings=function(t){var e=this,n=Object(p.d)(this.layouts[t].gridSettings);this.dialog.open(g.a,{disableClose:!0,panelClass:["tb-dialog","tb-fullscreen-dialog"],data:{settings:null,gridSettings:n}}).afterClosed().subscribe((function(n){n&&n.gridSettings&&(e.dashboardUtils.updateLayoutSettings(e.layouts[t],n.gridSettings),e.layoutsFormGroup.markAsDirty())}))},e.prototype.cancel=function(){this.dialogRef.close(null)},e.prototype.save=function(){this.submitted=!0;for(var t=0,e=Object.keys(this.layoutsFormGroup.controls);t<e.length;t++){var n=e[t];this.layoutsFormGroup.controls[n].value||delete this.layouts[n]}this.dialogRef.close(this.layouts)},e.ctorParameters=function(){return[{type:s.Store},{type:c.Router},{type:void 0,decorators:[{type:a.Inject,args:[r.MAT_DIALOG_DATA]}]},{type:o.d,decorators:[{type:a.SkipSelf}]},{type:r.MatDialogRef},{type:l.FormBuilder},{type:u.a},{type:m.a},{type:h.TranslateService},{type:r.MatDialog}]},e=d=Object(i.c)([Object(a.Component)({selector:"tb-manage-dashboard-layouts-dialog",template:Object(i.f)(n("G6Sg")).default,providers:[{provide:o.d,useExisting:d}],styles:[Object(i.f)(n("OKrC")).default]}),Object(i.h)(2,Object(a.Inject)(r.MAT_DIALOG_DATA)),Object(i.h)(3,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[s.Store,c.Router,Object,o.d,r.MatDialogRef,l.FormBuilder,u.a,m.a,h.TranslateService,r.MatDialog])],e)}(d.a)},qS8Y:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host ::ng-deep tb-entities-table.tb-details-mode .mat-drawer-container {\n  background-color: white;\n}'},qeFx:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div class="tb-led-indicator" fxLayout="column">\n  <div fxFlex="20" #ledTitleContainer class="title-container" fxLayout="row" fxLayoutAlign="center center" [fxShow]="showTitle">\n    <span #ledTitle class="led-title">{{title}}</span>\n  </div>\n  <div fxFlex="{{showTitle ? 80 : 100}}"\n       [ngStyle]="{paddingTop: showTitle ? \'5px\': \'10px\'}" #ledContainer id="led-container" fxLayout="column" fxLayoutAlign="center center">\n    <div #led class="led">\n    </div>\n  </div>\n  <div #ledErrorContainer class="error-container" [ngStyle]="{\'background\': error?.length ? \'rgba(255,255,255,0.25)\' : \'none\'}"\n       fxLayout="row" fxLayoutAlign="center center">\n    <span #ledError class="led-error">{{ error }}</span>\n  </div>\n  <div #textMeasure id="text-measure"></div>\n</div>\n'},"qpl/":function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .manage-dashboard-states .tb-entity-table .tb-entity-table-content {\n  width: 100%;\n  height: 100%;\n  background: #fff;\n}\n:host .manage-dashboard-states .tb-entity-table .tb-entity-table-content .tb-entity-table-title {\n  padding-right: 20px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n:host .manage-dashboard-states .tb-entity-table .tb-entity-table-content .table-container {\n  overflow: auto;\n}\n:host ::ng-deep .manage-dashboard-states .mat-sort-header-sorted .mat-sort-header-arrow {\n  opacity: 1 !important;\n}'},qxrw:function(t,e,n){"use strict";n.d(e,"c",(function(){return b})),n.d(e,"b",(function(){return y})),n.d(e,"a",(function(){return v})),n.d(e,"d",(function(){return w})),n.d(e,"e",(function(){return x}));var i=n("mrSG"),a=n("26FU"),o=n("S5bw"),r=n("F/XL"),s=n("Duvn"),l=n("QWsF"),c=n("xMyE"),d=n("9Z1F"),u=n("67Y/"),h=n("S1nX"),p=n("t9fZ"),m=function(){function t(t,e,n){this.fetchFunction=t,this.selectionEnabledFunction=e,this.dataLoadedFunction=n,this.entitiesSubject=new a.a([]),this.pageDataSubject=new a.a(Object(s.a)()),this.pageData$=this.pageDataSubject.asObservable(),this.selection=new l.c(!0,[]),this.currentEntity=null,this.dataLoading=!0}return t.prototype.connect=function(t){return this.entitiesSubject.asObservable()},t.prototype.disconnect=function(t){this.entitiesSubject.complete(),this.pageDataSubject.complete()},t.prototype.reset=function(){var t=Object(s.a)();this.onEntities(t.data),this.pageDataSubject.next(t),this.dataLoadedFunction()},t.prototype.loadEntities=function(t){var e=this;this.dataLoading=!0;var n=new o.a;return this.fetchFunction(t).pipe(Object(c.a)((function(){e.selection.clear()})),Object(d.a)((function(){return Object(r.a)(Object(s.a)())}))).subscribe((function(t){e.onEntities(t.data),e.pageDataSubject.next(t),n.next(t),e.dataLoadedFunction(),e.dataLoading=!1})),n},t.prototype.onEntities=function(t){this.entitiesSubject.next(t)},t.prototype.isAllSelected=function(){var t=this,e=this.selection.selected.length;return this.entitiesSubject.pipe(Object(u.a)((function(n){return e===t.selectableEntitiesCount(n)})),Object(h.a)())},t.prototype.isEmpty=function(){return this.entitiesSubject.pipe(Object(u.a)((function(t){return!t.length})),Object(h.a)())},t.prototype.total=function(){return this.pageDataSubject.pipe(Object(u.a)((function(t){return t.totalElements})),Object(h.a)())},t.prototype.toggleCurrentEntity=function(t){return this.currentEntity!==t&&(this.currentEntity=t,!0)},t.prototype.isCurrentEntity=function(t){return this.currentEntity&&t&&this.currentEntity.id&&t.id&&this.currentEntity.id.id===t.id.id},t.prototype.masterToggle=function(){var t=this;this.entitiesSubject.pipe(Object(c.a)((function(e){t.selection.selected.length===t.selectableEntitiesCount(e)?t.selection.clear():e.forEach((function(e){t.selectionEnabledFunction(e)&&t.selection.select(e)}))})),Object(p.a)(1)).subscribe()},t.prototype.selectableEntitiesCount=function(t){var e=this;return t.filter((function(t){return e.selectionEnabledFunction(t)})).length},t}(),g=n("4r/P"),f=function(t,e,n,i,a,o,r){void 0===i&&(i="0px"),void 0===a&&(a=!0),void 0===o&&(o=!1),void 0===r&&(r=!1),this.type=t,this.key=e,this.title=n,this.width=i,this.sortable=a,this.ignoreTranslate=o,this.mobileHide=r},b=function(t){function e(e,n,i,a,o,r,s,l,c){void 0===i&&(i="0px"),void 0===a&&(a=function(t,e){return t[e]?t[e]:""}),void 0===o&&(o=function(){return{}}),void 0===r&&(r=!0),void 0===s&&(s=function(){return{}}),void 0===l&&(l=function(){}),void 0===c&&(c=!1);var d=t.call(this,"content",e,n,i,r)||this;return d.key=e,d.title=n,d.width=i,d.cellContentFunction=a,d.cellStyleFunction=o,d.sortable=r,d.headerCellStyleFunction=s,d.cellTooltipFunction=l,d.isNumberColumn=c,d}return Object(i.d)(e,t),e}(f),y=function(t){function e(e,n,i,a){void 0===a&&(a="0px");var o=t.call(this,"action",e,n,a,!1)||this;return o.key=e,o.title=n,o.actionDescriptor=i,o.width=a,o}return Object(i.d)(e,t),e}(f),v=function(t){function e(e,n,i,a,o,r){return void 0===a&&(a="0px"),void 0===o&&(o="yyyy-MM-dd HH:mm:ss"),void 0===r&&(r=function(){return{}}),t.call(this,e,n,a,(function(t,e){return i.transform(t[e],o)}),r)||this}return Object(i.d)(e,t),e}(b),w=function(){var t=this;this.componentsData=null,this.loadDataOnInit=!0,this.onLoadAction=null,this.table=null,this.useTimePageLink=!1,this.entityType=null,this.tableTitle="",this.selectionEnabled=!0,this.searchEnabled=!0,this.addEnabled=!0,this.entitiesDeleteEnabled=!0,this.detailsPanelEnabled=!0,this.hideDetailsTabsOnEdit=!0,this.actionsColumnTitle=null,this.addDialogStyle={},this.defaultSortOrder={property:"createdTime",direction:g.a.DESC},this.displayPagination=!0,this.defaultPageSize=10,this.columns=[],this.cellActionDescriptors=[],this.groupActionDescriptors=[],this.headerActionDescriptors=[],this.addActionDescriptors=[],this.addEntity=null,this.dataSource=function(e){return new m(t.entitiesFetchFunction,t.entitySelectionEnabled,e)},this.detailsReadonly=function(){return!1},this.entitySelectionEnabled=function(){return!0},this.deleteEnabled=function(){return!0},this.deleteEntityTitle=function(){return""},this.deleteEntityContent=function(){return""},this.deleteEntitiesTitle=function(){return""},this.deleteEntitiesContent=function(){return""},this.loadEntity=function(){return Object(r.a)()},this.saveEntity=function(t){return Object(r.a)(t)},this.deleteEntity=function(){return Object(r.a)()},this.entitiesFetchFunction=function(){return Object(r.a)(Object(s.a)())},this.onEntityAction=function(){return!1},this.handleRowClick=function(){return!1},this.entityTitle=function(t){var e;return null===(e=t)||void 0===e?void 0:e.name},this.entityAdded=function(){},this.entityUpdated=function(){},this.entitiesDeleted=function(){}};function x(t){return'<mat-icon class="material-icons mat-icon">'+(t?"check_box":"check_box_outline_blank")+"</mat-icon>"}},rLQf:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host {\n  display: -ms-flexbox;\n  display: flex;\n  height: 100%;\n}\n:host .date-range-navigator {\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-wrap: wrap;\n      flex-wrap: wrap;\n  -ms-flex-align: center;\n      align-items: center;\n  -ms-flex-pack: space-evenly;\n      justify-content: space-evenly;\n  width: 100%;\n  margin: auto;\n}\n:host .date-range-navigator .drn__element {\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-direction: row;\n      flex-direction: row;\n  -ms-flex-align: center;\n      align-items: center;\n  max-width: 100%;\n  height: 60px;\n  margin: 4px 0;\n}\n:host .date-range-navigator .picker .picker__wrapper {\n  position: relative;\n  max-width: 100%;\n  padding: 2px;\n}\n:host .date-range-navigator .picker .picker__wrapper > label {\n  position: absolute;\n  right: -3px;\n  bottom: 100%;\n  left: 0;\n  padding-left: 3px;\n  color: #787878;\n  transform: scale(0.75);\n  transform-origin: left bottom;\n}\n:host .date-range-navigator .picker .md-select-value {\n  min-width: 225px;\n  border-color: #e1e1e1;\n}\n:host .date-range-navigator .picker .md-select-value .md-select-icon {\n  color: #757575;\n}\n:host .date-range-navigator.short-mode {\n  display: block;\n  width: 90%;\n}\n:host .date-range-navigator.short-mode .drn__element {\n  width: 100%;\n}\n:host .date-range-navigator.short-mode .picker .picker__wrapper {\n  width: 100%;\n}\n:host .date-range-navigator.short-mode .picker .md-select-value {\n  min-width: initial;\n}\n:host .date-range-navigator.short-mode.labels-hidden .drn__element {\n  margin: 0;\n}\n:host .date-range-navigator.long-mode.labels-hidden .drn__element {\n  height: 36px;\n}'},rVoF:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<tb-entities-table [entitiesTableConfig]="auditLogTableConfig" [ngClass]="{\'tb-details-mode\': detailsMode}"></tb-entities-table>\n'},rbUU:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .tb-entity-filter #relationsQueryFilter {\n  padding-top: 20px;\n}\n:host .tb-entity-filter #relationsQueryFilter tb-entity-select {\n  min-height: 92px;\n}\n:host .tb-entity-filter .tb-root-state-entity-switch {\n  padding-left: 10px;\n  padding-bottom: 10px;\n}\n:host .tb-entity-filter .tb-root-state-entity-switch .root-state-entity-switch {\n  margin: 0;\n}\n:host .tb-entity-filter .tb-root-state-entity-switch .root-state-entity-label {\n  margin: 5px 0 5px 10px;\n}'},rdEc:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .tb-widget-config .tb-advanced-widget-config {\n  height: 100%;\n}\n:host .tb-widget-config .tb-advanced-widget-config {\n  height: 100%;\n}\n:host .tb-widget-config .tb-datasource-type {\n  min-width: 110px;\n}\n@media screen and (min-width: 960px) {\n  :host .tb-widget-config .tb-datasource-type {\n    max-width: 110px;\n  }\n}\n@media screen and (min-width: 960px) {\n  :host .tb-widget-config .tb-datasource {\n    padding-left: 8px;\n  }\n}\n@media screen and (min-width: 960px) {\n  :host .tb-widget-config .tb-datasource-name {\n    width: 200px;\n    max-width: 200px;\n  }\n}\n@media screen and (min-width: 960px) {\n  :host .tb-widget-config .tb-data-keys {\n    padding-left: 8px;\n  }\n}\n:host ::ng-deep .tb-widget-config .mat-tab-body-wrapper {\n  position: absolute;\n  top: 49px;\n  left: 0;\n  right: 0;\n  bottom: 0;\n}\n:host ::ng-deep .tb-widget-config .tb-panel-hint {\n  font-size: 12px;\n  color: #808080;\n}\n:host ::ng-deep .tb-widget-config .mat-checkbox-label {\n  white-space: normal;\n}\n:host ::ng-deep .tb-widget-config .mat-expansion-panel.tb-datasources.mat-expanded {\n  overflow: visible;\n}\n:host ::ng-deep .tb-widget-config .mat-expansion-panel.tb-datasources .mat-expansion-panel-body {\n  padding: 0 12px 16px;\n}\n:host ::ng-deep .tb-widget-config .mat-expansion-panel .mat-expansion-panel-content {\n  font: inherit;\n}\n:host ::ng-deep .tb-widget-config .tb-datasource-type .mat-form-field-infix {\n  width: 100%;\n}\n:host ::ng-deep .tb-widget-config .tb-datasource-type .mat-select-value {\n  min-width: 92px;\n}\n:host ::ng-deep .tb-widget-config .tb-datasource tb-entity-alias-select .mat-form-field {\n  margin-top: 13px;\n}\n@media screen and (min-width: 960px) {\n  :host ::ng-deep .tb-widget-config .tb-datasource tb-entity-alias-select .mat-form-field {\n    width: 200px;\n    max-width: 200px;\n  }\n}\n@media screen and (min-width: 960px) {\n  :host ::ng-deep .tb-widget-config .tb-data-keys .mat-input-element {\n    min-height: 32px;\n  }\n}'},"rg+x":function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host ::ng-deep .mat-padding {\n  padding: 0;\n}'},rxPF:function(t,e,n){!function(t){"use strict";function e(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function n(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(e||(e="undefined"==typeof window?global:window),void 0!==e[t])return e[t];for(var n=["webkit","moz","ms","o"],i=0,a=n.length,o=t.charAt(0).toUpperCase()+t.substr(1);i<a;i++){var r=e[n[i]+o];if(void 0!==r)return r}return null}function r(){Array.prototype.constructor.apply(this,arguments)}function s(t,e,n,i,a,o){t.beginPath(),t.moveTo(e+o,n),t.lineTo(e+i-o,n),t.quadraticCurveTo(e+i,n,e+i,n+o),t.lineTo(e+i,n+a-o),t.quadraticCurveTo(e+i,n+a,e+i-o,n+a),t.lineTo(e+o,n+a),t.quadraticCurveTo(e,n+a,e,n+a-o),t.lineTo(e,n+o),t.quadraticCurveTo(e,n,e+o,n),t.closePath()}function l(t,e){var n,i=e.valueDec,a=e.valueInt,o=0,r=void 0,s=void 0;if(n=(t=parseFloat(t))<0,t=Math.abs(t),i>0){for(r=a-(s=t.toFixed(i).toString().split("."))[0].length;o<r;++o)s[0]="0"+s[0];s=(n?"-":"")+s[0]+"."+s[1]}else{for(r=a-(s=Math.round(t).toString()).length;o<r;++o)s="0"+s;s=(n?"-":"")+s}return s}function c(t,e,n){return t["font"+e+"Style"]+" "+t["font"+e+"Weight"]+" "+t["font"+e+"Size"]*n+"px "+t["font"+e]}function d(t){t.shadowOffsetX=null,t.shadowOffsetY=null,t.shadowBlur=null,t.shadowColor="",t.strokeStyle=null,t.lineWidth=0,t.save()}function u(t,e,n,i){e.valueTextShadow&&(t.shadowOffsetX=n,t.shadowOffsetY=n,t.shadowBlur=i,t.shadowColor=e.colorValueTextShadow)}function h(t,e,n,i,a){n.beginPath(),n.arc(0,0,J(t),0,2*at,!0),n.lineWidth=e,n.strokeStyle=a?it.linearGradient(n,i,a,t):i,n.stroke(),n.closePath()}function p(t,e){var n=q.pixelRatio;return t.maxRadius||(t.maxRadius=t.max-e.borderShadowWidth-e.borderOuterWidth*n-e.borderMiddleWidth*n-e.borderInnerWidth*n+(e.borderOuterWidth?.5:0)+(e.borderMiddleWidth?.5:0)+(e.borderInnerWidth?.5:0)),t.maxRadius}function m(t,e){var n=q.pixelRatio,i=e.borderShadowWidth*n,a=t.max-i-e.borderOuterWidth*n/2,o=a-e.borderOuterWidth*n/2-e.borderMiddleWidth*n/2+.5,r=o-e.borderMiddleWidth*n/2-e.borderInnerWidth*n/2+.5,s=p(t,e),l=void 0,c=!1;t.save(),e.borderOuterWidth&&(c=it.drawShadow(t,e,c),h(a,e.borderOuterWidth*n,t,e.colorBorderOuter,e.colorBorderOuterEnd)),e.borderMiddleWidth&&(c=it.drawShadow(t,e,c),h(o,e.borderMiddleWidth*n,t,e.colorBorderMiddle,e.colorBorderMiddleEnd)),e.borderInnerWidth&&(c=it.drawShadow(t,e,c),h(r,e.borderInnerWidth*n,t,e.colorBorderInner,e.colorBorderInnerEnd)),it.drawShadow(t,e,c),t.beginPath(),t.arc(0,0,J(s),0,2*at,!0),e.colorPlateEnd?((l=t.createRadialGradient(0,0,s/2,0,0,s)).addColorStop(0,e.colorPlate),l.addColorStop(1,e.colorPlateEnd)):l=e.colorPlate,t.fillStyle=l,t.fill(),t.closePath(),t.restore()}function g(t,e){var n=t.max*(parseFloat(e.highlightsWidth)||0)/100;if(n){var i=J(b(t,e)-n/2),a=0,o=e.highlights.length,r=(e.maxValue-e.minValue)/e.ticksAngle;for(t.save();a<o;a++){var s=e.highlights[a];t.beginPath(),t.rotate(ot),t.arc(0,0,i,it.radians(e.startAngle+(s.from-e.minValue)/r),it.radians(e.startAngle+(s.to-e.minValue)/r),!1),t.strokeStyle=s.color,t.lineWidth=n,t.lineCap=e.highlightsLineCap,t.stroke(),t.closePath(),t.restore(),t.save()}}}function f(t,e){var n=b(t,e),i=void 0,a=void 0,o=void 0,r=0,s=0,l=Math.abs(e.minorTicks)||0,c=e.ticksAngle/(e.maxValue-e.minValue);for(t.lineWidth=q.pixelRatio,t.strokeStyle=e.colorMinorTicks||e.colorStrokeTicks,t.save(),e.exactTicks?(a=e.maxValue-e.minValue,i=l?a/l:0,s=(et.mod(e.majorTicks[0],l)||0)*c):i=l*(e.majorTicks.length-1);r<i;++r)(o=e.startAngle+s+r*(e.ticksAngle/i))<=e.ticksAngle+e.startAngle&&(t.rotate(it.radians(o)),t.beginPath(),t.moveTo(0,n),t.lineTo(0,n-.075*t.max),w(t))}function b(t,e){var n=t.max/100;return p(t,e)-5*n-(e.barWidth?2*(parseFloat(e.barStrokeWidth)||0)+((parseFloat(e.barWidth)||0)+5)*n:0)}function y(t,e){it.prepareTicks(e);var n,i=J(b(t,e)),a=void 0,o=e.majorTicks.length,r=q.pixelRatio;for(t.lineWidth=2*r,t.save(),n=e.colorMajorTicks instanceof Array?e.colorMajorTicks:new Array(o).fill(e.colorStrokeTicks||e.colorMajorTicks),a=0;a<o;++a)t.strokeStyle=n[a],t.rotate(it.radians(v(e,e.exactTicks?e.majorTicks[a]:a,o))),t.beginPath(),t.moveTo(0,i),t.lineTo(0,i-.15*t.max),w(t);e.strokeTicks&&(t.strokeStyle=e.colorStrokeTicks||n[0],t.rotate(ot),t.beginPath(),t.arc(0,0,i,it.radians(e.startAngle),it.radians(e.startAngle+e.ticksAngle),!1),w(t))}function v(t,e,n){if(t.exactTicks){var i=t.ticksAngle/(t.maxValue-t.minValue);return t.startAngle+i*(e-t.minValue)}return t.startAngle+e*(t.ticksAngle/(n-1))}function w(t){t.stroke(),t.restore(),t.closePath(),t.save()}function x(t,e){var n=b(t,e)-.15*t.max,i={},a=0,o=e.majorTicks.length,r="needle"!==e.animationTarget,s=e.colorNumbers instanceof Array?e.colorNumbers:new Array(o).fill(e.colorNumbers),l=r?-(e.value-e.minValue)/(e.maxValue-e.minValue)*e.ticksAngle:0;for(r&&(t.save(),t.rotate(-it.radians(l))),t.font=it.font(e,"Numbers",t.max/200),t.lineWidth=0,t.textAlign="center",t.textBaseline="middle";a<o;++a){var c=l+v(e,e.exactTicks?e.majorTicks[a]:a,o),d=t.measureText(e.majorTicks[a]).width,u=e.fontNumbersSize,h=Math.sqrt(d*d+u*u)/2,p=it.radialPoint(n-h-e.numbersMargin/100*t.max,it.radians(c));360===c&&(c=0),i[c]||(i[c]=!0,t.fillStyle=s[a],t.fillText(e.majorTicks[a],p.x,p.y))}r&&t.restore()}function S(t,e){e.title&&(t.save(),t.font=it.font(e,"Title",t.max/200),t.fillStyle=e.colorTitle,t.textAlign="center",t.fillText(e.title,0,-t.max/4.25,.8*t.max),t.restore())}function C(t,e){e.units&&(t.save(),t.font=it.font(e,"Units",t.max/200),t.fillStyle=e.colorUnits,t.textAlign="center",t.fillText(it.formatContext(e,e.units),0,t.max/3.25,.8*t.max),t.restore())}function T(t,e){if(e.needle){var n=e.ticksAngle<360?it.normalizedValue(e).indented:e.value,i=h?e.startAngle:e.startAngle+(n-e.minValue)/(e.maxValue-e.minValue)*e.ticksAngle;"right"===e.barStartPosition&&(i=e.startAngle+e.ticksAngle-(n-e.minValue)/(e.maxValue-e.minValue)*e.ticksAngle);var a=p(t,e),o=J(a/100*e.needleCircleSize),r=J(a/100*e.needleCircleSize*.75),s=J(a/100*e.needleEnd),l=J(e.needleStart?a/100*e.needleStart:0),c=a/100*e.needleWidth,d=a/100*e.needleWidth/2,u=q.pixelRatio,h="needle"!==e.animationTarget;t.save(),it.drawNeedleShadow(t,e),t.rotate(it.radians(i)),t.fillStyle=it.linearGradient(t,e.colorNeedle,e.colorNeedleEnd,s-l),"arrow"===e.needleType?(t.beginPath(),t.moveTo(-d,-l),t.lineTo(-c,0),t.lineTo(-1*u,s),t.lineTo(u,s),t.lineTo(c,0),t.lineTo(d,-l),t.closePath(),t.fill(),t.beginPath(),t.lineTo(-.5*u,s),t.lineTo(-1*u,s),t.lineTo(-c,0),t.lineTo(-d,-l),t.lineTo(d/2*u-2*u,-l),t.closePath(),t.fillStyle=e.colorNeedleShadowUp,t.fill()):(t.beginPath(),t.moveTo(-d,s),t.lineTo(-d,l),t.lineTo(d,l),t.lineTo(d,s),t.closePath(),t.fill()),e.needleCircleSize&&(t.restore(),it.drawNeedleShadow(t,e),e.needleCircleOuter&&(t.beginPath(),t.arc(0,0,o,0,2*at,!0),t.fillStyle=it.linearGradient(t,e.colorNeedleCircleOuter,e.colorNeedleCircleOuterEnd,o),t.fill(),t.closePath()),e.needleCircleInner&&(t.beginPath(),t.arc(0,0,r,0,2*at,!0),t.fillStyle=it.linearGradient(t,e.colorNeedleCircleInner,e.colorNeedleCircleInnerEnd,r),t.fill(),t.closePath()),t.restore())}}function O(t,e,n){it.drawValueBox(t,e,n,0,t.max-.33*t.max,t.max)}function _(t,e){var n=t.max/100,i=p(t,e)-5*n,a=parseFloat(e.barStrokeWidth+"")||0,o=(parseFloat(e.barWidth+"")||0)*n,r=i-2*a-o,s=(i-r)/2,l=r+s,c=a/l,d=e.startAngle,u=e.startAngle+e.ticksAngle;if(t.save(),t.rotate(ot),a&&(t.beginPath(),t.arc(0,0,l,it.radians(d)-c,it.radians(u)+c,!1),t.strokeStyle=e.colorBarStroke,t.lineWidth=2*s,t.stroke(),t.closePath()),o&&(t.beginPath(),t.arc(0,0,l,it.radians(d),it.radians(u),!1),t.strokeStyle=e.colorBar,t.lineWidth=o,t.stroke(),t.closePath(),e.barShadow&&(t.beginPath(),t.arc(0,0,i,it.radians(d),it.radians(u),!1),t.clip(),t.beginPath(),t.strokeStyle=e.colorBar,t.lineWidth=1,t.shadowBlur=e.barShadow,t.shadowColor=e.colorBarShadow,t.shadowOffsetX=0,t.shadowOffsetY=0,t.arc(0,0,i,it.radians(e.startAngle),it.radians(e.startAngle+e.ticksAngle),!1),t.stroke(),t.closePath(),t.restore(),t.rotate(ot)),e.barProgress)){var h=function(t){var e=t.startAngle,n=t.startAngle+t.ticksAngle,i=e,a=e+(it.normalizedValue(t).normal-t.minValue)/(t.maxValue-t.minValue)*t.ticksAngle;if("middle"===t.barStartPosition){var o=.5*(t.minValue+t.maxValue);t.value<o?(i=180-(o-it.normalizedValue(t).normal)/(t.maxValue-t.minValue)*t.ticksAngle,a=180):(i=180,a=180+(it.normalizedValue(t).normal-o)/(t.maxValue-t.minValue)*t.ticksAngle)}else"right"===t.barStartPosition&&(i=n-a+e,a=n);return{startAngle:i,endAngle:a}}(e),m=h.startAngle,g=h.endAngle;t.beginPath(),t.arc(0,0,l,it.radians(m),it.radians(g),!1),t.strokeStyle=e.colorBarProgress,t.lineWidth=o,t.stroke(),t.closePath()}t.restore()}function L(t){return t.options.animatedValue?t.options.value:t.value}function I(t,e,n,i,a,o,r,s,l){t.beginPath(),t.lineWidth=e,t.strokeStyle=l?it.linearGradient(t,s,l,r,!0,a):s,n>0?it.roundRect(t,i,a,o,r,n):t.rect(i,a,o,r),t.stroke(),t.closePath()}function A(t,e,n,i,a,o){var r=q.pixelRatio;t.save();var s=e.borderRadius*r,l=a-e.borderShadowWidth-e.borderOuterWidth*r,c=l-e.borderOuterWidth*r-e.borderMiddleWidth*r,d=c-e.borderMiddleWidth*r-e.borderInnerWidth*r,u=d-e.borderInnerWidth*r,h=o-e.borderShadowWidth-e.borderOuterWidth*r,p=h-e.borderOuterWidth*r-e.borderMiddleWidth*r,m=p-e.borderMiddleWidth*r-e.borderInnerWidth*r,g=m-e.borderInnerWidth*r,f=n-(c-l)/2,b=f-(d-c)/2,y=b-(u-d)/2,v=i-(p-h)/2,w=v-(m-p)/2,x=w-(g-m)/2,S=0,C=!1;return e.borderOuterWidth&&(C=it.drawShadow(t,e,C),I(t,e.borderOuterWidth*r,s,n+e.borderOuterWidth*r/2-S,i+e.borderOuterWidth*r/2-S,l,h,e.colorBorderOuter,e.colorBorderOuterEnd),S+=.5*r),e.borderMiddleWidth&&(C=it.drawShadow(t,e,C),I(t,e.borderMiddleWidth*r,s-=1+2*S,f+e.borderMiddleWidth*r/2-S,v+e.borderMiddleWidth*r/2-S,c+2*S,p+2*S,e.colorBorderMiddle,e.colorBorderMiddleEnd),S+=.5*r),e.borderInnerWidth&&(C=it.drawShadow(t,e,C),I(t,e.borderInnerWidth*r,s-=1+2*S,b+e.borderInnerWidth*r/2-S,w+e.borderInnerWidth*r/2-S,d+2*S,m+2*S,e.colorBorderInner,e.colorBorderInnerEnd),S+=.5*r),it.drawShadow(t,e,C),function(t,e,n,i,a,o,r,s){t.beginPath(),t.fillStyle=s?it.linearGradient(t,r,s,a>o?a:o,o>a,a>o?n:i):r,e>0?it.roundRect(t,n,i,a,o,e):t.rect(n,i,a,o),t.fill(),t.closePath()}(t,s,y,x,u+2*S,g+2*S,e.colorPlate,e.colorPlateEnd),t.restore(),[y,x,u,g]}function k(t,e,n,i,a,o,r){var s=function(t,e,n,i,a,o){var r=q.pixelRatio,s=o>=a,l=s?.85*a:o,c=s?o:a;n=s?Q(n+(a-l)/2):n;var d=!!e.title,u=!!e.units,h=!!e.valueBox,p=void 0,m=void 0,g=void 0;s?(m=Q(.05*c),p=Q(.075*c),g=Q(.11*c),d&&(c-=p,i+=p),u&&(c-=m),h&&(c-=g)):(m=p=Q(.15*l),d&&(l-=p,i+=p),u&&(l-=m));var f=2*e.barStrokeWidth,b=e.barBeginCircle?Q(l*e.barBeginCircle/200-f/2):0,y=Q(l*e.barWidth/100-f),v=Q(c*e.barLength/100-f),w=Q((c-v)/2),x=Q(n+(s?l/2:w+b)),S=Q(i+(s?c-w-b+f/2:l/2)),C=!s||e.hasLeft&&e.hasRight?0:(e.hasRight?-1:1)*e.ticksWidth/100*l,T=s||e.hasLeft&&e.hasRight?0:(e.hasRight?-1:1)*e.ticksWidth/100*l;return t.barDimensions={isVertical:s,width:l,length:c,barWidth:y,barLength:v,strokeWidth:f,barMargin:w,radius:b,pixelRatio:r,barOffset:null,titleMargin:d?p:0,unitsMargin:u?m:0,get ticksLength(){return this.barLength-this.barOffset-this.strokeWidth},X:n+C,Y:i+T,x0:x+C,y0:S+T,baseX:n,baseY:i,ticksPadding:e.ticksPadding/100},t.barDimensions}(t,e,i,a,o,r),l=s.isVertical,c=s.width,d=s.barWidth,u=s.barLength,h=s.strokeWidth,p=s.barMargin,m=s.radius,g=s.x0,f=s.y0,b=s.X,y=s.Y,v=u;if(t.save(),t.beginPath(),e.barBeginCircle){var w=it.radians(l?270:0),x=Math.asin(d/2/m),S=Math.cos(x),C=Math.sin(x),T=g+(l?m*C:m*S-h/2),O=l?f-m*S:f+m*C,_=J(l?O-f:T-g);t.barDimensions.barOffset=Q(_+m);var L=l?Q(g-m*C):T,I=l?O:Q(f-m*C);"progress"===n&&(u=t.barDimensions.barOffset+(u-t.barDimensions.barOffset)*(it.normalizedValue(e).normal-e.minValue)/(e.maxValue-e.minValue));var A=Q(T+u-t.barDimensions.barOffset+h/2),k=Q(O-u+t.barDimensions.barOffset-h/2);t.arc(g,f,m,w+x,w-x),l?(t.moveTo(T,I),t.lineTo(T,k),t.lineTo(L,k),t.lineTo(L,I)):(t.moveTo(T,I),t.lineTo(A,I),t.lineTo(A,O),t.lineTo(T,O))}else{var E=Q(l?b+(c-d)/2:b+p),j=Q(l?y+u+p:y+(c-d)/2);"progress"===n&&(u*=(e.value-e.minValue)/(e.maxValue-e.minValue)),l?t.rect(E,j,d,-u):t.rect(E,j,u,d)}"progress"!==n&&e.barStrokeWidth&&(t.lineWidth=h,t.strokeStyle=e.colorBarStroke,t.stroke()),"progress"!==n&&e.colorBar?(t.fillStyle=e.colorBarEnd?it.linearGradient(t,e.colorBar,e.colorBarEnd,u,l,l?y:b):e.colorBar,t.fill()):"progress"===n&&e.colorBarProgress&&(t.fillStyle=e.colorBarProgressEnd?it.linearGradient(t,e.colorBarProgress,e.colorBarProgressEnd,v,l,l?y:b):e.colorBarProgress,t.fill()),t.closePath(),e.barBeginCircle&&(t.barDimensions.radius+=h),t.barDimensions.barWidth+=h,t.barDimensions.barLength+=h}function E(t,e,n,i,a,o){k(t,e,"",n,i,a,o)}function j(t,e){return e.needleSide!==t||e.tickSide!==t||e.numberSide!==t}function D(t,e,n,i,a,o){e.barProgress&&k(t,e,"progress",n,i,a,o)}function F(t,e,n,i,a){t.beginPath(),t.moveTo(e,n),t.lineTo(i,a),t.stroke(),t.closePath(),t.save()}function M(t,e,n,i,a,o,r,s,l){var c=t.barDimensions,d=c.isVertical,u=c.length,h=c.barWidth,p=c.barOffset,m=c.barMargin,g=c.pixelRatio,f=c.width,b=c.X,y=c.Y,v=c.ticksLength,w=c.ticksPadding,x=(f-h)/2,S=void 0,C=void 0,T=0,O=n.length,_=void 0,L=l*f,I=x-w*f,A=x+h+L+w*f,k=e instanceof Array?e:new Array(n.length).fill(e);t.lineWidth=s*g,t.save();for(var E=v/(a-i);T<O;T++)_=n[T],t.strokeStyle=k[T],d?(C=y+u-m-p+(i-_)*E,o&&F(t,S=b+I,C,Q(S-L),C),r&&F(t,S=b+A,C,Q(S-L),C)):(S=b+m+p-(i-_)*E,o&&F(t,S,C=y+I,S,Q(C-L)),r&&F(t,S,Q(C=y+A),S,C-L))}function R(t,e,n,i,a){t.beginPath(),t.moveTo(e,n),t.lineTo(i,a),t.stroke(),t.closePath()}function N(t,e,n,i){return e.colorNeedleEnd?it.linearGradient(t,i?e.colorNeedleEnd:e.colorNeedle,i?e.colorNeedle:e.colorNeedleEnd,n,!t.barDimensions.isVertical):e.colorNeedle}function P(t,e,n,i,a,o,r,s){t.lineWidth=e.needleWidth,t.strokeStyle=N(t,e,r,s),t.beginPath(),t.moveTo(n,i),t.lineTo(a,o),t.stroke(),t.closePath()}function V(t,e,n,i,a,o,r,s){var l=r-Q(.4*r),c=n===a,d=e.needleWidth/2;t.fillStyle=N(t,e,r,s),t.beginPath(),c?(i>o&&(l*=-1),t.moveTo(n-d,i),t.lineTo(n+d,i),t.lineTo(n+d,i+l),t.lineTo(n,o),t.lineTo(n-d,i+l),t.lineTo(n-d,i)):(n>a&&(l*=-1),t.moveTo(n,i-d),t.lineTo(n,i+d),t.lineTo(n+l,i+d),t.lineTo(a,i),t.lineTo(n+l,i-d),t.lineTo(n,i-d)),t.fill(),t.closePath()}function W(t,e,n,i,a,o,r){var s=(parseFloat(e.fontValueSize)||0)*o/200,l=(.11*r-s)/2;t.barDimensions.isVertical&&it.drawValueBox(t,e,n,i+o/2,a+r-s-l,o)}var z=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],i=!0,a=!1,o=void 0;try{for(var r,s=t[Symbol.iterator]();!(i=(r=s.next()).done)&&(n.push(r.value),!e||n.length!==e);i=!0);}catch(t){a=!0,o=t}finally{try{!i&&s.return&&s.return()}finally{if(a)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},B=function t(e,n,i){null===e&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,n);if(void 0===a){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,n,i)}if("value"in a)return a.value;var r=a.get;return void 0!==r?r.call(i):void 0},U=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:function(t,e){if(null==t)throw new TypeError("Cannot convert first argument to object");for(var n=Object(t),i=1;i<arguments.length;i++){var a=arguments[i];if(null!=a)for(var o=Object.keys(Object(a)),r=0,s=o.length;r<s;r++){var l=o[r],c=Object.getOwnPropertyDescriptor(a,l);void 0!==c&&c.enumerable&&(n[l]=a[l])}}return n}}),Array.prototype.indexOf||Object.defineProperty(Array.prototype,"indexOf",{value:function(t,e){var n;if(null===this)throw new TypeError('"this" is null or not defined');var i=Object(this),a=i.length>>>0;if(0===a)return-1;var o=+e||0;if(Math.abs(o)===1/0&&(o=0),o>=a)return-1;for(n=Math.max(o>=0?o:a-Math.abs(o),0);n<a;){if(n in i&&i[n]===t)return n;n++}return-1}}),Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{value:function(t){if(null===this)throw new TypeError("this is null or not defined");for(var e=Object(this),n=e.length>>>0,i=arguments[1],a=i>>0,o=a<0?Math.max(n+a,0):Math.min(a,n),r=arguments[2],s=void 0===r?n:r>>0,l=s<0?Math.max(n+s,0):Math.min(s,n);o<l;)e[o]=t,o++;return e}}),"undefined"==typeof window&&(window="undefined"==typeof global?{}:global);var G=function(){function t(){a(this,t),this._events={},this.addListener=this.on,this.removeListener=this.off}return U(t,[{key:"emit",value:function(t){if(this._events[t]){for(var e=0,n=this._events[t].length,i=arguments.length,a=Array(i>1?i-1:0),o=1;o<i;o++)a[o-1]=arguments[o];for(;e<n;e++)this._events[t][e]&&this._events[t][e].apply(this,a)}}},{key:"once",value:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];for(var a=0,o=n.length,r=this;a<o;a++)!function(){var e=n[a];n[a]=function n(){r.off(t,n),e.apply(r,arguments)}}();this.on.apply(this,[t].concat(n))}},{key:"on",value:function(t){this._events[t]||(this._events[t]=[]);for(var e=0,n=arguments.length<=1?0:arguments.length-1;e<n;e++)this._events[t].push(arguments.length<=e+1?void 0:arguments[e+1])}},{key:"off",value:function(t){if(this._events[t])for(var e=0,n=arguments.length<=1?0:arguments.length-1;e<n;e++)for(var i=arguments.length<=e+1?void 0:arguments[e+1],a=void 0;~(a=this._events[t].indexOf(i));)this._events[t].splice(a,1)}},{key:"removeAllListeners",value:function(t){delete this._events[t]}},{key:"listeners",get:function(){return this._events}}]),t}(),H=o("requestAnimationFrame")||function(t){return setTimeout((function(){return t((new Date).getTime())}),1e3/60)},K={linear:function(t){return t},quad:function(t){return Math.pow(t,2)},dequad:function(t){return 1-K.quad(1-t)},quint:function(t){return Math.pow(t,5)},dequint:function(t){return 1-Math.pow(1-t,5)},cycle:function(t){return 1-Math.sin(Math.acos(t))},decycle:function(t){return Math.sin(Math.acos(1-t))},bounce:function(t){return 1-K.debounce(1-t)},debounce:function(t){for(var e=0,n=1;;e+=n,n/=2)if(t>=(7-4*e)/11)return-Math.pow((11-6*e-11*t)/4,2)+Math.pow(n,2)},elastic:function(t){return 1-K.delastic(1-t)},delastic:function(t){return Math.pow(2,10*(t-1))*Math.cos(20*Math.PI*1.5/3*t)}},Y=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"linear",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};if(a(this,t),this.duration=n,this.rule=e,this.draw=i,this.end=o,"function"!=typeof this.draw)throw new TypeError("Invalid animation draw callback:",i);if("function"!=typeof this.end)throw new TypeError("Invalid animation end callback:",o)}return U(t,[{key:"animate",value:function(t,e){var n=this;this.frame&&this.cancel();var i=window.performance&&window.performance.now?window.performance.now():o("animationStartTime")||Date.now();t=t||this.draw,e=e||this.end,this.draw=t,this.end=e,this.frame=H((function(a){return function t(e,n,i,a,o,r,s){if("function"!=typeof a)throw new TypeError("Invalid animation rule:",a);var l=e-i,c=l/o,d=0;c>1&&(c=1),1!==c&&(d=a(c),isFinite(d)&&!isNaN(d)&&(c=d)),n&&n(c),l<o?s.frame=H((function(e){return t(e,n,i,a,o,r,s)})):(r&&r(),s.inProgress=!1)}(a,t,i,K[n.rule]||n.rule,n.duration,e,n)}))}},{key:"cancel",value:function(){this.frame&&((o("cancelAnimationFrame")||function(t){})(this.frame),this.frame=null)}},{key:"destroy",value:function(){this.cancel(),this.draw=null,this.end=null}}]),t}();Y.rules=K;var Z=function(){function e(n,i,o){a(this,e),this.options=n,this.element=i.toLowerCase(),this.type=e.toDashed(o),this.Type=t[o],this.mutationsObserved=!1,this.isObservable=!!window.MutationObserver,window.GAUGES_NO_AUTO_INIT||e.domReady(this.traverse.bind(this))}return U(e,[{key:"isValidNode",value:function(t){return!(!t.tagName||t.tagName.toLowerCase()!==this.element||t.getAttribute("data-type")!==this.type)}},{key:"traverse",value:function(){for(var t=document.getElementsByTagName(this.element),e=0,n=t.length;e<n;e++)this.process(t[e]);this.isObservable&&!this.mutationsObserved&&(new MutationObserver(this.observe.bind(this)).observe(document.body,{childList:!0,subtree:!0,attributes:!0,characterData:!0,attributeOldValue:!0,characterDataOldValue:!0}),this.mutationsObserved=!0)}},{key:"observe",value:function(t){for(var e=0,n=t.length;e<n;e++){var i=t[e];if("attributes"===i.type&&"data-type"===i.attributeName&&this.isValidNode(i.target)&&i.oldValue!==this.type)setTimeout(this.process.bind(this,i.target));else if(i.addedNodes&&i.addedNodes.length)for(var a=0,o=i.addedNodes.length;a<o;a++)setTimeout(this.process.bind(this,i.addedNodes[a]))}}},{key:"process",value:function(t){var n=this;if(!this.isValidNode(t))return null;var i=void 0,a=JSON.parse(JSON.stringify(this.options)),o=null;for(i in a)if(a.hasOwnProperty(i)){var r=e.toAttributeName(i),s=e.parse(t.getAttribute(r));null!=s&&(a[i]=s)}return a.renderTo=t,(o=new this.Type(a)).draw&&o.draw(),this.isObservable?(o.observer=new MutationObserver((function(i){i.forEach((function(i){if("attributes"===i.type){var a=i.attributeName.toLowerCase(),r=t.getAttribute(a).toLowerCase();if("data-type"===a&&r&&r!==n.type)o.observer.disconnect(),delete o.observer,o.destroy&&o.destroy();else if("data-"===a.substr(0,5)){var s=a.substr(5).split("-").map((function(t,e){return e?t.charAt(0).toUpperCase()+t.substr(1):t})).join(""),l={};l[s]=e.parse(t.getAttribute(i.attributeName)),"value"===s?o&&(o.value=l[s]):o.update&&o.update(l)}}}))})),o.observer.observe(t,{attributes:!0}),o):o}}],[{key:"parse",value:function(t){if("true"===t)return!0;if("false"===t)return!1;if("undefined"!==t){if("null"===t)return null;if(/^[-+#.\w\d\s]+(?:,[-+#.\w\d\s]*)+$/.test(t))return t.split(",");try{return JSON.parse(t)}catch(t){}return t}}},{key:"toDashed",value:function(t){for(var e=t.split(/(?=[A-Z])/),n=1,i=e.length,a=e[0].toLowerCase();n<i;n++)a+="-"+e[n].toLowerCase();return a}},{key:"toCamelCase",value:function(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=t.split(/-/),i=0,a=n.length,o="";i<a;i++)o+=i||e?n[i][0].toUpperCase()+n[i].substr(1).toLowerCase():n[i].toLowerCase();return o}},{key:"toAttributeName",value:function(t){return"data-"+e.toDashed(t)}},{key:"domReady",value:function(t){if(/comp|inter|loaded/.test((window.document||{}).readyState+""))return t();window.addEventListener?window.addEventListener("DOMContentLoaded",t,!1):window.attachEvent&&window.attachEvent("onload",t)}}]),e}(),q=function(){function t(e,n,i){a(this,t),t.collection.push(this),this.width=n||0,this.height=i||0,this.element=e,this.init()}return U(t,[{key:"init",value:function(){var e=t.pixelRatio;this.element.width=this.width*e,this.element.height=this.height*e,this.element.style.width=this.width+"px",this.element.style.height=this.height+"px",this.elementClone=this.element.cloneNode(!0),this.context=this.element.getContext("2d"),this.contextClone=this.elementClone.getContext("2d"),this.drawWidth=this.element.width,this.drawHeight=this.element.height,this.drawX=this.drawWidth/2,this.drawY=this.drawHeight/2,this.minSide=this.drawX<this.drawY?this.drawX:this.drawY,this.elementClone.initialized=!1,this.contextClone.translate(this.drawX,this.drawY),this.contextClone.save(),this.context.translate(this.drawX,this.drawY),this.context.save(),this.context.max=this.contextClone.max=this.minSide,this.context.maxRadius=this.contextClone.maxRadius=null}},{key:"destroy",value:function(){var e=t.collection.indexOf(this);~e&&t.collection.splice(e,1),this.context.clearRect(-this.drawX,-this.drawY,this.drawWidth,this.drawHeight),this.context.max=null,delete this.context.max,this.context.maxRadius=null,delete this.context.maxRadius,this.context=null,this.contextClone=null,this.elementClone=null,this.element=null,this.onRedraw=null}},{key:"commit",value:function(){var e=t.pixelRatio;return 1!==e&&(this.contextClone.scale(e,e),this.contextClone.save()),this}},{key:"redraw",value:function(){return this.init(),this.onRedraw&&this.onRedraw(),this}}],[{key:"redraw",value:function(){for(var e=0,n=t.collection.length;e<n;e++)t.collection[e].redraw()}},{key:"pixelRatio",get:function(){return window.devicePixelRatio||1}}]),t}();q.collection=[],window.matchMedia&&window.matchMedia("screen and (min-resolution: 2dppx)").addListener(q.redraw);var $={renderTo:null,width:0,height:0,minValue:0,maxValue:100,value:0,units:!1,exactTicks:!1,majorTicks:[0,20,40,60,80,100],minorTicks:10,strokeTicks:!0,animatedValue:!1,animateOnInit:!1,title:!1,borders:!0,numbersMargin:1,listeners:null,valueInt:3,valueDec:2,majorTicksInt:1,majorTicksDec:0,animation:!0,animationDuration:500,animationRule:"cycle",colorPlate:"#fff",colorPlateEnd:"",colorMajorTicks:"#444",colorMinorTicks:"#666",colorStrokeTicks:"",colorTitle:"#888",colorUnits:"#888",colorNumbers:"#444",colorNeedle:"rgba(240,128,128,1)",colorNeedleEnd:"rgba(255,160,122,.9)",colorValueText:"#444",colorValueTextShadow:"rgba(0,0,0,0.3)",colorBorderShadow:"rgba(0,0,0,0.5)",colorBorderOuter:"#ddd",colorBorderOuterEnd:"#aaa",colorBorderMiddle:"#eee",colorBorderMiddleEnd:"#f0f0f0",colorBorderInner:"#fafafa",colorBorderInnerEnd:"#ccc",colorValueBoxRect:"#888",colorValueBoxRectEnd:"#666",colorValueBoxBackground:"#babab2",colorValueBoxShadow:"rgba(0,0,0,1)",colorNeedleShadowUp:"rgba(2,255,255,0.2)",colorNeedleShadowDown:"rgba(188,143,143,0.45)",colorBarStroke:"#222",colorBar:"#ccc",colorBarProgress:"#888",colorBarShadow:"#000",fontNumbers:"Arial",fontTitle:"Arial",fontUnits:"Arial",fontValue:"Arial",fontNumbersSize:20,fontTitleSize:24,fontUnitsSize:22,fontValueSize:26,fontNumbersStyle:"normal",fontTitleStyle:"normal",fontUnitsStyle:"normal",fontValueStyle:"normal",fontNumbersWeight:"normal",fontTitleWeight:"normal",fontUnitsWeight:"normal",fontValueWeight:"normal",needle:!0,needleShadow:!0,needleType:"arrow",needleStart:5,needleEnd:85,needleWidth:4,borderOuterWidth:3,borderMiddleWidth:3,borderInnerWidth:3,borderShadowWidth:3,valueBox:!0,valueBoxStroke:5,valueBoxWidth:0,valueText:"",valueTextShadow:!0,valueBoxBorderRadius:2.5,highlights:[{from:20,to:60,color:"#eee"},{from:60,to:80,color:"#ccc"},{from:80,to:100,color:"#999"}],highlightsWidth:15,highlightsLineCap:"butt",barWidth:20,barStrokeWidth:0,barProgress:!0,barShadow:0};r.prototype=Object.create(Array.prototype),r.prototype.constructor=r,r.prototype.get=function(t){if("string"==typeof t)for(var e=0,n=this.length;e<n;e++){if((this[e].options.renderTo.tagName?this[e].options.renderTo:document.getElementById(this[e].options.renderTo||"")).getAttribute("id")===t)return this[e]}else if("number"==typeof t)return this[t];return null};var X="2.1.7",Q=Math.round,J=Math.abs,tt=new r;tt.version=X;var et=function(e){function o(e){a(this,o);var i=n(this,(o.__proto__||Object.getPrototypeOf(o)).call(this)),r=i.constructor.name;if("BaseGauge"===r)throw new TypeError("Attempt to instantiate abstract class!");if(tt.push(i),e.listeners&&Object.keys(e.listeners).forEach((function(t){(e.listeners[t]instanceof Array?e.listeners[t]:[e.listeners[t]]).forEach((function(e){i.on(t,e)}))})),i.version=X,i.type=t[r]||o,i.initialized=!1,e.minValue=parseFloat(e.minValue),e.maxValue=parseFloat(e.maxValue),e.value=parseFloat(e.value)||0,e.borders||(e.borderInnerWidth=e.borderMiddleWidth=e.borderOuterWidth=0),!e.renderTo)throw TypeError("Canvas element was not specified when creating the Gauge object!");var s=e.renderTo.tagName?e.renderTo:document.getElementById(e.renderTo);if(!(s instanceof HTMLCanvasElement))throw TypeError("Given gauge canvas element is invalid!");return e.width=parseFloat(e.width)||0,e.height=parseFloat(e.height)||0,e.width&&e.height||(e.width||(e.width=s.parentNode?s.parentNode.offsetWidth:s.offsetWidth),e.height||(e.height=s.parentNode?s.parentNode.offsetHeight:s.offsetHeight)),i.options=e||{},i.options.animateOnInit&&(i._value=i.options.value,i.options.value=i.options.minValue),i.canvas=new q(s,e.width,e.height),i.canvas.onRedraw=i.draw.bind(i),i.animation=new Y(e.animationRule,e.animationDuration),i}return i(o,e),U(o,[{key:"update",value:function(t){return Object.assign(this.options,this.type.configure(t||{})),this.canvas.width=this.options.width,this.canvas.height=this.options.height,this.animation.rule=this.options.animationRule,this.animation.duration=this.options.animationDuration,this.canvas.redraw(),this}},{key:"destroy",value:function(){var t=tt.indexOf(this);~t&&tt.splice(t,1),this.canvas.destroy(),this.canvas=null,this.animation.destroy(),this.animation=null,this.emit("destroy")}},{key:"draw",value:function(){return this.options.animateOnInit&&!this.initialized&&(this.value=this._value,this.initialized=!0,this.emit("init")),this.emit("render"),this}},{key:"value",set:function(t){var e=this;t=o.ensureValue(t,this.options.minValue);var n=this.options.value;if(t!==n)if(this.options.animation){if(this.animation.frame&&(this.options.value=this._value,this._value===t))return this.animation.cancel(),void delete this._value;void 0===this._value&&(this._value=t),this.emit("animationStart"),this.animation.animate((function(i){var a=n+(t-n)*i;e.options.animatedValue&&e.emit("value",a,e.value),e.options.value=a,e.draw(),e.emit("animate",i,e.options.value)}),(function(){void 0!==e._value&&(e.emit("value",e._value,e.value),e.options.value=e._value,delete e._value),e.draw(),e.emit("animationEnd")}))}else this.emit("value",t,this.value),this.options.value=t,this.draw()},get:function(){return void 0===this._value?this.options.value:this._value}}],[{key:"configure",value:function(t){return t}},{key:"initialize",value:function(t,e){return new Z(e,"canvas",t)}},{key:"fromElement",value:function(t){var e=Z.toCamelCase(t.getAttribute("data-type")),n=t.attributes,i=0,a=n.length,o={};if(e){for(/Gauge$/.test(e)||(e+="Gauge");i<a;i++)o[Z.toCamelCase(n[i].name.replace(/^data-/,""),!1)]=Z.parse(n[i].value);new Z(o,t.tagName,e).process(t)}}},{key:"ensureValue",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t=parseFloat(t),!isNaN(t)&&isFinite(t)||(t=parseFloat(e)||0),t}},{key:"mod",value:function(t,e){return(t%e+e)%e}},{key:"version",get:function(){return X}}]),o}(G);void 0!==t&&(t.BaseGauge=et,t.gauges=(window.document||{}).gauges=tt);var nt=/{([_a-zA-Z]+[_a-zA-Z0-9]*)}/g,it={roundRect:s,padValue:l,formatMajorTickNumber:function(t,e){var n=void 0,i=!1;return n=0===e.majorTicksDec?Math.round(t).toString():t.toFixed(e.majorTicksDec),e.majorTicksInt>1?(i=~n.indexOf("."),~n.indexOf("-")?"-"+[e.majorTicksInt+e.majorTicksDec+2+(i?1:0)-n.length].join("0")+n.replace("-",""):[e.majorTicksInt+e.majorTicksDec+1+(i?1:0)-n.length].join("0")+n):n},radians:function(t){return t*Math.PI/180},radialPoint:function(t,e){return{x:-t*Math.sin(e),y:t*Math.cos(e)}},linearGradient:function(t,e,n,i){var a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,r=t.createLinearGradient(a?0:o,a?o:0,a?0:i,a?i:0);return r.addColorStop(0,e),r.addColorStop(1,n),r},drawNeedleShadow:function(t,e){e.needleShadow&&(t.shadowOffsetX=2,t.shadowOffsetY=2,t.shadowBlur=10,t.shadowColor=e.colorNeedleShadowDown)},drawValueBox:function(t,e,n,i,a,o){if(e.valueBox){d(t);var r=e.valueDec?1+e.valueDec:0,h="9".repeat(Math.max.apply(null,[String(parseInt(n)).length+r].concat(e.majorTicks.map((function(t){return String(parseInt(t,10)).length+r}))))),p=e.valueText||l(n,e),m=o/200,g=o/100,f=.4*g,b=1.2*g;t.font=c(e,"Value",m),u(t,e,f,b);var y=t.measureText(e.valueText?p:"-"+l(Number(h),e)).width;d(t);var v=parseFloat(e.fontValueSize)*m+f+b,w=g*parseFloat(e.valueBoxStroke),x=2*o-2*w,S=y+10*g,C=1.1*v+f+b,T=g*e.valueBoxBorderRadius,O=(parseFloat(e.valueBoxWidth)||0)/100*x;O>S&&(S=O),S>x&&(S=x);var _=i-S/2,L=a-C/2,I=a-5.75*g;if(t.beginPath(),T?s(t,_,L,S,C,T):t.rect(_,L,S,C),w){var A=t.createRadialGradient(i,I,10*g,i,I,20*g);A.addColorStop(0,e.colorValueBoxRect),A.addColorStop(1,e.colorValueBoxRectEnd),t.strokeStyle=A,t.lineWidth=w,t.stroke()}e.colorValueBoxShadow&&(t.shadowBlur=1.2*g,t.shadowColor=e.colorValueBoxShadow),e.colorValueBoxBackground&&(t.fillStyle=e.colorValueBoxBackground,t.fill()),t.closePath(),t.restore(),u(t,e,f,b),t.fillStyle=e.colorValueText,t.textAlign="center",t.textBaseline="alphabetic",t.fillText(p,_+S/2,a+C/2-v/3),t.restore()}},verifyError:function(t){if(!(t instanceof DOMException&&2152923147===t.result))throw t},prepareTicks:function(t){return t.majorTicks instanceof Array||(t.majorTicks=t.majorTicks?[t.majorTicks]:[]),t.majorTicks.length||(t.majorTicks.push(it.formatMajorTickNumber(t.minValue,t)),t.majorTicks.push(it.formatMajorTickNumber(t.maxValue,t))),["right"!==t.tickSide,"left"!==t.tickSide]},drawShadow:function(t,e){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t.restore(),!0;t.save();var n=e.borderShadowWidth;return n&&(t.shadowBlur=n,t.shadowColor=e.colorBorderShadow),!0},font:c,normalizedValue:function(t){var e=t.value,n=t.minValue,i=t.maxValue,a=.01*(i-n);return{normal:e<n?n:e>i?i:e,indented:e<n?n-a:e>i?i+a:e}},formatContext:function(t,e){return e.replace(nt,(function(e,n){var i=t[n];return void 0!==i?i:e}))}},at=Math.PI,ot=at/2,rt=Object.assign({},$,{ticksAngle:270,startAngle:45,colorNeedleCircleOuter:"#f0f0f0",colorNeedleCircleOuterEnd:"#ccc",colorNeedleCircleInner:"#e8e8e8",colorNeedleCircleInnerEnd:"#f5f5f5",needleCircleSize:10,needleCircleInner:!0,needleCircleOuter:!0,needleStart:20,animationTarget:"needle",useMinPath:!1,barWidth:0,barStartPosition:"left"}),st=function(t){function e(t){return a(this,e),t=Object.assign({},rt,t||{}),n(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,e.configure(t)))}return i(e,t),U(e,[{key:"draw",value:function(){try{var t=this.canvas,n=[-t.drawX,-t.drawY,t.drawWidth,t.drawHeight],i=n[0],a=n[1],o=n[2],r=n[3],s=this.options;if("needle"===s.animationTarget){if(!t.elementClone.initialized){var l=t.contextClone;l.clearRect(i,a,o,r),l.save(),this.emit("beforePlate"),m(l,s),this.emit("beforeHighlights"),g(l,s),this.emit("beforeMinorTicks"),f(l,s),this.emit("beforeMajorTicks"),y(l,s),this.emit("beforeNumbers"),x(l,s),this.emit("beforeTitle"),S(l,s),this.emit("beforeUnits"),C(l,s),t.elementClone.initialized=!0}this.canvas.commit(),t.context.clearRect(i,a,o,r),t.context.save(),t.context.drawImage(t.elementClone,i,a,o,r),t.context.save(),this.emit("beforeProgressBar"),_(t.context,s),this.emit("beforeValueBox"),O(t.context,s,L(this)),this.emit("beforeNeedle"),T(t.context,s)}else{var c=-it.radians((s.value-s.minValue)/(s.maxValue-s.minValue)*s.ticksAngle);if(t.context.clearRect(i,a,o,r),t.context.save(),this.emit("beforePlate"),m(t.context,s),t.context.rotate(c),this.emit("beforeHighlights"),g(t.context,s),this.emit("beforeMinorTicks"),f(t.context,s),this.emit("beforeMajorTicks"),y(t.context,s),this.emit("beforeNumbers"),x(t.context,s),this.emit("beforeProgressBar"),_(t.context,s),t.context.rotate(-c),t.context.save(),!t.elementClone.initialized){var d=t.contextClone;d.clearRect(i,a,o,r),d.save(),this.emit("beforeTitle"),S(d,s),this.emit("beforeUnits"),C(d,s),this.emit("beforeNeedle"),T(d,s),t.elementClone.initialized=!0}t.context.drawImage(t.elementClone,i,a,o,r)}this.emit("beforeValueBox"),O(t.context,s,L(this)),B(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"draw",this).call(this)}catch(t){it.verifyError(t)}return this}},{key:"value",set:function(t){t=et.ensureValue(t,this.options.minValue),this.options.animation&&360===this.options.ticksAngle&&this.options.useMinPath&&(this._value=t,t=this.options.value+((t-this.options.value)%360+540)%360-180),function t(e,n,i,a){var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var r=Object.getPrototypeOf(e);null!==r&&t(r,n,i,a)}else if("value"in o&&o.writable)o.value=i;else{var s=o.set;void 0!==s&&s.call(a,i)}return i}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"value",t,this)},get:function(){return B(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"value",this)}}],[{key:"configure",value:function(t){return t.barWidth>50&&(t.barWidth=50),isNaN(t.startAngle)&&(t.startAngle=45),isNaN(t.ticksAngle)&&(t.ticksAngle=270),t.ticksAngle>360&&(t.ticksAngle=360),t.ticksAngle<0&&(t.ticksAngle=0),t.startAngle<0&&(t.startAngle=0),t.startAngle>360&&(t.startAngle=360),t}}]),e}(et);void 0!==t&&(t.RadialGauge=st),et.initialize("RadialGauge",rt);var lt=Object.assign({},$,{borderRadius:0,barBeginCircle:30,colorBarEnd:"",colorBarProgressEnd:"",needleWidth:6,tickSide:"both",needleSide:"both",numberSide:"both",ticksWidth:10,ticksWidthMinor:5,ticksPadding:5,barLength:85,fontTitleSize:26,highlightsWidth:10}),ct=function(t){function o(t){return a(this,o),t=Object.assign({},lt,t||{}),n(this,(o.__proto__||Object.getPrototypeOf(o)).call(this,o.configure(t)))}return i(o,t),U(o,[{key:"draw",value:function(){try{var t=this.canvas,n=[-t.drawX,-t.drawY,t.drawWidth,t.drawHeight],i=n[0],a=n[1],r=n[2],s=n[3],l=this.options;if(!t.elementClone.initialized){var c=t.contextClone;c.clearRect(i,a,r,s),c.save(),this.emit("beforePlate"),this.drawBox=A(c,l,i,a,r,s),this.emit("beforeBar"),E.apply(void 0,[c,l].concat(e(this.drawBox))),t.context.barDimensions=c.barDimensions,this.emit("beforeHighlights"),function(t,e){var n=t.barDimensions,i=n.isVertical,a=n.width,o=n.length,r=n.barWidth,s=n.barOffset,l=n.barMargin,c=n.X,d=n.Y,u=n.ticksLength,h=n.ticksPadding,p=a*(parseFloat(e.highlightsWidth)||0)/100;if(e.highlights&&p){var m="right"!==e.tickSide,g="left"!==e.tickSide,f=0,b=e.highlights.length,y=(a-r)/2,v=e.maxValue-e.minValue,w=Q(i?c+y:c+l+s),x=p,S=i?d+o-l-s:d+y,C=Q((e.ticksWidth/100+h)*a)+(p-e.ticksWidth/100*a),T=Q(r+h*a);for(t.save();f<b;f++){var O=e.highlights[f],_=u*J(e.minValue-O.from)/v,L=u*J((O.to-O.from)/v);t.beginPath(),t.fillStyle=O.color,i?(m&&t.rect(w-C,S-_,x,-L),g&&t.rect(w+T,S-_,x,-L)):(m&&t.rect(w+_,S-C,L,x),g&&t.rect(w+_,S+T,L,x)),t.fill(),t.closePath()}}}(c,l),this.emit("beforeMinorTicks"),function(t,e){var n=it.prepareTicks(e),i=z(n,2),a=i[0],o=i[1],r=[],s=e.minValue,l=Math.abs(e.minorTicks)||0,c=l?(e.maxValue-e.minValue)/(l*(e.majorTicks.length-1)):0;if(l)if(e.exactTicks)for(var d=et.mod(e.majorTicks[0],l)||0;s<e.maxValue;s+=l)d+s<e.maxValue&&r.push(d+s);else for(;s<e.maxValue;s+=c)r.push(s);M(t,e.colorMinorTicks||e.colorStrokeTicks,r,e.minValue,e.maxValue,a,o,1,e.ticksWidthMinor/100)}(c,l),this.emit("beforeMajorTicks"),function(t,e){var n=it.prepareTicks(e),i=z(n,2),a=i[0],o=i[1],r=2,s=(e.maxValue-e.minValue)/(e.majorTicks.length-1),l=e.colorMajorTicks instanceof Array?e.colorMajorTicks:new Array(e.majorTicks.length).fill(e.colorStrokeTicks||e.colorMajorTicks);if(M(t,l,e.exactTicks?e.majorTicks:e.majorTicks.map((function(t,n){return e.minValue+s*n})),e.minValue,e.maxValue,a,o,r,e.ticksWidth/100),e.strokeTicks){var c=t.barDimensions,d=c.isVertical,u=c.length,h=c.width,p=c.barWidth,m=c.barMargin,g=c.barOffset,f=c.X,b=c.Y,y=c.ticksLength,v=c.pixelRatio,w=c.ticksPadding,x=(h-p)/2+p+w*h,S=(h-p)/2-w*h,C=void 0,T=void 0,O=void 0,_=void 0;t.strokeStyle=e.colorStrokeTicks||l[0],r*=v,d?(_=(T=b+u-m-g+r/2)-y-r,a&&(O=C=Q(f+S),R(t,C,T,O,_)),o&&(O=C=Q(f+x),R(t,C,T,O,_))):(O=(C=f+m+g-r/2)+y+r,a&&(_=T=Q(b+S),R(t,C,T,O,_)),o&&(_=T=Q(b+x),R(t,C,T,O,_)))}}(c,l),this.emit("beforeNumbers"),function(t,e){var n=t.barDimensions,i=n.isVertical,a=n.length,o=n.width,r=n.barWidth,s=n.barMargin,l=n.barOffset,c=n.X,d=n.Y,u=n.ticksLength,h=n.ticksPadding,p=e.maxValue-e.minValue,m=p/(e.majorTicks.length-1),g=e.exactTicks?e.majorTicks:e.majorTicks.map((function(t,n){return e.minValue+m*n})),f=g.length,b="right"!==e.numberSide,y="left"!==e.numberSide,v=e.fontNumbersSize*o/200,w=0,x=(e.ticksWidth/100+2*h)*o,S=(o-r)/2-x,C=(o-r)/2+r+x,T=void 0,O=void 0,_=void 0,L=void 0,I=e.colorNumbers instanceof Array?e.colorNumbers:new Array(f).fill(e.colorNumbers),A=e.numbersMargin/100*o;for(t.font=it.font(e,"Numbers",o/200),t.lineWidth=0,t.textAlign="center";w<f;w++)t.fillStyle=I[w],L=e.majorTicks[w],_=e.exactTicks?u*((g[w]-e.minValue)/p):w*u/(f-1),i?(O=d+a-s-l-_+v/3,b&&(t.textAlign="right",t.fillText(L,c+S-A,O)),y&&(t.textAlign="left",t.fillText(L,c+C+A,O))):(t.measureText(L).width,T=c+s+l+_,b&&t.fillText(L,T,d+S-A),y&&t.fillText(L,T,d+C+v+A))}(c,l),this.emit("beforeTitle"),function(t,e){if(e.title){var n=t.barDimensions,i=n.isVertical,a=n.width,o=n.length,r=n.baseX,s=n.baseY,l=n.titleMargin,c=e.fontTitleSize*a/200,d=Q(r+(i?a:o)/2),u=Q(s+l/2-(i?c:c/2)-.025*(i?o:a));t.save(),t.textAlign="center",t.fillStyle=e.colorTitle,t.font=it.font(e,"Title",a/200),t.lineWidth=0,t.fillText(e.title,d,u,i?a:o)}}(c,l),this.emit("beforeUnits"),function(t,e){if(e.units){var n=t.barDimensions,i=n.isVertical,a=n.width,o=n.length,r=n.baseX,s=n.baseY,l=n.unitsMargin,c=e.fontUnitsSize*a/200,d=Q(r+(i?a:o)/2),u=Q(s+(i?o:a)+l/2-c/2);t.save(),t.textAlign="center",t.fillStyle=e.colorUnits,t.font=it.font(e,"Units",a/200),t.lineWidth=0,t.fillText(it.formatContext(e,e.units),d,u,i?a:o)}}(c,l),t.elementClone.initialized=!0}this.canvas.commit(),t.context.clearRect(i,a,r,s),t.context.save(),t.context.drawImage(t.elementClone,i,a,r,s),t.context.save(),this.emit("beforeProgressBar"),D.apply(void 0,[t.context,l].concat(e(this.drawBox))),this.emit("beforeNeedle"),function(t,e){if(e.needle){var n=t.barDimensions,i=n.isVertical,a=n.width,o=n.length,r=n.barWidth,s=n.barOffset,l=n.barMargin,c=n.ticksLength,d=n.X,u=n.Y,h=n.ticksPadding,p="right"!==e.needleSide,m="left"!==e.needleSide,g=c*(it.normalizedValue(e).indented-e.minValue)/(e.maxValue-e.minValue),f=(e.ticksWidth/100+h)*a,b=r/2+f,y=b*(e.needleEnd/100),v=void 0,w=void 0,x="arrow"===e.needleType.toLowerCase()?V:P,S=(a-r)/2,C=b*(e.needleStart/100),T=S-f-C,O=S+r+f+C;t.save(),it.drawNeedleShadow(t,e),i?(w=Q(u+o-l-s-g),p&&x(t,e,v=Q(d+T),w,v+y,w,y),m&&x(t,e,v=Q(d+O),w,v-y,w,y,!0)):(v=Q(d+l+s+g),p&&x(t,e,v,w=Q(u+T),v,w+y,y),m&&x(t,e,v,w=Q(u+O),v,w-y,y,!0)),t.restore()}}(t.context,l),this.emit("beforeValueBox"),W.apply(void 0,[t.context,l,l.animatedValue?this.options.value:this.value].concat(e(this.drawBox))),B(o.prototype.__proto__||Object.getPrototypeOf(o.prototype),"draw",this).call(this)}catch(t){it.verifyError(t)}return this}}],[{key:"configure",value:function(t){return t.barStrokeWidth>=t.barWidth&&(t.barStrokeWidth=Q(t.barWidth/2)),t.hasLeft=j("right",t),t.hasRight=j("left",t),t.value>t.maxValue&&(t.value=t.maxValue),t.value<t.minValue&&(t.value=t.minValue),et.configure(t)}}]),o}(et);void 0!==t&&(t.LinearGauge=ct),et.initialize("LinearGauge",lt),Object.assign(t,{Collection:r,GenericOptions:$,Animation:Y,BaseGauge:et,drawings:it,SmartCanvas:q,DomObserver:Z,vendorize:o})}(t.exports)},"s/fD":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div fxLayout="column" class="mat-content mat-padding">\n  <div fxLayout="row" *ngFor="let alias of entityAliasesInfo | keyvalue">\n    <mat-form-field fxFlex>\n      <mat-label>{{alias.value.alias}}</mat-label>\n      <mat-select [(ngModel)]="alias.value.selectedId"\n                  (ngModelChange)="currentAliasEntityChanged(alias.key, alias.value.selectedId)">\n        <mat-option *ngFor="let resolvedEntity of alias.value.resolvedEntities" [value]="resolvedEntity.id">\n          {{resolvedEntity.name}}\n        </mat-option>\n      </mat-select>\n    </mat-form-field>\n  </div>\n</div>\n'},sJ4O:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host-context(.tb-has-timewindow) .tb-entities-hierarchy mat-toolbar {\n  height: 60px;\n  max-height: 60px;\n}\n:host-context(.tb-has-timewindow) .tb-entities-hierarchy mat-toolbar .mat-toolbar-tools {\n  height: 60px;\n  max-height: 60px;\n}\n:host .tb-entities-hierarchy mat-toolbar.mat-table-toolbar:not([color=primary]) {\n  background: transparent;\n}\n:host .tb-entities-hierarchy mat-toolbar {\n  min-height: 39px;\n  max-height: 39px;\n}\n:host .tb-entities-hierarchy mat-toolbar .mat-toolbar-tools {\n  min-height: 39px;\n  max-height: 39px;\n}\n:host .tb-entities-hierarchy .tb-entities-nav-tree-panel {\n  overflow-x: auto;\n  overflow-y: auto;\n}\n:host ::ng-deep .tb-nav-tree-container.jstree-proton .jstree-anchor div.node-icon {\n  display: inline-block;\n  width: 22px;\n  height: 22px;\n  margin-right: 2px;\n  margin-bottom: 2px;\n  background-color: transparent;\n  background-repeat: no-repeat;\n  background-attachment: scroll;\n  background-position: center center;\n  background-size: 18px 18px;\n}\n:host ::ng-deep .tb-nav-tree-container.jstree-proton .jstree-anchor mat-icon.node-icon {\n  width: 22px;\n  min-width: 22px;\n  height: 22px;\n  min-height: 22px;\n  margin-right: 2px;\n  margin-bottom: 2px;\n  color: inherit;\n  vertical-align: middle;\n}\n:host ::ng-deep .tb-nav-tree-container.jstree-proton .jstree-anchor mat-icon.node-icon.material-icons {\n  font-size: 18px;\n  line-height: 22px;\n  text-align: center;\n}\n:host ::ng-deep .tb-nav-tree-container.jstree-proton .jstree-anchor.jstree-hovered:not(.jstree-clicked) div.node-icon, :host ::ng-deep .tb-nav-tree-container.jstree-proton .jstree-anchor.jstree-disabled div.node-icon {\n  opacity: 0.5;\n}\n@media (max-width: 768px) {\n  :host ::ng-deep .tb-nav-tree-container.jstree-proton-responsive .jstree-anchor div.node-icon {\n    width: 40px;\n    height: 40px;\n    margin: 0;\n    background-size: 24px 24px;\n  }\n  :host ::ng-deep .tb-nav-tree-container.jstree-proton-responsive .jstree-anchor mat-icon.node-icon {\n    width: 40px;\n    min-width: 40px;\n    height: 40px;\n    min-height: 40px;\n    margin: 0;\n  }\n  :host ::ng-deep .tb-nav-tree-container.jstree-proton-responsive .jstree-anchor mat-icon.node-icon.material-icons {\n    font-size: 24px;\n    line-height: 40px;\n  }\n}'},seHC:function(t,e,n){"use strict";n.d(e,"d",(function(){return h})),n.d(e,"b",(function(){return p})),n.d(e,"g",(function(){return m})),n.d(e,"h",(function(){return g})),n.d(e,"e",(function(){return f})),n.d(e,"f",(function(){return b})),n.d(e,"a",(function(){return v})),n.d(e,"l",(function(){return O})),n.d(e,"j",(function(){return _})),n.d(e,"i",(function(){return L})),n.d(e,"k",(function(){return I})),n.d(e,"m",(function(){return A})),n.d(e,"c",(function(){return k}));var i=n("mrSG"),a=n("4R65"),o=n.n(a),r=n("LvDl"),s=n.n(r),l=n("6blF"),c=n("F/XL"),d=n("67Y/"),u=n("//Q6");function h(t,e,n,i){var a=o.a.popup();return a.setContent(i),t.bindPopup(a,{autoClose:e.autocloseTooltip,closeOnClick:!1}),"hover"===e.showTooltipAction&&(t.off("click"),t.on("mouseover",(function(){t.openPopup()})),t.on("mouseout",(function(){t.closePopup()}))),t.on("popupopen",(function(){p(a,e,n)})),a}function p(t,e,n){var i=t.getElement().getElementsByClassName("tb-custom-action");Array.from(i).forEach((function(t){var i=t.getAttribute("data-action-name");t&&e.tooltipAction[i]&&(t.onclick=function(t){return e.tooltipAction[i](t,n),!1})}))}function m(t,e,n){return(n-t)/(e-t)}function g(t,e,n,i,a){var o;return(o={})[n]=t[n]+(e[n]-t[n])*a,o[i]=t[i]+(e[i]-t[i])*a,o}function f(t,e,n,i){if(Object(u.u)(t)||Object(u.u)(e))return 0;var a=-Math.atan2(e[n]-t[n],e[i]-t[i]);return a=180*a/Math.PI,parseInt(a.toFixed(2),10)}function b(t){return"string"==typeof t?t.split(","):"object"==typeof t?t:[0,0]}var y={};function v(t){var e;if(null===(e=t)||void 0===e?void 0:e.length){var n=Object(u.i)(t),i=y[n];return i?Object(c.a)(i):function(t){return new l.a((function(e){var n=document.createElement("img");n.style.position="absolute",n.style.left="-99999px",n.style.top="-99999px",n.onload=function(){e.next(n),document.body.removeChild(n),e.complete()},n.onerror=function(t){e.error(t),document.body.removeChild(n),e.complete()},document.body.appendChild(n),n.src=t}))}(t).pipe(Object(d.a)((function(t){return i=t.width/t.height,y[n]=i,i})))}}var w=/\${([^}]*)}/g,x=/<link-act name=['"]([^['"]*)['"]>([^<]*)<\/link-act>/g,S=/<button-act name=['"]([^['"]*)['"]>([^<]*)<\/button-act>/g;function C(t,e){return'<a href="javascript:void(0);" class="tb-custom-action" data-action-name='+t+">"+e+"</a>"}function T(t,e){return'<button mat-button class="tb-custom-action" data-action-name='+t+">"+e+"</button>"}var O={translateFn:null,translate:function(t,e){if(this.translateFn)return this.translateFn(t,e);throw console.error("Translate not assigned")},parseTemplate:function(t,e,n){return void 0===n&&(n=!1),function(t,e,n){var i="";try{n&&(t=n(t)),t=Object(u.c)(e.$datasource,t);for(var a=w.exec(t);null!==a;){var o=a[0],r=a[1],l=2,c=r.split(":");if(c.length>1&&(r=c[0],l=parseFloat(c[1])),r.startsWith("#")){var d=r.substring(1),h=Math.floor(Number(d));String(h)===d&&h>=0&&(r=e.$datasource.dataKeys[h].label)}var p=e[r]||"",m=void 0;m=Object(u.q)(p)?Object(u.A)(p,l):p,t=t.split(o).join(m),a=w.exec(t)}var g=void 0,f=void 0;for(a=x.exec(t);null!==a;)g=a[0],f=C(a[1],a[2]),t=t.split(g).join(f),a=x.exec(t);for(a=S.exec(t);null!==a;)g=a[0],f=T(a[1],a[2]),t=t.split(g).join(f),a=S.exec(t);i=s.a.template(t)(e)}catch(b){console.log(b,t)}return i}(n?this.translate(t):t,e,this.translate.bind(this))},setTranslate:function(t){this.translateFn=t}};function _(t){return s()(t).groupBy((function(t){var e,n;return null===(n=null===(e=t)||void 0===e?void 0:e.datasource)||void 0===n?void 0:n.entityName})).values().value().map((function(t,e){var n,i,a,o={entityName:null===(i=null===(n=t[0])||void 0===n?void 0:n.datasource)||void 0===i?void 0:i.entityName,$datasource:null===(a=t[0])||void 0===a?void 0:a.datasource,dsIndex:e,deviceType:null};return t.filter((function(t){return t.data.length})).forEach((function(t){var e,n,i,a,r,s,l,c,d;o[null===(n=null===(e=t)||void 0===e?void 0:e.dataKey)||void 0===n?void 0:n.label]=null===(i=t)||void 0===i?void 0:i.data[0][1],o[(null===(r=null===(a=t)||void 0===a?void 0:a.dataKey)||void 0===r?void 0:r.label)+"|ts"]=null===(s=t)||void 0===s?void 0:s.data[0][0],"type"===(null===(c=null===(l=t)||void 0===l?void 0:l.dataKey)||void 0===c?void 0:c.label)&&(o.deviceType=null===(d=t)||void 0===d?void 0:d.data[0][1])})),o}))}function L(t){return s()(t).groupBy((function(t){var e,n;return null===(n=null===(e=t)||void 0===e?void 0:e.datasource)||void 0===n?void 0:n.entityName})).values().value().map((function(t,e){return t[0].data.map((function(e,n){var i,a,o,r={entityName:null===(a=null===(i=t[0])||void 0===i?void 0:i.datasource)||void 0===a?void 0:a.entityName,$datasource:null===(o=t[0])||void 0===o?void 0:o.datasource,dsIndex:n,time:e[0],deviceType:null};return t.filter((function(t){return t.data.length&&t.data[n]})).forEach((function(t){var e,i,a,o,s,l,c,d,u;r[null===(i=null===(e=t)||void 0===e?void 0:e.dataKey)||void 0===i?void 0:i.label]=null===(a=t)||void 0===a?void 0:a.data[n][1],r[(null===(s=null===(o=t)||void 0===o?void 0:o.dataKey)||void 0===s?void 0:s.label)+"|ts"]=null===(l=t)||void 0===l?void 0:l.data[0][0],"type"===(null===(d=null===(c=t)||void 0===c?void 0:c.dataKey)||void 0===d?void 0:d.label)&&(r.deviceType=null===(u=t)||void 0===u?void 0:u.data[0][1])})),r}))}))}function I(t,e){var n;void 0===e&&(e=["def"]);var a=null;if(null===(n=t)||void 0===n?void 0:n.length)try{a=new(Function.bind.apply(Function,Object(i.l)([void 0],e,[t])))}catch(o){a=null}return a}function A(t,e){void 0===e&&(e=[]);var n=null;if(t&&"function"==typeof t)try{n=t.apply(void 0,e)}catch(i){console.log("error in external function:",i),n=null}return n}function k(t,e){var n=t/e;return n<0?n=0:n>1&&(n=1),n}},"t+c0":function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form [formGroup]="entityAliasesFormGroup" (ngSubmit)="save()" style="width: 700px;">\n  <mat-toolbar color="primary">\n    <h2>{{ title | translate }}</h2>\n    <span fxFlex></span>\n    <button mat-icon-button\n            (click)="cancel()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div style="height: 4px;" *ngIf="!(isLoading$ | async)"></div>\n  <div mat-dialog-content>\n    <div class="tb-aliases-header" fxLayout="row" fxLayoutAlign="start center">\n      <span fxFlex="5"></span>\n      <div fxFlex="95" fxLayout="row" fxLayoutAlign="start center">\n        <span class="tb-header-label" translate fxFlex="150px">alias.name</span>\n        <span class="tb-header-label" translate fxFlex style="padding-left: 10px;">alias.entity-filter</span>\n        <span class="tb-header-label" translate fxFlex="120px" style="padding-left: 10px;">alias.resolve-multiple</span>\n        <span style="min-width: 80px;"></span>\n      </div>\n    </div>\n    <fieldset [disabled]="isLoading$ | async">\n      <mat-divider></mat-divider>\n      <div fxFlex fxLayout="row" fxLayoutAlign="start center"\n           formArrayName="entityAliases"\n           *ngFor="let entityAliasControl of entityAliasesFormArray().controls; let $index = index">\n        <span fxFlex="5">{{$index + 1}}.</span>\n        <div class="mat-elevation-z4 tb-alias" fxFlex="95" fxLayout="row" fxLayoutAlign="start center">\n          <mat-form-field floatLabel="always" hideRequiredMarker class="mat-block" fxFlex="150px">\n            <mat-label></mat-label>\n            <input matInput [formControl]="entityAliasControl.get(\'alias\')" required placeholder="{{ \'entity.alias\' | translate }}">\n            <mat-error *ngIf="entityAliasControl.get(\'alias\').hasError(\'required\')">\n              {{ \'entity.alias-required\' | translate }}\n            </mat-error>\n          </mat-form-field>\n          <tb-entity-filter-view fxFlex style="padding-left: 10px;" [formControl]="entityAliasControl.get(\'filter\')">\n          </tb-entity-filter-view>\n          <section fxFlex="120px" style="padding-left: 10px;"\n                   class="tb-resolve-multiple-switch"\n                   fxLayout="column"\n                   fxLayoutAlign="center center">\n            <mat-slide-toggle class="resolve-multiple-switch"\n                   [formControl]="entityAliasControl.get(\'resolveMultiple\')">\n            </mat-slide-toggle>\n          </section>\n          <button [disabled]="isLoading$ | async"\n                  mat-icon-button color="primary"\n                  style="min-width: 40px;"\n                  type="button"\n                  (click)="editAlias($index)"\n                  matTooltip="{{ \'alias.edit\' | translate }}"\n                  matTooltipPosition="above">\n            <mat-icon>edit</mat-icon>\n          </button>\n          <button [disabled]="isLoading$ | async"\n                  mat-icon-button color="primary"\n                  style="min-width: 40px;"\n                  type="button"\n                  (click)="removeAlias($index)"\n                  matTooltip="{{ \'entity.remove-alias\' | translate }}"\n                  matTooltipPosition="above">\n            <mat-icon>close</mat-icon>\n          </button>\n        </div>\n      </div>\n    </fieldset>\n  </div>\n  <div mat-dialog-actions>\n    <button mat-raised-button color="primary"\n            type="button"\n            (click)="addAlias()"\n            [fxShow]="!disableAdd"\n            [disabled]="isLoading$ | async"\n            matTooltip="{{ \'alias.add\' | translate }}"\n            matTooltipPosition="above">\n      {{ \'alias.add\' | translate }}\n    </button>\n    <span fxFlex></span>\n    <button mat-raised-button color="primary"\n            type="submit"\n            [disabled]="(isLoading$ | async) || entityAliasesFormGroup.invalid || !entityAliasesFormGroup.dirty">\n      {{ \'action.save\' | translate }}\n    </button>\n    <button mat-button color="primary"\n            type="button"\n            [disabled]="(isLoading$ | async)"\n            (click)="cancel()"\n            cdkFocusInitial>\n      {{ \'action.cancel\' | translate }}\n    </button>\n  </div>\n</form>\n'},tDk6:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form [formGroup]="relationFormGroup" (ngSubmit)="save()" style="min-width: 600px;">\n  <mat-toolbar fxLayout="row" color="primary">\n    <h2>{{ (isAdd ? \'relation.add\' : \'relation.edit\' ) | translate }}</h2>\n    <span fxFlex></span>\n    <button mat-button mat-icon-button\n            (click)="cancel()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div style="height: 4px;" *ngIf="!(isLoading$ | async)"></div>\n  <div mat-dialog-content>\n    <fieldset [disabled]="isLoading$ | async">\n      <tb-relation-type-autocomplete\n        formControlName="type"\n        required="true">\n      </tb-relation-type-autocomplete>\n      <small>{{(direction === entitySearchDirection.FROM ?\n          \'relation.to-entity\' : \'relation.from-entity\') | translate}}</small>\n      <tb-entity-list-select\n        formControlName="targetEntityIds"\n        required="true">\n      </tb-entity-list-select>\n      <tb-json-object-edit\n        #additionalInfoEdit\n        [formControl]="additionalInfo"\n        label="{{ \'relation.additional-info\' | translate }}">\n      </tb-json-object-edit>\n      <div class="tb-error-messages" *ngIf="submitted &&\n                                            additionalInfo.invalid" role="alert">\n        <div translate class="tb-error-message">relation.invalid-additional-info</div>\n      </div>\n    </fieldset>\n  </div>\n  <div mat-dialog-actions fxLayout="row">\n    <span fxFlex></span>\n    <button mat-button mat-raised-button color="primary"\n            type="submit"\n            [disabled]="(isLoading$ | async) || relationFormGroup.invalid || !(relationFormGroup.dirty || additionalInfo.dirty)">\n      {{ (isAdd  ? \'action.add\' : \'action.save\') | translate }}\n    </button>\n    <button mat-button color="primary"\n            style="margin-right: 20px;"\n            type="button"\n            [disabled]="(isLoading$ | async)"\n            (click)="cancel()" cdkFocusInitial>\n      {{ \'action.cancel\' | translate }}\n    </button>\n  </div>\n</form>\n'},tFEo:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host table.tb-legend {\n  font-size: 12px;\n}\n:host table.tb-legend.tb-legend-column {\n  width: 100%;\n}\n:host table.tb-legend.tb-legend-row {\n  width: auto;\n  margin-left: auto;\n}\n:host table.tb-legend .tb-legend-header,\n:host table.tb-legend .tb-legend-value {\n  text-align: right;\n}\n:host table.tb-legend .tb-legend-header th {\n  padding: 0 10px 1px 0;\n  color: #ff6e40;\n  white-space: nowrap;\n  font-size: 12px;\n}\n:host table.tb-legend .tb-legend-keys td {\n  font-size: 12px;\n}\n:host table.tb-legend .tb-legend-keys td.tb-legend-label,\n:host table.tb-legend .tb-legend-keys td.tb-legend-value {\n  padding: 2px 10px;\n  white-space: nowrap;\n}\n:host table.tb-legend .tb-legend-keys .tb-legend-type {\n  min-width: 50px;\n  padding: 0 10px 1px 0;\n  font-weight: 700;\n  color: #ff6e40;\n  text-align: right;\n  white-space: nowrap;\n}\n:host table.tb-legend .tb-legend-keys .tb-legend-line {\n  display: inline-block;\n  width: 15px;\n  height: 3px;\n  vertical-align: middle;\n}\n:host table.tb-legend .tb-legend-keys .tb-legend-label {\n  padding: 2px 10px;\n  text-align: left;\n  white-space: nowrap;\n  outline: none;\n}\n:host table.tb-legend .tb-legend-keys .tb-legend-label.tb-horizontal {\n  width: 95%;\n}\n:host table.tb-legend .tb-legend-keys .tb-legend-label.tb-hidden-label {\n  text-decoration: line-through;\n  opacity: 0.6;\n}\n:host table.tb-legend .tb-legend-keys.tb-row-direction {\n  display: inline-block;\n}'},tM37:function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var i=n("mrSG"),a=n("TYT/"),o=n("MqYC"),r=n("ea4N"),s=n("6onV"),l=n("QJY3"),c=n("DaoB"),d=n("U3y+"),u=n("VNr4"),h=n("1y+p"),p=n("j37L"),m=n("YnEf"),g=n("gmuX"),f=n("DUip"),b=function(t){function e(e,n,i,a,o,r,s,l,c,d){var u=t.call(this,e,n,c)||this;return u.store=e,u.router=n,u.data=i,u.deviceService=a,u.assetService=o,u.entityViewService=r,u.dashboardService=s,u.errorStateMatcher=l,u.dialogRef=c,u.fb=d,u.submitted=!1,u.entityType=i.entityType,u}var g;return Object(i.d)(e,t),g=e,e.prototype.ngOnInit=function(){switch(this.addEntitiesToCustomerFormGroup=this.fb.group({entityIds:[null,[l.Validators.required]]}),this.data.entityType){case d.b.DEVICE:this.assignToCustomerTitle="device.assign-device-to-customer",this.assignToCustomerText="device.assign-device-to-customer-text";break;case d.b.ASSET:this.assignToCustomerTitle="asset.assign-asset-to-customer",this.assignToCustomerText="asset.assign-asset-to-customer-text";break;case d.b.ENTITY_VIEW:this.assignToCustomerTitle="entity-view.assign-entity-view-to-customer",this.assignToCustomerText="entity-view.assign-entity-view-to-customer-text";break;case d.b.DASHBOARD:this.assignToCustomerTitle="dashboard.assign-dashboard-to-customer",this.assignToCustomerText="dashboard.assign-dashboard-to-customer-text"}},e.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=!!(t&&t.invalid&&this.submitted);return n||i},e.prototype.cancel=function(){this.dialogRef.close(!1)},e.prototype.assign=function(){var t=this;this.submitted=!0;var e=this.addEntitiesToCustomerFormGroup.get("entityIds").value,n=[];e.forEach((function(e){n.push(t.getAssignToCustomerTask(t.data.customerId,e))})),Object(u.a)(n).subscribe((function(){t.dialogRef.close(!0)}))},e.prototype.getAssignToCustomerTask=function(t,e){switch(this.data.entityType){case d.b.DEVICE:return this.deviceService.assignDeviceToCustomer(t,e);case d.b.ASSET:return this.assetService.assignAssetToCustomer(t,e);case d.b.ENTITY_VIEW:return this.entityViewService.assignEntityViewToCustomer(t,e);case d.b.DASHBOARD:return this.dashboardService.assignDashboardToCustomer(t,e)}},e.ctorParameters=function(){return[{type:s.Store},{type:f.Router},{type:void 0,decorators:[{type:a.Inject,args:[r.MAT_DIALOG_DATA]}]},{type:c.a},{type:h.a},{type:p.a},{type:m.a},{type:o.d,decorators:[{type:a.SkipSelf}]},{type:r.MatDialogRef},{type:l.FormBuilder}]},e=g=Object(i.c)([Object(a.Component)({selector:"tb-add-entities-to-customer-dialog",template:Object(i.f)(n("vy0z")).default,providers:[{provide:o.d,useExisting:g}]}),Object(i.h)(2,Object(a.Inject)(r.MAT_DIALOG_DATA)),Object(i.h)(7,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[s.Store,f.Router,Object,c.a,h.a,p.a,m.a,o.d,r.MatDialogRef,l.FormBuilder])],e)}(g.a)},tdBX:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div class="trip-animation-widget">\n    <div class="trip-animation-label-container" *ngIf="settings.showLabel">\n        {{label}}\n    </div>\n    <div class="trip-animation-container" fxLayout="column">\n        <div class="map" #map></div>\n        <div class="trip-animation-info-panel" fxLayout="row">\n            <button class="tooltip-button" mat-mini-fab color="primary" aria-label="tooltip"\n                *ngIf="settings.showTooltip" (click)="visibleTooltip = !visibleTooltip">\n                <mat-icon>info_outline</mat-icon>\n            </button>\n        </div>\n        <div class="trip-animation-tooltip md-whiteframe-z4" fxLayout="column"\n            [ngClass]="{\'trip-animation-tooltip-hidden\':!visibleTooltip}" [innerHTML]="mainTooltip"\n            [ngStyle]="{\'background-color\': settings.tooltipColor, \'opacity\': settings.tooltipOpacity, \'color\': settings.tooltipFontColor}">\n        </div>\n    </div>\n  <tb-history-selector *ngIf="historicalData"\n                       [settings]="settings"\n                       [minTime]="minTime"\n                       [maxTime]="maxTime"\n                       [step]="normalizationStep"\n                       [anchors]="anchors"\n                       [useAnchors]="useAnchors"\n                       (timeUpdated)="timeUpdated($event)"></tb-history-selector>\n</div>\n'},thwt:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host {\n  width: 100%;\n  height: 100%;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-direction: column;\n      flex-direction: column;\n}\n:host ::ng-deep tb-details-panel > .mat-content > .mat-tab-group > .mat-tab-body-wrapper {\n  position: absolute;\n  top: 49px;\n  left: 0;\n  right: 0;\n  bottom: 0;\n}\n:host ::ng-deep tb-details-panel > .mat-content > .mat-tab-group > .mat-tab-header .mat-tab-label {\n  min-width: 40px;\n}'},txsh:function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var i=n("mrSG"),a=n("ea4N"),o=n("TYT/"),r=n("gmuX"),s=n("6onV"),l=n("DUip"),c=n("llUh"),d=function(t){function e(e,n,r,s,l){var d=t.call(this,e,n,s)||this;d.store=e,d.router=n,d.viewContainerRef=r,d.dialogRef=s,d.data=l,d.height="0px";var u={controller:d.data.controller};d.data.data&&(u=Object(i.a)(Object(i.a)({},u),d.data.data));var h=o.Injector.create({providers:[{provide:c.a,useValue:u},{provide:a.MatDialogRef,useValue:s}]});return d.customComponentRef=d.viewContainerRef.createComponent(d.data.customComponentFactory,0,h),d}return Object(i.d)(e,t),e.prototype.ngOnDestroy=function(){t.prototype.ngOnDestroy.call(this),this.customComponentRef&&this.customComponentRef.destroy()},e.ctorParameters=function(){return[{type:s.Store},{type:l.Router},{type:o.ViewContainerRef},{type:a.MatDialogRef},{type:void 0,decorators:[{type:o.Inject,args:[a.MAT_DIALOG_DATA]}]}]},Object(i.c)([Object(o.HostBinding)("style.height"),Object(i.g)("design:type",Object)],e.prototype,"height",void 0),e=Object(i.c)([Object(o.Component)({selector:"tb-custom-dialog-container-component",template:""}),Object(i.h)(4,Object(o.Inject)(a.MAT_DIALOG_DATA)),Object(i.g)("design:paramtypes",[s.Store,l.Router,o.ViewContainerRef,a.MatDialogRef,Object])],e)}(r.a)},uPsX:function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var i=n("mrSG"),a=n("TYT/"),o=n("MqYC"),r=n("ea4N"),s=n("6onV"),l=n("QJY3"),c=n("DaoB"),d=n("U3y+"),u=n("VNr4"),h=n("1y+p"),p=n("j37L"),m=n("gmuX"),g=n("DUip"),f=function(t){function e(e,n,i,a,o,r,s,l,c){var u=t.call(this,e,n,l)||this;return u.store=e,u.router=n,u.data=i,u.deviceService=a,u.assetService=o,u.entityViewService=r,u.errorStateMatcher=s,u.dialogRef=l,u.fb=c,u.submitted=!1,u.entityType=d.b,u}var m;return Object(i.d)(e,t),m=e,e.prototype.ngOnInit=function(){switch(this.assignToCustomerFormGroup=this.fb.group({customerId:[null,[l.Validators.required]]}),this.data.entityType){case d.b.DEVICE:this.assignToCustomerTitle="device.assign-device-to-customer",this.assignToCustomerText="device.assign-to-customer-text";break;case d.b.ASSET:this.assignToCustomerTitle="asset.assign-asset-to-customer",this.assignToCustomerText="asset.assign-to-customer-text";break;case d.b.ENTITY_VIEW:this.assignToCustomerTitle="entity-view.assign-entity-view-to-customer",this.assignToCustomerText="entity-view.assign-to-customer-text"}},e.prototype.isErrorState=function(t,e){var n=this.errorStateMatcher.isErrorState(t,e),i=!!(t&&t.invalid&&this.submitted);return n||i},e.prototype.cancel=function(){this.dialogRef.close(!1)},e.prototype.assign=function(){var t=this;this.submitted=!0;var e=this.assignToCustomerFormGroup.get("customerId").value,n=[];this.data.entityIds.forEach((function(i){n.push(t.getAssignToCustomerTask(e,i.id))})),Object(u.a)(n).subscribe((function(){t.dialogRef.close(!0)}))},e.prototype.getAssignToCustomerTask=function(t,e){switch(this.data.entityType){case d.b.DEVICE:return this.deviceService.assignDeviceToCustomer(t,e);case d.b.ASSET:return this.assetService.assignAssetToCustomer(t,e);case d.b.ENTITY_VIEW:return this.entityViewService.assignEntityViewToCustomer(t,e)}},e.ctorParameters=function(){return[{type:s.Store},{type:g.Router},{type:void 0,decorators:[{type:a.Inject,args:[r.MAT_DIALOG_DATA]}]},{type:c.a},{type:h.a},{type:p.a},{type:o.d,decorators:[{type:a.SkipSelf}]},{type:r.MatDialogRef},{type:l.FormBuilder}]},e=m=Object(i.c)([Object(a.Component)({selector:"tb-assign-to-customer-dialog",template:Object(i.f)(n("2TWi")).default,providers:[{provide:o.d,useExisting:m}]}),Object(i.h)(2,Object(a.Inject)(r.MAT_DIALOG_DATA)),Object(i.h)(6,Object(a.SkipSelf)()),Object(i.g)("design:paramtypes",[s.Store,g.Router,Object,c.a,h.a,p.a,o.d,r.MatDialogRef,l.FormBuilder])],e)}(m.a)},uRQ0:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host ::ng-deep .mat-dialog-content .mat-vertical-content form {\n  padding-bottom: 12px;\n}\n:host ::ng-deep .mat-dialog-content .mat-vertical-stepper-header {\n  pointer-events: none !important;\n}\n:host ::ng-deep .mat-dialog-content .tb-import-progress {\n  margin: 7px 0;\n}'},vFi6:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form class="mat-elevation-z1"\n      [formGroup]="attributeFormGroup" (ngSubmit)="update()" style="width: 400px; padding: 5px;">\n  <fieldset [disabled]="isLoading$ | async">\n    <tb-value-input\n      formControlName="value"\n      requiredText="attribute.value-required">\n    </tb-value-input>\n  </fieldset>\n  <div fxLayout="row" class="tb-panel-actions">\n    <span fxFlex></span>\n    <button mat-button color="primary"\n            style="margin-right: 20px;"\n            type="button"\n            [disabled]="(isLoading$ | async)"\n            (click)="cancel()" cdkFocusInitial>\n      {{ \'action.cancel\' | translate }}\n    </button>\n    <button mat-button mat-raised-button color="primary"\n            type="submit"\n            [disabled]="(isLoading$ | async) || attributeFormGroup.invalid || !attributeFormGroup.dirty">\n      {{ \'action.update\' | translate }}\n    </button>\n  </div>\n</form>\n'},"vU+U":function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host {\n  width: 100%;\n  height: 100%;\n  min-width: 300px;\n  overflow: hidden;\n  background: #fff;\n  border-radius: 4px;\n  box-shadow: 0 7px 8px -4px rgba(0, 0, 0, 0.2), 0 13px 19px 2px rgba(0, 0, 0, 0.14), 0 5px 24px 4px rgba(0, 0, 0, 0.12);\n}\n:host .mat-content {\n  overflow: hidden;\n  background-color: #fff;\n}\n:host .mat-padding {\n  padding: 16px;\n}'},vZSk:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\ntb-dashboard-toolbar mat-fab-toolbar mat-fab-trigger .mat-fab {\n  width: 36px;\n  height: 36px;\n  margin: 4px 0 0 4px;\n}\ntb-dashboard-toolbar mat-fab-toolbar mat-fab-trigger .mat-fab .mat-button-wrapper {\n  padding: 0;\n}\ntb-dashboard-toolbar mat-fab-toolbar.is-fullscreen .mat-fab-toolbar-wrapper {\n  height: 84px;\n}\n@media screen and (min-width: 960px) {\n  tb-dashboard-toolbar mat-fab-toolbar.is-fullscreen .mat-fab-toolbar-wrapper {\n    height: 64px;\n  }\n}\ntb-dashboard-toolbar mat-fab-toolbar.is-fullscreen .mat-fab-toolbar-wrapper mat-toolbar {\n  height: 80px;\n  min-height: 80px;\n}\ntb-dashboard-toolbar mat-fab-toolbar.is-fullscreen .mat-fab-toolbar-wrapper mat-toolbar .mat-toolbar-tools {\n  height: 80px;\n  min-height: 80px;\n}\n@media screen and (min-width: 960px) {\n  tb-dashboard-toolbar mat-fab-toolbar.is-fullscreen .mat-fab-toolbar-wrapper mat-toolbar {\n    height: 64px;\n    min-height: 64px;\n  }\n  tb-dashboard-toolbar mat-fab-toolbar.is-fullscreen .mat-fab-toolbar-wrapper mat-toolbar .mat-toolbar-tools {\n    height: 64px;\n    min-height: 64px;\n  }\n}\ntb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper {\n  height: 84px;\n}\n@media screen and (min-width: 960px) {\n  tb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper {\n    height: 50px;\n  }\n}\ntb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar {\n  height: 80px;\n  min-height: 80px;\n}\ntb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar .mat-toolbar-tools {\n  height: 80px;\n  min-height: 80px;\n}\n@media screen and (min-width: 960px) {\n  tb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar {\n    height: 50px;\n    min-height: 50px;\n  }\n  tb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar .mat-toolbar-tools {\n    height: 50px;\n    min-height: 50px;\n  }\n}\ntb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar mat-fab-actions {\n  margin-top: 0;\n  font-size: 16px;\n}\n@media screen and (max-width: 959px) {\n  tb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar mat-fab-actions {\n    height: 80px;\n    max-height: 80px;\n  }\n}\ntb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar mat-fab-actions .close-action {\n  margin-right: -18px;\n}\ntb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar mat-fab-actions .mat-fab-action-item {\n  width: 100%;\n  height: 80px;\n}\n@media screen and (min-width: 960px) {\n  tb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar mat-fab-actions .mat-fab-action-item {\n    height: 46px;\n  }\n}\ntb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar mat-fab-actions .mat-fab-action-item .tb-dashboard-action-panels {\n  height: 80px;\n}\n@media screen and (min-width: 960px) {\n  tb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar mat-fab-actions .mat-fab-action-item .tb-dashboard-action-panels {\n    height: 46px;\n  }\n}\ntb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar mat-fab-actions .mat-fab-action-item .tb-dashboard-action-panels .tb-dashboard-action-panel {\n  min-width: 0;\n  height: 40px;\n}\n@media screen and (max-width: 959px) {\n  tb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar mat-fab-actions .mat-fab-action-item .tb-dashboard-action-panels .tb-dashboard-action-panel mat-menu {\n    margin: 0;\n  }\n}\n@media screen and (min-width: 960px) {\n  tb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar mat-fab-actions .mat-fab-action-item .tb-dashboard-action-panels .tb-dashboard-action-panel {\n    height: 46px;\n  }\n}\ntb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar mat-fab-actions .mat-fab-action-item .tb-dashboard-action-panels .tb-dashboard-action-panel > div {\n  height: 40px;\n}\n@media screen and (min-width: 960px) {\n  tb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar mat-fab-actions .mat-fab-action-item .tb-dashboard-action-panels .tb-dashboard-action-panel > div {\n    height: 46px;\n  }\n}\ntb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar mat-fab-actions .mat-fab-action-item .tb-dashboard-action-panels .tb-dashboard-action-panel mat-select {\n  margin: 0;\n  pointer-events: all;\n}\ntb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar mat-fab-actions .mat-fab-action-item .tb-dashboard-action-panels .tb-dashboard-action-panel tb-states-component {\n  pointer-events: all;\n}\ntb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar mat-fab-actions .mat-fab-action-item .tb-dashboard-action-panels .tb-dashboard-action-panel button.mat-icon-button:not(.tb-mat-32) {\n  min-width: 40px;\n}\n@media screen and (max-width: 959px) {\n  tb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar mat-fab-actions .mat-fab-action-item .tb-dashboard-action-panels .tb-dashboard-action-panel button.mat-icon-button:not(.tb-mat-32) {\n    min-width: 28px;\n    padding: 2px;\n    margin: 0;\n  }\n  tb-dashboard-toolbar mat-fab-toolbar .mat-fab-toolbar-wrapper mat-toolbar mat-fab-actions .mat-fab-action-item .tb-dashboard-action-panels .tb-dashboard-action-panel button.mat-icon-button:not(.tb-mat-32) .mat-button-wrapper {\n    display: block;\n    line-height: 24px;\n  }\n}'},veKH:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n.tb-widget .tb-widget-error {\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-align: center;\n      align-items: center;\n  -ms-flex-pack: center;\n      justify-content: center;\n  background: rgba(255, 255, 255, 0.5);\n}\n.tb-widget .tb-widget-error span {\n  color: #f00;\n}\n.tb-widget .tb-widget-loading {\n  z-index: 3;\n  background: rgba(255, 255, 255, 0.15);\n}\n.tb-widget .tb-widget-error-container {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  background-color: #fff;\n}\n.tb-widget .tb-widget-error-msg {\n  padding: 5px;\n  font-size: 16px;\n  color: #f00;\n  word-wrap: break-word;\n}\n.tb-widget #widget-container {\n  min-height: 0;\n  min-width: 0;\n}'},vwmd:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .gateway-form {\n  height: 100%;\n  padding: 5px;\n  background-color: transparent;\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n:host .gateway-form .form-action-buttons {\n  padding-top: 8px;\n}\n:host .gateway-form .gateway-config .no-data-found {\n  position: relative;\n  display: -ms-flexbox;\n  display: flex;\n  height: 40px;\n  text-transform: uppercase;\n}\n:host ::ng-deep .mat-form-field-infix {\n  width: auto !important;\n}'},vy0z:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<form [formGroup]="addEntitiesToCustomerFormGroup" (ngSubmit)="assign()">\n  <mat-toolbar color="primary">\n    <h2>{{ assignToCustomerTitle | translate }}</h2>\n    <span fxFlex></span>\n    <button mat-button mat-icon-button\n            (click)="cancel()"\n            type="button">\n      <mat-icon class="material-icons">close</mat-icon>\n    </button>\n  </mat-toolbar>\n  <mat-progress-bar color="warn" mode="indeterminate" *ngIf="isLoading$ | async">\n  </mat-progress-bar>\n  <div style="height: 4px;" *ngIf="!(isLoading$ | async)"></div>\n  <div mat-dialog-content>\n    <fieldset [disabled]="isLoading$ | async">\n      <span>{{ assignToCustomerText | translate }}</span>\n      <tb-entity-list\n        formControlName="entityIds"\n        required\n        [entityType]="entityType"\n      >\n      </tb-entity-list>\n    </fieldset>\n  </div>\n  <div mat-dialog-actions fxLayoutAlign="end center">\n    <button mat-raised-button color="primary"\n            type="submit"\n            [disabled]="(isLoading$ | async) || addEntitiesToCustomerFormGroup.invalid\n            || !addEntitiesToCustomerFormGroup.dirty">\n      {{ \'action.assign\' | translate }}\n    </button>\n    <button mat-button color="primary"\n            type="button"\n            [disabled]="(isLoading$ | async)"\n            (click)="cancel()" cdkFocusInitial>\n      {{ \'action.cancel\' | translate }}\n    </button>\n  </div>\n</form>\n'},wFkW:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div class="tb-table-widget tb-absolute-fill">\n  <div fxFlex fxLayout="column" class="tb-absolute-fill">\n    <mat-toolbar class="mat-table-toolbar" [fxShow]="textSearchMode && alarmsDatasource.selection.isEmpty()">\n      <div class="mat-toolbar-tools">\n        <button mat-button mat-icon-button\n                matTooltip="{{ \'action.search\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>search</mat-icon>\n        </button>\n        <mat-form-field fxFlex>\n          <mat-label>&nbsp;</mat-label>\n          <input #searchInput matInput\n                 [(ngModel)]="pageLink.textSearch"\n                 placeholder="{{ \'alarm.search\' | translate }}"/>\n        </mat-form-field>\n        <button mat-button mat-icon-button (click)="exitFilterMode()"\n                matTooltip="{{ \'action.close\' | translate }}"\n                matTooltipPosition="above">\n          <mat-icon>close</mat-icon>\n        </button>\n      </div>\n    </mat-toolbar>\n    <mat-toolbar class="mat-table-toolbar" color="primary" [fxShow]="!alarmsDatasource.selection.isEmpty()">\n      <div class="mat-toolbar-tools">\n                <span>\n                  {{ translate.get(\'alarm.selected-alarms\',\n                  {count: alarmsDatasource.selection.selected.length}) | async }}\n                </span>\n        <span fxFlex></span>\n        <button *ngIf="allowAcknowledgment"\n                mat-button mat-icon-button [disabled]="isLoading$ | async"\n                matTooltip="{{ \'alarm.acknowledge\' | translate }}"\n                matTooltipPosition="above"\n                (click)="ackAlarms($event)">\n          <mat-icon>done</mat-icon>\n        </button>\n        <button mat-button mat-icon-button\n                [disabled]="isLoading$ | async"\n                matTooltip="{{ \'alarm.clear\' | translate }}"\n                matTooltipPosition="above"\n                (click)="clearAlarms($event)">\n          <mat-icon>clear</mat-icon>\n        </button>\n      </div>\n    </mat-toolbar>\n    <div fxFlex class="table-container">\n      <table mat-table [dataSource]="alarmsDatasource"\n                 matSort [matSortActive]="sortOrderProperty" [matSortDirection]="pageLink.sortDirection()" matSortDisableClear>\n        <ng-container matColumnDef="select" sticky>\n          <mat-header-cell *matHeaderCellDef style="width: 30px;">\n            <mat-checkbox (change)="$event ? alarmsDatasource.masterToggle() : null"\n                          [checked]="alarmsDatasource.selection.hasValue() && (alarmsDatasource.isAllSelected() | async)"\n                          [indeterminate]="alarmsDatasource.selection.hasValue() && !(alarmsDatasource.isAllSelected() | async)">\n            </mat-checkbox>\n          </mat-header-cell>\n          <mat-cell *matCellDef="let alarm">\n            <mat-checkbox (click)="$event.stopPropagation();"\n                          (change)="$event ? alarmsDatasource.toggleSelection(alarm) : null"\n                          [checked]="alarmsDatasource.isSelected(alarm)">\n            </mat-checkbox>\n          </mat-cell>\n        </ng-container>\n        <ng-container [matColumnDef]="column.def" *ngFor="let column of columns; trackBy: trackByColumnDef;">\n          <mat-header-cell [ngStyle]="headerStyle(column)" *matHeaderCellDef mat-sort-header> {{ column.title }} </mat-header-cell>\n          <mat-cell *matCellDef="let alarm;"\n                    [innerHTML]="cellContent(alarm, column)"\n                    [ngStyle]="cellStyle(alarm, column)">\n          </mat-cell>\n        </ng-container>\n        <ng-container matColumnDef="actions" [stickyEnd]="enableStickyAction">\n          <mat-header-cell *matHeaderCellDef [ngStyle.gt-md]="{ minWidth: (actionCellDescriptors.length * 40) + \'px\',\n                                                                maxWidth: (actionCellDescriptors.length * 40) + \'px\',\n                                                                width: (actionCellDescriptors.length * 40) + \'px\' }">\n          </mat-header-cell>\n          <mat-cell *matCellDef="let alarm" [ngStyle.gt-md]="{ minWidth: (actionCellDescriptors.length * 40) + \'px\',\n                                                                maxWidth: (actionCellDescriptors.length * 40) + \'px\',\n                                                                width: (actionCellDescriptors.length * 40) + \'px\' }">\n            <div fxHide fxShow.gt-md fxFlex fxLayout="row" fxLayoutAlign="end">\n              <button mat-button mat-icon-button [disabled]="(isLoading$ | async) || !actionEnabled(alarm, actionDescriptor)"\n                      *ngFor="let actionDescriptor of actionCellDescriptors"\n                      matTooltip="{{ actionDescriptor.displayName }}"\n                      matTooltipPosition="above"\n                      (click)="onActionButtonClick($event, alarm, actionDescriptor)">\n                <mat-icon>{{actionDescriptor.icon}}</mat-icon>\n              </button>\n            </div>\n            <div fxHide fxShow.lt-lg *ngIf="actionCellDescriptors.length">\n              <button mat-button mat-icon-button\n                      (click)="$event.stopPropagation(); ctx.detectChanges();"\n                      [matMenuTriggerFor]="cellActionsMenu">\n                <mat-icon class="material-icons">more_vert</mat-icon>\n              </button>\n              <mat-menu #cellActionsMenu="matMenu" xPosition="before">\n                <button mat-menu-item *ngFor="let actionDescriptor of actionCellDescriptors"\n                        [disabled]="(isLoading$ | async) || !actionEnabled(alarm, actionDescriptor)"\n                        (click)="onActionButtonClick($event, alarm, actionDescriptor)">\n                  <mat-icon>{{actionDescriptor.icon}}</mat-icon>\n                  <span>{{ actionDescriptor.displayName }}</span>\n                </button>\n              </mat-menu>\n            </div>\n          </mat-cell>\n        </ng-container>\n        <mat-header-row [ngClass]="{\'mat-row-select\': enableSelection}" *matHeaderRowDef="displayedColumns; sticky: true"></mat-header-row>\n        <mat-row [ngClass]="{\'mat-row-select\': enableSelection,\n                             \'mat-selected\': alarmsDatasource.isSelected(alarm),\n                             \'tb-current-entity\': alarmsDatasource.isCurrentAlarm(alarm)}"\n                 *matRowDef="let alarm; columns: displayedColumns;"\n                 (click)="onRowClick($event, alarm)"></mat-row>\n      </table>\n      <span [fxShow]="alarmsDatasource.isEmpty() | async"\n            fxLayoutAlign="center center"\n            class="no-data-found" translate>alarm.no-alarms-prompt</span>\n    </div>\n    <mat-divider *ngIf="displayPagination"></mat-divider>\n    <mat-paginator *ngIf="displayPagination"\n                   [length]="alarmsDatasource.total() | async"\n                   [pageIndex]="pageLink.page"\n                   [pageSize]="pageLink.pageSize"\n                   [pageSizeOptions]="pageSizeOptions"></mat-paginator>\n  </div>\n</div>\n'},wefO:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host {\n  min-width: 300px;\n  max-height: 150px;\n  overflow-x: hidden;\n  overflow-y: auto;\n  background: #fff;\n  border-radius: 4px;\n  box-shadow: 0 7px 8px -4px rgba(0, 0, 0, 0.2), 0 13px 19px 2px rgba(0, 0, 0, 0.14), 0 5px 24px 4px rgba(0, 0, 0, 0.12);\n}\n@media (min-height: 350px) {\n  :host {\n    max-height: 250px;\n  }\n}\n:host .mat-content {\n  background-color: #fff;\n}'},wpRk:function(t,e,n){"use strict";n.r(e),e.default="@charset \"UTF-8\";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .tb-switch {\n  width: 100%;\n  height: 100%;\n}\n:host .tb-switch .error-container {\n  position: absolute;\n  top: 1%;\n  right: 0;\n  left: 0;\n  z-index: 4;\n  height: 14px;\n}\n:host .tb-switch .error-container .switch-error {\n  color: #ff3315;\n  white-space: nowrap;\n}\n:host .tb-switch .onoff-container {\n  height: 100%;\n  font-weight: 500;\n  color: #757575;\n  white-space: nowrap;\n}\n:host .tb-switch .onoff-container .off-label {\n  color: #b7b5b5;\n}\n:host .tb-switch .onoff-container .on-label {\n  color: #ff7e57;\n  text-shadow: #ff6e4a 1px 1px 10px, #ffd1c3 1px 1px 10px;\n}\n:host .tb-switch .title-container .switch-title {\n  font-weight: 500;\n  color: #757575;\n  white-space: nowrap;\n}\n:host .tb-switch #switch-container {\n  padding-right: 10px;\n  padding-left: 10px;\n}\n:host .tb-switch .switch {\n  position: relative;\n}\n:host .tb-switch #text-measure {\n  position: absolute;\n  width: auto;\n  height: auto;\n  white-space: nowrap;\n  visibility: hidden;\n}\n:host ::ng-deep .tb-switch .switch mat-slide-toggle {\n  position: absolute;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  left: 0;\n  margin: 0;\n}\n:host ::ng-deep .tb-switch .switch mat-slide-toggle .mat-slide-toggle-bar {\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: url('thumb-bar.27f77ddce437270e3246.svg') no-repeat;\n  background-size: contain;\n  border-radius: 0;\n}\n:host ::ng-deep .tb-switch .switch mat-slide-toggle .mat-slide-toggle-thumb-container {\n  top: 5%;\n  left: 0.25%;\n  width: 50%;\n  height: 90%;\n}\n:host ::ng-deep .tb-switch .switch mat-slide-toggle .mat-slide-toggle-thumb {\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: url('thumb.3dba14b5469fb83a8c2f.svg') no-repeat;\n  background-size: contain;\n  border-radius: 0;\n  box-shadow: none;\n}\n:host ::ng-deep .tb-switch .switch mat-slide-toggle.mat-checked .mat-slide-toggle-thumb-container {\n  transform: translate3d(100%, 0, 0);\n}\n:host ::ng-deep .tb-switch .switch mat-slide-toggle.mat-checked .mat-slide-toggle-bar {\n  background: url('thumb-bar-checked.954f0d6c33f2090ba360.svg') no-repeat;\n  background-size: contain;\n}\n:host ::ng-deep .tb-switch .switch mat-slide-toggle.mat-checked .mat-slide-toggle-thumb {\n  background: url('thumb-checked.d24f2fe452504415d54e.svg') no-repeat;\n  background-size: contain;\n}"},wst2:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n("mrSG"),a=n("TYT/"),o=n("Valr"),r=n("PCNd"),s=n("10j8"),l=function(){function t(){}return t=Object(i.c)([Object(a.NgModule)({declarations:[s.a],imports:[o.CommonModule,r.a],exports:[s.a]})],t)}()},xK7S:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host .mat-dialog-content {\n  padding: 0 !important;\n  margin: 0 !important;\n  overflow: hidden;\n}'},xOOu:function(t,e,n){t.exports=function t(e,n,i){function a(r,s){if(!n[r]){if(!e[r]){if(o)return o(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[r]={exports:{}};e[r][0].call(c.exports,(function(t){return a(e[r][1][t]||t)}),c,c.exports,t,e,n,i)}return n[r].exports}for(var o=!1,r=0;r<i.length;r++)a(i[r]);return a}({1:[function(t,e,n){"use strict";var i=t("./utils"),a=t("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(t){for(var e,n,a,r,s,l,c,d=[],u=0,h=t.length,p=h,m="string"!==i.getTypeOf(t);u<t.length;)p=h-u,a=m?(e=t[u++],n=u<h?t[u++]:0,u<h?t[u++]:0):(e=t.charCodeAt(u++),n=u<h?t.charCodeAt(u++):0,u<h?t.charCodeAt(u++):0),r=e>>2,s=(3&e)<<4|n>>4,l=1<p?(15&n)<<2|a>>6:64,c=2<p?63&a:64,d.push(o.charAt(r)+o.charAt(s)+o.charAt(l)+o.charAt(c));return d.join("")},n.decode=function(t){var e,n,i,r,s,l,c=0,d=0,u="data:";if(t.substr(0,u.length)===u)throw new Error("Invalid base64 input, it looks like a data url.");var h,p=3*(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(t.charAt(t.length-1)===o.charAt(64)&&p--,t.charAt(t.length-2)===o.charAt(64)&&p--,p%1!=0)throw new Error("Invalid base64 input, bad content length.");for(h=a.uint8array?new Uint8Array(0|p):new Array(0|p);c<t.length;)e=o.indexOf(t.charAt(c++))<<2|(r=o.indexOf(t.charAt(c++)))>>4,n=(15&r)<<4|(s=o.indexOf(t.charAt(c++)))>>2,i=(3&s)<<6|(l=o.indexOf(t.charAt(c++))),h[d++]=e,64!==s&&(h[d++]=n),64!==l&&(h[d++]=i);return h}},{"./support":30,"./utils":32}],2:[function(t,e,n){"use strict";var i=t("./external"),a=t("./stream/DataWorker"),o=t("./stream/DataLengthProbe"),r=t("./stream/Crc32Probe");function s(t,e,n,i,a){this.compressedSize=t,this.uncompressedSize=e,this.crc32=n,this.compression=i,this.compressedContent=a}o=t("./stream/DataLengthProbe"),s.prototype={getContentWorker:function(){var t=new a(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),e=this;return t.on("end",(function(){if(this.streamInfo.data_length!==e.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),t},getCompressedWorker:function(){return new a(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},s.createWorkerFrom=function(t,e,n){return t.pipe(new r).pipe(new o("uncompressedSize")).pipe(e.compressWorker(n)).pipe(new o("compressedSize")).withStreamInfo("compression",e)},e.exports=s},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,e,n){"use strict";var i=t("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(t){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},n.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,e,n){"use strict";var i=t("./utils"),a=function(){for(var t,e=[],n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}();e.exports=function(t,e){return void 0!==t&&t.length?"string"!==i.getTypeOf(t)?function(t,e,n,i){var o=a,r=0+n;t^=-1;for(var s=0;s<r;s++)t=t>>>8^o[255&(t^e[s])];return-1^t}(0|e,t,t.length):function(t,e,n,i){var o=a,r=0+n;t^=-1;for(var s=0;s<r;s++)t=t>>>8^o[255&(t^e.charCodeAt(s))];return-1^t}(0|e,t,t.length):0}},{"./utils":32}],5:[function(t,e,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(t,e,n){"use strict";var i;i="undefined"!=typeof Promise?Promise:t("lie"),e.exports={Promise:i}},{lie:37}],7:[function(t,e,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,a=t("pako"),o=t("./utils"),r=t("./stream/GenericWorker"),s=i?"uint8array":"array";function l(t,e){r.call(this,"FlateWorker/"+t),this._pako=null,this._pakoAction=t,this._pakoOptions=e,this.meta={}}n.magic="\b\0",o.inherits(l,r),l.prototype.processChunk=function(t){this.meta=t.meta,null===this._pako&&this._createPako(),this._pako.push(o.transformTo(s,t.data),!1)},l.prototype.flush=function(){r.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){r.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(e){t.push({data:e,meta:t.meta})}},n.compressWorker=function(t){return new l("Deflate",t)},n.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,e,n){"use strict";function i(t,e){var n,i="";for(n=0;n<e;n++)i+=String.fromCharCode(255&t),t>>>=8;return i}function a(t,e,n,a,r,d){var u,h,p=t.file,m=t.compression,g=d!==s.utf8encode,f=o.transformTo("string",d(p.name)),b=o.transformTo("string",s.utf8encode(p.name)),y=p.comment,v=o.transformTo("string",d(y)),w=o.transformTo("string",s.utf8encode(y)),x=b.length!==p.name.length,S=w.length!==y.length,C="",T="",O="",_=p.dir,L=p.date,I={crc32:0,compressedSize:0,uncompressedSize:0};e&&!n||(I.crc32=t.crc32,I.compressedSize=t.compressedSize,I.uncompressedSize=t.uncompressedSize);var A=0;e&&(A|=8),g||!x&&!S||(A|=2048);var k=0,E=0;_&&(k|=16),"UNIX"===r?(E=798,k|=function(t,e){var n=t;return t||(n=e?16893:33204),(65535&n)<<16}(p.unixPermissions,_)):(E=20,k|=function(t){return 63&(t||0)}(p.dosPermissions)),u=L.getUTCHours(),u<<=6,u|=L.getUTCMinutes(),u<<=5,u|=L.getUTCSeconds()/2,h=L.getUTCFullYear()-1980,h<<=4,h|=L.getUTCMonth()+1,h<<=5,h|=L.getUTCDate(),x&&(T=i(1,1)+i(l(f),4)+b,C+="up"+i(T.length,2)+T),S&&(O=i(1,1)+i(l(v),4)+w,C+="uc"+i(O.length,2)+O);var j="";return j+="\n\0",j+=i(A,2),j+=m.magic,j+=i(u,2),j+=i(h,2),j+=i(I.crc32,4),j+=i(I.compressedSize,4),j+=i(I.uncompressedSize,4),j+=i(f.length,2),j+=i(C.length,2),{fileRecord:c.LOCAL_FILE_HEADER+j+f+C,dirRecord:c.CENTRAL_FILE_HEADER+i(E,2)+j+i(v.length,2)+"\0\0\0\0"+i(k,4)+i(a,4)+f+C+v}}var o=t("../utils"),r=t("../stream/GenericWorker"),s=t("../utf8"),l=t("../crc32"),c=t("../signature");function d(t,e,n,i){r.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=e,this.zipPlatform=n,this.encodeFileName=i,this.streamFiles=t,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(d,r),d.prototype.push=function(t){var e=t.meta.percent||0,n=this.entriesCount,i=this._sources.length;this.accumulate?this.contentBuffer.push(t):(this.bytesWritten+=t.data.length,r.prototype.push.call(this,{data:t.data,meta:{currentFile:this.currentFile,percent:n?(e+100*(n-i-1))/n:100}}))},d.prototype.openedSource=function(t){this.currentSourceOffset=this.bytesWritten,this.currentFile=t.file.name;var e=this.streamFiles&&!t.file.dir;if(e){var n=a(t,e,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(t){this.accumulate=!1;var e=this.streamFiles&&!t.file.dir,n=a(t,e,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),e)this.push({data:function(t){return c.DATA_DESCRIPTOR+i(t.crc32,4)+i(t.compressedSize,4)+i(t.uncompressedSize,4)}(t),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var t=this.bytesWritten,e=0;e<this.dirRecords.length;e++)this.push({data:this.dirRecords[e],meta:{percent:100}});var n=this.bytesWritten-t,a=function(t,e,n,a,r){var s=o.transformTo("string",r(a));return c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(t,2)+i(t,2)+i(e,4)+i(n,4)+i(s.length,2)+s}(this.dirRecords.length,n,t,this.zipComment,this.encodeFileName);this.push({data:a,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(t){this._sources.push(t);var e=this;return t.on("data",(function(t){e.processChunk(t)})),t.on("end",(function(){e.closedSource(e.previous.streamInfo),e._sources.length?e.prepareNextSource():e.end()})),t.on("error",(function(t){e.error(t)})),this},d.prototype.resume=function(){return!!r.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(t){var e=this._sources;if(!r.prototype.error.call(this,t))return!1;for(var n=0;n<e.length;n++)try{e[n].error(t)}catch(t){}return!0},d.prototype.lock=function(){r.prototype.lock.call(this);for(var t=this._sources,e=0;e<t.length;e++)t[e].lock()},e.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,e,n){"use strict";var i=t("../compressions"),a=t("./ZipFileWorker");n.generateWorker=function(t,e,n){var o=new a(e.streamFiles,n,e.platform,e.encodeFileName),r=0;try{t.forEach((function(t,n){r++;var a=function(t,e){var n=t||e,a=i[n];if(!a)throw new Error(n+" is not a valid compression method !");return a}(n.options.compression,e.compression),s=n.options.compressionOptions||e.compressionOptions||{},l=n.dir,c=n.date;n._compressWorker(a,s).withStreamInfo("file",{name:t,dir:l,date:c,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(o)})),o.entriesCount=r}catch(t){o.error(t)}return o}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,e,n){"use strict";function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var t=new i;for(var e in this)"function"!=typeof this[e]&&(t[e]=this[e]);return t}}(i.prototype=t("./object")).loadAsync=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.version="3.4.0",i.loadAsync=function(t,e){return(new i).loadAsync(t,e)},i.external=t("./external"),e.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,e,n){"use strict";var i=t("./utils"),a=t("./external"),o=t("./utf8"),r=(i=t("./utils"),t("./zipEntries")),s=t("./stream/Crc32Probe"),l=t("./nodejsUtils");function c(t){return new a.Promise((function(e,n){var i=t.decompressed.getContentWorker().pipe(new s);i.on("error",(function(t){n(t)})).on("end",(function(){i.streamInfo.crc32!==t.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):e()})).resume()}))}e.exports=function(t,e){var n=this;return e=i.extend(e||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),l.isNode&&l.isStream(t)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",t,!0,e.optimizedBinaryString,e.base64).then((function(t){var n=new r(e);return n.load(t),n})).then((function(t){var n=[a.Promise.resolve(t)],i=t.files;if(e.checkCRC32)for(var o=0;o<i.length;o++)n.push(c(i[o]));return a.Promise.all(n)})).then((function(t){for(var i=t.shift(),a=i.files,o=0;o<a.length;o++){var r=a[o];n.file(r.fileNameStr,r.decompressed,{binary:!0,optimizedBinaryString:!0,date:r.date,dir:r.dir,comment:r.fileCommentStr.length?r.fileCommentStr:null,unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions,createFolders:e.createFolders})}return i.zipComment.length&&(n.comment=i.zipComment),n}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,e,n){"use strict";var i=t("../utils"),a=t("../stream/GenericWorker");function o(t,e){a.call(this,"Nodejs stream input adapter for "+t),this._upstreamEnded=!1,this._bindStream(e)}i.inherits(o,a),o.prototype._bindStream=function(t){var e=this;(this._stream=t).pause(),t.on("data",(function(t){e.push({data:t,meta:{percent:0}})})).on("error",(function(t){e.isPaused?this.generatedError=t:e.error(t)})).on("end",(function(){e.isPaused?e._upstreamEnded=!0:e.end()}))},o.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},e.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,e,n){"use strict";var i=t("readable-stream").Readable;function a(t,e,n){i.call(this,e),this._helper=t;var a=this;t.on("data",(function(t,e){a.push(t)||a._helper.pause(),n&&n(e)})).on("error",(function(t){a.emit("error",t)})).on("end",(function(){a.push(null)}))}t("../utils").inherits(a,i),a.prototype._read=function(){this._helper.resume()},e.exports=a},{"../utils":32,"readable-stream":16}],14:[function(t,e,n){"use strict";e.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(t,e){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(t,e);if("number"==typeof t)throw new Error('The "data" argument must not be a number');return new Buffer(t,e)},allocBuffer:function(t){if(Buffer.alloc)return Buffer.alloc(t);var e=new Buffer(t);return e.fill(0),e},isBuffer:function(t){return Buffer.isBuffer(t)},isStream:function(t){return t&&"function"==typeof t.on&&"function"==typeof t.pause&&"function"==typeof t.resume}}},{}],15:[function(t,e,n){"use strict";function i(t,e,n){var i,a=o.getTypeOf(e),s=o.extend(n||{},l);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(t=g(t)),s.createFolders&&(i=m(t))&&f.call(this,i,!0);var u,b="string"===a&&!1===s.binary&&!1===s.base64;n&&void 0!==n.binary||(s.binary=!b),(e instanceof c&&0===e.uncompressedSize||s.dir||!e||0===e.length)&&(s.base64=!1,s.binary=!0,e="",s.compression="STORE",a="string"),u=e instanceof c||e instanceof r?e:h.isNode&&h.isStream(e)?new p(t,e):o.prepareContent(t,e,s.binary,s.optimizedBinaryString,s.base64);var y=new d(t,u,s);this.files[t]=y}var a=t("./utf8"),o=t("./utils"),r=t("./stream/GenericWorker"),s=t("./stream/StreamHelper"),l=t("./defaults"),c=t("./compressedObject"),d=t("./zipObject"),u=t("./generate"),h=t("./nodejsUtils"),p=t("./nodejs/NodejsStreamInputAdapter"),m=function(t){"/"===t.slice(-1)&&(t=t.substring(0,t.length-1));var e=t.lastIndexOf("/");return 0<e?t.substring(0,e):""},g=function(t){return"/"!==t.slice(-1)&&(t+="/"),t},f=function(t,e){return e=void 0!==e?e:l.createFolders,t=g(t),this.files[t]||i.call(this,t,null,{dir:!0,createFolders:e}),this.files[t]};function b(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(t){var e,n,i;for(e in this.files)this.files.hasOwnProperty(e)&&(i=this.files[e],(n=e.slice(this.root.length,e.length))&&e.slice(0,this.root.length)===this.root&&t(n,i))},filter:function(t){var e=[];return this.forEach((function(n,i){t(n,i)&&e.push(i)})),e},file:function(t,e,n){if(1!==arguments.length)return t=this.root+t,i.call(this,t,e,n),this;if(b(t)){var a=t;return this.filter((function(t,e){return!e.dir&&a.test(t)}))}var o=this.files[this.root+t];return o&&!o.dir?o:null},folder:function(t){if(!t)return this;if(b(t))return this.filter((function(e,n){return n.dir&&t.test(e)}));var e=this.root+t,n=f.call(this,e),i=this.clone();return i.root=n.name,i},remove:function(t){t=this.root+t;var e=this.files[t];if(e||("/"!==t.slice(-1)&&(t+="/"),e=this.files[t]),e&&!e.dir)delete this.files[t];else for(var n=this.filter((function(e,n){return n.name.slice(0,t.length)===t})),i=0;i<n.length;i++)delete this.files[n[i].name];return this},generate:function(t){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(t){var e,n={};try{if((n=o.extend(t||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");o.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS");var i=n.comment||this.comment||"";e=u.generateWorker(this,n,i)}catch(t){(e=new r("error")).error(t)}return new s(e,n.type||"string",n.mimeType)},generateAsync:function(t,e){return this.generateInternalStream(t).accumulate(e)},generateNodeStream:function(t,e){return(t=t||{}).type||(t.type="nodebuffer"),this.generateInternalStream(t).toNodejsStream(e)}};e.exports=y},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,e,n){e.exports=t("stream")},{stream:void 0}],17:[function(t,e,n){"use strict";var i=t("./DataReader");function a(t){i.call(this,t);for(var e=0;e<this.data.length;e++)t[e]=255&t[e]}t("../utils").inherits(a,i),a.prototype.byteAt=function(t){return this.data[this.zero+t]},a.prototype.lastIndexOfSignature=function(t){for(var e=t.charCodeAt(0),n=t.charCodeAt(1),i=t.charCodeAt(2),a=t.charCodeAt(3),o=this.length-4;0<=o;--o)if(this.data[o]===e&&this.data[o+1]===n&&this.data[o+2]===i&&this.data[o+3]===a)return o-this.zero;return-1},a.prototype.readAndCheckSignature=function(t){var e=t.charCodeAt(0),n=t.charCodeAt(1),i=t.charCodeAt(2),a=t.charCodeAt(3),o=this.readData(4);return e===o[0]&&n===o[1]&&i===o[2]&&a===o[3]},a.prototype.readData=function(t){if(this.checkOffset(t),0===t)return[];var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=a},{"../utils":32,"./DataReader":18}],18:[function(t,e,n){"use strict";var i=t("../utils");function a(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(t){},readInt:function(t){var e,n=0;for(this.checkOffset(t),e=this.index+t-1;e>=this.index;e--)n=(n<<8)+this.byteAt(e);return this.index+=t,n},readString:function(t){return i.transformTo("string",this.readData(t))},readData:function(t){},lastIndexOfSignature:function(t){},readAndCheckSignature:function(t){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}},e.exports=a},{"../utils":32}],19:[function(t,e,n){"use strict";var i=t("./Uint8ArrayReader");function a(t){i.call(this,t)}t("../utils").inherits(a,i),a.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,e,n){"use strict";var i=t("./DataReader");function a(t){i.call(this,t)}t("../utils").inherits(a,i),a.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},a.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},a.prototype.readAndCheckSignature=function(t){return t===this.readData(4)},a.prototype.readData=function(t){this.checkOffset(t);var e=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=a},{"../utils":32,"./DataReader":18}],21:[function(t,e,n){"use strict";var i=t("./ArrayReader");function a(t){i.call(this,t)}t("../utils").inherits(a,i),a.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var e=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,e},e.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(t,e,n){"use strict";var i=t("../utils"),a=t("../support"),o=t("./ArrayReader"),r=t("./StringReader"),s=t("./NodeBufferReader"),l=t("./Uint8ArrayReader");e.exports=function(t){var e=i.getTypeOf(t);return i.checkSupport(e),"string"!==e||a.uint8array?"nodebuffer"===e?new s(t):a.uint8array?new l(i.transformTo("uint8array",t)):new o(i.transformTo("array",t)):new r(t)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,e,n){"use strict";n.LOCAL_FILE_HEADER="PK\x03\x04",n.CENTRAL_FILE_HEADER="PK\x01\x02",n.CENTRAL_DIRECTORY_END="PK\x05\x06",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,e,n){"use strict";var i=t("./GenericWorker"),a=t("../utils");function o(t){i.call(this,"ConvertWorker to "+t),this.destType=t}a.inherits(o,i),o.prototype.processChunk=function(t){this.push({data:a.transformTo(this.destType,t.data),meta:t.meta})},e.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(t,e,n){"use strict";var i=t("./GenericWorker"),a=t("../crc32");function o(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(o,i),o.prototype.processChunk=function(t){this.streamInfo.crc32=a(t.data,this.streamInfo.crc32||0),this.push(t)},e.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,e,n){"use strict";var i=t("../utils"),a=t("./GenericWorker");function o(t){a.call(this,"DataLengthProbe for "+t),this.propName=t,this.withStreamInfo(t,0)}i.inherits(o,a),o.prototype.processChunk=function(t){if(t){var e=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=e+t.data.length}a.prototype.processChunk.call(this,t)},e.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(t,e,n){"use strict";var i=t("../utils"),a=t("./GenericWorker");function o(t){a.call(this,"DataWorker");var e=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,t.then((function(t){e.dataIsReady=!0,e.data=t,e.max=t&&t.length||0,e.type=i.getTypeOf(t),e.isPaused||e._tickAndRepeat()}),(function(t){e.error(t)}))}i.inherits(o,a),o.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var t=null,e=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":t=this.data.substring(this.index,e);break;case"uint8array":t=this.data.subarray(this.index,e);break;case"array":case"nodebuffer":t=this.data.slice(this.index,e)}return this.index=e,this.push({data:t,meta:{percent:this.max?this.index/this.max*100:0}})},e.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(t,e,n){"use strict";function i(t){this.name=t||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(t){this.emit("data",t)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(t){this.emit("error",t)}return!0},error:function(t){return!this.isFinished&&(this.isPaused?this.generatedError=t:(this.isFinished=!0,this.emit("error",t),this.previous&&this.previous.error(t),this.cleanUp()),!0)},on:function(t,e){return this._listeners[t].push(e),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(t,e){if(this._listeners[t])for(var n=0;n<this._listeners[t].length;n++)this._listeners[t][n].call(this,e)},pipe:function(t){return t.registerPrevious(this)},registerPrevious:function(t){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=t.streamInfo,this.mergeStreamInfo(),this.previous=t;var e=this;return t.on("data",(function(t){e.processChunk(t)})),t.on("end",(function(){e.end()})),t.on("error",(function(t){e.error(t)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var t=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),t=!0),this.previous&&this.previous.resume(),!t},flush:function(){},processChunk:function(t){this.push(t)},withStreamInfo:function(t,e){return this.extraStreamInfo[t]=e,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var t in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(t)&&(this.streamInfo[t]=this.extraStreamInfo[t])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var t="Worker "+this.name;return this.previous?this.previous+" -> "+t:t}},e.exports=i},{}],29:[function(t,e,n){"use strict";var i=t("../utils"),a=t("./ConvertWorker"),o=t("./GenericWorker"),r=t("../base64"),s=t("../support"),l=t("../external"),c=null;if(s.nodestream)try{c=t("../nodejs/NodejsStreamOutputAdapter")}catch(t){}function d(t,e,n){var r=e;switch(e){case"blob":case"arraybuffer":r="uint8array";break;case"base64":r="string"}try{this._internalType=r,this._outputType=e,this._mimeType=n,i.checkSupport(r),this._worker=t.pipe(new a(r)),t.lock()}catch(t){this._worker=new o("error"),this._worker.error(t)}}d.prototype={accumulate:function(t){return function(t,e){return new l.Promise((function(n,a){var o=[],s=t._internalType,l=t._outputType,c=t._mimeType;t.on("data",(function(t,n){o.push(t),e&&e(n)})).on("error",(function(t){o=[],a(t)})).on("end",(function(){try{var t=function(t,e,n){switch(t){case"blob":return i.newBlob(i.transformTo("arraybuffer",e),n);case"base64":return r.encode(e);default:return i.transformTo(t,e)}}(l,function(t,e){var n,i=0,a=null,o=0;for(n=0;n<e.length;n++)o+=e[n].length;switch(t){case"string":return e.join("");case"array":return Array.prototype.concat.apply([],e);case"uint8array":for(a=new Uint8Array(o),n=0;n<e.length;n++)a.set(e[n],i),i+=e[n].length;return a;case"nodebuffer":return Buffer.concat(e);default:throw new Error("concat : unsupported type '"+t+"'")}}(s,o),c);n(t)}catch(t){a(t)}o=[]})).resume()}))}(this,t)},on:function(t,e){var n=this;return"data"===t?this._worker.on(t,(function(t){e.call(n,t.data,t.meta)})):this._worker.on(t,(function(){i.delay(e,arguments,n)})),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(t){if(i.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:"nodebuffer"!==this._outputType},t)}},e.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,e,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var i=new ArrayBuffer(0);try{n.blob=0===new Blob([i],{type:"application/zip"}).size}catch(t){try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(i),n.blob=0===a.getBlob("application/zip").size}catch(t){n.blob=!1}}}try{n.nodestream=!!t("readable-stream").Readable}catch(t){n.nodestream=!1}},{"readable-stream":16}],31:[function(t,e,n){"use strict";for(var i=t("./utils"),a=t("./support"),o=t("./nodejsUtils"),r=t("./stream/GenericWorker"),s=new Array(256),l=0;l<256;l++)s[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(){r.call(this,"utf-8 decode"),this.leftOver=null}function d(){r.call(this,"utf-8 encode")}s[254]=s[254]=1,n.utf8encode=function(t){return a.nodebuffer?o.newBufferFrom(t,"utf-8"):function(t){var e,n,i,o,r,s=t.length,l=0;for(o=0;o<s;o++)55296==(64512&(n=t.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(e=a.uint8array?new Uint8Array(l):new Array(l),o=r=0;r<l;o++)55296==(64512&(n=t.charCodeAt(o)))&&o+1<s&&56320==(64512&(i=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(i-56320),o++),n<128?e[r++]=n:(n<2048?e[r++]=192|n>>>6:(n<65536?e[r++]=224|n>>>12:(e[r++]=240|n>>>18,e[r++]=128|n>>>12&63),e[r++]=128|n>>>6&63),e[r++]=128|63&n);return e}(t)},n.utf8decode=function(t){return a.nodebuffer?i.transformTo("nodebuffer",t).toString("utf-8"):function(t){var e,n,a,o,r=t.length,l=new Array(2*r);for(e=n=0;e<r;)if((a=t[e++])<128)l[n++]=a;else if(4<(o=s[a]))l[n++]=65533,e+=o-1;else{for(a&=2===o?31:3===o?15:7;1<o&&e<r;)a=a<<6|63&t[e++],o--;1<o?l[n++]=65533:a<65536?l[n++]=a:(a-=65536,l[n++]=55296|a>>10&1023,l[n++]=56320|1023&a)}return l.length!==n&&(l.subarray?l=l.subarray(0,n):l.length=n),i.applyFromCharCode(l)}(t=i.transformTo(a.uint8array?"uint8array":"array",t))},i.inherits(c,r),c.prototype.processChunk=function(t){var e=i.transformTo(a.uint8array?"uint8array":"array",t.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var o=e;(e=new Uint8Array(o.length+this.leftOver.length)).set(this.leftOver,0),e.set(o,this.leftOver.length)}else e=this.leftOver.concat(e);this.leftOver=null}var r=function(t,e){var n;for((e=e||t.length)>t.length&&(e=t.length),n=e-1;0<=n&&128==(192&t[n]);)n--;return n<0||0===n?e:n+s[t[n]]>e?n:e}(e),l=e;r!==e.length&&(a.uint8array?(l=e.subarray(0,r),this.leftOver=e.subarray(r,e.length)):(l=e.slice(0,r),this.leftOver=e.slice(r,e.length))),this.push({data:n.utf8decode(l),meta:t.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=c,i.inherits(d,r),d.prototype.processChunk=function(t){this.push({data:n.utf8encode(t.data),meta:t.meta})},n.Utf8EncodeWorker=d},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,e,n){"use strict";var i=t("./support"),a=t("./base64"),o=t("./nodejsUtils"),r=t("set-immediate-shim"),s=t("./external");function l(t){return t}function c(t,e){for(var n=0;n<t.length;++n)e[n]=255&t.charCodeAt(n);return e}n.newBlob=function(e,i){n.checkSupport("blob");try{return new Blob([e],{type:i})}catch(t){try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return a.append(e),a.getBlob(i)}catch(t){throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(t,e,n){var i=[],a=0,o=t.length;if(o<=n)return String.fromCharCode.apply(null,t);for(;a<o;)"array"===e||"nodebuffer"===e?i.push(String.fromCharCode.apply(null,t.slice(a,Math.min(a+n,o)))):i.push(String.fromCharCode.apply(null,t.subarray(a,Math.min(a+n,o)))),a+=n;return i.join("")},stringifyByChar:function(t){for(var e="",n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return e},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(t){return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&1===String.fromCharCode.apply(null,o.allocBuffer(1)).length}catch(t){return!1}}()}};function u(t){var e=65536,i=n.getTypeOf(t),a=!0;if("uint8array"===i?a=d.applyCanBeUsed.uint8array:"nodebuffer"===i&&(a=d.applyCanBeUsed.nodebuffer),a)for(;1<e;)try{return d.stringifyByChunk(t,i,e)}catch(t){e=Math.floor(e/2)}return d.stringifyByChar(t)}function h(t,e){for(var n=0;n<t.length;n++)e[n]=t[n];return e}n.applyFromCharCode=u;var p={};p.string={string:l,array:function(t){return c(t,new Array(t.length))},arraybuffer:function(t){return p.string.uint8array(t).buffer},uint8array:function(t){return c(t,new Uint8Array(t.length))},nodebuffer:function(t){return c(t,o.allocBuffer(t.length))}},p.array={string:u,array:l,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return o.newBufferFrom(t)}},p.arraybuffer={string:function(t){return u(new Uint8Array(t))},array:function(t){return h(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:l,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return o.newBufferFrom(new Uint8Array(t))}},p.uint8array={string:u,array:function(t){return h(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:l,nodebuffer:function(t){return o.newBufferFrom(t)}},p.nodebuffer={string:u,array:function(t){return h(t,new Array(t.length))},arraybuffer:function(t){return p.nodebuffer.uint8array(t).buffer},uint8array:function(t){return h(t,new Uint8Array(t.length))},nodebuffer:l},n.transformTo=function(t,e){if(e=e||"",!t)return e;n.checkSupport(t);var i=n.getTypeOf(e);return p[i][t](e)},n.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":i.nodebuffer&&o.isBuffer(t)?"nodebuffer":i.uint8array&&t instanceof Uint8Array?"uint8array":i.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(t){if(!i[t.toLowerCase()])throw new Error(t+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(t){var e,n,i="";for(n=0;n<(t||"").length;n++)i+="\\x"+((e=t.charCodeAt(n))<16?"0":"")+e.toString(16).toUpperCase();return i},n.delay=function(t,e,n){r((function(){t.apply(n||null,e||[])}))},n.inherits=function(t,e){function n(){}n.prototype=e.prototype,t.prototype=new n},n.extend=function(){var t,e,n={};for(t=0;t<arguments.length;t++)for(e in arguments[t])arguments[t].hasOwnProperty(e)&&void 0===n[e]&&(n[e]=arguments[t][e]);return n},n.prepareContent=function(t,e,o,r,l){return s.Promise.resolve(e).then((function(t){return i.blob&&(t instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(t)))&&"undefined"!=typeof FileReader?new s.Promise((function(e,n){var i=new FileReader;i.onload=function(t){e(t.target.result)},i.onerror=function(t){n(t.target.error)},i.readAsArrayBuffer(t)})):t})).then((function(e){var d=n.getTypeOf(e);return d?("arraybuffer"===d?e=n.transformTo("uint8array",e):"string"===d&&(l?e=a.decode(e):o&&!0!==r&&(e=function(t){return c(t,i.uint8array?new Uint8Array(t.length):new Array(t.length))}(e))),e):s.Promise.reject(new Error("Can't read the data of '"+t+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(t,e,n){"use strict";var i=t("./reader/readerFor"),a=t("./utils"),o=t("./signature"),r=t("./zipEntry"),s=(t("./utf8"),t("./support"));function l(t){this.files=[],this.loadOptions=t}l.prototype={checkSignature:function(t){if(!this.reader.readAndCheckSignature(t)){this.reader.index-=4;var e=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(e)+", expected "+a.pretty(t)+")")}},isSignature:function(t,e){var n=this.reader.index;this.reader.setIndex(t);var i=this.reader.readString(4)===e;return this.reader.setIndex(n),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),e=s.uint8array?"uint8array":"array",n=a.transformTo(e,t);this.zipComment=this.loadOptions.decodeFileName(n)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,e,n,i=this.zip64EndOfCentralSize-44;0<i;)t=this.reader.readInt(2),e=this.reader.readInt(4),n=this.reader.readData(e),this.zip64ExtensibleData[t]={id:t,length:e,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,e;for(t=0;t<this.files.length;t++)e=this.files[t],this.reader.setIndex(e.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),e.readLocalPart(this.reader),e.handleUTF8(),e.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(t=new r({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(t<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(t);var e=t;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(t=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var i=e-n;if(0<i)this.isSignature(e,o.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(t){this.reader=i(t)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},e.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(t,e,n){"use strict";var i=t("./reader/readerFor"),a=t("./utils"),o=t("./compressedObject"),r=t("./crc32"),s=t("./utf8"),l=t("./compressions"),c=t("./support");function d(t,e){this.options=t,this.loadOptions=e}d.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(t){var e,n;if(t.skip(22),this.fileNameLength=t.readInt(2),n=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(e=function(t){for(var e in l)if(l.hasOwnProperty(e)&&l[e].magic===t)return l[e];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,e,t.readData(this.compressedSize))},readCentralPart:function(t){this.versionMadeBy=t.readInt(2),t.skip(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4);var e=t.readInt(2);if(this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");t.skip(e),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==t&&(this.dosPermissions=63&this.externalFileAttributes),3==t&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(t){if(this.extraFields[1]){var e=i(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(t){var e,n,i,a=t.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});t.index<a;)e=t.readInt(2),n=t.readInt(2),i=t.readData(n),this.extraFields[e]={id:e,length:n,value:i}},handleUTF8:function(){var t=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=s.utf8decode(this.fileName),this.fileCommentStr=s.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();if(null!==e)this.fileNameStr=e;else{var n=a.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var i=this.findExtraFieldUnicodeComment();if(null!==i)this.fileCommentStr=i;else{var o=a.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(o)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var e=i(t.value);return 1!==e.readInt(1)||r(this.fileName)!==e.readInt(4)?null:s.utf8decode(e.readData(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var e=i(t.value);return 1!==e.readInt(1)||r(this.fileComment)!==e.readInt(4)?null:s.utf8decode(e.readData(t.length-5))}return null}},e.exports=d},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,e,n){"use strict";function i(t,e,n){this.name=t,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=e,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}}var a=t("./stream/StreamHelper"),o=t("./stream/DataWorker"),r=t("./utf8"),s=t("./compressedObject"),l=t("./stream/GenericWorker");i.prototype={internalStream:function(t){var e=null,n="string";try{if(!t)throw new Error("No output type specified.");var i="string"===(n=t.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),e=this._decompressWorker();var o=!this._dataBinary;o&&!i&&(e=e.pipe(new r.Utf8EncodeWorker)),!o&&i&&(e=e.pipe(new r.Utf8DecodeWorker))}catch(t){(e=new l("error")).error(t)}return new a(e,n,"")},async:function(t,e){return this.internalStream(t).accumulate(e)},nodeStream:function(t,e){return this.internalStream(t||"nodebuffer").toNodejsStream(e)},_compressWorker:function(t,e){if(this._data instanceof s&&this._data.compression.magic===t.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new r.Utf8EncodeWorker)),s.createWorkerFrom(n,t,e)},_decompressWorker:function(){return this._data instanceof s?this._data.getContentWorker():this._data instanceof l?this._data:new o(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],d=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},u=0;u<c.length;u++)i.prototype[c[u]]=d;e.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,e,n){(function(t){"use strict";var n,i,a=t.MutationObserver||t.WebKitMutationObserver;if(a){var o=0,r=new a(d),s=t.document.createTextNode("");r.observe(s,{characterData:!0}),n=function(){s.data=o=++o%2}}else if(t.setImmediate||void 0===t.MessageChannel)n="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){d(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(d,0)};else{var l=new t.MessageChannel;l.port1.onmessage=d,n=function(){l.port2.postMessage(0)}}var c=[];function d(){var t,e;i=!0;for(var n=c.length;n;){for(e=c,c=[],t=-1;++t<n;)e[t]();n=c.length}i=!1}e.exports=function(t){1!==c.push(t)||i||n()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(t,e,n){"use strict";var i=t("immediate");function a(){}var o={},r=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function c(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,t!==a&&p(this,t)}function d(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function u(t,e,n){i((function(){var i;try{i=e(n)}catch(i){return o.reject(t,i)}i===t?o.reject(t,new TypeError("Cannot resolve promise with itself")):o.resolve(t,i)}))}function h(t){var e=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof e)return function(){e.apply(t,arguments)}}function p(t,e){var n=!1;function i(e){n||(n=!0,o.reject(t,e))}function a(e){n||(n=!0,o.resolve(t,e))}var r=m((function(){e(a,i)}));"error"===r.status&&i(r.value)}function m(t,e){var n={};try{n.value=t(e),n.status="success"}catch(t){n.status="error",n.value=t}return n}(e.exports=c).prototype.finally=function(t){if("function"!=typeof t)return this;var e=this.constructor;return this.then((function(n){return e.resolve(t()).then((function(){return n}))}),(function(n){return e.resolve(t()).then((function(){throw n}))}))},c.prototype.catch=function(t){return this.then(null,t)},c.prototype.then=function(t,e){if("function"!=typeof t&&this.state===s||"function"!=typeof e&&this.state===r)return this;var n=new this.constructor(a);return this.state!==l?u(n,this.state===s?t:e,this.outcome):this.queue.push(new d(n,t,e)),n},d.prototype.callFulfilled=function(t){o.resolve(this.promise,t)},d.prototype.otherCallFulfilled=function(t){u(this.promise,this.onFulfilled,t)},d.prototype.callRejected=function(t){o.reject(this.promise,t)},d.prototype.otherCallRejected=function(t){u(this.promise,this.onRejected,t)},o.resolve=function(t,e){var n=m(h,e);if("error"===n.status)return o.reject(t,n.value);var i=n.value;if(i)p(t,i);else{t.state=s,t.outcome=e;for(var a=-1,r=t.queue.length;++a<r;)t.queue[a].callFulfilled(e)}return t},o.reject=function(t,e){t.state=r,t.outcome=e;for(var n=-1,i=t.queue.length;++n<i;)t.queue[n].callRejected(e);return t},c.resolve=function(t){return t instanceof this?t:o.resolve(new this(a),t)},c.reject=function(t){var e=new this(a);return o.reject(e,t)},c.all=function(t){var e=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var n=t.length,i=!1;if(!n)return this.resolve([]);for(var r=new Array(n),s=0,l=-1,c=new this(a);++l<n;)d(t[l],l);return c;function d(t,a){e.resolve(t).then((function(t){r[a]=t,++s!==n||i||(i=!0,o.resolve(c,r))}),(function(t){i||(i=!0,o.reject(c,t))}))}},c.race=function(t){if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var e=t.length,n=!1;if(!e)return this.resolve([]);for(var i,r=-1,s=new this(a);++r<e;)i=t[r],this.resolve(i).then((function(t){n||(n=!0,o.resolve(s,t))}),(function(t){n||(n=!0,o.reject(s,t))}));return s}},{immediate:36}],38:[function(t,e,n){"use strict";var i={};(0,t("./lib/utils/common").assign)(i,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),e.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,e,n){"use strict";var i=t("./zlib/deflate"),a=t("./utils/common"),o=t("./utils/strings"),r=t("./zlib/messages"),s=t("./zlib/zstream"),l=Object.prototype.toString;function c(t){if(!(this instanceof c))return new c(t);this.options=a.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},t||{});var e=this.options;e.raw&&0<e.windowBits?e.windowBits=-e.windowBits:e.gzip&&0<e.windowBits&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var n=i.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(0!==n)throw new Error(r[n]);if(e.header&&i.deflateSetHeader(this.strm,e.header),e.dictionary){var d;if(d="string"==typeof e.dictionary?o.string2buf(e.dictionary):"[object ArrayBuffer]"===l.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,0!==(n=i.deflateSetDictionary(this.strm,d)))throw new Error(r[n]);this._dict_set=!0}}function d(t,e){var n=new c(e);if(n.push(t,!0),n.err)throw n.msg||r[n.err];return n.result}c.prototype.push=function(t,e){var n,r,s=this.strm,c=this.options.chunkSize;if(this.ended)return!1;r=e===~~e?e:!0===e?4:0,"string"==typeof t?s.input=o.string2buf(t):"[object ArrayBuffer]"===l.call(t)?s.input=new Uint8Array(t):s.input=t,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new a.Buf8(c),s.next_out=0,s.avail_out=c),1!==(n=i.deflate(s,r))&&0!==n)return this.onEnd(n),!(this.ended=!0);0!==s.avail_out&&(0!==s.avail_in||4!==r&&2!==r)||("string"===this.options.to?this.onData(o.buf2binstring(a.shrinkBuf(s.output,s.next_out))):this.onData(a.shrinkBuf(s.output,s.next_out)))}while((0<s.avail_in||0===s.avail_out)&&1!==n);return 4===r?(n=i.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,0===n):2!==r||(this.onEnd(0),!(s.avail_out=0))},c.prototype.onData=function(t){this.chunks.push(t)},c.prototype.onEnd=function(t){0===t&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},n.Deflate=c,n.deflate=d,n.deflateRaw=function(t,e){return(e=e||{}).raw=!0,d(t,e)},n.gzip=function(t,e){return(e=e||{}).gzip=!0,d(t,e)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,e,n){"use strict";var i=t("./zlib/inflate"),a=t("./utils/common"),o=t("./utils/strings"),r=t("./zlib/constants"),s=t("./zlib/messages"),l=t("./zlib/zstream"),c=t("./zlib/gzheader"),d=Object.prototype.toString;function u(t){if(!(this instanceof u))return new u(t);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},t||{});var e=this.options;e.raw&&0<=e.windowBits&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(0<=e.windowBits&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),15<e.windowBits&&e.windowBits<48&&0==(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var n=i.inflateInit2(this.strm,e.windowBits);if(n!==r.Z_OK)throw new Error(s[n]);this.header=new c,i.inflateGetHeader(this.strm,this.header)}function h(t,e){var n=new u(e);if(n.push(t,!0),n.err)throw n.msg||s[n.err];return n.result}u.prototype.push=function(t,e){var n,s,l,c,u,h,p=this.strm,m=this.options.chunkSize,g=this.options.dictionary,f=!1;if(this.ended)return!1;s=e===~~e?e:!0===e?r.Z_FINISH:r.Z_NO_FLUSH,"string"==typeof t?p.input=o.binstring2buf(t):"[object ArrayBuffer]"===d.call(t)?p.input=new Uint8Array(t):p.input=t,p.next_in=0,p.avail_in=p.input.length;do{if(0===p.avail_out&&(p.output=new a.Buf8(m),p.next_out=0,p.avail_out=m),(n=i.inflate(p,r.Z_NO_FLUSH))===r.Z_NEED_DICT&&g&&(h="string"==typeof g?o.string2buf(g):"[object ArrayBuffer]"===d.call(g)?new Uint8Array(g):g,n=i.inflateSetDictionary(this.strm,h)),n===r.Z_BUF_ERROR&&!0===f&&(n=r.Z_OK,f=!1),n!==r.Z_STREAM_END&&n!==r.Z_OK)return this.onEnd(n),!(this.ended=!0);p.next_out&&(0!==p.avail_out&&n!==r.Z_STREAM_END&&(0!==p.avail_in||s!==r.Z_FINISH&&s!==r.Z_SYNC_FLUSH)||("string"===this.options.to?(l=o.utf8border(p.output,p.next_out),c=p.next_out-l,u=o.buf2string(p.output,l),p.next_out=c,p.avail_out=m-c,c&&a.arraySet(p.output,p.output,l,c,0),this.onData(u)):this.onData(a.shrinkBuf(p.output,p.next_out)))),0===p.avail_in&&0===p.avail_out&&(f=!0)}while((0<p.avail_in||0===p.avail_out)&&n!==r.Z_STREAM_END);return n===r.Z_STREAM_END&&(s=r.Z_FINISH),s===r.Z_FINISH?(n=i.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===r.Z_OK):s!==r.Z_SYNC_FLUSH||(this.onEnd(r.Z_OK),!(p.avail_out=0))},u.prototype.onData=function(t){this.chunks.push(t)},u.prototype.onEnd=function(t){t===r.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},n.Inflate=u,n.inflate=h,n.inflateRaw=function(t,e){return(e=e||{}).raw=!0,h(t,e)},n.ungzip=h},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,e,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(t){for(var e=Array.prototype.slice.call(arguments,1);e.length;){var n=e.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}}return t},n.shrinkBuf=function(t,e){return t.length===e?t:t.subarray?t.subarray(0,e):(t.length=e,t)};var a={arraySet:function(t,e,n,i,a){if(e.subarray&&t.subarray)t.set(e.subarray(n,n+i),a);else for(var o=0;o<i;o++)t[a+o]=e[n+o]},flattenChunks:function(t){var e,n,i,a,o,r;for(e=i=0,n=t.length;e<n;e++)i+=t[e].length;for(r=new Uint8Array(i),e=a=0,n=t.length;e<n;e++)o=t[e],r.set(o,a),a+=o.length;return r}},o={arraySet:function(t,e,n,i,a){for(var o=0;o<i;o++)t[a+o]=e[n+o]},flattenChunks:function(t){return[].concat.apply([],t)}};n.setTyped=function(t){t?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,a)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,o))},n.setTyped(i)},{}],42:[function(t,e,n){"use strict";var i=t("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(t){a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){o=!1}for(var r=new i.Buf8(256),s=0;s<256;s++)r[s]=252<=s?6:248<=s?5:240<=s?4:224<=s?3:192<=s?2:1;function l(t,e){if(e<65537&&(t.subarray&&o||!t.subarray&&a))return String.fromCharCode.apply(null,i.shrinkBuf(t,e));for(var n="",r=0;r<e;r++)n+=String.fromCharCode(t[r]);return n}r[254]=r[254]=1,n.string2buf=function(t){var e,n,a,o,r,s=t.length,l=0;for(o=0;o<s;o++)55296==(64512&(n=t.charCodeAt(o)))&&o+1<s&&56320==(64512&(a=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(a-56320),o++),l+=n<128?1:n<2048?2:n<65536?3:4;for(e=new i.Buf8(l),o=r=0;r<l;o++)55296==(64512&(n=t.charCodeAt(o)))&&o+1<s&&56320==(64512&(a=t.charCodeAt(o+1)))&&(n=65536+(n-55296<<10)+(a-56320),o++),n<128?e[r++]=n:(n<2048?e[r++]=192|n>>>6:(n<65536?e[r++]=224|n>>>12:(e[r++]=240|n>>>18,e[r++]=128|n>>>12&63),e[r++]=128|n>>>6&63),e[r++]=128|63&n);return e},n.buf2binstring=function(t){return l(t,t.length)},n.binstring2buf=function(t){for(var e=new i.Buf8(t.length),n=0,a=e.length;n<a;n++)e[n]=t.charCodeAt(n);return e},n.buf2string=function(t,e){var n,i,a,o,s=e||t.length,c=new Array(2*s);for(n=i=0;n<s;)if((a=t[n++])<128)c[i++]=a;else if(4<(o=r[a]))c[i++]=65533,n+=o-1;else{for(a&=2===o?31:3===o?15:7;1<o&&n<s;)a=a<<6|63&t[n++],o--;1<o?c[i++]=65533:a<65536?c[i++]=a:(a-=65536,c[i++]=55296|a>>10&1023,c[i++]=56320|1023&a)}return l(c,i)},n.utf8border=function(t,e){var n;for((e=e||t.length)>t.length&&(e=t.length),n=e-1;0<=n&&128==(192&t[n]);)n--;return n<0||0===n?e:n+r[t[n]]>e?n:e}},{"./common":41}],43:[function(t,e,n){"use strict";e.exports=function(t,e,n,i){for(var a=65535&t|0,o=t>>>16&65535|0,r=0;0!==n;){for(n-=r=2e3<n?2e3:n;o=o+(a=a+e[i++]|0)|0,--r;);a%=65521,o%=65521}return a|o<<16|0}},{}],44:[function(t,e,n){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,e,n){"use strict";var i=function(){for(var t,e=[],n=0;n<256;n++){t=n;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[n]=t}return e}();e.exports=function(t,e,n,a){var o=i,r=a+n;t^=-1;for(var s=a;s<r;s++)t=t>>>8^o[255&(t^e[s])];return-1^t}},{}],46:[function(t,e,n){"use strict";var i,a=t("../utils/common"),o=t("./trees"),r=t("./adler32"),s=t("./crc32"),l=t("./messages"),c=-2,d=258,u=262,h=113;function p(t,e){return t.msg=l[e],e}function m(t){return(t<<1)-(4<t?9:0)}function g(t){for(var e=t.length;0<=--e;)t[e]=0}function f(t){var e=t.state,n=e.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(a.arraySet(t.output,e.pending_buf,e.pending_out,n,t.next_out),t.next_out+=n,e.pending_out+=n,t.total_out+=n,t.avail_out-=n,e.pending-=n,0===e.pending&&(e.pending_out=0))}function b(t,e){o._tr_flush_block(t,0<=t.block_start?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,f(t.strm)}function y(t,e){t.pending_buf[t.pending++]=e}function v(t,e){t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e}function w(t,e){var n,i,a=t.max_chain_length,o=t.strstart,r=t.prev_length,s=t.nice_match,l=t.strstart>t.w_size-u?t.strstart-(t.w_size-u):0,c=t.window,h=t.w_mask,p=t.prev,m=t.strstart+d,g=c[o+r-1],f=c[o+r];t.prev_length>=t.good_match&&(a>>=2),s>t.lookahead&&(s=t.lookahead);do{if(c[(n=e)+r]===f&&c[n+r-1]===g&&c[n]===c[o]&&c[++n]===c[o+1]){o+=2,n++;do{}while(c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&c[++o]===c[++n]&&o<m);if(i=d-(m-o),o=m-d,r<i){if(t.match_start=e,s<=(r=i))break;g=c[o+r-1],f=c[o+r]}}}while((e=p[e&h])>l&&0!=--a);return r<=t.lookahead?r:t.lookahead}function x(t){var e,n,i,o,l,c,d,h,p,m,g=t.w_size;do{if(o=t.window_size-t.lookahead-t.strstart,t.strstart>=g+(g-u)){for(a.arraySet(t.window,t.window,g,g,0),t.match_start-=g,t.strstart-=g,t.block_start-=g,e=n=t.hash_size;i=t.head[--e],t.head[e]=g<=i?i-g:0,--n;);for(e=n=g;i=t.prev[--e],t.prev[e]=g<=i?i-g:0,--n;);o+=g}if(0===t.strm.avail_in)break;if(c=t.strm,d=t.window,h=t.strstart+t.lookahead,m=void 0,(p=o)<(m=c.avail_in)&&(m=p),n=0===m?0:(c.avail_in-=m,a.arraySet(d,c.input,c.next_in,m,h),1===c.state.wrap?c.adler=r(c.adler,d,m,h):2===c.state.wrap&&(c.adler=s(c.adler,d,m,h)),c.next_in+=m,c.total_in+=m,m),t.lookahead+=n,t.lookahead+t.insert>=3)for(l=t.strstart-t.insert,t.ins_h=t.window[l],t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[l+3-1])&t.hash_mask,t.prev[l&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=l,l++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<u&&0!==t.strm.avail_in)}function S(t,e){for(var n,i;;){if(t.lookahead<u){if(x(t),t.lookahead<u&&0===e)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==n&&t.strstart-n<=t.w_size-u&&(t.match_length=w(t,n)),t.match_length>=3)if(i=o._tr_tally(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){for(t.match_length--;t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart,0!=--t.match_length;);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else i=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(b(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,4===e?(b(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(b(t,!1),0===t.strm.avail_out)?1:2}function C(t,e){for(var n,i,a;;){if(t.lookahead<u){if(x(t),t.lookahead<u&&0===e)return 1;if(0===t.lookahead)break}if(n=0,t.lookahead>=3&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==n&&t.prev_length<t.max_lazy_match&&t.strstart-n<=t.w_size-u&&(t.match_length=w(t,n),t.match_length<=5&&(1===t.strategy||3===t.match_length&&4096<t.strstart-t.match_start)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){for(a=t.strstart+t.lookahead-3,i=o._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;++t.strstart<=a&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+3-1])&t.hash_mask,n=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!=--t.prev_length;);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(b(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if((i=o._tr_tally(t,0,t.window[t.strstart-1]))&&b(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=o._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,4===e?(b(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(b(t,!1),0===t.strm.avail_out)?1:2}function T(t,e,n,i,a){this.good_length=t,this.max_lazy=e,this.nice_length=n,this.max_chain=i,this.func=a}function O(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(1146),this.dyn_dtree=new a.Buf16(122),this.bl_tree=new a.Buf16(78),g(this.dyn_ltree),g(this.dyn_dtree),g(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(16),this.heap=new a.Buf16(573),g(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(573),g(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function _(t){var e;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=2,(e=t.state).pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=e.wrap?42:h,t.adler=2===e.wrap?0:1,e.last_flush=0,o._tr_init(e),0):p(t,c)}function L(t){var e=_(t);return 0===e&&function(t){t.window_size=2*t.w_size,g(t.head),t.max_lazy_match=i[t.level].max_lazy,t.good_match=i[t.level].good_length,t.nice_match=i[t.level].nice_length,t.max_chain_length=i[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0}(t.state),e}function I(t,e,n,i,o,r){if(!t)return c;var s=1;if(-1===e&&(e=6),i<0?(s=0,i=-i):15<i&&(s=2,i-=16),o<1||9<o||8!==n||i<8||15<i||e<0||9<e||r<0||4<r)return p(t,c);8===i&&(i=9);var l=new O;return(t.state=l).strm=t,l.wrap=s,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=o+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new a.Buf8(2*l.w_size),l.head=new a.Buf16(l.hash_size),l.prev=new a.Buf16(l.w_size),l.lit_bufsize=1<<o+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new a.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=e,l.strategy=r,l.method=n,L(t)}i=[new T(0,0,0,0,(function(t,e){var n=65535;for(n>t.pending_buf_size-5&&(n=t.pending_buf_size-5);;){if(t.lookahead<=1){if(x(t),0===t.lookahead&&0===e)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var i=t.block_start+n;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,b(t,!1),0===t.strm.avail_out))return 1;if(t.strstart-t.block_start>=t.w_size-u&&(b(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(b(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&(b(t,!1),t.strm.avail_out),1)})),new T(4,4,8,4,S),new T(4,5,16,8,S),new T(4,6,32,32,S),new T(4,4,16,16,C),new T(8,16,32,32,C),new T(8,16,128,128,C),new T(8,32,128,256,C),new T(32,128,258,1024,C),new T(32,258,258,4096,C)],n.deflateInit=function(t,e){return I(t,e,8,15,8,0)},n.deflateInit2=I,n.deflateReset=L,n.deflateResetKeep=_,n.deflateSetHeader=function(t,e){return t&&t.state?2!==t.state.wrap?c:(t.state.gzhead=e,0):c},n.deflate=function(t,e){var n,a,r,l;if(!t||!t.state||5<e||e<0)return t?p(t,c):c;if(a=t.state,!t.output||!t.input&&0!==t.avail_in||666===a.status&&4!==e)return p(t,0===t.avail_out?-5:c);if(a.strm=t,n=a.last_flush,a.last_flush=e,42===a.status)if(2===a.wrap)t.adler=0,y(a,31),y(a,139),y(a,8),a.gzhead?(y(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),y(a,255&a.gzhead.time),y(a,a.gzhead.time>>8&255),y(a,a.gzhead.time>>16&255),y(a,a.gzhead.time>>24&255),y(a,9===a.level?2:2<=a.strategy||a.level<2?4:0),y(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(y(a,255&a.gzhead.extra.length),y(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(t.adler=s(t.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=69):(y(a,0),y(a,0),y(a,0),y(a,0),y(a,0),y(a,9===a.level?2:2<=a.strategy||a.level<2?4:0),y(a,3),a.status=h);else{var u=8+(a.w_bits-8<<4)<<8;u|=(2<=a.strategy||a.level<2?0:a.level<6?1:6===a.level?2:3)<<6,0!==a.strstart&&(u|=32),u+=31-u%31,a.status=h,v(a,u),0!==a.strstart&&(v(a,t.adler>>>16),v(a,65535&t.adler)),t.adler=1}if(69===a.status)if(a.gzhead.extra){for(r=a.pending;a.gzindex<(65535&a.gzhead.extra.length)&&(a.pending!==a.pending_buf_size||(a.gzhead.hcrc&&a.pending>r&&(t.adler=s(t.adler,a.pending_buf,a.pending-r,r)),f(t),r=a.pending,a.pending!==a.pending_buf_size));)y(a,255&a.gzhead.extra[a.gzindex]),a.gzindex++;a.gzhead.hcrc&&a.pending>r&&(t.adler=s(t.adler,a.pending_buf,a.pending-r,r)),a.gzindex===a.gzhead.extra.length&&(a.gzindex=0,a.status=73)}else a.status=73;if(73===a.status)if(a.gzhead.name){r=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>r&&(t.adler=s(t.adler,a.pending_buf,a.pending-r,r)),f(t),r=a.pending,a.pending===a.pending_buf_size)){l=1;break}l=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,y(a,l)}while(0!==l);a.gzhead.hcrc&&a.pending>r&&(t.adler=s(t.adler,a.pending_buf,a.pending-r,r)),0===l&&(a.gzindex=0,a.status=91)}else a.status=91;if(91===a.status)if(a.gzhead.comment){r=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>r&&(t.adler=s(t.adler,a.pending_buf,a.pending-r,r)),f(t),r=a.pending,a.pending===a.pending_buf_size)){l=1;break}l=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,y(a,l)}while(0!==l);a.gzhead.hcrc&&a.pending>r&&(t.adler=s(t.adler,a.pending_buf,a.pending-r,r)),0===l&&(a.status=103)}else a.status=103;if(103===a.status&&(a.gzhead.hcrc?(a.pending+2>a.pending_buf_size&&f(t),a.pending+2<=a.pending_buf_size&&(y(a,255&t.adler),y(a,t.adler>>8&255),t.adler=0,a.status=h)):a.status=h),0!==a.pending){if(f(t),0===t.avail_out)return a.last_flush=-1,0}else if(0===t.avail_in&&m(e)<=m(n)&&4!==e)return p(t,-5);if(666===a.status&&0!==t.avail_in)return p(t,-5);if(0!==t.avail_in||0!==a.lookahead||0!==e&&666!==a.status){var w=2===a.strategy?function(t,e){for(var n;;){if(0===t.lookahead&&(x(t),0===t.lookahead)){if(0===e)return 1;break}if(t.match_length=0,n=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,n&&(b(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(b(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(b(t,!1),0===t.strm.avail_out)?1:2}(a,e):3===a.strategy?function(t,e){for(var n,i,a,r,s=t.window;;){if(t.lookahead<=d){if(x(t),t.lookahead<=d&&0===e)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&0<t.strstart&&(i=s[a=t.strstart-1])===s[++a]&&i===s[++a]&&i===s[++a]){r=t.strstart+d;do{}while(i===s[++a]&&i===s[++a]&&i===s[++a]&&i===s[++a]&&i===s[++a]&&i===s[++a]&&i===s[++a]&&i===s[++a]&&a<r);t.match_length=d-(r-a),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(n=o._tr_tally(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(n=o._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),n&&(b(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,4===e?(b(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(b(t,!1),0===t.strm.avail_out)?1:2}(a,e):i[a.level].func(a,e);if(3!==w&&4!==w||(a.status=666),1===w||3===w)return 0===t.avail_out&&(a.last_flush=-1),0;if(2===w&&(1===e?o._tr_align(a):5!==e&&(o._tr_stored_block(a,0,0,!1),3===e&&(g(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),f(t),0===t.avail_out))return a.last_flush=-1,0}return 4!==e?0:a.wrap<=0?1:(2===a.wrap?(y(a,255&t.adler),y(a,t.adler>>8&255),y(a,t.adler>>16&255),y(a,t.adler>>24&255),y(a,255&t.total_in),y(a,t.total_in>>8&255),y(a,t.total_in>>16&255),y(a,t.total_in>>24&255)):(v(a,t.adler>>>16),v(a,65535&t.adler)),f(t),0<a.wrap&&(a.wrap=-a.wrap),0!==a.pending?0:1)},n.deflateEnd=function(t){var e;return t&&t.state?42!==(e=t.state.status)&&69!==e&&73!==e&&91!==e&&103!==e&&e!==h&&666!==e?p(t,c):(t.state=null,e===h?p(t,-3):0):c},n.deflateSetDictionary=function(t,e){var n,i,o,s,l,d,u,h,p=e.length;if(!t||!t.state)return c;if(2===(s=(n=t.state).wrap)||1===s&&42!==n.status||n.lookahead)return c;for(1===s&&(t.adler=r(t.adler,e,p,0)),n.wrap=0,p>=n.w_size&&(0===s&&(g(n.head),n.strstart=0,n.block_start=0,n.insert=0),h=new a.Buf8(n.w_size),a.arraySet(h,e,p-n.w_size,n.w_size,0),e=h,p=n.w_size),l=t.avail_in,d=t.next_in,u=t.input,t.avail_in=p,t.next_in=0,t.input=e,x(n);n.lookahead>=3;){for(i=n.strstart,o=n.lookahead-2;n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+3-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++,--o;);n.strstart=i,n.lookahead=2,x(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=2,n.match_available=0,t.next_in=d,t.input=u,t.avail_in=l,n.wrap=s,0},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,e,n){"use strict";e.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,e,n){"use strict";e.exports=function(t,e){var n,i,a,o,r,s,l,c,d,u,h,p,m,g,f,b,y,v,w,x,S,C,T,O,_;n=t.state,i=t.next_in,O=t.input,a=i+(t.avail_in-5),o=t.next_out,_=t.output,r=o-(e-t.avail_out),s=o+(t.avail_out-257),l=n.dmax,c=n.wsize,d=n.whave,u=n.wnext,h=n.window,p=n.hold,m=n.bits,g=n.lencode,f=n.distcode,b=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;t:do{m<15&&(p+=O[i++]<<m,m+=8,p+=O[i++]<<m,m+=8),v=g[p&b];e:for(;;){if(p>>>=w=v>>>24,m-=w,0==(w=v>>>16&255))_[o++]=65535&v;else{if(!(16&w)){if(0==(64&w)){v=g[(65535&v)+(p&(1<<w)-1)];continue e}if(32&w){n.mode=12;break t}t.msg="invalid literal/length code",n.mode=30;break t}x=65535&v,(w&=15)&&(m<w&&(p+=O[i++]<<m,m+=8),x+=p&(1<<w)-1,p>>>=w,m-=w),m<15&&(p+=O[i++]<<m,m+=8,p+=O[i++]<<m,m+=8),v=f[p&y];n:for(;;){if(p>>>=w=v>>>24,m-=w,!(16&(w=v>>>16&255))){if(0==(64&w)){v=f[(65535&v)+(p&(1<<w)-1)];continue n}t.msg="invalid distance code",n.mode=30;break t}if(S=65535&v,m<(w&=15)&&(p+=O[i++]<<m,(m+=8)<w&&(p+=O[i++]<<m,m+=8)),l<(S+=p&(1<<w)-1)){t.msg="invalid distance too far back",n.mode=30;break t}if(p>>>=w,m-=w,(w=o-r)<S){if(d<(w=S-w)&&n.sane){t.msg="invalid distance too far back",n.mode=30;break t}if(T=h,(C=0)===u){if(C+=c-w,w<x){for(x-=w;_[o++]=h[C++],--w;);C=o-S,T=_}}else if(u<w){if(C+=c+u-w,(w-=u)<x){for(x-=w;_[o++]=h[C++],--w;);if(C=0,u<x){for(x-=w=u;_[o++]=h[C++],--w;);C=o-S,T=_}}}else if(C+=u-w,w<x){for(x-=w;_[o++]=h[C++],--w;);C=o-S,T=_}for(;2<x;)_[o++]=T[C++],_[o++]=T[C++],_[o++]=T[C++],x-=3;x&&(_[o++]=T[C++],1<x&&(_[o++]=T[C++]))}else{for(C=o-S;_[o++]=_[C++],_[o++]=_[C++],_[o++]=_[C++],2<(x-=3););x&&(_[o++]=_[C++],1<x&&(_[o++]=_[C++]))}break}}break}}while(i<a&&o<s);i-=x=m>>3,p&=(1<<(m-=x<<3))-1,t.next_in=i,t.next_out=o,t.avail_in=i<a?a-i+5:5-(i-a),t.avail_out=o<s?s-o+257:257-(o-s),n.hold=p,n.bits=m}},{}],49:[function(t,e,n){"use strict";var i=t("../utils/common"),a=t("./adler32"),o=t("./crc32"),r=t("./inffast"),s=t("./inftrees"),l=-2;function c(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function d(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function u(t){var e;return t&&t.state?(e=t.state,t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=1,e.last=0,e.havedict=0,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new i.Buf32(852),e.distcode=e.distdyn=new i.Buf32(592),e.sane=1,e.back=-1,0):l}function h(t){var e;return t&&t.state?((e=t.state).wsize=0,e.whave=0,e.wnext=0,u(t)):l}function p(t,e){var n,i;return t&&t.state?(i=t.state,e<0?(n=0,e=-e):(n=1+(e>>4),e<48&&(e&=15)),e&&(e<8||15<e)?l:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=n,i.wbits=e,h(t))):l}function m(t,e){var n,i;return t?(i=new d,(t.state=i).window=null,0!==(n=p(t,e))&&(t.state=null),n):l}var g,f,b=!0;function y(t){if(b){var e;for(g=new i.Buf32(512),f=new i.Buf32(32),e=0;e<144;)t.lens[e++]=8;for(;e<256;)t.lens[e++]=9;for(;e<280;)t.lens[e++]=7;for(;e<288;)t.lens[e++]=8;for(s(1,t.lens,0,288,g,0,t.work,{bits:9}),e=0;e<32;)t.lens[e++]=5;s(2,t.lens,0,32,f,0,t.work,{bits:5}),b=!1}t.lencode=g,t.lenbits=9,t.distcode=f,t.distbits=5}function v(t,e,n,a){var o,r=t.state;return null===r.window&&(r.wsize=1<<r.wbits,r.wnext=0,r.whave=0,r.window=new i.Buf8(r.wsize)),a>=r.wsize?(i.arraySet(r.window,e,n-r.wsize,r.wsize,0),r.wnext=0,r.whave=r.wsize):(a<(o=r.wsize-r.wnext)&&(o=a),i.arraySet(r.window,e,n-a,o,r.wnext),(a-=o)?(i.arraySet(r.window,e,n-a,a,0),r.wnext=a,r.whave=r.wsize):(r.wnext+=o,r.wnext===r.wsize&&(r.wnext=0),r.whave<r.wsize&&(r.whave+=o))),0}n.inflateReset=h,n.inflateReset2=p,n.inflateResetKeep=u,n.inflateInit=function(t){return m(t,15)},n.inflateInit2=m,n.inflate=function(t,e){var n,d,u,h,p,m,g,f,b,w,x,S,C,T,O,_,L,I,A,k,E,j,D,F,M=0,R=new i.Buf8(4),N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return l;12===(n=t.state).mode&&(n.mode=13),p=t.next_out,u=t.output,g=t.avail_out,h=t.next_in,d=t.input,m=t.avail_in,f=n.hold,b=n.bits,w=m,x=g,j=0;t:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;b<16;){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}if(2&n.wrap&&35615===f){R[n.check=0]=255&f,R[1]=f>>>8&255,n.check=o(n.check,R,2,0),b=f=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&f)<<8)+(f>>8))%31){t.msg="incorrect header check",n.mode=30;break}if(8!=(15&f)){t.msg="unknown compression method",n.mode=30;break}if(b-=4,E=8+(15&(f>>>=4)),0===n.wbits)n.wbits=E;else if(E>n.wbits){t.msg="invalid window size",n.mode=30;break}n.dmax=1<<E,t.adler=n.check=1,n.mode=512&f?10:12,b=f=0;break;case 2:for(;b<16;){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}if(n.flags=f,8!=(255&n.flags)){t.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){t.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=f>>8&1),512&n.flags&&(R[0]=255&f,R[1]=f>>>8&255,n.check=o(n.check,R,2,0)),b=f=0,n.mode=3;case 3:for(;b<32;){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}n.head&&(n.head.time=f),512&n.flags&&(R[0]=255&f,R[1]=f>>>8&255,R[2]=f>>>16&255,R[3]=f>>>24&255,n.check=o(n.check,R,4,0)),b=f=0,n.mode=4;case 4:for(;b<16;){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}n.head&&(n.head.xflags=255&f,n.head.os=f>>8),512&n.flags&&(R[0]=255&f,R[1]=f>>>8&255,n.check=o(n.check,R,2,0)),b=f=0,n.mode=5;case 5:if(1024&n.flags){for(;b<16;){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}n.length=f,n.head&&(n.head.extra_len=f),512&n.flags&&(R[0]=255&f,R[1]=f>>>8&255,n.check=o(n.check,R,2,0)),b=f=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&(m<(S=n.length)&&(S=m),S&&(n.head&&(E=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),i.arraySet(n.head.extra,d,h,S,E)),512&n.flags&&(n.check=o(n.check,d,S,h)),m-=S,h+=S,n.length-=S),n.length))break t;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===m)break t;for(S=0;E=d[h+S++],n.head&&E&&n.length<65536&&(n.head.name+=String.fromCharCode(E)),E&&S<m;);if(512&n.flags&&(n.check=o(n.check,d,S,h)),m-=S,h+=S,E)break t}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===m)break t;for(S=0;E=d[h+S++],n.head&&E&&n.length<65536&&(n.head.comment+=String.fromCharCode(E)),E&&S<m;);if(512&n.flags&&(n.check=o(n.check,d,S,h)),m-=S,h+=S,E)break t}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;b<16;){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}if(f!==(65535&n.check)){t.msg="header crc mismatch",n.mode=30;break}b=f=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),t.adler=n.check=0,n.mode=12;break;case 10:for(;b<32;){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}t.adler=n.check=c(f),b=f=0,n.mode=11;case 11:if(0===n.havedict)return t.next_out=p,t.avail_out=g,t.next_in=h,t.avail_in=m,n.hold=f,n.bits=b,2;t.adler=n.check=1,n.mode=12;case 12:if(5===e||6===e)break t;case 13:if(n.last){f>>>=7&b,b-=7&b,n.mode=27;break}for(;b<3;){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}switch(n.last=1&f,b-=1,3&(f>>>=1)){case 0:n.mode=14;break;case 1:if(y(n),n.mode=20,6!==e)break;f>>>=2,b-=2;break t;case 2:n.mode=17;break;case 3:t.msg="invalid block type",n.mode=30}f>>>=2,b-=2;break;case 14:for(f>>>=7&b,b-=7&b;b<32;){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}if((65535&f)!=(f>>>16^65535)){t.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&f,b=f=0,n.mode=15,6===e)break t;case 15:n.mode=16;case 16:if(S=n.length){if(m<S&&(S=m),g<S&&(S=g),0===S)break t;i.arraySet(u,d,h,S,p),m-=S,h+=S,g-=S,p+=S,n.length-=S;break}n.mode=12;break;case 17:for(;b<14;){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}if(n.nlen=257+(31&f),f>>>=5,b-=5,n.ndist=1+(31&f),f>>>=5,b-=5,n.ncode=4+(15&f),f>>>=4,b-=4,286<n.nlen||30<n.ndist){t.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;b<3;){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}n.lens[N[n.have++]]=7&f,f>>>=3,b-=3}for(;n.have<19;)n.lens[N[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,D={bits:n.lenbits},j=s(0,n.lens,0,19,n.lencode,0,n.work,D),n.lenbits=D.bits,j){t.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;_=(M=n.lencode[f&(1<<n.lenbits)-1])>>>16&255,L=65535&M,!((O=M>>>24)<=b);){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}if(L<16)f>>>=O,b-=O,n.lens[n.have++]=L;else{if(16===L){for(F=O+2;b<F;){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}if(f>>>=O,b-=O,0===n.have){t.msg="invalid bit length repeat",n.mode=30;break}E=n.lens[n.have-1],S=3+(3&f),f>>>=2,b-=2}else if(17===L){for(F=O+3;b<F;){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}b-=O,E=0,S=3+(7&(f>>>=O)),f>>>=3,b-=3}else{for(F=O+7;b<F;){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}b-=O,E=0,S=11+(127&(f>>>=O)),f>>>=7,b-=7}if(n.have+S>n.nlen+n.ndist){t.msg="invalid bit length repeat",n.mode=30;break}for(;S--;)n.lens[n.have++]=E}}if(30===n.mode)break;if(0===n.lens[256]){t.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,D={bits:n.lenbits},j=s(1,n.lens,0,n.nlen,n.lencode,0,n.work,D),n.lenbits=D.bits,j){t.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,D={bits:n.distbits},j=s(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,D),n.distbits=D.bits,j){t.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===e)break t;case 20:n.mode=21;case 21:if(6<=m&&258<=g){t.next_out=p,t.avail_out=g,t.next_in=h,t.avail_in=m,n.hold=f,n.bits=b,r(t,x),p=t.next_out,u=t.output,g=t.avail_out,h=t.next_in,d=t.input,m=t.avail_in,f=n.hold,b=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;_=(M=n.lencode[f&(1<<n.lenbits)-1])>>>16&255,L=65535&M,!((O=M>>>24)<=b);){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}if(_&&0==(240&_)){for(I=O,A=_,k=L;_=(M=n.lencode[k+((f&(1<<I+A)-1)>>I)])>>>16&255,L=65535&M,!(I+(O=M>>>24)<=b);){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}f>>>=I,b-=I,n.back+=I}if(f>>>=O,b-=O,n.back+=O,n.length=L,0===_){n.mode=26;break}if(32&_){n.back=-1,n.mode=12;break}if(64&_){t.msg="invalid literal/length code",n.mode=30;break}n.extra=15&_,n.mode=22;case 22:if(n.extra){for(F=n.extra;b<F;){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}n.length+=f&(1<<n.extra)-1,f>>>=n.extra,b-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;_=(M=n.distcode[f&(1<<n.distbits)-1])>>>16&255,L=65535&M,!((O=M>>>24)<=b);){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}if(0==(240&_)){for(I=O,A=_,k=L;_=(M=n.distcode[k+((f&(1<<I+A)-1)>>I)])>>>16&255,L=65535&M,!(I+(O=M>>>24)<=b);){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}f>>>=I,b-=I,n.back+=I}if(f>>>=O,b-=O,n.back+=O,64&_){t.msg="invalid distance code",n.mode=30;break}n.offset=L,n.extra=15&_,n.mode=24;case 24:if(n.extra){for(F=n.extra;b<F;){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}n.offset+=f&(1<<n.extra)-1,f>>>=n.extra,b-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){t.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===g)break t;if(S=x-g,n.offset>S){if((S=n.offset-S)>n.whave&&n.sane){t.msg="invalid distance too far back",n.mode=30;break}C=S>n.wnext?(S-=n.wnext,n.wsize-S):n.wnext-S,S>n.length&&(S=n.length),T=n.window}else T=u,C=p-n.offset,S=n.length;for(g<S&&(S=g),g-=S,n.length-=S;u[p++]=T[C++],--S;);0===n.length&&(n.mode=21);break;case 26:if(0===g)break t;u[p++]=n.length,g--,n.mode=21;break;case 27:if(n.wrap){for(;b<32;){if(0===m)break t;m--,f|=d[h++]<<b,b+=8}if(x-=g,t.total_out+=x,n.total+=x,x&&(t.adler=n.check=n.flags?o(n.check,u,x,p-x):a(n.check,u,x,p-x)),x=g,(n.flags?f:c(f))!==n.check){t.msg="incorrect data check",n.mode=30;break}b=f=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;b<32;){if(0===m)break t;m--,f+=d[h++]<<b,b+=8}if(f!==(4294967295&n.total)){t.msg="incorrect length check",n.mode=30;break}b=f=0}n.mode=29;case 29:j=1;break t;case 30:j=-3;break t;case 31:return-4;case 32:default:return l}return t.next_out=p,t.avail_out=g,t.next_in=h,t.avail_in=m,n.hold=f,n.bits=b,(n.wsize||x!==t.avail_out&&n.mode<30&&(n.mode<27||4!==e))&&v(t,t.output,t.next_out,x-t.avail_out)?(n.mode=31,-4):(w-=t.avail_in,x-=t.avail_out,t.total_in+=w,t.total_out+=x,n.total+=x,n.wrap&&x&&(t.adler=n.check=n.flags?o(n.check,u,x,t.next_out-x):a(n.check,u,x,t.next_out-x)),t.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==w&&0===x||4===e)&&0===j&&(j=-5),j)},n.inflateEnd=function(t){if(!t||!t.state)return l;var e=t.state;return e.window&&(e.window=null),t.state=null,0},n.inflateGetHeader=function(t,e){var n;return t&&t.state?0==(2&(n=t.state).wrap)?l:((n.head=e).done=!1,0):l},n.inflateSetDictionary=function(t,e){var n,i=e.length;return t&&t.state?0!==(n=t.state).wrap&&11!==n.mode?l:11===n.mode&&a(1,e,i,0)!==n.check?-3:v(t,e,i,i)?(n.mode=31,-4):(n.havedict=1,0):l},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,e,n){"use strict";var i=t("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],r=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(t,e,n,l,c,d,u,h){var p,m,g,f,b,y,v,w,x,S=h.bits,C=0,T=0,O=0,_=0,L=0,I=0,A=0,k=0,E=0,j=0,D=null,F=0,M=new i.Buf16(16),R=new i.Buf16(16),N=null,P=0;for(C=0;C<=15;C++)M[C]=0;for(T=0;T<l;T++)M[e[n+T]]++;for(L=S,_=15;1<=_&&0===M[_];_--);if(_<L&&(L=_),0===_)return c[d++]=20971520,c[d++]=20971520,h.bits=1,0;for(O=1;O<_&&0===M[O];O++);for(L<O&&(L=O),C=k=1;C<=15;C++)if(k<<=1,(k-=M[C])<0)return-1;if(0<k&&(0===t||1!==_))return-1;for(R[1]=0,C=1;C<15;C++)R[C+1]=R[C]+M[C];for(T=0;T<l;T++)0!==e[n+T]&&(u[R[e[n+T]]++]=T);if(y=0===t?(D=N=u,19):1===t?(D=a,F-=257,N=o,P-=257,256):(D=r,N=s,-1),C=O,b=d,A=T=j=0,g=-1,f=(E=1<<(I=L))-1,1===t&&852<E||2===t&&592<E)return 1;for(;;){for(v=C-A,x=u[T]<y?(w=0,u[T]):u[T]>y?(w=N[P+u[T]],D[F+u[T]]):(w=96,0),p=1<<C-A,O=m=1<<I;c[b+(j>>A)+(m-=p)]=v<<24|w<<16|x|0,0!==m;);for(p=1<<C-1;j&p;)p>>=1;if(0!==p?(j&=p-1,j+=p):j=0,T++,0==--M[C]){if(C===_)break;C=e[n+u[T]]}if(L<C&&(j&f)!==g){for(0===A&&(A=L),b+=O,k=1<<(I=C-A);I+A<_&&!((k-=M[I+A])<=0);)I++,k<<=1;if(E+=1<<I,1===t&&852<E||2===t&&592<E)return 1;c[g=j&f]=L<<24|I<<16|b-d|0}}return 0!==j&&(c[b+j]=C-A<<24|64<<16|0),h.bits=L,0}},{"../utils/common":41}],51:[function(t,e,n){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,e,n){"use strict";var i=t("../utils/common");function a(t){for(var e=t.length;0<=--e;)t[e]=0}var o=256,r=286,s=30,l=15,c=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],d=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],u=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],h=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],p=new Array(576);a(p);var m=new Array(60);a(m);var g=new Array(512);a(g);var f=new Array(256);a(f);var b=new Array(29);a(b);var y,v,w,x=new Array(s);function S(t,e,n,i,a){this.static_tree=t,this.extra_bits=e,this.extra_base=n,this.elems=i,this.max_length=a,this.has_stree=t&&t.length}function C(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}function T(t){return t<256?g[t]:g[256+(t>>>7)]}function O(t,e){t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255}function _(t,e,n){t.bi_valid>16-n?(t.bi_buf|=e<<t.bi_valid&65535,O(t,t.bi_buf),t.bi_buf=e>>16-t.bi_valid,t.bi_valid+=n-16):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=n)}function L(t,e,n){_(t,n[2*e],n[2*e+1])}function I(t,e){for(var n=0;n|=1&t,t>>>=1,n<<=1,0<--e;);return n>>>1}function A(t,e,n){var i,a,o=new Array(16),r=0;for(i=1;i<=l;i++)o[i]=r=r+n[i-1]<<1;for(a=0;a<=e;a++){var s=t[2*a+1];0!==s&&(t[2*a]=I(o[s]++,s))}}function k(t){var e;for(e=0;e<r;e++)t.dyn_ltree[2*e]=0;for(e=0;e<s;e++)t.dyn_dtree[2*e]=0;for(e=0;e<19;e++)t.bl_tree[2*e]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function E(t){8<t.bi_valid?O(t,t.bi_buf):0<t.bi_valid&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function j(t,e,n,i){var a=2*e,o=2*n;return t[a]<t[o]||t[a]===t[o]&&i[e]<=i[n]}function D(t,e,n){for(var i=t.heap[n],a=n<<1;a<=t.heap_len&&(a<t.heap_len&&j(e,t.heap[a+1],t.heap[a],t.depth)&&a++,!j(e,i,t.heap[a],t.depth));)t.heap[n]=t.heap[a],n=a,a<<=1;t.heap[n]=i}function F(t,e,n){var i,a,r,s,l=0;if(0!==t.last_lit)for(;i=t.pending_buf[t.d_buf+2*l]<<8|t.pending_buf[t.d_buf+2*l+1],a=t.pending_buf[t.l_buf+l],l++,0===i?L(t,a,e):(L(t,(r=f[a])+o+1,e),0!==(s=c[r])&&_(t,a-=b[r],s),L(t,r=T(--i),n),0!==(s=d[r])&&_(t,i-=x[r],s)),l<t.last_lit;);L(t,256,e)}function M(t,e){var n,i,a,o=e.dyn_tree,r=e.stat_desc.static_tree,s=e.stat_desc.has_stree,c=e.stat_desc.elems,d=-1;for(t.heap_len=0,t.heap_max=573,n=0;n<c;n++)0!==o[2*n]?(t.heap[++t.heap_len]=d=n,t.depth[n]=0):o[2*n+1]=0;for(;t.heap_len<2;)o[2*(a=t.heap[++t.heap_len]=d<2?++d:0)]=1,t.depth[a]=0,t.opt_len--,s&&(t.static_len-=r[2*a+1]);for(e.max_code=d,n=t.heap_len>>1;1<=n;n--)D(t,o,n);for(a=c;n=t.heap[1],t.heap[1]=t.heap[t.heap_len--],D(t,o,1),i=t.heap[1],t.heap[--t.heap_max]=n,t.heap[--t.heap_max]=i,o[2*a]=o[2*n]+o[2*i],t.depth[a]=(t.depth[n]>=t.depth[i]?t.depth[n]:t.depth[i])+1,o[2*n+1]=o[2*i+1]=a,t.heap[1]=a++,D(t,o,1),2<=t.heap_len;);t.heap[--t.heap_max]=t.heap[1],function(t,e){var n,i,a,o,r,s,c=e.dyn_tree,d=e.max_code,u=e.stat_desc.static_tree,h=e.stat_desc.has_stree,p=e.stat_desc.extra_bits,m=e.stat_desc.extra_base,g=e.stat_desc.max_length,f=0;for(o=0;o<=l;o++)t.bl_count[o]=0;for(c[2*t.heap[t.heap_max]+1]=0,n=t.heap_max+1;n<573;n++)g<(o=c[2*c[2*(i=t.heap[n])+1]+1]+1)&&(o=g,f++),c[2*i+1]=o,d<i||(t.bl_count[o]++,r=0,m<=i&&(r=p[i-m]),s=c[2*i],t.opt_len+=s*(o+r),h&&(t.static_len+=s*(u[2*i+1]+r)));if(0!==f){do{for(o=g-1;0===t.bl_count[o];)o--;t.bl_count[o]--,t.bl_count[o+1]+=2,t.bl_count[g]--,f-=2}while(0<f);for(o=g;0!==o;o--)for(i=t.bl_count[o];0!==i;)d<(a=t.heap[--n])||(c[2*a+1]!==o&&(t.opt_len+=(o-c[2*a+1])*c[2*a],c[2*a+1]=o),i--)}}(t,e),A(o,d,t.bl_count)}function R(t,e,n){var i,a,o=-1,r=e[1],s=0,l=7,c=4;for(0===r&&(l=138,c=3),e[2*(n+1)+1]=65535,i=0;i<=n;i++)a=r,r=e[2*(i+1)+1],++s<l&&a===r||(s<c?t.bl_tree[2*a]+=s:0!==a?(a!==o&&t.bl_tree[2*a]++,t.bl_tree[32]++):s<=10?t.bl_tree[34]++:t.bl_tree[36]++,o=a,c=(s=0)===r?(l=138,3):a===r?(l=6,3):(l=7,4))}function N(t,e,n){var i,a,o=-1,r=e[1],s=0,l=7,c=4;for(0===r&&(l=138,c=3),i=0;i<=n;i++)if(a=r,r=e[2*(i+1)+1],!(++s<l&&a===r)){if(s<c)for(;L(t,a,t.bl_tree),0!=--s;);else 0!==a?(a!==o&&(L(t,a,t.bl_tree),s--),L(t,16,t.bl_tree),_(t,s-3,2)):s<=10?(L(t,17,t.bl_tree),_(t,s-3,3)):(L(t,18,t.bl_tree),_(t,s-11,7));o=a,c=(s=0)===r?(l=138,3):a===r?(l=6,3):(l=7,4)}}a(x);var P=!1;function V(t,e,n,a){_(t,0+(a?1:0),3),function(t,e,n,a){E(t),O(t,n),O(t,~n),i.arraySet(t.pending_buf,t.window,e,n,t.pending),t.pending+=n}(t,e,n)}n._tr_init=function(t){P||(function(){var t,e,n,i,a,o=new Array(16);for(i=n=0;i<28;i++)for(b[i]=n,t=0;t<1<<c[i];t++)f[n++]=i;for(f[n-1]=i,i=a=0;i<16;i++)for(x[i]=a,t=0;t<1<<d[i];t++)g[a++]=i;for(a>>=7;i<s;i++)for(x[i]=a<<7,t=0;t<1<<d[i]-7;t++)g[256+a++]=i;for(e=0;e<=l;e++)o[e]=0;for(t=0;t<=143;)p[2*t+1]=8,t++,o[8]++;for(;t<=255;)p[2*t+1]=9,t++,o[9]++;for(;t<=279;)p[2*t+1]=7,t++,o[7]++;for(;t<=287;)p[2*t+1]=8,t++,o[8]++;for(A(p,287,o),t=0;t<s;t++)m[2*t+1]=5,m[2*t]=I(t,5);y=new S(p,c,257,r,l),v=new S(m,d,0,s,l),w=new S(new Array(0),u,0,19,7)}(),P=!0),t.l_desc=new C(t.dyn_ltree,y),t.d_desc=new C(t.dyn_dtree,v),t.bl_desc=new C(t.bl_tree,w),t.bi_buf=0,t.bi_valid=0,k(t)},n._tr_stored_block=V,n._tr_flush_block=function(t,e,n,i){var a,r,s=0;0<t.level?(2===t.strm.data_type&&(t.strm.data_type=function(t){var e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<o;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0}(t)),M(t,t.l_desc),M(t,t.d_desc),s=function(t){var e;for(R(t,t.dyn_ltree,t.l_desc.max_code),R(t,t.dyn_dtree,t.d_desc.max_code),M(t,t.bl_desc),e=18;3<=e&&0===t.bl_tree[2*h[e]+1];e--);return t.opt_len+=3*(e+1)+5+5+4,e}(t),a=t.opt_len+3+7>>>3,(r=t.static_len+3+7>>>3)<=a&&(a=r)):a=r=n+5,n+4<=a&&-1!==e?V(t,e,n,i):4===t.strategy||r===a?(_(t,2+(i?1:0),3),F(t,p,m)):(_(t,4+(i?1:0),3),function(t,e,n,i){var a;for(_(t,e-257,5),_(t,n-1,5),_(t,i-4,4),a=0;a<i;a++)_(t,t.bl_tree[2*h[a]+1],3);N(t,t.dyn_ltree,e-1),N(t,t.dyn_dtree,n-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),F(t,t.dyn_ltree,t.dyn_dtree)),k(t),i&&E(t)},n._tr_tally=function(t,e,n){return t.pending_buf[t.d_buf+2*t.last_lit]=e>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&e,t.pending_buf[t.l_buf+t.last_lit]=255&n,t.last_lit++,0===e?t.dyn_ltree[2*n]++:(t.matches++,e--,t.dyn_ltree[2*(f[n]+o+1)]++,t.dyn_dtree[2*T(e)]++),t.last_lit===t.lit_bufsize-1},n._tr_align=function(t){_(t,2,3),L(t,256,p),function(t){16===t.bi_valid?(O(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},{"../utils/common":41}],53:[function(t,e,n){"use strict";e.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,e,n){"use strict";e.exports="function"==typeof setImmediate?setImmediate:function(){var t=[].slice.apply(arguments);t.splice(1,0,0),setTimeout.apply(null,t)}},{}]},{},[10])(10)},xOh4:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div class="tb-round-switch" fxLayout="column" [ngStyle]="{\'pointerEvents\': ctx.isEdit ? \'none\' : \'all\'}">\n  <div #switchTitleContainer fxFlex="20" class="title-container" fxLayout="row" fxLayoutAlign="center center" [fxShow]="showTitle">\n    <span #switchTitle class="switch-title">{{title}}</span>\n  </div>\n  <div #switchContainer fxFlex="{{showTitle ? 80 : 100}}" [ngStyle]="{paddingTop: showTitle ? \'5px\': \'10px\'}" id="switch-container" fxLayout="column" fxLayoutAlign="center center">\n    <div #switch class="switch">\n      <input #onoff type="checkbox" id="{{checkboxId}}" name="onoff" />\n      <div class="back">\n        <label class="but" for="{{checkboxId}}">\n          <span class="on">I</span>\n          <span class="off">0</span>\n        </label>\n      </div>\n    </div>\n  </div>\n  <div #switchErrorContainer class="error-container" [ngStyle]="{\'background\': error?.length ? \'rgba(255,255,255,0.25)\' : \'none\'}"\n       fxLayout="row" fxLayoutAlign="center center">\n    <span #switchError class="switch-error">{{ error }}</span>\n  </div>\n  <div #textMeasure id="text-measure"></div>\n</div>\n'},"y4O+":function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host ::ng-deep .mat-form-field-infix {\n  border-top: none;\n}'},yDMV:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<mat-tab-group [ngClass]="{\'tb-headless\': (widgetType === widgetTypes.static && !displayAdvanced())}"\n               class="tb-widget-config tb-absolute-fill" [(selectedIndex)]="selectedTab">\n  <mat-tab label="{{ \'widget-config.data\' | translate }}" [fxShow]="widgetType !== widgetTypes.static">\n    <div [formGroup]="dataSettings" class="mat-content mat-padding" fxLayout="column" fxLayoutGap="8px">\n      <div *ngIf="widgetType === widgetTypes.timeseries || widgetType === widgetTypes.alarm" fxFlex="100"\n           fxLayout.xs="column" fxLayoutGap="8px" fxLayoutAlign.xs="center" fxLayout="row" fxLayoutAlign="start center">\n        <div fxLayout="column" fxLayoutGap="8px" fxFlex.gt-xs>\n          <mat-checkbox formControlName="useDashboardTimewindow">\n            {{ \'widget-config.use-dashboard-timewindow\' | translate }}\n          </mat-checkbox>\n          <mat-checkbox formControlName="displayTimewindow">\n            {{ \'widget-config.display-timewindow\' | translate }}\n          </mat-checkbox>\n        </div>\n        <section fxLayout="row" fxLayoutAlign="start center" fxLayout.lt-lg="column" fxLayoutAlign.lt-lg="center start"\n                 fxFlex.gt-xs style="margin-bottom: 16px;">\n          <span [ngClass]="{\'tb-disabled-label\': dataSettings.get(\'useDashboardTimewindow\').value}" translate\n                style="padding-right: 8px;">widget-config.timewindow</span>\n          <tb-timewindow asButton="true"\n                         isEdit="true"\n                         aggregation="{{ widgetType === widgetTypes.timeseries }}"\n                         fxFlex formControlName="timewindow"></tb-timewindow>\n        </section>\n      </div>\n      <div *ngIf="widgetType === widgetTypes.alarm" fxLayout="column" fxLayoutAlign="center">\n        <div fxLayout="column" fxLayoutAlign="center" fxLayout.gt-xs="row" fxLayoutAlign.gt-xs="start center"\n             fxLayoutGap="8px">\n          <mat-form-field fxFlex class="mat-block">\n            <mat-label translate>alarm.alarm-status</mat-label>\n            <mat-select formControlName="alarmSearchStatus">\n              <mat-option *ngFor="let searchStatus of alarmSearchStatuses" [value]="searchStatus">\n                {{ (\'alarm.search-status.\' + searchStatus) | translate }}\n              </mat-option>\n            </mat-select>\n          </mat-form-field>\n          <mat-form-field fxFlex class="mat-block">\n            <mat-label translate>alarm.polling-interval</mat-label>\n            <input matInput required\n                   formControlName="alarmsPollingInterval"\n                   type="number"\n                   step="1"/>\n            <mat-error *ngIf="dataSettings.get(\'alarmsPollingInterval\').hasError(\'required\')">\n              {{ \'alarm.polling-interval-required\' | translate }}\n            </mat-error>\n            <mat-error *ngIf="dataSettings.get(\'alarmsPollingInterval\').hasError(\'min\')">\n              {{ \'alarm.min-polling-interval-message\' | translate }}\n            </mat-error>\n          </mat-form-field>\n        </div>\n        <div fxLayout="column" fxLayoutAlign="center" fxLayout.gt-xs="row" fxLayoutAlign.gt-xs="start center"\n             fxLayoutGap="8px">\n          <mat-form-field fxFlex class="mat-block">\n            <mat-label translate>alarm.max-count-load</mat-label>\n            <input matInput required\n                   formControlName="alarmsMaxCountLoad"\n                   type="number"\n                   min="0"\n                   step="1">\n            <mat-error *ngIf="dataSettings.get(\'alarmsMaxCountLoad\').hasError(\'required\')">\n              {{ \'alarm.max-count-load-required\' | translate }}\n            </mat-error>\n            <mat-error *ngIf="dataSettings.get(\'alarmsMaxCountLoad\').hasError(\'min\')">\n              {{ \'alarm.max-count-load-error-min\' | translate }}\n            </mat-error>\n          </mat-form-field>\n          <mat-form-field fxFlex class="mat-block">\n            <mat-label translate>alarm.fetch-size</mat-label>\n            <input matInput required\n                   formControlName="alarmsFetchSize"\n                   type="number"\n                   min="10"\n                   step="1">\n            <mat-error *ngIf="dataSettings.get(\'alarmsFetchSize\').hasError(\'required\')">\n              {{ \'alarm.fetch-size-required\' | translate }}\n            </mat-error>\n            <mat-error *ngIf="dataSettings.get(\'alarmsFetchSize\').hasError(\'min\')">\n              {{ \'alarm.fetch-size-error-min\' | translate }}\n            </mat-error>\n          </mat-form-field>\n        </div>\n      </div>\n      <mat-expansion-panel class="tb-datasources" *ngIf="widgetType !== widgetTypes.rpc &&\n                                  widgetType !== widgetTypes.alarm &&\n                                  widgetType !== widgetTypes.static &&\n                                  modelValue?.isDataEnabled" [expanded]="true">\n        <mat-expansion-panel-header>\n          <mat-panel-title fxLayout="column">\n            <div class="tb-panel-title" translate>widget-config.datasources</div>\n            <div *ngIf="modelValue?.typeParameters && modelValue?.typeParameters.maxDatasources > -1"\n                 class="tb-panel-hint">{{ \'widget-config.maximum-datasources\' | translate:{count: modelValue?.typeParameters.maxDatasources} }}</div>\n          </mat-panel-title>\n        </mat-expansion-panel-header>\n        <div *ngIf="datasourcesFormArray().length === 0; else datasourcesTemplate">\n              <span translate fxLayoutAlign="center center"\n                    class="tb-prompt">datasource.add-datasource-prompt</span>\n        </div>\n        <ng-template #datasourcesTemplate>\n          <div fxFlex fxLayout="row" fxLayoutAlign="start center">\n            <span fxFlex="5"></span>\n            <div fxFlex fxLayout="row" fxLayoutAlign="start center"\n                 style="padding: 0 0 0 10px; margin: 5px;">\n              <span translate style="min-width: 110px;">widget-config.datasource-type</span>\n              <span fxHide fxShow.gt-sm translate fxFlex\n                    style="padding-left: 10px;">widget-config.datasource-parameters</span>\n              <span style="min-width: 40px;"></span>\n            </div>\n          </div>\n          <div style="overflow: auto; padding-bottom: 15px;">\n            <div fxFlex fxLayout="row" fxLayoutAlign="start center"\n                 formArrayName="datasources"\n                 *ngFor="let datasourceControl of datasourcesFormArray().controls; let $index = index;">\n              <span fxFlex="5">{{$index + 1}}.</span>\n              <div [formGroupName]="$index" class="mat-elevation-z4" fxFlex\n                   fxLayout="row"\n                   fxLayoutAlign="start center"\n                   style="padding: 0 0 0 10px; margin: 5px;">\n                <section fxFlex\n                         fxLayout="column"\n                         fxLayoutAlign="center"\n                         fxLayout.gt-sm="row"\n                         fxLayoutAlign.gt-sm="start center">\n                  <mat-form-field class="tb-datasource-type">\n                    <mat-select formControlName="type">\n                      <mat-option *ngFor="let datasourceType of datasourceTypes" [value]="datasourceType">\n                        {{ datasourceTypesTranslations.get(datasourceType) | translate }}\n                      </mat-option>\n                    </mat-select>\n                  </mat-form-field>\n                  <section class="tb-datasource" [ngSwitch]="datasourceControl.get(\'type\').value">\n                    <ng-template [ngSwitchCase]="datasourceType.function">\n                      <mat-form-field floatLabel="always"\n                                      class="tb-datasource-name" style="min-width: 200px;">\n                        <mat-label></mat-label>\n                        <input matInput\n                               placeholder="{{ \'datasource.name\' | translate }}"\n                               formControlName="name">\n                      </mat-form-field>\n                    </ng-template>\n                    <ng-template [ngSwitchCase]="datasourceType.entity">\n                      <tb-entity-alias-select\n                        [tbRequired]="datasourceControl.get(\'type\').value === datasourceType.entity"\n                        [aliasController]="aliasController"\n                        formControlName="entityAliasId"\n                        [callbacks]="widgetConfigCallbacks">\n                      </tb-entity-alias-select>\n                    </ng-template>\n                  </section>\n                  <tb-data-keys class="tb-data-keys" fxFlex\n                                [widgetType]="widgetType"\n                                [datasourceType]="datasourceControl.get(\'type\').value"\n                                [maxDataKeys]="modelValue?.typeParameters?.maxDataKeys"\n                                [optDataKeys]="modelValue?.typeParameters?.dataKeysOptional"\n                                [aliasController]="aliasController"\n                                [datakeySettingsSchema]="modelValue?.dataKeySettingsSchema"\n                                [callbacks]="widgetConfigCallbacks"\n                                [entityAliasId]="datasourceControl.get(\'entityAliasId\').value"\n                                formControlName="dataKeys">\n                  </tb-data-keys>\n                </section>\n                <button [disabled]="isLoading$ | async"\n                        type="button"\n                        mat-icon-button color="primary"\n                        style="min-width: 40px;"\n                        (click)="removeDatasource($index)"\n                        matTooltip="{{ \'widget-config.remove-datasource\' | translate }}"\n                        matTooltipPosition="above">\n                  <mat-icon>close</mat-icon>\n                </button>\n              </div>\n            </div>\n          </div>\n        </ng-template>\n        <div fxFlex fxLayout="row" fxLayoutAlign="start center">\n          <button [disabled]="isLoading$ | async"\n                  type="button"\n                  mat-raised-button color="primary"\n                  [fxShow]="modelValue?.typeParameters &&\n                            (modelValue?.typeParameters.maxDatasources == -1 || datasourcesFormArray().controls.length < modelValue?.typeParameters.maxDatasources)"\n                  (click)="addDatasource()"\n                  matTooltip="{{ \'widget-config.add-datasource\' | translate }}"\n                  matTooltipPosition="above">\n            <mat-icon>add</mat-icon>\n            <span translate>action.add</span>\n          </button>\n        </div>\n      </mat-expansion-panel>\n      <mat-expansion-panel class="tb-datasources" *ngIf="widgetType === widgetTypes.rpc &&\n                                  modelValue?.isDataEnabled" [expanded]="true">\n        <mat-expansion-panel-header>\n          <mat-panel-title>\n            {{ \'widget-config.target-device\' | translate }}\n          </mat-panel-title>\n        </mat-expansion-panel-header>\n        <div [formGroup]="targetDeviceSettings" style="padding: 0 5px;">\n          <tb-entity-alias-select fxFlex\n            [tbRequired]="!widgetEditMode"\n            [aliasController]="aliasController"\n            [allowedEntityTypes]="[entityTypes.DEVICE]"\n            [callbacks]="widgetConfigCallbacks"\n            formControlName="targetDeviceAliasId">\n          </tb-entity-alias-select>\n        </div>\n      </mat-expansion-panel>\n      <mat-expansion-panel class="tb-datasources" *ngIf="widgetType === widgetTypes.alarm &&\n                                  modelValue?.isDataEnabled" [expanded]="true">\n        <mat-expansion-panel-header>\n          <mat-panel-title>\n            {{ \'widget-config.alarm-source\' | translate }}\n          </mat-panel-title>\n        </mat-expansion-panel-header>\n        <div [formGroup]="alarmSourceSettings" style="padding: 0 5px;">\n          <section fxFlex\n                   fxLayout="column"\n                   fxLayoutAlign="center"\n                   fxLayout.gt-sm="row"\n                   fxLayoutAlign.gt-sm="start center">\n            <mat-form-field class="tb-datasource-type">\n              <mat-select formControlName="type">\n                <mat-option *ngFor="let datasourceType of datasourceTypes" [value]="datasourceType">\n                  {{ datasourceTypesTranslations.get(datasourceType) | translate }}\n                </mat-option>\n              </mat-select>\n            </mat-form-field>\n            <section class="tb-datasource" [ngSwitch]="alarmSourceSettings.get(\'type\').value">\n              <ng-template [ngSwitchCase]="datasourceType.function">\n                <mat-form-field floatLabel="always" [fxShow]="widgetType !== widgetTypes.alarm"\n                                class="tb-datasource-name" style="min-width: 200px;">\n                  <mat-label></mat-label>\n                  <input matInput\n                         placeholder="{{ \'datasource.name\' | translate }}"\n                         formControlName="name">\n                </mat-form-field>\n              </ng-template>\n              <ng-template [ngSwitchCase]="datasourceType.entity">\n                <tb-entity-alias-select\n                  [tbRequired]="alarmSourceSettings.get(\'type\').value === datasourceType.entity"\n                  [aliasController]="aliasController"\n                  formControlName="entityAliasId"\n                  [callbacks]="widgetConfigCallbacks">\n                </tb-entity-alias-select>\n              </ng-template>\n            </section>\n            <tb-data-keys class="tb-data-keys" fxFlex\n                          [widgetType]="widgetType"\n                          [datasourceType]="alarmSourceSettings.get(\'type\').value"\n                          [aliasController]="aliasController"\n                          [datakeySettingsSchema]="modelValue?.dataKeySettingsSchema"\n                          [callbacks]="widgetConfigCallbacks"\n                          [entityAliasId]="alarmSourceSettings.get(\'entityAliasId\').value"\n                          formControlName="dataKeys">\n            </tb-data-keys>\n          </section>\n        </div>\n      </mat-expansion-panel>\n    </div>\n  </mat-tab>\n  <mat-tab label="{{ \'widget-config.settings\' | translate }}">\n    <div class="mat-content mat-padding" fxLayout="column" fxLayoutGap="8px">\n      <div [formGroup]="widgetSettings" fxLayout="column" fxLayoutGap="8px">\n        <span translate>widget-config.general-settings</span>\n        <div fxLayout.xs="column" fxLayoutAlign.xs="center" fxLayout="row" fxLayoutAlign="start center">\n          <div fxLayout="column" fxLayoutAlign="center" fxFlex.sm="40%" fxFlex.gt-sm="30%">\n            <mat-form-field fxFlex class="mat-block">\n              <mat-label translate>widget-config.title</mat-label>\n              <input matInput formControlName="title">\n            </mat-form-field>\n            <mat-form-field fxFlex>\n              <mat-label translate>widget-config.title-tooltip</mat-label>\n              <input matInput formControlName="titleTooltip">\n            </mat-form-field>\n          </div>\n          <div fxFlex [fxShow]="widgetSettings.get(\'showTitle\').value">\n            <tb-json-object-edit\n              [editorStyle]="{minHeight: \'100px\'}"\n              required\n              label="{{ \'widget-config.title-style\' | translate }}"\n              formControlName="titleStyle"\n            ></tb-json-object-edit>\n          </div>\n        </div>\n        <div fxLayout="column" fxLayoutAlign="center" fxLayout.gt-md="row" fxLayoutAlign.gt-md="start center" fxFlex="100%"\n             fxLayoutGap="8px">\n          <div fxLayout.xs="column" fxLayoutAlign.xs="center" fxLayout="row" fxLayoutAlign="start center"\n               fxLayoutGap="8px" fxFlex.gt-md>\n            <mat-checkbox fxFlex formControlName="showTitleIcon">\n              {{ \'widget-config.display-icon\' | translate }}\n            </mat-checkbox>\n            <tb-material-icon-select fxFlex\n              formControlName="titleIcon">\n            </tb-material-icon-select>\n          </div>\n          <div fxLayout.xs="column" fxLayoutAlign.xs="center" fxLayout="row" fxLayoutAlign="start center"\n               fxLayoutGap="8px" fxFlex.gt-md>\n            <tb-color-input fxFlex\n                            label="{{\'widget-config.icon-color\' | translate}}"\n                            icon="format_color_fill"\n                            openOnInput\n                            formControlName="iconColor">\n            </tb-color-input>\n            <mat-form-field fxFlex>\n              <mat-label translate>widget-config.icon-size</mat-label>\n              <input matInput formControlName="iconSize">\n            </mat-form-field>\n          </div>\n        </div>\n        <div fxLayout.xs="column" fxLayoutAlign.xs="center" fxLayout="row" fxLayoutAlign="start center"\n             fxLayoutGap="8px">\n          <div fxLayout="column" fxLayoutAlign="center" fxLayoutGap="8px" fxFlex.sm="40%" fxFlex.gt-sm="30%">\n            <mat-checkbox formControlName="showTitle">\n              {{ \'widget-config.display-title\' | translate }}\n            </mat-checkbox>\n            <mat-checkbox formControlName="dropShadow">\n              {{ \'widget-config.drop-shadow\' | translate }}\n            </mat-checkbox>\n            <mat-checkbox formControlName="enableFullscreen">\n              {{ \'widget-config.enable-fullscreen\' | translate }}\n            </mat-checkbox>\n          </div>\n          <div fxFlex>\n            <tb-json-object-edit\n              [editorStyle]="{minHeight: \'100px\'}"\n              required\n              label="{{ \'widget-config.widget-style\' | translate }}"\n              formControlName="widgetStyle"\n            ></tb-json-object-edit>\n          </div>\n        </div>\n        <div fxLayout="column" fxLayoutAlign="center" fxLayout.gt-md="row" fxLayoutAlign.gt-md="start center"\n             fxFlex="100%" fxLayoutGap="8px">\n          <div fxLayout.xs="column" fxLayoutAlign.xs="center" fxLayout="row" fxLayoutAlign="start center"\n               fxLayoutGap="8px" fxFlex.gt-md>\n            <tb-color-input fxFlex\n                            label="{{\'widget-config.background-color\' | translate}}"\n                            icon="format_color_fill"\n                            openOnInput\n                            formControlName="backgroundColor">\n            </tb-color-input>\n            <tb-color-input fxFlex\n                            label="{{\'widget-config.text-color\' | translate}}"\n                            icon="format_color_fill"\n                            openOnInput\n                            formControlName="color">\n            </tb-color-input>\n          </div>\n          <div fxLayout.xs="column" fxLayoutAlign.xs="center" fxLayout="row" fxLayoutAlign="start center"\n               fxLayoutGap="8px" fxFlex.gt-md>\n            <mat-form-field fxFlex>\n              <mat-label translate>widget-config.padding</mat-label>\n              <input matInput formControlName="padding">\n            </mat-form-field>\n            <mat-form-field fxFlex>\n              <mat-label translate>widget-config.margin</mat-label>\n              <input matInput formControlName="margin">\n            </mat-form-field>\n          </div>\n        </div>\n        <div fxLayout.xs="column" fxLayoutAlign.xs="center" fxLayout="row" fxLayoutAlign="start center"\n             fxLayoutGap="8px">\n          <mat-form-field fxFlex>\n            <mat-label translate>widget-config.units</mat-label>\n            <input matInput formControlName="units">\n          </mat-form-field>\n          <mat-form-field fxFlex>\n            <mat-label translate>widget-config.decimals</mat-label>\n            <input matInput formControlName="decimals" type="number" min="0" max="15" step="1">\n          </mat-form-field>\n        </div>\n        <div [fxShow]="widgetType === widgetTypes.timeseries || widgetType === widgetTypes.latest"\n             fxLayout.xs="column" fxLayoutAlign.xs="center" fxLayout="row" fxLayoutAlign="start center"\n             fxLayoutGap="8px" fxFlex="100%">\n          <mat-checkbox fxFlex.gt-xs formControlName="showLegend">\n            {{ \'widget-config.display-legend\' | translate }}\n          </mat-checkbox>\n          <section fxFlex.gt-xs fxLayout="row" fxLayoutAlign="start center" style="margin-bottom: 16px;">\n            <tb-legend-config formControlName="legendConfig">\n            </tb-legend-config>\n          </section>\n        </div>\n      </div>\n      <div [formGroup]="layoutSettings" fxLayout="column" fxLayoutGap="8px">\n        <span translate>widget-config.mobile-mode-settings</span>\n        <div fxLayout.xs="column" fxLayoutAlign.xs="center" fxLayout="row" fxLayoutAlign="start center"\n             fxLayoutGap="8px">\n          <mat-form-field fxFlex>\n            <mat-label translate>widget-config.order</mat-label>\n            <input matInput formControlName="mobileOrder" type="number" step="1">\n          </mat-form-field>\n          <mat-form-field fxFlex>\n            <mat-label translate>widget-config.height</mat-label>\n            <input matInput formControlName="mobileHeight" type="number" min="1" max="10" step="1">\n          </mat-form-field>\n        </div>\n      </div>\n    </div>\n  </mat-tab>\n  <mat-tab *ngIf="displayAdvanced()" label="{{ \'widget-config.advanced\' | translate }}">\n    <div [formGroup]="advancedSettings" class="mat-content mat-padding tb-advanced-widget-config"\n         fxLayout="column">\n        <tb-json-form\n          formControlName="settings">\n        </tb-json-form>\n    </div>\n  </mat-tab>\n  <mat-tab label="{{ \'widget-config.actions\' | translate }}" [formGroup]="actionsSettings">\n    <tb-manage-widget-actions\n      [callbacks]="widgetConfigCallbacks"\n      formControlName="actionsData">\n    </tb-manage-widget-actions>\n  </mat-tab>\n</mat-tab-group>\n'},yOwA:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n("mrSG"),a=n("TYT/"),o=n("6onV"),r=function(t){function e(e){var n=t.call(this,e)||this;return n.store=e,n}return Object(i.d)(e,t),e.prototype.ngOnInit=function(){t.prototype.ngOnInit.call(this)},e.ctorParameters=function(){return[{type:o.Store}]},e=Object(i.c)([Object(a.Component)({selector:"tb-dashboard-tabs",template:Object(i.f)(n("AP+x")).default}),Object(i.g)("design:paramtypes",[o.Store])],e)}(n("AUWA").a)},z3OR:function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),n.d(e,"f",(function(){return a})),n.d(e,"e",(function(){return o})),n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return l})),function(t){t.name="NAME",t.type="TYPE",t.label="LABEL",t.clientAttribute="CLIENT_ATTRIBUTE",t.sharedAttribute="SHARED_ATTRIBUTE",t.serverAttribute="SERVER_ATTRIBUTE",t.timeseries="TIMESERIES",t.entityField="ENTITY_FIELD",t.accessToken="ACCESS_TOKEN",t.isGateway="IS_GATEWAY",t.description="DESCRIPTION"}(i||(i={}));var a=[i.name,i.type,i.accessToken],o=new Map([[i.name,"import.column-type.name"],[i.type,"import.column-type.type"],[i.label,"import.column-type.label"],[i.clientAttribute,"import.column-type.client-attribute"],[i.sharedAttribute,"import.column-type.shared-attribute"],[i.serverAttribute,"import.column-type.server-attribute"],[i.timeseries,"import.column-type.timeseries"],[i.entityField,"import.column-type.entity-field"],[i.accessToken,"import.column-type.access-token"],[i.isGateway,"import.column-type.isgateway"],[i.description,"import.column-type.description"]]),r={mimeType:"text/json",extension:"json"},s={mimeType:"application/zip",extension:"zip"};function l(t,e,n){var i=(e=e||{}).delim||",",a=e.header||!1,o={},r=t.split(/[\r\n]+/),s=c(r[0],i);if(s.length<2)return n("import.import-csv-number-columns-error"),-1;var l=a?r.slice(1,r.length):r;o.headers=s,o.rows=[];for(var u=0,h=l;u<h.length;u++){var p=h[u];if(0===p.length)break;var m=c(p,i);if(m.length!==o.headers.length)return n("import.import-csv-invalid-format-error",{line:a?o.rows.length+2:o.rows.length+1}),-1;for(var g=0;g<m.length;g++)m[g]=d(m[g]);o.rows.push(m)}return o}function c(t,e){var n,i,a;for(i=(n=t.split(e=e||",")).length-1;i>=0;i--)'"'===n[i].replace(/"\s+$/,'"').charAt(n[i].length-1)?(a=n[i].replace(/^\s+"/,'"')).length>1&&'"'===a.charAt(0)?n[i]=n[i].replace(/^\s*"|"\s*$/g,"").replace(/""/g,'"'):i?n.splice(i-1,2,[n[i-1],n[i]].join(e)):n=n.shift().split(e).concat(n):n[i].replace(/""/g,'"');return n}function d(t){return function(t){return t=t.replace(",","."),!isNaN(parseFloat(t))&&isFinite(t)}(t.replace(",","."))?parseFloat(t.replace(",",".")):0===t.search(/^(true|false)$/im)?"true"===t.toLowerCase():""===t?null:t}},zOCL:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<table mat-table [dataSource]="dataSource">\n  <ng-container matColumnDef="order">\n    <mat-header-cell *matHeaderCellDef style="min-width: 40px; max-width: 40px; width: 40px"></mat-header-cell>\n    <mat-cell *matCellDef="let column; let i = index">\n      {{ (i+1) }}\n    </mat-cell>\n  </ng-container>\n  <ng-container matColumnDef="sampleData">\n    <mat-header-cell *matHeaderCellDef style="flex: 0 0 30%;"> {{ \'import.column-example\' | translate }} </mat-header-cell>\n    <mat-cell *matCellDef="let column">\n      {{column.sampleData}}\n    </mat-cell>\n  </ng-container>\n  <ng-container matColumnDef="type">\n    <mat-header-cell *matHeaderCellDef style="flex: 0 0 40%"> {{ \'import.column-type.column-type\' | translate }} </mat-header-cell>\n    <mat-cell *matCellDef="let column">\n      <mat-select matInput [(ngModel)]="column.type" (ngModelChange)="columnsUpdated()">\n        <mat-option *ngFor="let type of columnTypes" [value]="type.value" [disabled]="type.disabled">\n          {{ columnTypesTranslations.get(type.value) | translate }}\n        </mat-option>\n      </mat-select>\n    </mat-cell>\n  </ng-container>\n  <ng-container matColumnDef="key">\n    <mat-header-cell *matHeaderCellDef style="flex: 0 0 30%"> {{ \'import.column-key\' | translate }} </mat-header-cell>\n    <mat-cell *matCellDef="let column">\n      <mat-form-field floatLabel="always" hideRequiredMarker\n                      *ngIf="isColumnTypeDiffers(column.type)">\n        <mat-label></mat-label>\n        <input matInput required\n               [(ngModel)]="column.key" (ngModelChange)="columnsUpdated()"\n               placeholder="{{ \'import.column-value\' | translate }}"/>\n      </mat-form-field>\n    </mat-cell>\n  </ng-container>\n  <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>\n  <mat-row *matRowDef="let column; columns: displayedColumns;"></mat-row>\n</table>\n<mat-divider></mat-divider>\n'},zkmH:function(t,e,n){"use strict";n.r(e),e.default='\x3c!--\n\n    Copyright \xa9 2016-2020 The Thingsboard Authors\n\n    Licensed under the Apache License, Version 2.0 (the "License");\n    you may not use this file except in compliance with the License.\n    You may obtain a copy of the License at\n\n        http://www.apache.org/licenses/LICENSE-2.0\n\n    Unless required by applicable law or agreed to in writing, software\n    distributed under the License is distributed on an "AS IS" BASIS,\n    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n    See the License for the specific language governing permissions and\n    limitations under the License.\n\n--\x3e\n<div class="tb-relation-filters" [formGroup]="relationFiltersFormGroup">\n  <div class="container">\n    <div class="header" [fxShow]="relationFiltersFormArray().length">\n      <div fxLayout="row" fxLayoutAlign="start center">\n        <span class="cell" style="width: 200px; min-width: 200px;" translate>relation.type</span>\n        <span class="cell" fxFlex translate>entity.entity-types</span>\n        <span class="cell" style="width: 40px; min-width: 40px;">&nbsp;</span>\n      </div>\n    </div>\n    <div class="body" [fxShow]="relationFiltersFormArray().length">\n      <div class="row" fxFlex fxLayout="row"\n           fxLayoutAlign="start center" formArrayName="relationFilters"\n           *ngFor="let relationFilterControl of relationFiltersFormArray().controls; let $index = index">\n        <div class="mat-elevation-z1" fxFlex fxLayout="row" fxLayoutAlign="start center">\n          <tb-relation-type-autocomplete\n            class="cell" style="width: 200px; min-width: 200px;"\n            [formControl]="relationFilterControl.get(\'relationType\')">\n          </tb-relation-type-autocomplete>\n          <tb-entity-type-list class="cell" fxFlex\n            [allowedEntityTypes]="allowedEntityTypes"\n            [formControl]="relationFilterControl.get(\'entityTypes\')">\n          </tb-entity-type-list>\n          <button mat-icon-button color="primary"\n                  type="button"\n                  style="width: 40px; min-width: 40px;"\n                  (click)="removeFilter($index)"\n                  [disabled]="isLoading$ | async"\n                  matTooltip="{{ \'relation.remove-relation-filter\' | translate }}"\n                  matTooltipPosition="above">\n            <mat-icon>close</mat-icon>\n          </button>\n        </div>\n      </div>\n    </div>\n  </div>\n  <div class="any-filter" [fxShow]="!relationFiltersFormArray().length">\n        <span fxLayoutAlign="center center"\n              class="tb-prompt" translate>relation.any-relation</span>\n  </div>\n  <div>\n    <button mat-raised-button color="primary"\n            [disabled]="isLoading$ | async"\n            (click)="addFilter()"\n            type="button"\n            matTooltip="{{ \'relation.add-relation-filter\' | translate }}"\n            matTooltipPosition="above">\n      <mat-icon>add</mat-icon>\n      {{ \'action.add\' | translate }}\n    </button>\n  </div>\n</div>\n'},zt1W:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host {\n  background-color: #f9f9f9;\n}'},ztIS:function(t,e,n){"use strict";n.r(e),e.default='@charset "UTF-8";\n/**\n * Copyright \xa9 2016-2020 The Thingsboard Authors\n *\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n:host {\n  width: 100%;\n  height: 100%;\n}\n:host form,\n:host fieldset {\n  height: 100%;\n}\n:host .mat-content {\n  overflow: hidden;\n  background-color: #fff;\n}\n:host .mat-padding {\n  padding: 16px;\n}'}}]);